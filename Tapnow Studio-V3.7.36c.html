<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tapnow Studio</title>
  <script type="module" crossorigin>var cv=Object.defineProperty;var im=e=>{throw TypeError(e)};var uv=(e,t,r)=>t in e?cv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Pn=(e,t,r)=>uv(e,typeof t!="symbol"?t+"":t,r),dv=(e,t,r)=>t.has(e)||im("Cannot "+r);var om=(e,t,r)=>t.has(e)?im("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r);var Qc=(e,t,r)=>(dv(e,t,"access private method"),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();var xi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ex(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var tx={exports:{}},gd={},nx={exports:{}},sn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mc=Symbol.for("react.element"),pv=Symbol.for("react.portal"),fv=Symbol.for("react.fragment"),hv=Symbol.for("react.strict_mode"),mv=Symbol.for("react.profiler"),gv=Symbol.for("react.provider"),xv=Symbol.for("react.context"),yv=Symbol.for("react.forward_ref"),bv=Symbol.for("react.suspense"),vv=Symbol.for("react.memo"),wv=Symbol.for("react.lazy"),am=Symbol.iterator;function kv(e){return e===null||typeof e!="object"?null:(e=am&&e[am]||e["@@iterator"],typeof e=="function"?e:null)}var rx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sx=Object.assign,ix={};function La(e,t,r){this.props=e,this.context=t,this.refs=ix,this.updater=r||rx}La.prototype.isReactComponent={};La.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};La.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ox(){}ox.prototype=La.prototype;function n0(e,t,r){this.props=e,this.context=t,this.refs=ix,this.updater=r||rx}var r0=n0.prototype=new ox;r0.constructor=n0;sx(r0,La.prototype);r0.isPureReactComponent=!0;var lm=Array.isArray,ax=Object.prototype.hasOwnProperty,s0={current:null},lx={key:!0,ref:!0,__self:!0,__source:!0};function cx(e,t,r){var s,o={},a=null,l=null;if(t!=null)for(s in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(a=""+t.key),t)ax.call(t,s)&&!lx.hasOwnProperty(s)&&(o[s]=t[s]);var u=arguments.length-2;if(u===1)o.children=r;else if(1<u){for(var m=Array(u),v=0;v<u;v++)m[v]=arguments[v+2];o.children=m}if(e&&e.defaultProps)for(s in u=e.defaultProps,u)o[s]===void 0&&(o[s]=u[s]);return{$$typeof:mc,type:e,key:a,ref:l,props:o,_owner:s0.current}}function zv(e,t){return{$$typeof:mc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function i0(e){return typeof e=="object"&&e!==null&&e.$$typeof===mc}function jv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var cm=/\/+/g;function xp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?jv(""+e.key):t.toString(36)}function Eu(e,t,r,s,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case mc:case pv:l=!0}}if(l)return l=e,o=o(l),e=s===""?"."+xp(l,0):s,lm(o)?(r="",e!=null&&(r=e.replace(cm,"$&/")+"/"),Eu(o,t,r,"",function(v){return v})):o!=null&&(i0(o)&&(o=zv(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(cm,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=s===""?".":s+":",lm(e))for(var u=0;u<e.length;u++){a=e[u];var m=s+xp(a,u);l+=Eu(a,t,r,m,o)}else if(m=kv(e),typeof m=="function")for(e=m.call(e),u=0;!(a=e.next()).done;)a=a.value,m=s+xp(a,u++),l+=Eu(a,t,r,m,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function eu(e,t,r){if(e==null)return e;var s=[],o=0;return Eu(e,s,"","",function(a){return t.call(r,a,o++)}),s}function Nv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Dr={current:null},Iu={transition:null},_v={ReactCurrentDispatcher:Dr,ReactCurrentBatchConfig:Iu,ReactCurrentOwner:s0};function ux(){throw Error("act(...) is not supported in production builds of React.")}sn.Children={map:eu,forEach:function(e,t,r){eu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return eu(e,function(){t++}),t},toArray:function(e){return eu(e,function(t){return t})||[]},only:function(e){if(!i0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};sn.Component=La;sn.Fragment=fv;sn.Profiler=mv;sn.PureComponent=n0;sn.StrictMode=hv;sn.Suspense=bv;sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_v;sn.act=ux;sn.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=sx({},e.props),o=e.key,a=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,l=s0.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(m in t)ax.call(t,m)&&!lx.hasOwnProperty(m)&&(s[m]=t[m]===void 0&&u!==void 0?u[m]:t[m])}var m=arguments.length-2;if(m===1)s.children=r;else if(1<m){u=Array(m);for(var v=0;v<m;v++)u[v]=arguments[v+2];s.children=u}return{$$typeof:mc,type:e.type,key:o,ref:a,props:s,_owner:l}};sn.createContext=function(e){return e={$$typeof:xv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:gv,_context:e},e.Consumer=e};sn.createElement=cx;sn.createFactory=function(e){var t=cx.bind(null,e);return t.type=e,t};sn.createRef=function(){return{current:null}};sn.forwardRef=function(e){return{$$typeof:yv,render:e}};sn.isValidElement=i0;sn.lazy=function(e){return{$$typeof:wv,_payload:{_status:-1,_result:e},_init:Nv}};sn.memo=function(e,t){return{$$typeof:vv,type:e,compare:t===void 0?null:t}};sn.startTransition=function(e){var t=Iu.transition;Iu.transition={};try{e()}finally{Iu.transition=t}};sn.unstable_act=ux;sn.useCallback=function(e,t){return Dr.current.useCallback(e,t)};sn.useContext=function(e){return Dr.current.useContext(e)};sn.useDebugValue=function(){};sn.useDeferredValue=function(e){return Dr.current.useDeferredValue(e)};sn.useEffect=function(e,t){return Dr.current.useEffect(e,t)};sn.useId=function(){return Dr.current.useId()};sn.useImperativeHandle=function(e,t,r){return Dr.current.useImperativeHandle(e,t,r)};sn.useInsertionEffect=function(e,t){return Dr.current.useInsertionEffect(e,t)};sn.useLayoutEffect=function(e,t){return Dr.current.useLayoutEffect(e,t)};sn.useMemo=function(e,t){return Dr.current.useMemo(e,t)};sn.useReducer=function(e,t,r){return Dr.current.useReducer(e,t,r)};sn.useRef=function(e){return Dr.current.useRef(e)};sn.useState=function(e){return Dr.current.useState(e)};sn.useSyncExternalStore=function(e,t,r){return Dr.current.useSyncExternalStore(e,t,r)};sn.useTransition=function(){return Dr.current.useTransition()};sn.version="18.3.1";nx.exports=sn;var D=nx.exports;const xd=ex(D);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sv=D,Cv=Symbol.for("react.element"),Ev=Symbol.for("react.fragment"),Iv=Object.prototype.hasOwnProperty,$v=Sv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mv={key:!0,ref:!0,__self:!0,__source:!0};function dx(e,t,r){var s,o={},a=null,l=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(l=t.ref);for(s in t)Iv.call(t,s)&&!Mv.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:Cv,type:e,key:a,ref:l,props:o,_owner:$v.current}}gd.Fragment=Ev;gd.jsx=dx;gd.jsxs=dx;tx.exports=gd;var i=tx.exports,tf={},px={exports:{}},ls={},fx={exports:{}},hx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(we,Ne){var et=we.length;we.push(Ne);e:for(;0<et;){var ee=et-1>>>1,ae=we[ee];if(0<o(ae,Ne))we[ee]=Ne,we[et]=ae,et=ee;else break e}}function r(we){return we.length===0?null:we[0]}function s(we){if(we.length===0)return null;var Ne=we[0],et=we.pop();if(et!==Ne){we[0]=et;e:for(var ee=0,ae=we.length,Te=ae>>>1;ee<Te;){var it=2*(ee+1)-1,Pe=we[it],Gt=it+1,an=we[Gt];if(0>o(Pe,et))Gt<ae&&0>o(an,Pe)?(we[ee]=an,we[Gt]=et,ee=Gt):(we[ee]=Pe,we[it]=et,ee=it);else if(Gt<ae&&0>o(an,et))we[ee]=an,we[Gt]=et,ee=Gt;else break e}}return Ne}function o(we,Ne){var et=we.sortIndex-Ne.sortIndex;return et!==0?et:we.id-Ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var m=[],v=[],I=1,$=null,_=3,b=!1,T=!1,k=!1,R=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(we){for(var Ne=r(v);Ne!==null;){if(Ne.callback===null)s(v);else if(Ne.startTime<=we)s(v),Ne.sortIndex=Ne.expirationTime,t(m,Ne);else break;Ne=r(v)}}function L(we){if(k=!1,P(we),!T)if(r(m)!==null)T=!0,lt(Y);else{var Ne=r(v);Ne!==null&&Se(L,Ne.startTime-we)}}function Y(we,Ne){T=!1,k&&(k=!1,x(be),be=-1),b=!0;var et=_;try{for(P(Ne),$=r(m);$!==null&&(!($.expirationTime>Ne)||we&&!We());){var ee=$.callback;if(typeof ee=="function"){$.callback=null,_=$.priorityLevel;var ae=ee($.expirationTime<=Ne);Ne=e.unstable_now(),typeof ae=="function"?$.callback=ae:$===r(m)&&s(m),P(Ne)}else s(m);$=r(m)}if($!==null)var Te=!0;else{var it=r(v);it!==null&&Se(L,it.startTime-Ne),Te=!1}return Te}finally{$=null,_=et,b=!1}}var oe=!1,ie=null,be=-1,ye=5,he=-1;function We(){return!(e.unstable_now()-he<ye)}function X(){if(ie!==null){var we=e.unstable_now();he=we;var Ne=!0;try{Ne=ie(!0,we)}finally{Ne?ke():(oe=!1,ie=null)}}else oe=!1}var ke;if(typeof w=="function")ke=function(){w(X)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,xe=M.port2;M.port1.onmessage=X,ke=function(){xe.postMessage(null)}}else ke=function(){R(X,0)};function lt(we){ie=we,oe||(oe=!0,ke())}function Se(we,Ne){be=R(function(){we(e.unstable_now())},Ne)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(we){we.callback=null},e.unstable_continueExecution=function(){T||b||(T=!0,lt(Y))},e.unstable_forceFrameRate=function(we){0>we||125<we?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ye=0<we?Math.floor(1e3/we):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return r(m)},e.unstable_next=function(we){switch(_){case 1:case 2:case 3:var Ne=3;break;default:Ne=_}var et=_;_=Ne;try{return we()}finally{_=et}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(we,Ne){switch(we){case 1:case 2:case 3:case 4:case 5:break;default:we=3}var et=_;_=we;try{return Ne()}finally{_=et}},e.unstable_scheduleCallback=function(we,Ne,et){var ee=e.unstable_now();switch(typeof et=="object"&&et!==null?(et=et.delay,et=typeof et=="number"&&0<et?ee+et:ee):et=ee,we){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=et+ae,we={id:I++,callback:Ne,priorityLevel:we,startTime:et,expirationTime:ae,sortIndex:-1},et>ee?(we.sortIndex=et,t(v,we),r(m)===null&&we===r(v)&&(k?(x(be),be=-1):k=!0,Se(L,et-ee))):(we.sortIndex=ae,t(m,we),T||b||(T=!0,lt(Y))),we},e.unstable_shouldYield=We,e.unstable_wrapCallback=function(we){var Ne=_;return function(){var et=_;_=Ne;try{return we.apply(this,arguments)}finally{_=et}}}})(hx);fx.exports=hx;var Tv=fx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pv=D,as=Tv;function tt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mx=new Set,ql={};function Uo(e,t){Ma(e,t),Ma(e+"Capture",t)}function Ma(e,t){for(ql[e]=t,e=0;e<t.length;e++)mx.add(t[e])}var ki=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nf=Object.prototype.hasOwnProperty,Av=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,um={},dm={};function Rv(e){return nf.call(dm,e)?!0:nf.call(um,e)?!1:Av.test(e)?dm[e]=!0:(um[e]=!0,!1)}function Dv(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ov(e,t,r,s){if(t===null||typeof t>"u"||Dv(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Or(e,t,r,s,o,a,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=l}var vr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){vr[e]=new Or(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];vr[t]=new Or(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){vr[e]=new Or(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){vr[e]=new Or(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){vr[e]=new Or(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){vr[e]=new Or(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){vr[e]=new Or(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){vr[e]=new Or(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){vr[e]=new Or(e,5,!1,e.toLowerCase(),null,!1,!1)});var o0=/[\-:]([a-z])/g;function a0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(o0,a0);vr[t]=new Or(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(o0,a0);vr[t]=new Or(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(o0,a0);vr[t]=new Or(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){vr[e]=new Or(e,1,!1,e.toLowerCase(),null,!1,!1)});vr.xlinkHref=new Or("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){vr[e]=new Or(e,1,!1,e.toLowerCase(),null,!0,!0)});function l0(e,t,r,s){var o=vr.hasOwnProperty(t)?vr[t]:null;(o!==null?o.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ov(t,r,o,s)&&(r=null),s||o===null?Rv(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,s=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var _i=Pv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tu=Symbol.for("react.element"),ha=Symbol.for("react.portal"),ma=Symbol.for("react.fragment"),c0=Symbol.for("react.strict_mode"),rf=Symbol.for("react.profiler"),gx=Symbol.for("react.provider"),xx=Symbol.for("react.context"),u0=Symbol.for("react.forward_ref"),sf=Symbol.for("react.suspense"),of=Symbol.for("react.suspense_list"),d0=Symbol.for("react.memo"),Ki=Symbol.for("react.lazy"),yx=Symbol.for("react.offscreen"),pm=Symbol.iterator;function gl(e){return e===null||typeof e!="object"?null:(e=pm&&e[pm]||e["@@iterator"],typeof e=="function"?e:null)}var Gn=Object.assign,yp;function Pl(e){if(yp===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);yp=t&&t[1]||""}return`
`+yp+e}var bp=!1;function vp(e,t){if(!e||bp)return"";bp=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(v){var s=v}Reflect.construct(e,[],t)}else{try{t.call()}catch(v){s=v}e.call(t.prototype)}else{try{throw Error()}catch(v){s=v}e()}}catch(v){if(v&&s&&typeof v.stack=="string"){for(var o=v.stack.split(`
`),a=s.stack.split(`
`),l=o.length-1,u=a.length-1;1<=l&&0<=u&&o[l]!==a[u];)u--;for(;1<=l&&0<=u;l--,u--)if(o[l]!==a[u]){if(l!==1||u!==1)do if(l--,u--,0>u||o[l]!==a[u]){var m=`
`+o[l].replace(" at new "," at ");return e.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",e.displayName)),m}while(1<=l&&0<=u);break}}}finally{bp=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Pl(e):""}function Lv(e){switch(e.tag){case 5:return Pl(e.type);case 16:return Pl("Lazy");case 13:return Pl("Suspense");case 19:return Pl("SuspenseList");case 0:case 2:case 15:return e=vp(e.type,!1),e;case 11:return e=vp(e.type.render,!1),e;case 1:return e=vp(e.type,!0),e;default:return""}}function af(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ma:return"Fragment";case ha:return"Portal";case rf:return"Profiler";case c0:return"StrictMode";case sf:return"Suspense";case of:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case xx:return(e.displayName||"Context")+".Consumer";case gx:return(e._context.displayName||"Context")+".Provider";case u0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case d0:return t=e.displayName||null,t!==null?t:af(e.type)||"Memo";case Ki:t=e._payload,e=e._init;try{return af(e(t))}catch{}}return null}function Uv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return af(t);case 8:return t===c0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function oo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function bx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Fv(e){var t=bx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(l){s=""+l,a.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(l){s=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function nu(e){e._valueTracker||(e._valueTracker=Fv(e))}function vx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=bx(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function Wu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function lf(e,t){var r=t.checked;return Gn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function fm(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=oo(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function wx(e,t){t=t.checked,t!=null&&l0(e,"checked",t,!1)}function cf(e,t){wx(e,t);var r=oo(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?uf(e,t.type,r):t.hasOwnProperty("defaultValue")&&uf(e,t.type,oo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hm(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function uf(e,t,r){(t!=="number"||Wu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Al=Array.isArray;function _a(e,t,r,s){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&s&&(e[r].defaultSelected=!0)}else{for(r=""+oo(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function df(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(tt(91));return Gn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function mm(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(tt(92));if(Al(r)){if(1<r.length)throw Error(tt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:oo(r)}}function kx(e,t){var r=oo(t.value),s=oo(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function gm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function zx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?zx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ru,jx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ru=ru||document.createElement("div"),ru.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ru.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ql(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Fl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Bv=["Webkit","ms","Moz","O"];Object.keys(Fl).forEach(function(e){Bv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fl[t]=Fl[e]})});function Nx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Fl.hasOwnProperty(e)&&Fl[e]?(""+t).trim():t+"px"}function _x(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,o=Nx(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,o):e[r]=o}}var Wv=Gn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ff(e,t){if(t){if(Wv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(tt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(tt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(tt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(tt(62))}}function hf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mf=null;function p0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gf=null,Sa=null,Ca=null;function xm(e){if(e=yc(e)){if(typeof gf!="function")throw Error(tt(280));var t=e.stateNode;t&&(t=kd(t),gf(e.stateNode,e.type,t))}}function Sx(e){Sa?Ca?Ca.push(e):Ca=[e]:Sa=e}function Cx(){if(Sa){var e=Sa,t=Ca;if(Ca=Sa=null,xm(e),t)for(e=0;e<t.length;e++)xm(t[e])}}function Ex(e,t){return e(t)}function Ix(){}var wp=!1;function $x(e,t,r){if(wp)return e(t,r);wp=!0;try{return Ex(e,t,r)}finally{wp=!1,(Sa!==null||Ca!==null)&&(Ix(),Cx())}}function ec(e,t){var r=e.stateNode;if(r===null)return null;var s=kd(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(tt(231,t,typeof r));return r}var xf=!1;if(ki)try{var xl={};Object.defineProperty(xl,"passive",{get:function(){xf=!0}}),window.addEventListener("test",xl,xl),window.removeEventListener("test",xl,xl)}catch{xf=!1}function Hv(e,t,r,s,o,a,l,u,m){var v=Array.prototype.slice.call(arguments,3);try{t.apply(r,v)}catch(I){this.onError(I)}}var Bl=!1,Hu=null,Vu=!1,yf=null,Vv={onError:function(e){Bl=!0,Hu=e}};function Kv(e,t,r,s,o,a,l,u,m){Bl=!1,Hu=null,Hv.apply(Vv,arguments)}function Yv(e,t,r,s,o,a,l,u,m){if(Kv.apply(this,arguments),Bl){if(Bl){var v=Hu;Bl=!1,Hu=null}else throw Error(tt(198));Vu||(Vu=!0,yf=v)}}function Fo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Mx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ym(e){if(Fo(e)!==e)throw Error(tt(188))}function Gv(e){var t=e.alternate;if(!t){if(t=Fo(e),t===null)throw Error(tt(188));return t!==e?null:e}for(var r=e,s=t;;){var o=r.return;if(o===null)break;var a=o.alternate;if(a===null){if(s=o.return,s!==null){r=s;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===r)return ym(o),e;if(a===s)return ym(o),t;a=a.sibling}throw Error(tt(188))}if(r.return!==s.return)r=o,s=a;else{for(var l=!1,u=o.child;u;){if(u===r){l=!0,r=o,s=a;break}if(u===s){l=!0,s=o,r=a;break}u=u.sibling}if(!l){for(u=a.child;u;){if(u===r){l=!0,r=a,s=o;break}if(u===s){l=!0,s=a,r=o;break}u=u.sibling}if(!l)throw Error(tt(189))}}if(r.alternate!==s)throw Error(tt(190))}if(r.tag!==3)throw Error(tt(188));return r.stateNode.current===r?e:t}function Tx(e){return e=Gv(e),e!==null?Px(e):null}function Px(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Px(e);if(t!==null)return t;e=e.sibling}return null}var Ax=as.unstable_scheduleCallback,bm=as.unstable_cancelCallback,Xv=as.unstable_shouldYield,Jv=as.unstable_requestPaint,qn=as.unstable_now,Zv=as.unstable_getCurrentPriorityLevel,f0=as.unstable_ImmediatePriority,Rx=as.unstable_UserBlockingPriority,Ku=as.unstable_NormalPriority,qv=as.unstable_LowPriority,Dx=as.unstable_IdlePriority,yd=null,si=null;function Qv(e){if(si&&typeof si.onCommitFiberRoot=="function")try{si.onCommitFiberRoot(yd,e,void 0,(e.current.flags&128)===128)}catch{}}var Ws=Math.clz32?Math.clz32:nw,ew=Math.log,tw=Math.LN2;function nw(e){return e>>>=0,e===0?32:31-(ew(e)/tw|0)|0}var su=64,iu=4194304;function Rl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yu(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,o=e.suspendedLanes,a=e.pingedLanes,l=r&268435455;if(l!==0){var u=l&~o;u!==0?s=Rl(u):(a&=l,a!==0&&(s=Rl(a)))}else l=r&~o,l!==0?s=Rl(l):a!==0&&(s=Rl(a));if(s===0)return 0;if(t!==0&&t!==s&&!(t&o)&&(o=s&-s,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Ws(t),o=1<<r,s|=e[r],t&=~o;return s}function rw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sw(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var l=31-Ws(a),u=1<<l,m=o[l];m===-1?(!(u&r)||u&s)&&(o[l]=rw(u,t)):m<=t&&(e.expiredLanes|=u),a&=~u}}function bf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ox(){var e=su;return su<<=1,!(su&4194240)&&(su=64),e}function kp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function gc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ws(t),e[t]=r}function iw(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-Ws(r),a=1<<o;t[o]=0,s[o]=-1,e[o]=-1,r&=~a}}function h0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Ws(r),o=1<<s;o&t|e[s]&t&&(e[s]|=t),r&=~o}}var kn=0;function Lx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ux,m0,Fx,Bx,Wx,vf=!1,ou=[],qi=null,Qi=null,eo=null,tc=new Map,nc=new Map,Gi=[],ow="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vm(e,t){switch(e){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Qi=null;break;case"mouseover":case"mouseout":eo=null;break;case"pointerover":case"pointerout":tc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":nc.delete(t.pointerId)}}function yl(e,t,r,s,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:a,targetContainers:[o]},t!==null&&(t=yc(t),t!==null&&m0(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function aw(e,t,r,s,o){switch(t){case"focusin":return qi=yl(qi,e,t,r,s,o),!0;case"dragenter":return Qi=yl(Qi,e,t,r,s,o),!0;case"mouseover":return eo=yl(eo,e,t,r,s,o),!0;case"pointerover":var a=o.pointerId;return tc.set(a,yl(tc.get(a)||null,e,t,r,s,o)),!0;case"gotpointercapture":return a=o.pointerId,nc.set(a,yl(nc.get(a)||null,e,t,r,s,o)),!0}return!1}function Hx(e){var t=Co(e.target);if(t!==null){var r=Fo(t);if(r!==null){if(t=r.tag,t===13){if(t=Mx(r),t!==null){e.blockedOn=t,Wx(e.priority,function(){Fx(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $u(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=wf(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);mf=s,r.target.dispatchEvent(s),mf=null}else return t=yc(r),t!==null&&m0(t),e.blockedOn=r,!1;t.shift()}return!0}function wm(e,t,r){$u(e)&&r.delete(t)}function lw(){vf=!1,qi!==null&&$u(qi)&&(qi=null),Qi!==null&&$u(Qi)&&(Qi=null),eo!==null&&$u(eo)&&(eo=null),tc.forEach(wm),nc.forEach(wm)}function bl(e,t){e.blockedOn===t&&(e.blockedOn=null,vf||(vf=!0,as.unstable_scheduleCallback(as.unstable_NormalPriority,lw)))}function rc(e){function t(o){return bl(o,e)}if(0<ou.length){bl(ou[0],e);for(var r=1;r<ou.length;r++){var s=ou[r];s.blockedOn===e&&(s.blockedOn=null)}}for(qi!==null&&bl(qi,e),Qi!==null&&bl(Qi,e),eo!==null&&bl(eo,e),tc.forEach(t),nc.forEach(t),r=0;r<Gi.length;r++)s=Gi[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<Gi.length&&(r=Gi[0],r.blockedOn===null);)Hx(r),r.blockedOn===null&&Gi.shift()}var Ea=_i.ReactCurrentBatchConfig,Gu=!0;function cw(e,t,r,s){var o=kn,a=Ea.transition;Ea.transition=null;try{kn=1,g0(e,t,r,s)}finally{kn=o,Ea.transition=a}}function uw(e,t,r,s){var o=kn,a=Ea.transition;Ea.transition=null;try{kn=4,g0(e,t,r,s)}finally{kn=o,Ea.transition=a}}function g0(e,t,r,s){if(Gu){var o=wf(e,t,r,s);if(o===null)Mp(e,t,s,Xu,r),vm(e,s);else if(aw(o,e,t,r,s))s.stopPropagation();else if(vm(e,s),t&4&&-1<ow.indexOf(e)){for(;o!==null;){var a=yc(o);if(a!==null&&Ux(a),a=wf(e,t,r,s),a===null&&Mp(e,t,s,Xu,r),a===o)break;o=a}o!==null&&s.stopPropagation()}else Mp(e,t,s,null,r)}}var Xu=null;function wf(e,t,r,s){if(Xu=null,e=p0(s),e=Co(e),e!==null)if(t=Fo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Mx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xu=e,null}function Vx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zv()){case f0:return 1;case Rx:return 4;case Ku:case qv:return 16;case Dx:return 536870912;default:return 16}default:return 16}}var Ji=null,x0=null,Mu=null;function Kx(){if(Mu)return Mu;var e,t=x0,r=t.length,s,o="value"in Ji?Ji.value:Ji.textContent,a=o.length;for(e=0;e<r&&t[e]===o[e];e++);var l=r-e;for(s=1;s<=l&&t[r-s]===o[a-s];s++);return Mu=o.slice(e,1<s?1-s:void 0)}function Tu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function au(){return!0}function km(){return!1}function cs(e){function t(r,s,o,a,l){this._reactName=r,this._targetInst=o,this.type=s,this.nativeEvent=a,this.target=l,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(r=e[u],this[u]=r?r(a):a[u]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?au:km,this.isPropagationStopped=km,this}return Gn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=au)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=au)},persist:function(){},isPersistent:au}),t}var Ua={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},y0=cs(Ua),xc=Gn({},Ua,{view:0,detail:0}),dw=cs(xc),zp,jp,vl,bd=Gn({},xc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:b0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vl&&(vl&&e.type==="mousemove"?(zp=e.screenX-vl.screenX,jp=e.screenY-vl.screenY):jp=zp=0,vl=e),zp)},movementY:function(e){return"movementY"in e?e.movementY:jp}}),zm=cs(bd),pw=Gn({},bd,{dataTransfer:0}),fw=cs(pw),hw=Gn({},xc,{relatedTarget:0}),Np=cs(hw),mw=Gn({},Ua,{animationName:0,elapsedTime:0,pseudoElement:0}),gw=cs(mw),xw=Gn({},Ua,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yw=cs(xw),bw=Gn({},Ua,{data:0}),jm=cs(bw),vw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ww={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zw(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=kw[e])?!!t[e]:!1}function b0(){return zw}var jw=Gn({},xc,{key:function(e){if(e.key){var t=vw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Tu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ww[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:b0,charCode:function(e){return e.type==="keypress"?Tu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Tu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nw=cs(jw),_w=Gn({},bd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nm=cs(_w),Sw=Gn({},xc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:b0}),Cw=cs(Sw),Ew=Gn({},Ua,{propertyName:0,elapsedTime:0,pseudoElement:0}),Iw=cs(Ew),$w=Gn({},bd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mw=cs($w),Tw=[9,13,27,32],v0=ki&&"CompositionEvent"in window,Wl=null;ki&&"documentMode"in document&&(Wl=document.documentMode);var Pw=ki&&"TextEvent"in window&&!Wl,Yx=ki&&(!v0||Wl&&8<Wl&&11>=Wl),_m=" ",Sm=!1;function Gx(e,t){switch(e){case"keyup":return Tw.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ga=!1;function Aw(e,t){switch(e){case"compositionend":return Xx(t);case"keypress":return t.which!==32?null:(Sm=!0,_m);case"textInput":return e=t.data,e===_m&&Sm?null:e;default:return null}}function Rw(e,t){if(ga)return e==="compositionend"||!v0&&Gx(e,t)?(e=Kx(),Mu=x0=Ji=null,ga=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Yx&&t.locale!=="ko"?null:t.data;default:return null}}var Dw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Dw[e.type]:t==="textarea"}function Jx(e,t,r,s){Sx(s),t=Ju(t,"onChange"),0<t.length&&(r=new y0("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var Hl=null,sc=null;function Ow(e){ay(e,0)}function vd(e){var t=ba(e);if(vx(t))return e}function Lw(e,t){if(e==="change")return t}var Zx=!1;if(ki){var _p;if(ki){var Sp="oninput"in document;if(!Sp){var Em=document.createElement("div");Em.setAttribute("oninput","return;"),Sp=typeof Em.oninput=="function"}_p=Sp}else _p=!1;Zx=_p&&(!document.documentMode||9<document.documentMode)}function Im(){Hl&&(Hl.detachEvent("onpropertychange",qx),sc=Hl=null)}function qx(e){if(e.propertyName==="value"&&vd(sc)){var t=[];Jx(t,sc,e,p0(e)),$x(Ow,t)}}function Uw(e,t,r){e==="focusin"?(Im(),Hl=t,sc=r,Hl.attachEvent("onpropertychange",qx)):e==="focusout"&&Im()}function Fw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return vd(sc)}function Bw(e,t){if(e==="click")return vd(t)}function Ww(e,t){if(e==="input"||e==="change")return vd(t)}function Hw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vs=typeof Object.is=="function"?Object.is:Hw;function ic(e,t){if(Vs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var o=r[s];if(!nf.call(t,o)||!Vs(e[o],t[o]))return!1}return!0}function $m(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Mm(e,t){var r=$m(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=$m(r)}}function Qx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Qx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ey(){for(var e=window,t=Wu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Wu(e.document)}return t}function w0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Vw(e){var t=ey(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Qx(r.ownerDocument.documentElement,r)){if(s!==null&&w0(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,a=Math.min(s.start,o);s=s.end===void 0?a:Math.min(s.end,o),!e.extend&&a>s&&(o=s,s=a,a=o),o=Mm(r,a);var l=Mm(r,s);o&&l&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>s?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Kw=ki&&"documentMode"in document&&11>=document.documentMode,xa=null,kf=null,Vl=null,zf=!1;function Tm(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;zf||xa==null||xa!==Wu(s)||(s=xa,"selectionStart"in s&&w0(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Vl&&ic(Vl,s)||(Vl=s,s=Ju(kf,"onSelect"),0<s.length&&(t=new y0("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=xa)))}function lu(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ya={animationend:lu("Animation","AnimationEnd"),animationiteration:lu("Animation","AnimationIteration"),animationstart:lu("Animation","AnimationStart"),transitionend:lu("Transition","TransitionEnd")},Cp={},ty={};ki&&(ty=document.createElement("div").style,"AnimationEvent"in window||(delete ya.animationend.animation,delete ya.animationiteration.animation,delete ya.animationstart.animation),"TransitionEvent"in window||delete ya.transitionend.transition);function wd(e){if(Cp[e])return Cp[e];if(!ya[e])return e;var t=ya[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ty)return Cp[e]=t[r];return e}var ny=wd("animationend"),ry=wd("animationiteration"),sy=wd("animationstart"),iy=wd("transitionend"),oy=new Map,Pm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function lo(e,t){oy.set(e,t),Uo(t,[e])}for(var Ep=0;Ep<Pm.length;Ep++){var Ip=Pm[Ep],Yw=Ip.toLowerCase(),Gw=Ip[0].toUpperCase()+Ip.slice(1);lo(Yw,"on"+Gw)}lo(ny,"onAnimationEnd");lo(ry,"onAnimationIteration");lo(sy,"onAnimationStart");lo("dblclick","onDoubleClick");lo("focusin","onFocus");lo("focusout","onBlur");lo(iy,"onTransitionEnd");Ma("onMouseEnter",["mouseout","mouseover"]);Ma("onMouseLeave",["mouseout","mouseover"]);Ma("onPointerEnter",["pointerout","pointerover"]);Ma("onPointerLeave",["pointerout","pointerover"]);Uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dl));function Am(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,Yv(s,t,void 0,e),e.currentTarget=null}function ay(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],o=s.event;s=s.listeners;e:{var a=void 0;if(t)for(var l=s.length-1;0<=l;l--){var u=s[l],m=u.instance,v=u.currentTarget;if(u=u.listener,m!==a&&o.isPropagationStopped())break e;Am(o,u,v),a=m}else for(l=0;l<s.length;l++){if(u=s[l],m=u.instance,v=u.currentTarget,u=u.listener,m!==a&&o.isPropagationStopped())break e;Am(o,u,v),a=m}}}if(Vu)throw e=yf,Vu=!1,yf=null,e}function An(e,t){var r=t[Cf];r===void 0&&(r=t[Cf]=new Set);var s=e+"__bubble";r.has(s)||(ly(t,e,2,!1),r.add(s))}function $p(e,t,r){var s=0;t&&(s|=4),ly(r,e,s,t)}var cu="_reactListening"+Math.random().toString(36).slice(2);function oc(e){if(!e[cu]){e[cu]=!0,mx.forEach(function(r){r!=="selectionchange"&&(Xw.has(r)||$p(r,!1,e),$p(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cu]||(t[cu]=!0,$p("selectionchange",!1,t))}}function ly(e,t,r,s){switch(Vx(t)){case 1:var o=cw;break;case 4:o=uw;break;default:o=g0}r=o.bind(null,t,r,e),o=void 0,!xf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function Mp(e,t,r,s,o){var a=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var l=s.tag;if(l===3||l===4){var u=s.stateNode.containerInfo;if(u===o||u.nodeType===8&&u.parentNode===o)break;if(l===4)for(l=s.return;l!==null;){var m=l.tag;if((m===3||m===4)&&(m=l.stateNode.containerInfo,m===o||m.nodeType===8&&m.parentNode===o))return;l=l.return}for(;u!==null;){if(l=Co(u),l===null)return;if(m=l.tag,m===5||m===6){s=a=l;continue e}u=u.parentNode}}s=s.return}$x(function(){var v=a,I=p0(r),$=[];e:{var _=oy.get(e);if(_!==void 0){var b=y0,T=e;switch(e){case"keypress":if(Tu(r)===0)break e;case"keydown":case"keyup":b=Nw;break;case"focusin":T="focus",b=Np;break;case"focusout":T="blur",b=Np;break;case"beforeblur":case"afterblur":b=Np;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=zm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=fw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=Cw;break;case ny:case ry:case sy:b=gw;break;case iy:b=Iw;break;case"scroll":b=dw;break;case"wheel":b=Mw;break;case"copy":case"cut":case"paste":b=yw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=Nm}var k=(t&4)!==0,R=!k&&e==="scroll",x=k?_!==null?_+"Capture":null:_;k=[];for(var w=v,P;w!==null;){P=w;var L=P.stateNode;if(P.tag===5&&L!==null&&(P=L,x!==null&&(L=ec(w,x),L!=null&&k.push(ac(w,L,P)))),R)break;w=w.return}0<k.length&&(_=new b(_,T,null,r,I),$.push({event:_,listeners:k}))}}if(!(t&7)){e:{if(_=e==="mouseover"||e==="pointerover",b=e==="mouseout"||e==="pointerout",_&&r!==mf&&(T=r.relatedTarget||r.fromElement)&&(Co(T)||T[zi]))break e;if((b||_)&&(_=I.window===I?I:(_=I.ownerDocument)?_.defaultView||_.parentWindow:window,b?(T=r.relatedTarget||r.toElement,b=v,T=T?Co(T):null,T!==null&&(R=Fo(T),T!==R||T.tag!==5&&T.tag!==6)&&(T=null)):(b=null,T=v),b!==T)){if(k=zm,L="onMouseLeave",x="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(k=Nm,L="onPointerLeave",x="onPointerEnter",w="pointer"),R=b==null?_:ba(b),P=T==null?_:ba(T),_=new k(L,w+"leave",b,r,I),_.target=R,_.relatedTarget=P,L=null,Co(I)===v&&(k=new k(x,w+"enter",T,r,I),k.target=P,k.relatedTarget=R,L=k),R=L,b&&T)t:{for(k=b,x=T,w=0,P=k;P;P=ca(P))w++;for(P=0,L=x;L;L=ca(L))P++;for(;0<w-P;)k=ca(k),w--;for(;0<P-w;)x=ca(x),P--;for(;w--;){if(k===x||x!==null&&k===x.alternate)break t;k=ca(k),x=ca(x)}k=null}else k=null;b!==null&&Rm($,_,b,k,!1),T!==null&&R!==null&&Rm($,R,T,k,!0)}}e:{if(_=v?ba(v):window,b=_.nodeName&&_.nodeName.toLowerCase(),b==="select"||b==="input"&&_.type==="file")var Y=Lw;else if(Cm(_))if(Zx)Y=Ww;else{Y=Fw;var oe=Uw}else(b=_.nodeName)&&b.toLowerCase()==="input"&&(_.type==="checkbox"||_.type==="radio")&&(Y=Bw);if(Y&&(Y=Y(e,v))){Jx($,Y,r,I);break e}oe&&oe(e,_,v),e==="focusout"&&(oe=_._wrapperState)&&oe.controlled&&_.type==="number"&&uf(_,"number",_.value)}switch(oe=v?ba(v):window,e){case"focusin":(Cm(oe)||oe.contentEditable==="true")&&(xa=oe,kf=v,Vl=null);break;case"focusout":Vl=kf=xa=null;break;case"mousedown":zf=!0;break;case"contextmenu":case"mouseup":case"dragend":zf=!1,Tm($,r,I);break;case"selectionchange":if(Kw)break;case"keydown":case"keyup":Tm($,r,I)}var ie;if(v0)e:{switch(e){case"compositionstart":var be="onCompositionStart";break e;case"compositionend":be="onCompositionEnd";break e;case"compositionupdate":be="onCompositionUpdate";break e}be=void 0}else ga?Gx(e,r)&&(be="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(be="onCompositionStart");be&&(Yx&&r.locale!=="ko"&&(ga||be!=="onCompositionStart"?be==="onCompositionEnd"&&ga&&(ie=Kx()):(Ji=I,x0="value"in Ji?Ji.value:Ji.textContent,ga=!0)),oe=Ju(v,be),0<oe.length&&(be=new jm(be,e,null,r,I),$.push({event:be,listeners:oe}),ie?be.data=ie:(ie=Xx(r),ie!==null&&(be.data=ie)))),(ie=Pw?Aw(e,r):Rw(e,r))&&(v=Ju(v,"onBeforeInput"),0<v.length&&(I=new jm("onBeforeInput","beforeinput",null,r,I),$.push({event:I,listeners:v}),I.data=ie))}ay($,t)})}function ac(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ju(e,t){for(var r=t+"Capture",s=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=ec(e,r),a!=null&&s.unshift(ac(e,a,o)),a=ec(e,t),a!=null&&s.push(ac(e,a,o))),e=e.return}return s}function ca(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Rm(e,t,r,s,o){for(var a=t._reactName,l=[];r!==null&&r!==s;){var u=r,m=u.alternate,v=u.stateNode;if(m!==null&&m===s)break;u.tag===5&&v!==null&&(u=v,o?(m=ec(r,a),m!=null&&l.unshift(ac(r,m,u))):o||(m=ec(r,a),m!=null&&l.push(ac(r,m,u)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var Jw=/\r\n?/g,Zw=/\u0000|\uFFFD/g;function Dm(e){return(typeof e=="string"?e:""+e).replace(Jw,`
`).replace(Zw,"")}function uu(e,t,r){if(t=Dm(t),Dm(e)!==t&&r)throw Error(tt(425))}function Zu(){}var jf=null,Nf=null;function _f(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Sf=typeof setTimeout=="function"?setTimeout:void 0,qw=typeof clearTimeout=="function"?clearTimeout:void 0,Om=typeof Promise=="function"?Promise:void 0,Qw=typeof queueMicrotask=="function"?queueMicrotask:typeof Om<"u"?function(e){return Om.resolve(null).then(e).catch(e2)}:Sf;function e2(e){setTimeout(function(){throw e})}function Tp(e,t){var r=t,s=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(s===0){e.removeChild(o),rc(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=o}while(r);rc(t)}function to(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Lm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Fa=Math.random().toString(36).slice(2),ti="__reactFiber$"+Fa,lc="__reactProps$"+Fa,zi="__reactContainer$"+Fa,Cf="__reactEvents$"+Fa,t2="__reactListeners$"+Fa,n2="__reactHandles$"+Fa;function Co(e){var t=e[ti];if(t)return t;for(var r=e.parentNode;r;){if(t=r[zi]||r[ti]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Lm(e);e!==null;){if(r=e[ti])return r;e=Lm(e)}return t}e=r,r=e.parentNode}return null}function yc(e){return e=e[ti]||e[zi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ba(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(tt(33))}function kd(e){return e[lc]||null}var Ef=[],va=-1;function co(e){return{current:e}}function Rn(e){0>va||(e.current=Ef[va],Ef[va]=null,va--)}function In(e,t){va++,Ef[va]=e.current,e.current=t}var ao={},Sr=co(ao),Kr=co(!1),To=ao;function Ta(e,t){var r=e.type.contextTypes;if(!r)return ao;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in r)o[a]=t[a];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Yr(e){return e=e.childContextTypes,e!=null}function qu(){Rn(Kr),Rn(Sr)}function Um(e,t,r){if(Sr.current!==ao)throw Error(tt(168));In(Sr,t),In(Kr,r)}function cy(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var o in s)if(!(o in t))throw Error(tt(108,Uv(e)||"Unknown",o));return Gn({},r,s)}function Qu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ao,To=Sr.current,In(Sr,e),In(Kr,Kr.current),!0}function Fm(e,t,r){var s=e.stateNode;if(!s)throw Error(tt(169));r?(e=cy(e,t,To),s.__reactInternalMemoizedMergedChildContext=e,Rn(Kr),Rn(Sr),In(Sr,e)):Rn(Kr),In(Kr,r)}var gi=null,zd=!1,Pp=!1;function uy(e){gi===null?gi=[e]:gi.push(e)}function r2(e){zd=!0,uy(e)}function uo(){if(!Pp&&gi!==null){Pp=!0;var e=0,t=kn;try{var r=gi;for(kn=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}gi=null,zd=!1}catch(o){throw gi!==null&&(gi=gi.slice(e+1)),Ax(f0,uo),o}finally{kn=t,Pp=!1}}return null}var wa=[],ka=0,ed=null,td=0,xs=[],ys=0,Po=null,bi=1,vi="";function _o(e,t){wa[ka++]=td,wa[ka++]=ed,ed=e,td=t}function dy(e,t,r){xs[ys++]=bi,xs[ys++]=vi,xs[ys++]=Po,Po=e;var s=bi;e=vi;var o=32-Ws(s)-1;s&=~(1<<o),r+=1;var a=32-Ws(t)+o;if(30<a){var l=o-o%5;a=(s&(1<<l)-1).toString(32),s>>=l,o-=l,bi=1<<32-Ws(t)+o|r<<o|s,vi=a+e}else bi=1<<a|r<<o|s,vi=e}function k0(e){e.return!==null&&(_o(e,1),dy(e,1,0))}function z0(e){for(;e===ed;)ed=wa[--ka],wa[ka]=null,td=wa[--ka],wa[ka]=null;for(;e===Po;)Po=xs[--ys],xs[ys]=null,vi=xs[--ys],xs[ys]=null,bi=xs[--ys],xs[ys]=null}var os=null,is=null,Fn=!1,Bs=null;function py(e,t){var r=bs(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Bm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,os=e,is=to(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,os=e,is=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Po!==null?{id:bi,overflow:vi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=bs(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,os=e,is=null,!0):!1;default:return!1}}function If(e){return(e.mode&1)!==0&&(e.flags&128)===0}function $f(e){if(Fn){var t=is;if(t){var r=t;if(!Bm(e,t)){if(If(e))throw Error(tt(418));t=to(r.nextSibling);var s=os;t&&Bm(e,t)?py(s,r):(e.flags=e.flags&-4097|2,Fn=!1,os=e)}}else{if(If(e))throw Error(tt(418));e.flags=e.flags&-4097|2,Fn=!1,os=e}}}function Wm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;os=e}function du(e){if(e!==os)return!1;if(!Fn)return Wm(e),Fn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!_f(e.type,e.memoizedProps)),t&&(t=is)){if(If(e))throw fy(),Error(tt(418));for(;t;)py(e,t),t=to(t.nextSibling)}if(Wm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(tt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){is=to(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}is=null}}else is=os?to(e.stateNode.nextSibling):null;return!0}function fy(){for(var e=is;e;)e=to(e.nextSibling)}function Pa(){is=os=null,Fn=!1}function j0(e){Bs===null?Bs=[e]:Bs.push(e)}var s2=_i.ReactCurrentBatchConfig;function wl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(tt(309));var s=r.stateNode}if(!s)throw Error(tt(147,e));var o=s,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(l){var u=o.refs;l===null?delete u[a]:u[a]=l},t._stringRef=a,t)}if(typeof e!="string")throw Error(tt(284));if(!r._owner)throw Error(tt(290,e))}return e}function pu(e,t){throw e=Object.prototype.toString.call(t),Error(tt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Hm(e){var t=e._init;return t(e._payload)}function hy(e){function t(x,w){if(e){var P=x.deletions;P===null?(x.deletions=[w],x.flags|=16):P.push(w)}}function r(x,w){if(!e)return null;for(;w!==null;)t(x,w),w=w.sibling;return null}function s(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function o(x,w){return x=io(x,w),x.index=0,x.sibling=null,x}function a(x,w,P){return x.index=P,e?(P=x.alternate,P!==null?(P=P.index,P<w?(x.flags|=2,w):P):(x.flags|=2,w)):(x.flags|=1048576,w)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function u(x,w,P,L){return w===null||w.tag!==6?(w=Fp(P,x.mode,L),w.return=x,w):(w=o(w,P),w.return=x,w)}function m(x,w,P,L){var Y=P.type;return Y===ma?I(x,w,P.props.children,L,P.key):w!==null&&(w.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Ki&&Hm(Y)===w.type)?(L=o(w,P.props),L.ref=wl(x,w,P),L.return=x,L):(L=Uu(P.type,P.key,P.props,null,x.mode,L),L.ref=wl(x,w,P),L.return=x,L)}function v(x,w,P,L){return w===null||w.tag!==4||w.stateNode.containerInfo!==P.containerInfo||w.stateNode.implementation!==P.implementation?(w=Bp(P,x.mode,L),w.return=x,w):(w=o(w,P.children||[]),w.return=x,w)}function I(x,w,P,L,Y){return w===null||w.tag!==7?(w=Mo(P,x.mode,L,Y),w.return=x,w):(w=o(w,P),w.return=x,w)}function $(x,w,P){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Fp(""+w,x.mode,P),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case tu:return P=Uu(w.type,w.key,w.props,null,x.mode,P),P.ref=wl(x,null,w),P.return=x,P;case ha:return w=Bp(w,x.mode,P),w.return=x,w;case Ki:var L=w._init;return $(x,L(w._payload),P)}if(Al(w)||gl(w))return w=Mo(w,x.mode,P,null),w.return=x,w;pu(x,w)}return null}function _(x,w,P,L){var Y=w!==null?w.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return Y!==null?null:u(x,w,""+P,L);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case tu:return P.key===Y?m(x,w,P,L):null;case ha:return P.key===Y?v(x,w,P,L):null;case Ki:return Y=P._init,_(x,w,Y(P._payload),L)}if(Al(P)||gl(P))return Y!==null?null:I(x,w,P,L,null);pu(x,P)}return null}function b(x,w,P,L,Y){if(typeof L=="string"&&L!==""||typeof L=="number")return x=x.get(P)||null,u(w,x,""+L,Y);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case tu:return x=x.get(L.key===null?P:L.key)||null,m(w,x,L,Y);case ha:return x=x.get(L.key===null?P:L.key)||null,v(w,x,L,Y);case Ki:var oe=L._init;return b(x,w,P,oe(L._payload),Y)}if(Al(L)||gl(L))return x=x.get(P)||null,I(w,x,L,Y,null);pu(w,L)}return null}function T(x,w,P,L){for(var Y=null,oe=null,ie=w,be=w=0,ye=null;ie!==null&&be<P.length;be++){ie.index>be?(ye=ie,ie=null):ye=ie.sibling;var he=_(x,ie,P[be],L);if(he===null){ie===null&&(ie=ye);break}e&&ie&&he.alternate===null&&t(x,ie),w=a(he,w,be),oe===null?Y=he:oe.sibling=he,oe=he,ie=ye}if(be===P.length)return r(x,ie),Fn&&_o(x,be),Y;if(ie===null){for(;be<P.length;be++)ie=$(x,P[be],L),ie!==null&&(w=a(ie,w,be),oe===null?Y=ie:oe.sibling=ie,oe=ie);return Fn&&_o(x,be),Y}for(ie=s(x,ie);be<P.length;be++)ye=b(ie,x,be,P[be],L),ye!==null&&(e&&ye.alternate!==null&&ie.delete(ye.key===null?be:ye.key),w=a(ye,w,be),oe===null?Y=ye:oe.sibling=ye,oe=ye);return e&&ie.forEach(function(We){return t(x,We)}),Fn&&_o(x,be),Y}function k(x,w,P,L){var Y=gl(P);if(typeof Y!="function")throw Error(tt(150));if(P=Y.call(P),P==null)throw Error(tt(151));for(var oe=Y=null,ie=w,be=w=0,ye=null,he=P.next();ie!==null&&!he.done;be++,he=P.next()){ie.index>be?(ye=ie,ie=null):ye=ie.sibling;var We=_(x,ie,he.value,L);if(We===null){ie===null&&(ie=ye);break}e&&ie&&We.alternate===null&&t(x,ie),w=a(We,w,be),oe===null?Y=We:oe.sibling=We,oe=We,ie=ye}if(he.done)return r(x,ie),Fn&&_o(x,be),Y;if(ie===null){for(;!he.done;be++,he=P.next())he=$(x,he.value,L),he!==null&&(w=a(he,w,be),oe===null?Y=he:oe.sibling=he,oe=he);return Fn&&_o(x,be),Y}for(ie=s(x,ie);!he.done;be++,he=P.next())he=b(ie,x,be,he.value,L),he!==null&&(e&&he.alternate!==null&&ie.delete(he.key===null?be:he.key),w=a(he,w,be),oe===null?Y=he:oe.sibling=he,oe=he);return e&&ie.forEach(function(X){return t(x,X)}),Fn&&_o(x,be),Y}function R(x,w,P,L){if(typeof P=="object"&&P!==null&&P.type===ma&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case tu:e:{for(var Y=P.key,oe=w;oe!==null;){if(oe.key===Y){if(Y=P.type,Y===ma){if(oe.tag===7){r(x,oe.sibling),w=o(oe,P.props.children),w.return=x,x=w;break e}}else if(oe.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===Ki&&Hm(Y)===oe.type){r(x,oe.sibling),w=o(oe,P.props),w.ref=wl(x,oe,P),w.return=x,x=w;break e}r(x,oe);break}else t(x,oe);oe=oe.sibling}P.type===ma?(w=Mo(P.props.children,x.mode,L,P.key),w.return=x,x=w):(L=Uu(P.type,P.key,P.props,null,x.mode,L),L.ref=wl(x,w,P),L.return=x,x=L)}return l(x);case ha:e:{for(oe=P.key;w!==null;){if(w.key===oe)if(w.tag===4&&w.stateNode.containerInfo===P.containerInfo&&w.stateNode.implementation===P.implementation){r(x,w.sibling),w=o(w,P.children||[]),w.return=x,x=w;break e}else{r(x,w);break}else t(x,w);w=w.sibling}w=Bp(P,x.mode,L),w.return=x,x=w}return l(x);case Ki:return oe=P._init,R(x,w,oe(P._payload),L)}if(Al(P))return T(x,w,P,L);if(gl(P))return k(x,w,P,L);pu(x,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,w!==null&&w.tag===6?(r(x,w.sibling),w=o(w,P),w.return=x,x=w):(r(x,w),w=Fp(P,x.mode,L),w.return=x,x=w),l(x)):r(x,w)}return R}var Aa=hy(!0),my=hy(!1),nd=co(null),rd=null,za=null,N0=null;function _0(){N0=za=rd=null}function S0(e){var t=nd.current;Rn(nd),e._currentValue=t}function Mf(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function Ia(e,t){rd=e,N0=za=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vr=!0),e.firstContext=null)}function ws(e){var t=e._currentValue;if(N0!==e)if(e={context:e,memoizedValue:t,next:null},za===null){if(rd===null)throw Error(tt(308));za=e,rd.dependencies={lanes:0,firstContext:e}}else za=za.next=e;return t}var Eo=null;function C0(e){Eo===null?Eo=[e]:Eo.push(e)}function gy(e,t,r,s){var o=t.interleaved;return o===null?(r.next=r,C0(t)):(r.next=o.next,o.next=r),t.interleaved=r,ji(e,s)}function ji(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Yi=!1;function E0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xy(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function wi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function no(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,dn&2){var o=s.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),s.pending=t,ji(e,r)}return o=s.interleaved,o===null?(t.next=t,C0(s)):(t.next=o.next,o.next=t),s.interleaved=t,ji(e,r)}function Pu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,h0(e,r)}}function Vm(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var o=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?o=a=l:a=a.next=l,r=r.next}while(r!==null);a===null?o=a=t:a=a.next=t}else o=a=t;r={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function sd(e,t,r,s){var o=e.updateQueue;Yi=!1;var a=o.firstBaseUpdate,l=o.lastBaseUpdate,u=o.shared.pending;if(u!==null){o.shared.pending=null;var m=u,v=m.next;m.next=null,l===null?a=v:l.next=v,l=m;var I=e.alternate;I!==null&&(I=I.updateQueue,u=I.lastBaseUpdate,u!==l&&(u===null?I.firstBaseUpdate=v:u.next=v,I.lastBaseUpdate=m))}if(a!==null){var $=o.baseState;l=0,I=v=m=null,u=a;do{var _=u.lane,b=u.eventTime;if((s&_)===_){I!==null&&(I=I.next={eventTime:b,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var T=e,k=u;switch(_=t,b=r,k.tag){case 1:if(T=k.payload,typeof T=="function"){$=T.call(b,$,_);break e}$=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=k.payload,_=typeof T=="function"?T.call(b,$,_):T,_==null)break e;$=Gn({},$,_);break e;case 2:Yi=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,_=o.effects,_===null?o.effects=[u]:_.push(u))}else b={eventTime:b,lane:_,tag:u.tag,payload:u.payload,callback:u.callback,next:null},I===null?(v=I=b,m=$):I=I.next=b,l|=_;if(u=u.next,u===null){if(u=o.shared.pending,u===null)break;_=u,u=_.next,_.next=null,o.lastBaseUpdate=_,o.shared.pending=null}}while(!0);if(I===null&&(m=$),o.baseState=m,o.firstBaseUpdate=v,o.lastBaseUpdate=I,t=o.shared.interleaved,t!==null){o=t;do l|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);Ro|=l,e.lanes=l,e.memoizedState=$}}function Km(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],o=s.callback;if(o!==null){if(s.callback=null,s=r,typeof o!="function")throw Error(tt(191,o));o.call(s)}}}var bc={},ii=co(bc),cc=co(bc),uc=co(bc);function Io(e){if(e===bc)throw Error(tt(174));return e}function I0(e,t){switch(In(uc,t),In(cc,e),In(ii,bc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pf(t,e)}Rn(ii),In(ii,t)}function Ra(){Rn(ii),Rn(cc),Rn(uc)}function yy(e){Io(uc.current);var t=Io(ii.current),r=pf(t,e.type);t!==r&&(In(cc,e),In(ii,r))}function $0(e){cc.current===e&&(Rn(ii),Rn(cc))}var Kn=co(0);function id(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ap=[];function M0(){for(var e=0;e<Ap.length;e++)Ap[e]._workInProgressVersionPrimary=null;Ap.length=0}var Au=_i.ReactCurrentDispatcher,Rp=_i.ReactCurrentBatchConfig,Ao=0,Yn=null,ar=null,fr=null,od=!1,Kl=!1,dc=0,i2=0;function jr(){throw Error(tt(321))}function T0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Vs(e[r],t[r]))return!1;return!0}function P0(e,t,r,s,o,a){if(Ao=a,Yn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Au.current=e===null||e.memoizedState===null?c2:u2,e=r(s,o),Kl){a=0;do{if(Kl=!1,dc=0,25<=a)throw Error(tt(301));a+=1,fr=ar=null,t.updateQueue=null,Au.current=d2,e=r(s,o)}while(Kl)}if(Au.current=ad,t=ar!==null&&ar.next!==null,Ao=0,fr=ar=Yn=null,od=!1,t)throw Error(tt(300));return e}function A0(){var e=dc!==0;return dc=0,e}function ei(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?Yn.memoizedState=fr=e:fr=fr.next=e,fr}function ks(){if(ar===null){var e=Yn.alternate;e=e!==null?e.memoizedState:null}else e=ar.next;var t=fr===null?Yn.memoizedState:fr.next;if(t!==null)fr=t,ar=e;else{if(e===null)throw Error(tt(310));ar=e,e={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},fr===null?Yn.memoizedState=fr=e:fr=fr.next=e}return fr}function pc(e,t){return typeof t=="function"?t(e):t}function Dp(e){var t=ks(),r=t.queue;if(r===null)throw Error(tt(311));r.lastRenderedReducer=e;var s=ar,o=s.baseQueue,a=r.pending;if(a!==null){if(o!==null){var l=o.next;o.next=a.next,a.next=l}s.baseQueue=o=a,r.pending=null}if(o!==null){a=o.next,s=s.baseState;var u=l=null,m=null,v=a;do{var I=v.lane;if((Ao&I)===I)m!==null&&(m=m.next={lane:0,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null}),s=v.hasEagerState?v.eagerState:e(s,v.action);else{var $={lane:I,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null};m===null?(u=m=$,l=s):m=m.next=$,Yn.lanes|=I,Ro|=I}v=v.next}while(v!==null&&v!==a);m===null?l=s:m.next=u,Vs(s,t.memoizedState)||(Vr=!0),t.memoizedState=s,t.baseState=l,t.baseQueue=m,r.lastRenderedState=s}if(e=r.interleaved,e!==null){o=e;do a=o.lane,Yn.lanes|=a,Ro|=a,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Op(e){var t=ks(),r=t.queue;if(r===null)throw Error(tt(311));r.lastRenderedReducer=e;var s=r.dispatch,o=r.pending,a=t.memoizedState;if(o!==null){r.pending=null;var l=o=o.next;do a=e(a,l.action),l=l.next;while(l!==o);Vs(a,t.memoizedState)||(Vr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,s]}function by(){}function vy(e,t){var r=Yn,s=ks(),o=t(),a=!Vs(s.memoizedState,o);if(a&&(s.memoizedState=o,Vr=!0),s=s.queue,R0(zy.bind(null,r,s,e),[e]),s.getSnapshot!==t||a||fr!==null&&fr.memoizedState.tag&1){if(r.flags|=2048,fc(9,ky.bind(null,r,s,o,t),void 0,null),hr===null)throw Error(tt(349));Ao&30||wy(r,t,o)}return o}function wy(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Yn.updateQueue,t===null?(t={lastEffect:null,stores:null},Yn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function ky(e,t,r,s){t.value=r,t.getSnapshot=s,jy(t)&&Ny(e)}function zy(e,t,r){return r(function(){jy(t)&&Ny(e)})}function jy(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Vs(e,r)}catch{return!0}}function Ny(e){var t=ji(e,1);t!==null&&Hs(t,e,1,-1)}function Ym(e){var t=ei();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pc,lastRenderedState:e},t.queue=e,e=e.dispatch=l2.bind(null,Yn,e),[t.memoizedState,e]}function fc(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=Yn.updateQueue,t===null?(t={lastEffect:null,stores:null},Yn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function _y(){return ks().memoizedState}function Ru(e,t,r,s){var o=ei();Yn.flags|=e,o.memoizedState=fc(1|t,r,void 0,s===void 0?null:s)}function jd(e,t,r,s){var o=ks();s=s===void 0?null:s;var a=void 0;if(ar!==null){var l=ar.memoizedState;if(a=l.destroy,s!==null&&T0(s,l.deps)){o.memoizedState=fc(t,r,a,s);return}}Yn.flags|=e,o.memoizedState=fc(1|t,r,a,s)}function Gm(e,t){return Ru(8390656,8,e,t)}function R0(e,t){return jd(2048,8,e,t)}function Sy(e,t){return jd(4,2,e,t)}function Cy(e,t){return jd(4,4,e,t)}function Ey(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Iy(e,t,r){return r=r!=null?r.concat([e]):null,jd(4,4,Ey.bind(null,t,e),r)}function D0(){}function $y(e,t){var r=ks();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&T0(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function My(e,t){var r=ks();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&T0(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function Ty(e,t,r){return Ao&21?(Vs(r,t)||(r=Ox(),Yn.lanes|=r,Ro|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vr=!0),e.memoizedState=r)}function o2(e,t){var r=kn;kn=r!==0&&4>r?r:4,e(!0);var s=Rp.transition;Rp.transition={};try{e(!1),t()}finally{kn=r,Rp.transition=s}}function Py(){return ks().memoizedState}function a2(e,t,r){var s=so(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},Ay(e))Ry(t,r);else if(r=gy(e,t,r,s),r!==null){var o=Pr();Hs(r,e,s,o),Dy(r,t,s)}}function l2(e,t,r){var s=so(e),o={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ay(e))Ry(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var l=t.lastRenderedState,u=a(l,r);if(o.hasEagerState=!0,o.eagerState=u,Vs(u,l)){var m=t.interleaved;m===null?(o.next=o,C0(t)):(o.next=m.next,m.next=o),t.interleaved=o;return}}catch{}finally{}r=gy(e,t,o,s),r!==null&&(o=Pr(),Hs(r,e,s,o),Dy(r,t,s))}}function Ay(e){var t=e.alternate;return e===Yn||t!==null&&t===Yn}function Ry(e,t){Kl=od=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Dy(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,h0(e,r)}}var ad={readContext:ws,useCallback:jr,useContext:jr,useEffect:jr,useImperativeHandle:jr,useInsertionEffect:jr,useLayoutEffect:jr,useMemo:jr,useReducer:jr,useRef:jr,useState:jr,useDebugValue:jr,useDeferredValue:jr,useTransition:jr,useMutableSource:jr,useSyncExternalStore:jr,useId:jr,unstable_isNewReconciler:!1},c2={readContext:ws,useCallback:function(e,t){return ei().memoizedState=[e,t===void 0?null:t],e},useContext:ws,useEffect:Gm,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Ru(4194308,4,Ey.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ru(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ru(4,2,e,t)},useMemo:function(e,t){var r=ei();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=ei();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=a2.bind(null,Yn,e),[s.memoizedState,e]},useRef:function(e){var t=ei();return e={current:e},t.memoizedState=e},useState:Ym,useDebugValue:D0,useDeferredValue:function(e){return ei().memoizedState=e},useTransition:function(){var e=Ym(!1),t=e[0];return e=o2.bind(null,e[1]),ei().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=Yn,o=ei();if(Fn){if(r===void 0)throw Error(tt(407));r=r()}else{if(r=t(),hr===null)throw Error(tt(349));Ao&30||wy(s,t,r)}o.memoizedState=r;var a={value:r,getSnapshot:t};return o.queue=a,Gm(zy.bind(null,s,a,e),[e]),s.flags|=2048,fc(9,ky.bind(null,s,a,r,t),void 0,null),r},useId:function(){var e=ei(),t=hr.identifierPrefix;if(Fn){var r=vi,s=bi;r=(s&~(1<<32-Ws(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=dc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=i2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},u2={readContext:ws,useCallback:$y,useContext:ws,useEffect:R0,useImperativeHandle:Iy,useInsertionEffect:Sy,useLayoutEffect:Cy,useMemo:My,useReducer:Dp,useRef:_y,useState:function(){return Dp(pc)},useDebugValue:D0,useDeferredValue:function(e){var t=ks();return Ty(t,ar.memoizedState,e)},useTransition:function(){var e=Dp(pc)[0],t=ks().memoizedState;return[e,t]},useMutableSource:by,useSyncExternalStore:vy,useId:Py,unstable_isNewReconciler:!1},d2={readContext:ws,useCallback:$y,useContext:ws,useEffect:R0,useImperativeHandle:Iy,useInsertionEffect:Sy,useLayoutEffect:Cy,useMemo:My,useReducer:Op,useRef:_y,useState:function(){return Op(pc)},useDebugValue:D0,useDeferredValue:function(e){var t=ks();return ar===null?t.memoizedState=e:Ty(t,ar.memoizedState,e)},useTransition:function(){var e=Op(pc)[0],t=ks().memoizedState;return[e,t]},useMutableSource:by,useSyncExternalStore:vy,useId:Py,unstable_isNewReconciler:!1};function Us(e,t){if(e&&e.defaultProps){t=Gn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Tf(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:Gn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Nd={isMounted:function(e){return(e=e._reactInternals)?Fo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Pr(),o=so(e),a=wi(s,o);a.payload=t,r!=null&&(a.callback=r),t=no(e,a,o),t!==null&&(Hs(t,e,o,s),Pu(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Pr(),o=so(e),a=wi(s,o);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=no(e,a,o),t!==null&&(Hs(t,e,o,s),Pu(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Pr(),s=so(e),o=wi(r,s);o.tag=2,t!=null&&(o.callback=t),t=no(e,o,s),t!==null&&(Hs(t,e,s,r),Pu(t,e,s))}};function Xm(e,t,r,s,o,a,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,a,l):t.prototype&&t.prototype.isPureReactComponent?!ic(r,s)||!ic(o,a):!0}function Oy(e,t,r){var s=!1,o=ao,a=t.contextType;return typeof a=="object"&&a!==null?a=ws(a):(o=Yr(t)?To:Sr.current,s=t.contextTypes,a=(s=s!=null)?Ta(e,o):ao),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Nd,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function Jm(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&Nd.enqueueReplaceState(t,t.state,null)}function Pf(e,t,r,s){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},E0(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=ws(a):(a=Yr(t)?To:Sr.current,o.context=Ta(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Tf(e,t,a,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Nd.enqueueReplaceState(o,o.state,null),sd(e,r,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Da(e,t){try{var r="",s=t;do r+=Lv(s),s=s.return;while(s);var o=r}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function Lp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Af(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var p2=typeof WeakMap=="function"?WeakMap:Map;function Ly(e,t,r){r=wi(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){cd||(cd=!0,Vf=s),Af(e,t)},r}function Uy(e,t,r){r=wi(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=t.value;r.payload=function(){return s(o)},r.callback=function(){Af(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Af(e,t),typeof s!="function"&&(ro===null?ro=new Set([this]):ro.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function Zm(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new p2;var o=new Set;s.set(t,o)}else o=s.get(t),o===void 0&&(o=new Set,s.set(t,o));o.has(r)||(o.add(r),e=_2.bind(null,e,t,r),t.then(e,e))}function qm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Qm(e,t,r,s,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=wi(-1,1),t.tag=2,no(r,t,1))),r.lanes|=1),e)}var f2=_i.ReactCurrentOwner,Vr=!1;function Tr(e,t,r,s){t.child=e===null?my(t,null,r,s):Aa(t,e.child,r,s)}function eg(e,t,r,s,o){r=r.render;var a=t.ref;return Ia(t,o),s=P0(e,t,r,s,a,o),r=A0(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ni(e,t,o)):(Fn&&r&&k0(t),t.flags|=1,Tr(e,t,s,o),t.child)}function tg(e,t,r,s,o){if(e===null){var a=r.type;return typeof a=="function"&&!V0(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,Fy(e,t,a,s,o)):(e=Uu(r.type,null,s,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&o)){var l=a.memoizedProps;if(r=r.compare,r=r!==null?r:ic,r(l,s)&&e.ref===t.ref)return Ni(e,t,o)}return t.flags|=1,e=io(a,s),e.ref=t.ref,e.return=t,t.child=e}function Fy(e,t,r,s,o){if(e!==null){var a=e.memoizedProps;if(ic(a,s)&&e.ref===t.ref)if(Vr=!1,t.pendingProps=s=a,(e.lanes&o)!==0)e.flags&131072&&(Vr=!0);else return t.lanes=e.lanes,Ni(e,t,o)}return Rf(e,t,r,s,o)}function By(e,t,r){var s=t.pendingProps,o=s.children,a=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},In(Na,rs),rs|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,In(Na,rs),rs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:r,In(Na,rs),rs|=s}else a!==null?(s=a.baseLanes|r,t.memoizedState=null):s=r,In(Na,rs),rs|=s;return Tr(e,t,o,r),t.child}function Wy(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Rf(e,t,r,s,o){var a=Yr(r)?To:Sr.current;return a=Ta(t,a),Ia(t,o),r=P0(e,t,r,s,a,o),s=A0(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ni(e,t,o)):(Fn&&s&&k0(t),t.flags|=1,Tr(e,t,r,o),t.child)}function ng(e,t,r,s,o){if(Yr(r)){var a=!0;Qu(t)}else a=!1;if(Ia(t,o),t.stateNode===null)Du(e,t),Oy(t,r,s),Pf(t,r,s,o),s=!0;else if(e===null){var l=t.stateNode,u=t.memoizedProps;l.props=u;var m=l.context,v=r.contextType;typeof v=="object"&&v!==null?v=ws(v):(v=Yr(r)?To:Sr.current,v=Ta(t,v));var I=r.getDerivedStateFromProps,$=typeof I=="function"||typeof l.getSnapshotBeforeUpdate=="function";$||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==s||m!==v)&&Jm(t,l,s,v),Yi=!1;var _=t.memoizedState;l.state=_,sd(t,s,l,o),m=t.memoizedState,u!==s||_!==m||Kr.current||Yi?(typeof I=="function"&&(Tf(t,r,I,s),m=t.memoizedState),(u=Yi||Xm(t,r,u,s,_,m,v))?($||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=m),l.props=s,l.state=m,l.context=v,s=u):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{l=t.stateNode,xy(e,t),u=t.memoizedProps,v=t.type===t.elementType?u:Us(t.type,u),l.props=v,$=t.pendingProps,_=l.context,m=r.contextType,typeof m=="object"&&m!==null?m=ws(m):(m=Yr(r)?To:Sr.current,m=Ta(t,m));var b=r.getDerivedStateFromProps;(I=typeof b=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(u!==$||_!==m)&&Jm(t,l,s,m),Yi=!1,_=t.memoizedState,l.state=_,sd(t,s,l,o);var T=t.memoizedState;u!==$||_!==T||Kr.current||Yi?(typeof b=="function"&&(Tf(t,r,b,s),T=t.memoizedState),(v=Yi||Xm(t,r,v,s,_,T,m)||!1)?(I||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(s,T,m),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(s,T,m)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=T),l.props=s,l.state=T,l.context=m,s=v):(typeof l.componentDidUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),s=!1)}return Df(e,t,r,s,a,o)}function Df(e,t,r,s,o,a){Wy(e,t);var l=(t.flags&128)!==0;if(!s&&!l)return o&&Fm(t,r,!1),Ni(e,t,a);s=t.stateNode,f2.current=t;var u=l&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&l?(t.child=Aa(t,e.child,null,a),t.child=Aa(t,null,u,a)):Tr(e,t,u,a),t.memoizedState=s.state,o&&Fm(t,r,!0),t.child}function Hy(e){var t=e.stateNode;t.pendingContext?Um(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Um(e,t.context,!1),I0(e,t.containerInfo)}function rg(e,t,r,s,o){return Pa(),j0(o),t.flags|=256,Tr(e,t,r,s),t.child}var Of={dehydrated:null,treeContext:null,retryLane:0};function Lf(e){return{baseLanes:e,cachePool:null,transitions:null}}function Vy(e,t,r){var s=t.pendingProps,o=Kn.current,a=!1,l=(t.flags&128)!==0,u;if((u=l)||(u=e!==null&&e.memoizedState===null?!1:(o&2)!==0),u?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),In(Kn,o&1),e===null)return $f(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=s.children,e=s.fallback,a?(s=t.mode,a=t.child,l={mode:"hidden",children:l},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=l):a=Cd(l,s,0,null),e=Mo(e,s,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Lf(r),t.memoizedState=Of,e):O0(t,l));if(o=e.memoizedState,o!==null&&(u=o.dehydrated,u!==null))return h2(e,t,l,s,u,o,r);if(a){a=s.fallback,l=t.mode,o=e.child,u=o.sibling;var m={mode:"hidden",children:s.children};return!(l&1)&&t.child!==o?(s=t.child,s.childLanes=0,s.pendingProps=m,t.deletions=null):(s=io(o,m),s.subtreeFlags=o.subtreeFlags&14680064),u!==null?a=io(u,a):(a=Mo(a,l,r,null),a.flags|=2),a.return=t,s.return=t,s.sibling=a,t.child=s,s=a,a=t.child,l=e.child.memoizedState,l=l===null?Lf(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~r,t.memoizedState=Of,s}return a=e.child,e=a.sibling,s=io(a,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function O0(e,t){return t=Cd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function fu(e,t,r,s){return s!==null&&j0(s),Aa(t,e.child,null,r),e=O0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function h2(e,t,r,s,o,a,l){if(r)return t.flags&256?(t.flags&=-257,s=Lp(Error(tt(422))),fu(e,t,l,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=s.fallback,o=t.mode,s=Cd({mode:"visible",children:s.children},o,0,null),a=Mo(a,o,l,null),a.flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,t.mode&1&&Aa(t,e.child,null,l),t.child.memoizedState=Lf(l),t.memoizedState=Of,a);if(!(t.mode&1))return fu(e,t,l,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var u=s.dgst;return s=u,a=Error(tt(419)),s=Lp(a,s,void 0),fu(e,t,l,s)}if(u=(l&e.childLanes)!==0,Vr||u){if(s=hr,s!==null){switch(l&-l){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(s.suspendedLanes|l)?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,ji(e,o),Hs(s,e,o,-1))}return H0(),s=Lp(Error(tt(421))),fu(e,t,l,s)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=S2.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,is=to(o.nextSibling),os=t,Fn=!0,Bs=null,e!==null&&(xs[ys++]=bi,xs[ys++]=vi,xs[ys++]=Po,bi=e.id,vi=e.overflow,Po=t),t=O0(t,s.children),t.flags|=4096,t)}function sg(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Mf(e.return,t,r)}function Up(e,t,r,s,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=r,a.tailMode=o)}function Ky(e,t,r){var s=t.pendingProps,o=s.revealOrder,a=s.tail;if(Tr(e,t,s.children,r),s=Kn.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&sg(e,r,t);else if(e.tag===19)sg(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(In(Kn,s),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&id(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),Up(t,!1,o,r,a);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&id(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}Up(t,!0,r,null,a);break;case"together":Up(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Du(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ni(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ro|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(tt(153));if(t.child!==null){for(e=t.child,r=io(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=io(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function m2(e,t,r){switch(t.tag){case 3:Hy(t),Pa();break;case 5:yy(t);break;case 1:Yr(t.type)&&Qu(t);break;case 4:I0(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,o=t.memoizedProps.value;In(nd,s._currentValue),s._currentValue=o;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(In(Kn,Kn.current&1),t.flags|=128,null):r&t.child.childLanes?Vy(e,t,r):(In(Kn,Kn.current&1),e=Ni(e,t,r),e!==null?e.sibling:null);In(Kn,Kn.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return Ky(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),In(Kn,Kn.current),s)break;return null;case 22:case 23:return t.lanes=0,By(e,t,r)}return Ni(e,t,r)}var Yy,Uf,Gy,Xy;Yy=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Uf=function(){};Gy=function(e,t,r,s){var o=e.memoizedProps;if(o!==s){e=t.stateNode,Io(ii.current);var a=null;switch(r){case"input":o=lf(e,o),s=lf(e,s),a=[];break;case"select":o=Gn({},o,{value:void 0}),s=Gn({},s,{value:void 0}),a=[];break;case"textarea":o=df(e,o),s=df(e,s),a=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Zu)}ff(r,s);var l;r=null;for(v in o)if(!s.hasOwnProperty(v)&&o.hasOwnProperty(v)&&o[v]!=null)if(v==="style"){var u=o[v];for(l in u)u.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else v!=="dangerouslySetInnerHTML"&&v!=="children"&&v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(ql.hasOwnProperty(v)?a||(a=[]):(a=a||[]).push(v,null));for(v in s){var m=s[v];if(u=o!=null?o[v]:void 0,s.hasOwnProperty(v)&&m!==u&&(m!=null||u!=null))if(v==="style")if(u){for(l in u)!u.hasOwnProperty(l)||m&&m.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in m)m.hasOwnProperty(l)&&u[l]!==m[l]&&(r||(r={}),r[l]=m[l])}else r||(a||(a=[]),a.push(v,r)),r=m;else v==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,u=u?u.__html:void 0,m!=null&&u!==m&&(a=a||[]).push(v,m)):v==="children"?typeof m!="string"&&typeof m!="number"||(a=a||[]).push(v,""+m):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&(ql.hasOwnProperty(v)?(m!=null&&v==="onScroll"&&An("scroll",e),a||u===m||(a=[])):(a=a||[]).push(v,m))}r&&(a=a||[]).push("style",r);var v=a;(t.updateQueue=v)&&(t.flags|=4)}};Xy=function(e,t,r,s){r!==s&&(t.flags|=4)};function kl(e,t){if(!Fn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function g2(e,t,r){var s=t.pendingProps;switch(z0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(t),null;case 1:return Yr(t.type)&&qu(),Nr(t),null;case 3:return s=t.stateNode,Ra(),Rn(Kr),Rn(Sr),M0(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(du(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Bs!==null&&(Gf(Bs),Bs=null))),Uf(e,t),Nr(t),null;case 5:$0(t);var o=Io(uc.current);if(r=t.type,e!==null&&t.stateNode!=null)Gy(e,t,r,s,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(tt(166));return Nr(t),null}if(e=Io(ii.current),du(t)){s=t.stateNode,r=t.type;var a=t.memoizedProps;switch(s[ti]=t,s[lc]=a,e=(t.mode&1)!==0,r){case"dialog":An("cancel",s),An("close",s);break;case"iframe":case"object":case"embed":An("load",s);break;case"video":case"audio":for(o=0;o<Dl.length;o++)An(Dl[o],s);break;case"source":An("error",s);break;case"img":case"image":case"link":An("error",s),An("load",s);break;case"details":An("toggle",s);break;case"input":fm(s,a),An("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},An("invalid",s);break;case"textarea":mm(s,a),An("invalid",s)}ff(r,a),o=null;for(var l in a)if(a.hasOwnProperty(l)){var u=a[l];l==="children"?typeof u=="string"?s.textContent!==u&&(a.suppressHydrationWarning!==!0&&uu(s.textContent,u,e),o=["children",u]):typeof u=="number"&&s.textContent!==""+u&&(a.suppressHydrationWarning!==!0&&uu(s.textContent,u,e),o=["children",""+u]):ql.hasOwnProperty(l)&&u!=null&&l==="onScroll"&&An("scroll",s)}switch(r){case"input":nu(s),hm(s,a,!0);break;case"textarea":nu(s),gm(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=Zu)}s=o,t.updateQueue=s,s!==null&&(t.flags|=4)}else{l=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=zx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=l.createElement(r,{is:s.is}):(e=l.createElement(r),r==="select"&&(l=e,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):e=l.createElementNS(e,r),e[ti]=t,e[lc]=s,Yy(e,t,!1,!1),t.stateNode=e;e:{switch(l=hf(r,s),r){case"dialog":An("cancel",e),An("close",e),o=s;break;case"iframe":case"object":case"embed":An("load",e),o=s;break;case"video":case"audio":for(o=0;o<Dl.length;o++)An(Dl[o],e);o=s;break;case"source":An("error",e),o=s;break;case"img":case"image":case"link":An("error",e),An("load",e),o=s;break;case"details":An("toggle",e),o=s;break;case"input":fm(e,s),o=lf(e,s),An("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=Gn({},s,{value:void 0}),An("invalid",e);break;case"textarea":mm(e,s),o=df(e,s),An("invalid",e);break;default:o=s}ff(r,o),u=o;for(a in u)if(u.hasOwnProperty(a)){var m=u[a];a==="style"?_x(e,m):a==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&jx(e,m)):a==="children"?typeof m=="string"?(r!=="textarea"||m!=="")&&Ql(e,m):typeof m=="number"&&Ql(e,""+m):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(ql.hasOwnProperty(a)?m!=null&&a==="onScroll"&&An("scroll",e):m!=null&&l0(e,a,m,l))}switch(r){case"input":nu(e),hm(e,s,!1);break;case"textarea":nu(e),gm(e);break;case"option":s.value!=null&&e.setAttribute("value",""+oo(s.value));break;case"select":e.multiple=!!s.multiple,a=s.value,a!=null?_a(e,!!s.multiple,a,!1):s.defaultValue!=null&&_a(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=Zu)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nr(t),null;case 6:if(e&&t.stateNode!=null)Xy(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(tt(166));if(r=Io(uc.current),Io(ii.current),du(t)){if(s=t.stateNode,r=t.memoizedProps,s[ti]=t,(a=s.nodeValue!==r)&&(e=os,e!==null))switch(e.tag){case 3:uu(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&uu(s.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[ti]=t,t.stateNode=s}return Nr(t),null;case 13:if(Rn(Kn),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fn&&is!==null&&t.mode&1&&!(t.flags&128))fy(),Pa(),t.flags|=98560,a=!1;else if(a=du(t),s!==null&&s.dehydrated!==null){if(e===null){if(!a)throw Error(tt(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(tt(317));a[ti]=t}else Pa(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nr(t),a=!1}else Bs!==null&&(Gf(Bs),Bs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Kn.current&1?lr===0&&(lr=3):H0())),t.updateQueue!==null&&(t.flags|=4),Nr(t),null);case 4:return Ra(),Uf(e,t),e===null&&oc(t.stateNode.containerInfo),Nr(t),null;case 10:return S0(t.type._context),Nr(t),null;case 17:return Yr(t.type)&&qu(),Nr(t),null;case 19:if(Rn(Kn),a=t.memoizedState,a===null)return Nr(t),null;if(s=(t.flags&128)!==0,l=a.rendering,l===null)if(s)kl(a,!1);else{if(lr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=id(e),l!==null){for(t.flags|=128,kl(a,!1),s=l.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)a=r,e=s,a.flags&=14680066,l=a.alternate,l===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return In(Kn,Kn.current&1|2),t.child}e=e.sibling}a.tail!==null&&qn()>Oa&&(t.flags|=128,s=!0,kl(a,!1),t.lanes=4194304)}else{if(!s)if(e=id(l),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),kl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!l.alternate&&!Fn)return Nr(t),null}else 2*qn()-a.renderingStartTime>Oa&&r!==1073741824&&(t.flags|=128,s=!0,kl(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(r=a.last,r!==null?r.sibling=l:t.child=l,a.last=l)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=qn(),t.sibling=null,r=Kn.current,In(Kn,s?r&1|2:r&1),t):(Nr(t),null);case 22:case 23:return W0(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?rs&1073741824&&(Nr(t),t.subtreeFlags&6&&(t.flags|=8192)):Nr(t),null;case 24:return null;case 25:return null}throw Error(tt(156,t.tag))}function x2(e,t){switch(z0(t),t.tag){case 1:return Yr(t.type)&&qu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ra(),Rn(Kr),Rn(Sr),M0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return $0(t),null;case 13:if(Rn(Kn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(tt(340));Pa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Rn(Kn),null;case 4:return Ra(),null;case 10:return S0(t.type._context),null;case 22:case 23:return W0(),null;case 24:return null;default:return null}}var hu=!1,_r=!1,y2=typeof WeakSet=="function"?WeakSet:Set,St=null;function ja(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Jn(e,t,s)}else r.current=null}function Ff(e,t,r){try{r()}catch(s){Jn(e,t,s)}}var ig=!1;function b2(e,t){if(jf=Gu,e=ey(),w0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var o=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var l=0,u=-1,m=-1,v=0,I=0,$=e,_=null;t:for(;;){for(var b;$!==r||o!==0&&$.nodeType!==3||(u=l+o),$!==a||s!==0&&$.nodeType!==3||(m=l+s),$.nodeType===3&&(l+=$.nodeValue.length),(b=$.firstChild)!==null;)_=$,$=b;for(;;){if($===e)break t;if(_===r&&++v===o&&(u=l),_===a&&++I===s&&(m=l),(b=$.nextSibling)!==null)break;$=_,_=$.parentNode}$=b}r=u===-1||m===-1?null:{start:u,end:m}}else r=null}r=r||{start:0,end:0}}else r=null;for(Nf={focusedElem:e,selectionRange:r},Gu=!1,St=t;St!==null;)if(t=St,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,St=e;else for(;St!==null;){t=St;try{var T=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var k=T.memoizedProps,R=T.memoizedState,x=t.stateNode,w=x.getSnapshotBeforeUpdate(t.elementType===t.type?k:Us(t.type,k),R);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var P=t.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(tt(163))}}catch(L){Jn(t,t.return,L)}if(e=t.sibling,e!==null){e.return=t.return,St=e;break}St=t.return}return T=ig,ig=!1,T}function Yl(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&Ff(t,r,a)}o=o.next}while(o!==s)}}function _d(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function Bf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Jy(e){var t=e.alternate;t!==null&&(e.alternate=null,Jy(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ti],delete t[lc],delete t[Cf],delete t[t2],delete t[n2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Zy(e){return e.tag===5||e.tag===3||e.tag===4}function og(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Zy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wf(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Zu));else if(s!==4&&(e=e.child,e!==null))for(Wf(e,t,r),e=e.sibling;e!==null;)Wf(e,t,r),e=e.sibling}function Hf(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Hf(e,t,r),e=e.sibling;e!==null;)Hf(e,t,r),e=e.sibling}var yr=null,Fs=!1;function Wi(e,t,r){for(r=r.child;r!==null;)qy(e,t,r),r=r.sibling}function qy(e,t,r){if(si&&typeof si.onCommitFiberUnmount=="function")try{si.onCommitFiberUnmount(yd,r)}catch{}switch(r.tag){case 5:_r||ja(r,t);case 6:var s=yr,o=Fs;yr=null,Wi(e,t,r),yr=s,Fs=o,yr!==null&&(Fs?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&(Fs?(e=yr,r=r.stateNode,e.nodeType===8?Tp(e.parentNode,r):e.nodeType===1&&Tp(e,r),rc(e)):Tp(yr,r.stateNode));break;case 4:s=yr,o=Fs,yr=r.stateNode.containerInfo,Fs=!0,Wi(e,t,r),yr=s,Fs=o;break;case 0:case 11:case 14:case 15:if(!_r&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var a=o,l=a.destroy;a=a.tag,l!==void 0&&(a&2||a&4)&&Ff(r,t,l),o=o.next}while(o!==s)}Wi(e,t,r);break;case 1:if(!_r&&(ja(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(u){Jn(r,t,u)}Wi(e,t,r);break;case 21:Wi(e,t,r);break;case 22:r.mode&1?(_r=(s=_r)||r.memoizedState!==null,Wi(e,t,r),_r=s):Wi(e,t,r);break;default:Wi(e,t,r)}}function ag(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new y2),t.forEach(function(s){var o=C2.bind(null,e,s);r.has(s)||(r.add(s),s.then(o,o))})}}function As(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var o=r[s];try{var a=e,l=t,u=l;e:for(;u!==null;){switch(u.tag){case 5:yr=u.stateNode,Fs=!1;break e;case 3:yr=u.stateNode.containerInfo,Fs=!0;break e;case 4:yr=u.stateNode.containerInfo,Fs=!0;break e}u=u.return}if(yr===null)throw Error(tt(160));qy(a,l,o),yr=null,Fs=!1;var m=o.alternate;m!==null&&(m.return=null),o.return=null}catch(v){Jn(o,t,v)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Qy(t,e),t=t.sibling}function Qy(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(As(t,e),qs(e),s&4){try{Yl(3,e,e.return),_d(3,e)}catch(k){Jn(e,e.return,k)}try{Yl(5,e,e.return)}catch(k){Jn(e,e.return,k)}}break;case 1:As(t,e),qs(e),s&512&&r!==null&&ja(r,r.return);break;case 5:if(As(t,e),qs(e),s&512&&r!==null&&ja(r,r.return),e.flags&32){var o=e.stateNode;try{Ql(o,"")}catch(k){Jn(e,e.return,k)}}if(s&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,l=r!==null?r.memoizedProps:a,u=e.type,m=e.updateQueue;if(e.updateQueue=null,m!==null)try{u==="input"&&a.type==="radio"&&a.name!=null&&wx(o,a),hf(u,l);var v=hf(u,a);for(l=0;l<m.length;l+=2){var I=m[l],$=m[l+1];I==="style"?_x(o,$):I==="dangerouslySetInnerHTML"?jx(o,$):I==="children"?Ql(o,$):l0(o,I,$,v)}switch(u){case"input":cf(o,a);break;case"textarea":kx(o,a);break;case"select":var _=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var b=a.value;b!=null?_a(o,!!a.multiple,b,!1):_!==!!a.multiple&&(a.defaultValue!=null?_a(o,!!a.multiple,a.defaultValue,!0):_a(o,!!a.multiple,a.multiple?[]:"",!1))}o[lc]=a}catch(k){Jn(e,e.return,k)}}break;case 6:if(As(t,e),qs(e),s&4){if(e.stateNode===null)throw Error(tt(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(k){Jn(e,e.return,k)}}break;case 3:if(As(t,e),qs(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{rc(t.containerInfo)}catch(k){Jn(e,e.return,k)}break;case 4:As(t,e),qs(e);break;case 13:As(t,e),qs(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(F0=qn())),s&4&&ag(e);break;case 22:if(I=r!==null&&r.memoizedState!==null,e.mode&1?(_r=(v=_r)||I,As(t,e),_r=v):As(t,e),qs(e),s&8192){if(v=e.memoizedState!==null,(e.stateNode.isHidden=v)&&!I&&e.mode&1)for(St=e,I=e.child;I!==null;){for($=St=I;St!==null;){switch(_=St,b=_.child,_.tag){case 0:case 11:case 14:case 15:Yl(4,_,_.return);break;case 1:ja(_,_.return);var T=_.stateNode;if(typeof T.componentWillUnmount=="function"){s=_,r=_.return;try{t=s,T.props=t.memoizedProps,T.state=t.memoizedState,T.componentWillUnmount()}catch(k){Jn(s,r,k)}}break;case 5:ja(_,_.return);break;case 22:if(_.memoizedState!==null){cg($);continue}}b!==null?(b.return=_,St=b):cg($)}I=I.sibling}e:for(I=null,$=e;;){if($.tag===5){if(I===null){I=$;try{o=$.stateNode,v?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(u=$.stateNode,m=$.memoizedProps.style,l=m!=null&&m.hasOwnProperty("display")?m.display:null,u.style.display=Nx("display",l))}catch(k){Jn(e,e.return,k)}}}else if($.tag===6){if(I===null)try{$.stateNode.nodeValue=v?"":$.memoizedProps}catch(k){Jn(e,e.return,k)}}else if(($.tag!==22&&$.tag!==23||$.memoizedState===null||$===e)&&$.child!==null){$.child.return=$,$=$.child;continue}if($===e)break e;for(;$.sibling===null;){if($.return===null||$.return===e)break e;I===$&&(I=null),$=$.return}I===$&&(I=null),$.sibling.return=$.return,$=$.sibling}}break;case 19:As(t,e),qs(e),s&4&&ag(e);break;case 21:break;default:As(t,e),qs(e)}}function qs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Zy(r)){var s=r;break e}r=r.return}throw Error(tt(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(Ql(o,""),s.flags&=-33);var a=og(e);Hf(e,a,o);break;case 3:case 4:var l=s.stateNode.containerInfo,u=og(e);Wf(e,u,l);break;default:throw Error(tt(161))}}catch(m){Jn(e,e.return,m)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function v2(e,t,r){St=e,e1(e)}function e1(e,t,r){for(var s=(e.mode&1)!==0;St!==null;){var o=St,a=o.child;if(o.tag===22&&s){var l=o.memoizedState!==null||hu;if(!l){var u=o.alternate,m=u!==null&&u.memoizedState!==null||_r;u=hu;var v=_r;if(hu=l,(_r=m)&&!v)for(St=o;St!==null;)l=St,m=l.child,l.tag===22&&l.memoizedState!==null?ug(o):m!==null?(m.return=l,St=m):ug(o);for(;a!==null;)St=a,e1(a),a=a.sibling;St=o,hu=u,_r=v}lg(e)}else o.subtreeFlags&8772&&a!==null?(a.return=o,St=a):lg(e)}}function lg(e){for(;St!==null;){var t=St;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:_r||_d(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!_r)if(r===null)s.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:Us(t.type,r.memoizedProps);s.componentDidUpdate(o,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Km(t,a,s);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Km(t,l,r)}break;case 5:var u=t.stateNode;if(r===null&&t.flags&4){r=u;var m=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&r.focus();break;case"img":m.src&&(r.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var v=t.alternate;if(v!==null){var I=v.memoizedState;if(I!==null){var $=I.dehydrated;$!==null&&rc($)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(tt(163))}_r||t.flags&512&&Bf(t)}catch(_){Jn(t,t.return,_)}}if(t===e){St=null;break}if(r=t.sibling,r!==null){r.return=t.return,St=r;break}St=t.return}}function cg(e){for(;St!==null;){var t=St;if(t===e){St=null;break}var r=t.sibling;if(r!==null){r.return=t.return,St=r;break}St=t.return}}function ug(e){for(;St!==null;){var t=St;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{_d(4,t)}catch(m){Jn(t,r,m)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var o=t.return;try{s.componentDidMount()}catch(m){Jn(t,o,m)}}var a=t.return;try{Bf(t)}catch(m){Jn(t,a,m)}break;case 5:var l=t.return;try{Bf(t)}catch(m){Jn(t,l,m)}}}catch(m){Jn(t,t.return,m)}if(t===e){St=null;break}var u=t.sibling;if(u!==null){u.return=t.return,St=u;break}St=t.return}}var w2=Math.ceil,ld=_i.ReactCurrentDispatcher,L0=_i.ReactCurrentOwner,vs=_i.ReactCurrentBatchConfig,dn=0,hr=null,nr=null,br=0,rs=0,Na=co(0),lr=0,hc=null,Ro=0,Sd=0,U0=0,Gl=null,Hr=null,F0=0,Oa=1/0,mi=null,cd=!1,Vf=null,ro=null,mu=!1,Zi=null,ud=0,Xl=0,Kf=null,Ou=-1,Lu=0;function Pr(){return dn&6?qn():Ou!==-1?Ou:Ou=qn()}function so(e){return e.mode&1?dn&2&&br!==0?br&-br:s2.transition!==null?(Lu===0&&(Lu=Ox()),Lu):(e=kn,e!==0||(e=window.event,e=e===void 0?16:Vx(e.type)),e):1}function Hs(e,t,r,s){if(50<Xl)throw Xl=0,Kf=null,Error(tt(185));gc(e,r,s),(!(dn&2)||e!==hr)&&(e===hr&&(!(dn&2)&&(Sd|=r),lr===4&&Xi(e,br)),Gr(e,s),r===1&&dn===0&&!(t.mode&1)&&(Oa=qn()+500,zd&&uo()))}function Gr(e,t){var r=e.callbackNode;sw(e,t);var s=Yu(e,e===hr?br:0);if(s===0)r!==null&&bm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&bm(r),t===1)e.tag===0?r2(dg.bind(null,e)):uy(dg.bind(null,e)),Qw(function(){!(dn&6)&&uo()}),r=null;else{switch(Lx(s)){case 1:r=f0;break;case 4:r=Rx;break;case 16:r=Ku;break;case 536870912:r=Dx;break;default:r=Ku}r=l1(r,t1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function t1(e,t){if(Ou=-1,Lu=0,dn&6)throw Error(tt(327));var r=e.callbackNode;if($a()&&e.callbackNode!==r)return null;var s=Yu(e,e===hr?br:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=dd(e,s);else{t=s;var o=dn;dn|=2;var a=r1();(hr!==e||br!==t)&&(mi=null,Oa=qn()+500,$o(e,t));do try{j2();break}catch(u){n1(e,u)}while(!0);_0(),ld.current=a,dn=o,nr!==null?t=0:(hr=null,br=0,t=lr)}if(t!==0){if(t===2&&(o=bf(e),o!==0&&(s=o,t=Yf(e,o))),t===1)throw r=hc,$o(e,0),Xi(e,s),Gr(e,qn()),r;if(t===6)Xi(e,s);else{if(o=e.current.alternate,!(s&30)&&!k2(o)&&(t=dd(e,s),t===2&&(a=bf(e),a!==0&&(s=a,t=Yf(e,a))),t===1))throw r=hc,$o(e,0),Xi(e,s),Gr(e,qn()),r;switch(e.finishedWork=o,e.finishedLanes=s,t){case 0:case 1:throw Error(tt(345));case 2:So(e,Hr,mi);break;case 3:if(Xi(e,s),(s&130023424)===s&&(t=F0+500-qn(),10<t)){if(Yu(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){Pr(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Sf(So.bind(null,e,Hr,mi),t);break}So(e,Hr,mi);break;case 4:if(Xi(e,s),(s&4194240)===s)break;for(t=e.eventTimes,o=-1;0<s;){var l=31-Ws(s);a=1<<l,l=t[l],l>o&&(o=l),s&=~a}if(s=o,s=qn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*w2(s/1960))-s,10<s){e.timeoutHandle=Sf(So.bind(null,e,Hr,mi),s);break}So(e,Hr,mi);break;case 5:So(e,Hr,mi);break;default:throw Error(tt(329))}}}return Gr(e,qn()),e.callbackNode===r?t1.bind(null,e):null}function Yf(e,t){var r=Gl;return e.current.memoizedState.isDehydrated&&($o(e,t).flags|=256),e=dd(e,t),e!==2&&(t=Hr,Hr=r,t!==null&&Gf(t)),e}function Gf(e){Hr===null?Hr=e:Hr.push.apply(Hr,e)}function k2(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var o=r[s],a=o.getSnapshot;o=o.value;try{if(!Vs(a(),o))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xi(e,t){for(t&=~U0,t&=~Sd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ws(t),s=1<<r;e[r]=-1,t&=~s}}function dg(e){if(dn&6)throw Error(tt(327));$a();var t=Yu(e,0);if(!(t&1))return Gr(e,qn()),null;var r=dd(e,t);if(e.tag!==0&&r===2){var s=bf(e);s!==0&&(t=s,r=Yf(e,s))}if(r===1)throw r=hc,$o(e,0),Xi(e,t),Gr(e,qn()),r;if(r===6)throw Error(tt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,So(e,Hr,mi),Gr(e,qn()),null}function B0(e,t){var r=dn;dn|=1;try{return e(t)}finally{dn=r,dn===0&&(Oa=qn()+500,zd&&uo())}}function Do(e){Zi!==null&&Zi.tag===0&&!(dn&6)&&$a();var t=dn;dn|=1;var r=vs.transition,s=kn;try{if(vs.transition=null,kn=1,e)return e()}finally{kn=s,vs.transition=r,dn=t,!(dn&6)&&uo()}}function W0(){rs=Na.current,Rn(Na)}function $o(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,qw(r)),nr!==null)for(r=nr.return;r!==null;){var s=r;switch(z0(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&qu();break;case 3:Ra(),Rn(Kr),Rn(Sr),M0();break;case 5:$0(s);break;case 4:Ra();break;case 13:Rn(Kn);break;case 19:Rn(Kn);break;case 10:S0(s.type._context);break;case 22:case 23:W0()}r=r.return}if(hr=e,nr=e=io(e.current,null),br=rs=t,lr=0,hc=null,U0=Sd=Ro=0,Hr=Gl=null,Eo!==null){for(t=0;t<Eo.length;t++)if(r=Eo[t],s=r.interleaved,s!==null){r.interleaved=null;var o=s.next,a=r.pending;if(a!==null){var l=a.next;a.next=o,s.next=l}r.pending=s}Eo=null}return e}function n1(e,t){do{var r=nr;try{if(_0(),Au.current=ad,od){for(var s=Yn.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}od=!1}if(Ao=0,fr=ar=Yn=null,Kl=!1,dc=0,L0.current=null,r===null||r.return===null){lr=1,hc=t,nr=null;break}e:{var a=e,l=r.return,u=r,m=t;if(t=br,u.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var v=m,I=u,$=I.tag;if(!(I.mode&1)&&($===0||$===11||$===15)){var _=I.alternate;_?(I.updateQueue=_.updateQueue,I.memoizedState=_.memoizedState,I.lanes=_.lanes):(I.updateQueue=null,I.memoizedState=null)}var b=qm(l);if(b!==null){b.flags&=-257,Qm(b,l,u,a,t),b.mode&1&&Zm(a,v,t),t=b,m=v;var T=t.updateQueue;if(T===null){var k=new Set;k.add(m),t.updateQueue=k}else T.add(m);break e}else{if(!(t&1)){Zm(a,v,t),H0();break e}m=Error(tt(426))}}else if(Fn&&u.mode&1){var R=qm(l);if(R!==null){!(R.flags&65536)&&(R.flags|=256),Qm(R,l,u,a,t),j0(Da(m,u));break e}}a=m=Da(m,u),lr!==4&&(lr=2),Gl===null?Gl=[a]:Gl.push(a),a=l;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var x=Ly(a,m,t);Vm(a,x);break e;case 1:u=m;var w=a.type,P=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(ro===null||!ro.has(P)))){a.flags|=65536,t&=-t,a.lanes|=t;var L=Uy(a,u,t);Vm(a,L);break e}}a=a.return}while(a!==null)}i1(r)}catch(Y){t=Y,nr===r&&r!==null&&(nr=r=r.return);continue}break}while(!0)}function r1(){var e=ld.current;return ld.current=ad,e===null?ad:e}function H0(){(lr===0||lr===3||lr===2)&&(lr=4),hr===null||!(Ro&268435455)&&!(Sd&268435455)||Xi(hr,br)}function dd(e,t){var r=dn;dn|=2;var s=r1();(hr!==e||br!==t)&&(mi=null,$o(e,t));do try{z2();break}catch(o){n1(e,o)}while(!0);if(_0(),dn=r,ld.current=s,nr!==null)throw Error(tt(261));return hr=null,br=0,lr}function z2(){for(;nr!==null;)s1(nr)}function j2(){for(;nr!==null&&!Xv();)s1(nr)}function s1(e){var t=a1(e.alternate,e,rs);e.memoizedProps=e.pendingProps,t===null?i1(e):nr=t,L0.current=null}function i1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=x2(r,t),r!==null){r.flags&=32767,nr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{lr=6,nr=null;return}}else if(r=g2(r,t,rs),r!==null){nr=r;return}if(t=t.sibling,t!==null){nr=t;return}nr=t=e}while(t!==null);lr===0&&(lr=5)}function So(e,t,r){var s=kn,o=vs.transition;try{vs.transition=null,kn=1,N2(e,t,r,s)}finally{vs.transition=o,kn=s}return null}function N2(e,t,r,s){do $a();while(Zi!==null);if(dn&6)throw Error(tt(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(tt(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(iw(e,a),e===hr&&(nr=hr=null,br=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||mu||(mu=!0,l1(Ku,function(){return $a(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=vs.transition,vs.transition=null;var l=kn;kn=1;var u=dn;dn|=4,L0.current=null,b2(e,r),Qy(r,e),Vw(Nf),Gu=!!jf,Nf=jf=null,e.current=r,v2(r),Jv(),dn=u,kn=l,vs.transition=a}else e.current=r;if(mu&&(mu=!1,Zi=e,ud=o),a=e.pendingLanes,a===0&&(ro=null),Qv(r.stateNode),Gr(e,qn()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],s(o.value,{componentStack:o.stack,digest:o.digest});if(cd)throw cd=!1,e=Vf,Vf=null,e;return ud&1&&e.tag!==0&&$a(),a=e.pendingLanes,a&1?e===Kf?Xl++:(Xl=0,Kf=e):Xl=0,uo(),null}function $a(){if(Zi!==null){var e=Lx(ud),t=vs.transition,r=kn;try{if(vs.transition=null,kn=16>e?16:e,Zi===null)var s=!1;else{if(e=Zi,Zi=null,ud=0,dn&6)throw Error(tt(331));var o=dn;for(dn|=4,St=e.current;St!==null;){var a=St,l=a.child;if(St.flags&16){var u=a.deletions;if(u!==null){for(var m=0;m<u.length;m++){var v=u[m];for(St=v;St!==null;){var I=St;switch(I.tag){case 0:case 11:case 15:Yl(8,I,a)}var $=I.child;if($!==null)$.return=I,St=$;else for(;St!==null;){I=St;var _=I.sibling,b=I.return;if(Jy(I),I===v){St=null;break}if(_!==null){_.return=b,St=_;break}St=b}}}var T=a.alternate;if(T!==null){var k=T.child;if(k!==null){T.child=null;do{var R=k.sibling;k.sibling=null,k=R}while(k!==null)}}St=a}}if(a.subtreeFlags&2064&&l!==null)l.return=a,St=l;else e:for(;St!==null;){if(a=St,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Yl(9,a,a.return)}var x=a.sibling;if(x!==null){x.return=a.return,St=x;break e}St=a.return}}var w=e.current;for(St=w;St!==null;){l=St;var P=l.child;if(l.subtreeFlags&2064&&P!==null)P.return=l,St=P;else e:for(l=w;St!==null;){if(u=St,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:_d(9,u)}}catch(Y){Jn(u,u.return,Y)}if(u===l){St=null;break e}var L=u.sibling;if(L!==null){L.return=u.return,St=L;break e}St=u.return}}if(dn=o,uo(),si&&typeof si.onPostCommitFiberRoot=="function")try{si.onPostCommitFiberRoot(yd,e)}catch{}s=!0}return s}finally{kn=r,vs.transition=t}}return!1}function pg(e,t,r){t=Da(r,t),t=Ly(e,t,1),e=no(e,t,1),t=Pr(),e!==null&&(gc(e,1,t),Gr(e,t))}function Jn(e,t,r){if(e.tag===3)pg(e,e,r);else for(;t!==null;){if(t.tag===3){pg(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ro===null||!ro.has(s))){e=Da(r,e),e=Uy(t,e,1),t=no(t,e,1),e=Pr(),t!==null&&(gc(t,1,e),Gr(t,e));break}}t=t.return}}function _2(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Pr(),e.pingedLanes|=e.suspendedLanes&r,hr===e&&(br&r)===r&&(lr===4||lr===3&&(br&130023424)===br&&500>qn()-F0?$o(e,0):U0|=r),Gr(e,t)}function o1(e,t){t===0&&(e.mode&1?(t=iu,iu<<=1,!(iu&130023424)&&(iu=4194304)):t=1);var r=Pr();e=ji(e,t),e!==null&&(gc(e,t,r),Gr(e,r))}function S2(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),o1(e,r)}function C2(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(tt(314))}s!==null&&s.delete(t),o1(e,r)}var a1;a1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kr.current)Vr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vr=!1,m2(e,t,r);Vr=!!(e.flags&131072)}else Vr=!1,Fn&&t.flags&1048576&&dy(t,td,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Du(e,t),e=t.pendingProps;var o=Ta(t,Sr.current);Ia(t,r),o=P0(null,t,s,e,o,r);var a=A0();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yr(s)?(a=!0,Qu(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,E0(t),o.updater=Nd,t.stateNode=o,o._reactInternals=t,Pf(t,s,e,r),t=Df(null,t,s,!0,a,r)):(t.tag=0,Fn&&a&&k0(t),Tr(null,t,o,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Du(e,t),e=t.pendingProps,o=s._init,s=o(s._payload),t.type=s,o=t.tag=I2(s),e=Us(s,e),o){case 0:t=Rf(null,t,s,e,r);break e;case 1:t=ng(null,t,s,e,r);break e;case 11:t=eg(null,t,s,e,r);break e;case 14:t=tg(null,t,s,Us(s.type,e),r);break e}throw Error(tt(306,s,""))}return t;case 0:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Us(s,o),Rf(e,t,s,o,r);case 1:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Us(s,o),ng(e,t,s,o,r);case 3:e:{if(Hy(t),e===null)throw Error(tt(387));s=t.pendingProps,a=t.memoizedState,o=a.element,xy(e,t),sd(t,s,null,r);var l=t.memoizedState;if(s=l.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=Da(Error(tt(423)),t),t=rg(e,t,s,r,o);break e}else if(s!==o){o=Da(Error(tt(424)),t),t=rg(e,t,s,r,o);break e}else for(is=to(t.stateNode.containerInfo.firstChild),os=t,Fn=!0,Bs=null,r=my(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Pa(),s===o){t=Ni(e,t,r);break e}Tr(e,t,s,r)}t=t.child}return t;case 5:return yy(t),e===null&&$f(t),s=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,l=o.children,_f(s,o)?l=null:a!==null&&_f(s,a)&&(t.flags|=32),Wy(e,t),Tr(e,t,l,r),t.child;case 6:return e===null&&$f(t),null;case 13:return Vy(e,t,r);case 4:return I0(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Aa(t,null,s,r):Tr(e,t,s,r),t.child;case 11:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Us(s,o),eg(e,t,s,o,r);case 7:return Tr(e,t,t.pendingProps,r),t.child;case 8:return Tr(e,t,t.pendingProps.children,r),t.child;case 12:return Tr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,o=t.pendingProps,a=t.memoizedProps,l=o.value,In(nd,s._currentValue),s._currentValue=l,a!==null)if(Vs(a.value,l)){if(a.children===o.children&&!Kr.current){t=Ni(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var u=a.dependencies;if(u!==null){l=a.child;for(var m=u.firstContext;m!==null;){if(m.context===s){if(a.tag===1){m=wi(-1,r&-r),m.tag=2;var v=a.updateQueue;if(v!==null){v=v.shared;var I=v.pending;I===null?m.next=m:(m.next=I.next,I.next=m),v.pending=m}}a.lanes|=r,m=a.alternate,m!==null&&(m.lanes|=r),Mf(a.return,r,t),u.lanes|=r;break}m=m.next}}else if(a.tag===10)l=a.type===t.type?null:a.child;else if(a.tag===18){if(l=a.return,l===null)throw Error(tt(341));l.lanes|=r,u=l.alternate,u!==null&&(u.lanes|=r),Mf(l,r,t),l=a.sibling}else l=a.child;if(l!==null)l.return=a;else for(l=a;l!==null;){if(l===t){l=null;break}if(a=l.sibling,a!==null){a.return=l.return,l=a;break}l=l.return}a=l}Tr(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,s=t.pendingProps.children,Ia(t,r),o=ws(o),s=s(o),t.flags|=1,Tr(e,t,s,r),t.child;case 14:return s=t.type,o=Us(s,t.pendingProps),o=Us(s.type,o),tg(e,t,s,o,r);case 15:return Fy(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Us(s,o),Du(e,t),t.tag=1,Yr(s)?(e=!0,Qu(t)):e=!1,Ia(t,r),Oy(t,s,o),Pf(t,s,o,r),Df(null,t,s,!0,e,r);case 19:return Ky(e,t,r);case 22:return By(e,t,r)}throw Error(tt(156,t.tag))};function l1(e,t){return Ax(e,t)}function E2(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bs(e,t,r,s){return new E2(e,t,r,s)}function V0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function I2(e){if(typeof e=="function")return V0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===u0)return 11;if(e===d0)return 14}return 2}function io(e,t){var r=e.alternate;return r===null?(r=bs(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Uu(e,t,r,s,o,a){var l=2;if(s=e,typeof e=="function")V0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case ma:return Mo(r.children,o,a,t);case c0:l=8,o|=8;break;case rf:return e=bs(12,r,t,o|2),e.elementType=rf,e.lanes=a,e;case sf:return e=bs(13,r,t,o),e.elementType=sf,e.lanes=a,e;case of:return e=bs(19,r,t,o),e.elementType=of,e.lanes=a,e;case yx:return Cd(r,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gx:l=10;break e;case xx:l=9;break e;case u0:l=11;break e;case d0:l=14;break e;case Ki:l=16,s=null;break e}throw Error(tt(130,e==null?e:typeof e,""))}return t=bs(l,r,t,o),t.elementType=e,t.type=s,t.lanes=a,t}function Mo(e,t,r,s){return e=bs(7,e,s,t),e.lanes=r,e}function Cd(e,t,r,s){return e=bs(22,e,s,t),e.elementType=yx,e.lanes=r,e.stateNode={isHidden:!1},e}function Fp(e,t,r){return e=bs(6,e,null,t),e.lanes=r,e}function Bp(e,t,r){return t=bs(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $2(e,t,r,s,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kp(0),this.expirationTimes=kp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kp(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function K0(e,t,r,s,o,a,l,u,m){return e=new $2(e,t,r,u,m),t===1?(t=1,a===!0&&(t|=8)):t=0,a=bs(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},E0(a),e}function M2(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ha,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function c1(e){if(!e)return ao;e=e._reactInternals;e:{if(Fo(e)!==e||e.tag!==1)throw Error(tt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(tt(171))}if(e.tag===1){var r=e.type;if(Yr(r))return cy(e,r,t)}return t}function u1(e,t,r,s,o,a,l,u,m){return e=K0(r,s,!0,e,o,a,l,u,m),e.context=c1(null),r=e.current,s=Pr(),o=so(r),a=wi(s,o),a.callback=t??null,no(r,a,o),e.current.lanes=o,gc(e,o,s),Gr(e,s),e}function Ed(e,t,r,s){var o=t.current,a=Pr(),l=so(o);return r=c1(r),t.context===null?t.context=r:t.pendingContext=r,t=wi(a,l),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=no(o,t,l),e!==null&&(Hs(e,o,l,a),Pu(e,o,l)),l}function pd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Y0(e,t){fg(e,t),(e=e.alternate)&&fg(e,t)}function T2(){return null}var d1=typeof reportError=="function"?reportError:function(e){console.error(e)};function G0(e){this._internalRoot=e}Id.prototype.render=G0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(tt(409));Ed(e,t,null,null)};Id.prototype.unmount=G0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Do(function(){Ed(null,e,null,null)}),t[zi]=null}};function Id(e){this._internalRoot=e}Id.prototype.unstable_scheduleHydration=function(e){if(e){var t=Bx();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Gi.length&&t!==0&&t<Gi[r].priority;r++);Gi.splice(r,0,e),r===0&&Hx(e)}};function X0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hg(){}function P2(e,t,r,s,o){if(o){if(typeof s=="function"){var a=s;s=function(){var v=pd(l);a.call(v)}}var l=u1(t,s,e,0,null,!1,!1,"",hg);return e._reactRootContainer=l,e[zi]=l.current,oc(e.nodeType===8?e.parentNode:e),Do(),l}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var u=s;s=function(){var v=pd(m);u.call(v)}}var m=K0(e,0,!1,null,null,!1,!1,"",hg);return e._reactRootContainer=m,e[zi]=m.current,oc(e.nodeType===8?e.parentNode:e),Do(function(){Ed(t,m,r,s)}),m}function Md(e,t,r,s,o){var a=r._reactRootContainer;if(a){var l=a;if(typeof o=="function"){var u=o;o=function(){var m=pd(l);u.call(m)}}Ed(t,l,e,o)}else l=P2(r,t,e,o,s);return pd(l)}Ux=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Rl(t.pendingLanes);r!==0&&(h0(t,r|1),Gr(t,qn()),!(dn&6)&&(Oa=qn()+500,uo()))}break;case 13:Do(function(){var s=ji(e,1);if(s!==null){var o=Pr();Hs(s,e,1,o)}}),Y0(e,1)}};m0=function(e){if(e.tag===13){var t=ji(e,134217728);if(t!==null){var r=Pr();Hs(t,e,134217728,r)}Y0(e,134217728)}};Fx=function(e){if(e.tag===13){var t=so(e),r=ji(e,t);if(r!==null){var s=Pr();Hs(r,e,t,s)}Y0(e,t)}};Bx=function(){return kn};Wx=function(e,t){var r=kn;try{return kn=e,t()}finally{kn=r}};gf=function(e,t,r){switch(t){case"input":if(cf(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var o=kd(s);if(!o)throw Error(tt(90));vx(s),cf(s,o)}}}break;case"textarea":kx(e,r);break;case"select":t=r.value,t!=null&&_a(e,!!r.multiple,t,!1)}};Ex=B0;Ix=Do;var A2={usingClientEntryPoint:!1,Events:[yc,ba,kd,Sx,Cx,B0]},zl={findFiberByHostInstance:Co,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},R2={bundleType:zl.bundleType,version:zl.version,rendererPackageName:zl.rendererPackageName,rendererConfig:zl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_i.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Tx(e),e===null?null:e.stateNode},findFiberByHostInstance:zl.findFiberByHostInstance||T2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gu.isDisabled&&gu.supportsFiber)try{yd=gu.inject(R2),si=gu}catch{}}ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A2;ls.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!X0(t))throw Error(tt(200));return M2(e,t,null,r)};ls.createRoot=function(e,t){if(!X0(e))throw Error(tt(299));var r=!1,s="",o=d1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=K0(e,1,!1,null,null,r,!1,s,o),e[zi]=t.current,oc(e.nodeType===8?e.parentNode:e),new G0(t)};ls.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(tt(188)):(e=Object.keys(e).join(","),Error(tt(268,e)));return e=Tx(t),e=e===null?null:e.stateNode,e};ls.flushSync=function(e){return Do(e)};ls.hydrate=function(e,t,r){if(!$d(t))throw Error(tt(200));return Md(null,e,t,!0,r)};ls.hydrateRoot=function(e,t,r){if(!X0(e))throw Error(tt(405));var s=r!=null&&r.hydratedSources||null,o=!1,a="",l=d1;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=u1(t,null,e,1,r??null,o,!1,a,l),e[zi]=t.current,oc(e),s)for(e=0;e<s.length;e++)r=s[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new Id(t)};ls.render=function(e,t,r){if(!$d(t))throw Error(tt(200));return Md(null,e,t,!1,r)};ls.unmountComponentAtNode=function(e){if(!$d(e))throw Error(tt(40));return e._reactRootContainer?(Do(function(){Md(null,null,e,!1,function(){e._reactRootContainer=null,e[zi]=null})}),!0):!1};ls.unstable_batchedUpdates=B0;ls.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!$d(r))throw Error(tt(200));if(e==null||e._reactInternals===void 0)throw Error(tt(38));return Md(e,t,r,!1,s)};ls.version="18.3.1-next-f1338f8080-20240426";function p1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p1)}catch(e){console.error(e)}}p1(),px.exports=ls;var f1=px.exports,mg=f1;tf.createRoot=mg.createRoot,tf.hydrateRoot=mg.hydrateRoot;function J0(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let Bo=J0();function h1(e){Bo=e}const m1=/[&<>"']/,D2=new RegExp(m1.source,"g"),g1=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,O2=new RegExp(g1.source,"g"),L2={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gg=e=>L2[e];function ss(e,t){if(t){if(m1.test(e))return e.replace(D2,gg)}else if(g1.test(e))return e.replace(O2,gg);return e}const U2=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function F2(e){return e.replace(U2,(t,r)=>(r=r.toLowerCase(),r==="colon"?":":r.charAt(0)==="#"?r.charAt(1)==="x"?String.fromCharCode(parseInt(r.substring(2),16)):String.fromCharCode(+r.substring(1)):""))}const B2=/(^|[^\[])\^/g;function jn(e,t){let r=typeof e=="string"?e:e.source;t=t||"";const s={replace:(o,a)=>{let l=typeof a=="string"?a:a.source;return l=l.replace(B2,"$1"),r=r.replace(o,l),s},getRegex:()=>new RegExp(r,t)};return s}function xg(e){try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}const Jl={exec:()=>null};function yg(e,t){const r=e.replace(/\|/g,(a,l,u)=>{let m=!1,v=l;for(;--v>=0&&u[v]==="\\";)m=!m;return m?"|":" |"}),s=r.split(/ \|/);let o=0;if(s[0].trim()||s.shift(),s.length>0&&!s[s.length-1].trim()&&s.pop(),t)if(s.length>t)s.splice(t);else for(;s.length<t;)s.push("");for(;o<s.length;o++)s[o]=s[o].trim().replace(/\\\|/g,"|");return s}function xu(e,t,r){const s=e.length;if(s===0)return"";let o=0;for(;o<s&&e.charAt(s-o-1)===t;)o++;return e.slice(0,s-o)}function W2(e,t){if(e.indexOf(t[1])===-1)return-1;let r=0;for(let s=0;s<e.length;s++)if(e[s]==="\\")s++;else if(e[s]===t[0])r++;else if(e[s]===t[1]&&(r--,r<0))return s;return-1}function bg(e,t,r,s){const o=t.href,a=t.title?ss(t.title):null,l=e[1].replace(/\\([\[\]])/g,"$1");if(e[0].charAt(0)!=="!"){s.state.inLink=!0;const u={type:"link",raw:r,href:o,title:a,text:l,tokens:s.inlineTokens(l)};return s.state.inLink=!1,u}return{type:"image",raw:r,href:o,title:a,text:ss(l)}}function H2(e,t){const r=e.match(/^(\s+)(?:```)/);if(r===null)return t;const s=r[1];return t.split(`
`).map(o=>{const a=o.match(/^\s+/);if(a===null)return o;const[l]=a;return l.length>=s.length?o.slice(s.length):o}).join(`
`)}class fd{constructor(t){Pn(this,"options");Pn(this,"rules");Pn(this,"lexer");this.options=t||Bo}space(t){const r=this.rules.block.newline.exec(t);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(t){const r=this.rules.block.code.exec(t);if(r){const s=r[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?s:xu(s,`
`)}}}fences(t){const r=this.rules.block.fences.exec(t);if(r){const s=r[0],o=H2(s,r[3]||"");return{type:"code",raw:s,lang:r[2]?r[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):r[2],text:o}}}heading(t){const r=this.rules.block.heading.exec(t);if(r){let s=r[2].trim();if(/#$/.test(s)){const o=xu(s,"#");(this.options.pedantic||!o||/ $/.test(o))&&(s=o.trim())}return{type:"heading",raw:r[0],depth:r[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(t){const r=this.rules.block.hr.exec(t);if(r)return{type:"hr",raw:r[0]}}blockquote(t){const r=this.rules.block.blockquote.exec(t);if(r){let s=r[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);s=xu(s.replace(/^ *>[ \t]?/gm,""),`
`);const o=this.lexer.state.top;this.lexer.state.top=!0;const a=this.lexer.blockTokens(s);return this.lexer.state.top=o,{type:"blockquote",raw:r[0],tokens:a,text:s}}}list(t){let r=this.rules.block.list.exec(t);if(r){let s=r[1].trim();const o=s.length>1,a={type:"list",raw:"",ordered:o,start:o?+s.slice(0,-1):"",loose:!1,items:[]};s=o?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=o?s:"[*+-]");const l=new RegExp(`^( {0,3}${s})((?:[	 ][^\\n]*)?(?:\\n|$))`);let u="",m="",v=!1;for(;t;){let I=!1;if(!(r=l.exec(t))||this.rules.block.hr.test(t))break;u=r[0],t=t.substring(u.length);let $=r[2].split(`
`,1)[0].replace(/^\t+/,x=>" ".repeat(3*x.length)),_=t.split(`
`,1)[0],b=0;this.options.pedantic?(b=2,m=$.trimStart()):(b=r[2].search(/[^ ]/),b=b>4?1:b,m=$.slice(b),b+=r[1].length);let T=!1;if(!$&&/^ *$/.test(_)&&(u+=_+`
`,t=t.substring(_.length+1),I=!0),!I){const x=new RegExp(`^ {0,${Math.min(3,b-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),w=new RegExp(`^ {0,${Math.min(3,b-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),P=new RegExp(`^ {0,${Math.min(3,b-1)}}(?:\`\`\`|~~~)`),L=new RegExp(`^ {0,${Math.min(3,b-1)}}#`);for(;t;){const Y=t.split(`
`,1)[0];if(_=Y,this.options.pedantic&&(_=_.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),P.test(_)||L.test(_)||x.test(_)||w.test(t))break;if(_.search(/[^ ]/)>=b||!_.trim())m+=`
`+_.slice(b);else{if(T||$.search(/[^ ]/)>=4||P.test($)||L.test($)||w.test($))break;m+=`
`+_}!T&&!_.trim()&&(T=!0),u+=Y+`
`,t=t.substring(Y.length+1),$=_.slice(b)}}a.loose||(v?a.loose=!0:/\n *\n *$/.test(u)&&(v=!0));let k=null,R;this.options.gfm&&(k=/^\[[ xX]\] /.exec(m),k&&(R=k[0]!=="[ ] ",m=m.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:u,task:!!k,checked:R,loose:!1,text:m,tokens:[]}),a.raw+=u}a.items[a.items.length-1].raw=u.trimEnd(),a.items[a.items.length-1].text=m.trimEnd(),a.raw=a.raw.trimEnd();for(let I=0;I<a.items.length;I++)if(this.lexer.state.top=!1,a.items[I].tokens=this.lexer.blockTokens(a.items[I].text,[]),!a.loose){const $=a.items[I].tokens.filter(b=>b.type==="space"),_=$.length>0&&$.some(b=>/\n.*\n/.test(b.raw));a.loose=_}if(a.loose)for(let I=0;I<a.items.length;I++)a.items[I].loose=!0;return a}}html(t){const r=this.rules.block.html.exec(t);if(r)return{type:"html",block:!0,raw:r[0],pre:r[1]==="pre"||r[1]==="script"||r[1]==="style",text:r[0]}}def(t){const r=this.rules.block.def.exec(t);if(r){const s=r[1].toLowerCase().replace(/\s+/g," "),o=r[2]?r[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=r[3]?r[3].substring(1,r[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):r[3];return{type:"def",tag:s,raw:r[0],href:o,title:a}}}table(t){const r=this.rules.block.table.exec(t);if(!r||!/[:|]/.test(r[2]))return;const s=yg(r[1]),o=r[2].replace(/^\||\| *$/g,"").split("|"),a=r[3]&&r[3].trim()?r[3].replace(/\n[ \t]*$/,"").split(`
`):[],l={type:"table",raw:r[0],header:[],align:[],rows:[]};if(s.length===o.length){for(const u of o)/^ *-+: *$/.test(u)?l.align.push("right"):/^ *:-+: *$/.test(u)?l.align.push("center"):/^ *:-+ *$/.test(u)?l.align.push("left"):l.align.push(null);for(const u of s)l.header.push({text:u,tokens:this.lexer.inline(u)});for(const u of a)l.rows.push(yg(u,l.header.length).map(m=>({text:m,tokens:this.lexer.inline(m)})));return l}}lheading(t){const r=this.rules.block.lheading.exec(t);if(r)return{type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:this.lexer.inline(r[1])}}paragraph(t){const r=this.rules.block.paragraph.exec(t);if(r){const s=r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1];return{type:"paragraph",raw:r[0],text:s,tokens:this.lexer.inline(s)}}}text(t){const r=this.rules.block.text.exec(t);if(r)return{type:"text",raw:r[0],text:r[0],tokens:this.lexer.inline(r[0])}}escape(t){const r=this.rules.inline.escape.exec(t);if(r)return{type:"escape",raw:r[0],text:ss(r[1])}}tag(t){const r=this.rules.inline.tag.exec(t);if(r)return!this.lexer.state.inLink&&/^<a /i.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:r[0]}}link(t){const r=this.rules.inline.link.exec(t);if(r){const s=r[2].trim();if(!this.options.pedantic&&/^</.test(s)){if(!/>$/.test(s))return;const l=xu(s.slice(0,-1),"\\");if((s.length-l.length)%2===0)return}else{const l=W2(r[2],"()");if(l>-1){const m=(r[0].indexOf("!")===0?5:4)+r[1].length+l;r[2]=r[2].substring(0,l),r[0]=r[0].substring(0,m).trim(),r[3]=""}}let o=r[2],a="";if(this.options.pedantic){const l=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(o);l&&(o=l[1],a=l[3])}else a=r[3]?r[3].slice(1,-1):"";return o=o.trim(),/^</.test(o)&&(this.options.pedantic&&!/>$/.test(s)?o=o.slice(1):o=o.slice(1,-1)),bg(r,{href:o&&o.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},r[0],this.lexer)}}reflink(t,r){let s;if((s=this.rules.inline.reflink.exec(t))||(s=this.rules.inline.nolink.exec(t))){const o=(s[2]||s[1]).replace(/\s+/g," "),a=r[o.toLowerCase()];if(!a){const l=s[0].charAt(0);return{type:"text",raw:l,text:l}}return bg(s,a,s[0],this.lexer)}}emStrong(t,r,s=""){let o=this.rules.inline.emStrongLDelim.exec(t);if(!o||o[3]&&s.match(/[\p{L}\p{N}]/u))return;if(!(o[1]||o[2]||"")||!s||this.rules.inline.punctuation.exec(s)){const l=[...o[0]].length-1;let u,m,v=l,I=0;const $=o[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for($.lastIndex=0,r=r.slice(-1*t.length+l);(o=$.exec(r))!=null;){if(u=o[1]||o[2]||o[3]||o[4]||o[5]||o[6],!u)continue;if(m=[...u].length,o[3]||o[4]){v+=m;continue}else if((o[5]||o[6])&&l%3&&!((l+m)%3)){I+=m;continue}if(v-=m,v>0)continue;m=Math.min(m,m+v+I);const _=[...o[0]][0].length,b=t.slice(0,l+o.index+_+m);if(Math.min(l,m)%2){const k=b.slice(1,-1);return{type:"em",raw:b,text:k,tokens:this.lexer.inlineTokens(k)}}const T=b.slice(2,-2);return{type:"strong",raw:b,text:T,tokens:this.lexer.inlineTokens(T)}}}}codespan(t){const r=this.rules.inline.code.exec(t);if(r){let s=r[2].replace(/\n/g," ");const o=/[^ ]/.test(s),a=/^ /.test(s)&&/ $/.test(s);return o&&a&&(s=s.substring(1,s.length-1)),s=ss(s,!0),{type:"codespan",raw:r[0],text:s}}}br(t){const r=this.rules.inline.br.exec(t);if(r)return{type:"br",raw:r[0]}}del(t){const r=this.rules.inline.del.exec(t);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2])}}autolink(t){const r=this.rules.inline.autolink.exec(t);if(r){let s,o;return r[2]==="@"?(s=ss(r[1]),o="mailto:"+s):(s=ss(r[1]),o=s),{type:"link",raw:r[0],text:s,href:o,tokens:[{type:"text",raw:s,text:s}]}}}url(t){var s;let r;if(r=this.rules.inline.url.exec(t)){let o,a;if(r[2]==="@")o=ss(r[0]),a="mailto:"+o;else{let l;do l=r[0],r[0]=((s=this.rules.inline._backpedal.exec(r[0]))==null?void 0:s[0])??"";while(l!==r[0]);o=ss(r[0]),r[1]==="www."?a="http://"+r[0]:a=r[0]}return{type:"link",raw:r[0],text:o,href:a,tokens:[{type:"text",raw:o,text:o}]}}}inlineText(t){const r=this.rules.inline.text.exec(t);if(r){let s;return this.lexer.state.inRawBlock?s=r[0]:s=ss(r[0]),{type:"text",raw:r[0],text:s}}}}const V2=/^(?: *(?:\n|$))+/,K2=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,Y2=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,vc=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,G2=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,x1=/(?:[*+-]|\d{1,9}[.)])/,y1=jn(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,x1).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Z0=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,X2=/^[^\n]+/,q0=/(?!\s*\])(?:\\.|[^\[\]\\])+/,J2=jn(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",q0).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Z2=jn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,x1).getRegex(),Td="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Q0=/\x3C!--(?:-?>|[\s\S]*?(?:-->|$))/,q2=jn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",Q0).replace("tag",Td).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),b1=jn(Z0).replace("hr",vc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Td).getRegex(),Q2=jn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",b1).getRegex(),eh={blockquote:Q2,code:K2,def:J2,fences:Y2,heading:G2,hr:vc,html:q2,lheading:y1,list:Z2,newline:V2,paragraph:b1,table:Jl,text:X2},vg=jn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",vc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Td).getRegex(),ek={...eh,table:vg,paragraph:jn(Z0).replace("hr",vc).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",vg).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Td).getRegex()},tk={...eh,html:jn(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Q0).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Jl,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:jn(Z0).replace("hr",vc).replace("heading",` *#{1,6} *[^
]`).replace("lheading",y1).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},v1=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,nk=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,w1=/^( {2,}|\\)\n(?!\s*$)/,rk=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,wc="\\p{P}\\p{S}",sk=jn(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,wc).getRegex(),ik=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,ok=jn(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,wc).getRegex(),ak=jn("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,wc).getRegex(),lk=jn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,wc).getRegex(),ck=jn(/\\([punct])/,"gu").replace(/punct/g,wc).getRegex(),uk=jn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),dk=jn(Q0).replace("(?:-->|$)","-->").getRegex(),pk=jn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",dk).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),hd=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,fk=jn(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",hd).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),k1=jn(/^!?\[(label)\]\[(ref)\]/).replace("label",hd).replace("ref",q0).getRegex(),z1=jn(/^!?\[(ref)\](?:\[\])?/).replace("ref",q0).getRegex(),hk=jn("reflink|nolink(?!\\()","g").replace("reflink",k1).replace("nolink",z1).getRegex(),th={_backpedal:Jl,anyPunctuation:ck,autolink:uk,blockSkip:ik,br:w1,code:nk,del:Jl,emStrongLDelim:ok,emStrongRDelimAst:ak,emStrongRDelimUnd:lk,escape:v1,link:fk,nolink:z1,punctuation:sk,reflink:k1,reflinkSearch:hk,tag:pk,text:rk,url:Jl},mk={...th,link:jn(/^!?\[(label)\]\((.*?)\)/).replace("label",hd).getRegex(),reflink:jn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",hd).getRegex()},Xf={...th,escape:jn(v1).replace("])","~|])").getRegex(),url:jn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},gk={...Xf,br:jn(w1).replace("{2,}","*").getRegex(),text:jn(Xf.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},yu={normal:eh,gfm:ek,pedantic:tk},jl={normal:th,gfm:Xf,breaks:gk,pedantic:mk};class ni{constructor(t){Pn(this,"tokens");Pn(this,"options");Pn(this,"state");Pn(this,"tokenizer");Pn(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Bo,this.options.tokenizer=this.options.tokenizer||new fd,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const r={block:yu.normal,inline:jl.normal};this.options.pedantic?(r.block=yu.pedantic,r.inline=jl.pedantic):this.options.gfm&&(r.block=yu.gfm,this.options.breaks?r.inline=jl.breaks:r.inline=jl.gfm),this.tokenizer.rules=r}static get rules(){return{block:yu,inline:jl}}static lex(t,r){return new ni(r).lex(t)}static lexInline(t,r){return new ni(r).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`),this.blockTokens(t,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){const s=this.inlineQueue[r];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,r=[]){this.options.pedantic?t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t=t.replace(/^( *)(\t+)/gm,(u,m,v)=>m+"    ".repeat(v.length));let s,o,a,l;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(u=>(s=u.call({lexer:this},t,r))?(t=t.substring(s.raw.length),r.push(s),!0):!1))){if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length),s.raw.length===1&&r.length>0?r[r.length-1].raw+=`
`:r.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+s.raw,o.text+=`
`+s.text,this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length),o=r[r.length-1],o&&(o.type==="paragraph"||o.type==="text")?(o.raw+=`
`+s.raw,o.text+=`
`+s.raw,this.inlineQueue[this.inlineQueue.length-1].src=o.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),r.push(s);continue}if(a=t,this.options.extensions&&this.options.extensions.startBlock){let u=1/0;const m=t.slice(1);let v;this.options.extensions.startBlock.forEach(I=>{v=I.call({lexer:this},m),typeof v=="number"&&v>=0&&(u=Math.min(u,v))}),u<1/0&&u>=0&&(a=t.substring(0,u+1))}if(this.state.top&&(s=this.tokenizer.paragraph(a))){o=r[r.length-1],l&&o.type==="paragraph"?(o.raw+=`
`+s.raw,o.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(s),l=a.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length),o=r[r.length-1],o&&o.type==="text"?(o.raw+=`
`+s.raw,o.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=o.text):r.push(s);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,r}inline(t,r=[]){return this.inlineQueue.push({src:t,tokens:r}),r}inlineTokens(t,r=[]){let s,o,a,l=t,u,m,v;if(this.tokens.links){const I=Object.keys(this.tokens.links);if(I.length>0)for(;(u=this.tokenizer.rules.inline.reflinkSearch.exec(l))!=null;)I.includes(u[0].slice(u[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,u.index)+"["+"a".repeat(u[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(u=this.tokenizer.rules.inline.blockSkip.exec(l))!=null;)l=l.slice(0,u.index)+"["+"a".repeat(u[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(u=this.tokenizer.rules.inline.anyPunctuation.exec(l))!=null;)l=l.slice(0,u.index)+"++"+l.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(m||(v=""),m=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(I=>(s=I.call({lexer:this},t,r))?(t=t.substring(s.raw.length),r.push(s),!0):!1))){if(s=this.tokenizer.escape(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.tag(t)){t=t.substring(s.raw.length),o=r[r.length-1],o&&s.type==="text"&&o.type==="text"?(o.raw+=s.raw,o.text+=s.text):r.push(s);continue}if(s=this.tokenizer.link(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(s.raw.length),o=r[r.length-1],o&&s.type==="text"&&o.type==="text"?(o.raw+=s.raw,o.text+=s.text):r.push(s);continue}if(s=this.tokenizer.emStrong(t,l,v)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.codespan(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.br(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.del(t)){t=t.substring(s.raw.length),r.push(s);continue}if(s=this.tokenizer.autolink(t)){t=t.substring(s.raw.length),r.push(s);continue}if(!this.state.inLink&&(s=this.tokenizer.url(t))){t=t.substring(s.raw.length),r.push(s);continue}if(a=t,this.options.extensions&&this.options.extensions.startInline){let I=1/0;const $=t.slice(1);let _;this.options.extensions.startInline.forEach(b=>{_=b.call({lexer:this},$),typeof _=="number"&&_>=0&&(I=Math.min(I,_))}),I<1/0&&I>=0&&(a=t.substring(0,I+1))}if(s=this.tokenizer.inlineText(a)){t=t.substring(s.raw.length),s.raw.slice(-1)!=="_"&&(v=s.raw.slice(-1)),m=!0,o=r[r.length-1],o&&o.type==="text"?(o.raw+=s.raw,o.text+=s.text):r.push(s);continue}if(t){const I="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(I);break}else throw new Error(I)}}return r}}class md{constructor(t){Pn(this,"options");this.options=t||Bo}code(t,r,s){var a;const o=(a=(r||"").match(/^\S*/))==null?void 0:a[0];return t=t.replace(/\n$/,"")+`
`,o?'<pre><code class="language-'+ss(o)+'">'+(s?t:ss(t,!0))+`</code></pre>
`:"<pre><code>"+(s?t:ss(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
${t}</blockquote>
`}html(t,r){return t}heading(t,r,s){return`<h${r}>${t}</h${r}>
`}hr(){return`<hr>
`}list(t,r,s){const o=r?"ol":"ul",a=r&&s!==1?' start="'+s+'"':"";return"<"+o+a+`>
`+t+"</"+o+`>
`}listitem(t,r,s){return`<li>${t}</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(t){return`<p>${t}</p>
`}table(t,r){return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow(t){return`<tr>
${t}</tr>
`}tablecell(t,r){const s=r.header?"th":"td";return(r.align?`<${s} align="${r.align}">`:`<${s}>`)+t+`</${s}>
`}strong(t){return`<strong>${t}</strong>`}em(t){return`<em>${t}</em>`}codespan(t){return`<code>${t}</code>`}br(){return"<br>"}del(t){return`<del>${t}</del>`}link(t,r,s){const o=xg(t);if(o===null)return s;t=o;let a='<a href="'+t+'"';return r&&(a+=' title="'+r+'"'),a+=">"+s+"</a>",a}image(t,r,s){const o=xg(t);if(o===null)return s;t=o;let a=`<img src="${t}" alt="${s}"`;return r&&(a+=` title="${r}"`),a+=">",a}text(t){return t}}class nh{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,r,s){return""+s}image(t,r,s){return""+s}br(){return""}}class ri{constructor(t){Pn(this,"options");Pn(this,"renderer");Pn(this,"textRenderer");this.options=t||Bo,this.options.renderer=this.options.renderer||new md,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new nh}static parse(t,r){return new ri(r).parse(t)}static parseInline(t,r){return new ri(r).parseInline(t)}parse(t,r=!0){let s="";for(let o=0;o<t.length;o++){const a=t[o];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const l=a,u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(l.type)){s+=u||"";continue}}switch(a.type){case"space":continue;case"hr":{s+=this.renderer.hr();continue}case"heading":{const l=a;s+=this.renderer.heading(this.parseInline(l.tokens),l.depth,F2(this.parseInline(l.tokens,this.textRenderer)));continue}case"code":{const l=a;s+=this.renderer.code(l.text,l.lang,!!l.escaped);continue}case"table":{const l=a;let u="",m="";for(let I=0;I<l.header.length;I++)m+=this.renderer.tablecell(this.parseInline(l.header[I].tokens),{header:!0,align:l.align[I]});u+=this.renderer.tablerow(m);let v="";for(let I=0;I<l.rows.length;I++){const $=l.rows[I];m="";for(let _=0;_<$.length;_++)m+=this.renderer.tablecell(this.parseInline($[_].tokens),{header:!1,align:l.align[_]});v+=this.renderer.tablerow(m)}s+=this.renderer.table(u,v);continue}case"blockquote":{const l=a,u=this.parse(l.tokens);s+=this.renderer.blockquote(u);continue}case"list":{const l=a,u=l.ordered,m=l.start,v=l.loose;let I="";for(let $=0;$<l.items.length;$++){const _=l.items[$],b=_.checked,T=_.task;let k="";if(_.task){const R=this.renderer.checkbox(!!b);v?_.tokens.length>0&&_.tokens[0].type==="paragraph"?(_.tokens[0].text=R+" "+_.tokens[0].text,_.tokens[0].tokens&&_.tokens[0].tokens.length>0&&_.tokens[0].tokens[0].type==="text"&&(_.tokens[0].tokens[0].text=R+" "+_.tokens[0].tokens[0].text)):_.tokens.unshift({type:"text",text:R+" "}):k+=R+" "}k+=this.parse(_.tokens,v),I+=this.renderer.listitem(k,T,!!b)}s+=this.renderer.list(I,u,m);continue}case"html":{const l=a;s+=this.renderer.html(l.text,l.block);continue}case"paragraph":{const l=a;s+=this.renderer.paragraph(this.parseInline(l.tokens));continue}case"text":{let l=a,u=l.tokens?this.parseInline(l.tokens):l.text;for(;o+1<t.length&&t[o+1].type==="text";)l=t[++o],u+=`
`+(l.tokens?this.parseInline(l.tokens):l.text);s+=r?this.renderer.paragraph(u):u;continue}default:{const l='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return s}parseInline(t,r){r=r||this.renderer;let s="";for(let o=0;o<t.length;o++){const a=t[o];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){s+=l||"";continue}}switch(a.type){case"escape":{const l=a;s+=r.text(l.text);break}case"html":{const l=a;s+=r.html(l.text);break}case"link":{const l=a;s+=r.link(l.href,l.title,this.parseInline(l.tokens,r));break}case"image":{const l=a;s+=r.image(l.href,l.title,l.text);break}case"strong":{const l=a;s+=r.strong(this.parseInline(l.tokens,r));break}case"em":{const l=a;s+=r.em(this.parseInline(l.tokens,r));break}case"codespan":{const l=a;s+=r.codespan(l.text);break}case"br":{s+=r.br();break}case"del":{const l=a;s+=r.del(this.parseInline(l.tokens,r));break}case"text":{const l=a;s+=r.text(l.text);break}default:{const l='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return s}}class Zl{constructor(t){Pn(this,"options");this.options=t||Bo}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}}Pn(Zl,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Lo,Jf,j1;class xk{constructor(...t){om(this,Lo);Pn(this,"defaults",J0());Pn(this,"options",this.setOptions);Pn(this,"parse",Qc(this,Lo,Jf).call(this,ni.lex,ri.parse));Pn(this,"parseInline",Qc(this,Lo,Jf).call(this,ni.lexInline,ri.parseInline));Pn(this,"Parser",ri);Pn(this,"Renderer",md);Pn(this,"TextRenderer",nh);Pn(this,"Lexer",ni);Pn(this,"Tokenizer",fd);Pn(this,"Hooks",Zl);this.use(...t)}walkTokens(t,r){var o,a;let s=[];for(const l of t)switch(s=s.concat(r.call(this,l)),l.type){case"table":{const u=l;for(const m of u.header)s=s.concat(this.walkTokens(m.tokens,r));for(const m of u.rows)for(const v of m)s=s.concat(this.walkTokens(v.tokens,r));break}case"list":{const u=l;s=s.concat(this.walkTokens(u.items,r));break}default:{const u=l;(a=(o=this.defaults.extensions)==null?void 0:o.childTokens)!=null&&a[u.type]?this.defaults.extensions.childTokens[u.type].forEach(m=>{const v=u[m].flat(1/0);s=s.concat(this.walkTokens(v,r))}):u.tokens&&(s=s.concat(this.walkTokens(u.tokens,r)))}}return s}use(...t){const r=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(s=>{const o={...s};if(o.async=this.defaults.async||o.async||!1,s.extensions&&(s.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const l=r.renderers[a.name];l?r.renderers[a.name]=function(...u){let m=a.renderer.apply(this,u);return m===!1&&(m=l.apply(this,u)),m}:r.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const l=r[a.level];l?l.unshift(a.tokenizer):r[a.level]=[a.tokenizer],a.start&&(a.level==="block"?r.startBlock?r.startBlock.push(a.start):r.startBlock=[a.start]:a.level==="inline"&&(r.startInline?r.startInline.push(a.start):r.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(r.childTokens[a.name]=a.childTokens)}),o.extensions=r),s.renderer){const a=this.defaults.renderer||new md(this.defaults);for(const l in s.renderer){if(!(l in a))throw new Error(`renderer '${l}' does not exist`);if(l==="options")continue;const u=l,m=s.renderer[u],v=a[u];a[u]=(...I)=>{let $=m.apply(a,I);return $===!1&&($=v.apply(a,I)),$||""}}o.renderer=a}if(s.tokenizer){const a=this.defaults.tokenizer||new fd(this.defaults);for(const l in s.tokenizer){if(!(l in a))throw new Error(`tokenizer '${l}' does not exist`);if(["options","rules","lexer"].includes(l))continue;const u=l,m=s.tokenizer[u],v=a[u];a[u]=(...I)=>{let $=m.apply(a,I);return $===!1&&($=v.apply(a,I)),$}}o.tokenizer=a}if(s.hooks){const a=this.defaults.hooks||new Zl;for(const l in s.hooks){if(!(l in a))throw new Error(`hook '${l}' does not exist`);if(l==="options")continue;const u=l,m=s.hooks[u],v=a[u];Zl.passThroughHooks.has(l)?a[u]=I=>{if(this.defaults.async)return Promise.resolve(m.call(a,I)).then(_=>v.call(a,_));const $=m.call(a,I);return v.call(a,$)}:a[u]=(...I)=>{let $=m.apply(a,I);return $===!1&&($=v.apply(a,I)),$}}o.hooks=a}if(s.walkTokens){const a=this.defaults.walkTokens,l=s.walkTokens;o.walkTokens=function(u){let m=[];return m.push(l.call(this,u)),a&&(m=m.concat(a.call(this,u))),m}}this.defaults={...this.defaults,...o}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,r){return ni.lex(t,r??this.defaults)}parser(t,r){return ri.parse(t,r??this.defaults)}}Lo=new WeakSet,Jf=function(t,r){return(s,o)=>{const a={...o},l={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(l.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),l.async=!0);const u=Qc(this,Lo,j1).call(this,!!l.silent,!!l.async);if(typeof s>"u"||s===null)return u(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return u(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));if(l.hooks&&(l.hooks.options=l),l.async)return Promise.resolve(l.hooks?l.hooks.preprocess(s):s).then(m=>t(m,l)).then(m=>l.hooks?l.hooks.processAllTokens(m):m).then(m=>l.walkTokens?Promise.all(this.walkTokens(m,l.walkTokens)).then(()=>m):m).then(m=>r(m,l)).then(m=>l.hooks?l.hooks.postprocess(m):m).catch(u);try{l.hooks&&(s=l.hooks.preprocess(s));let m=t(s,l);l.hooks&&(m=l.hooks.processAllTokens(m)),l.walkTokens&&this.walkTokens(m,l.walkTokens);let v=r(m,l);return l.hooks&&(v=l.hooks.postprocess(v)),v}catch(m){return u(m)}}},j1=function(t,r){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const o="<p>An error occurred:</p><pre>"+ss(s.message+"",!0)+"</pre>";return r?Promise.resolve(o):o}if(r)return Promise.reject(s);throw s}};const Oo=new xk;function wn(e,t){return Oo.parse(e,t)}wn.options=wn.setOptions=function(e){return Oo.setOptions(e),wn.defaults=Oo.defaults,h1(wn.defaults),wn};wn.getDefaults=J0;wn.defaults=Bo;wn.use=function(...e){return Oo.use(...e),wn.defaults=Oo.defaults,h1(wn.defaults),wn};wn.walkTokens=function(e,t){return Oo.walkTokens(e,t)};wn.parseInline=Oo.parseInline;wn.Parser=ri;wn.parser=ri.parse;wn.Renderer=md;wn.TextRenderer=nh;wn.Lexer=ni;wn.lexer=ni.lex;wn.Tokenizer=fd;wn.Hooks=Zl;wn.parse=wn;wn.options;wn.setOptions;wn.use;wn.walkTokens;wn.parseInline;ri.parse;ni.lex;/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:N1,setPrototypeOf:wg,isFrozen:yk,getPrototypeOf:bk,getOwnPropertyDescriptor:vk}=Object;let{freeze:Ar,seal:zs,create:Zf}=Object,{apply:qf,construct:Qf}=typeof Reflect<"u"&&Reflect;Ar||(Ar=function(t){return t});zs||(zs=function(t){return t});qf||(qf=function(t,r){for(var s=arguments.length,o=new Array(s>2?s-2:0),a=2;a<s;a++)o[a-2]=arguments[a];return t.apply(r,o)});Qf||(Qf=function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return new t(...s)});const bu=Rr(Array.prototype.forEach),wk=Rr(Array.prototype.lastIndexOf),kg=Rr(Array.prototype.pop),Nl=Rr(Array.prototype.push),kk=Rr(Array.prototype.splice),Fu=Rr(String.prototype.toLowerCase),Wp=Rr(String.prototype.toString),Hp=Rr(String.prototype.match),_l=Rr(String.prototype.replace),zk=Rr(String.prototype.indexOf),jk=Rr(String.prototype.trim),Ls=Rr(Object.prototype.hasOwnProperty),Mr=Rr(RegExp.prototype.test),Sl=Nk(TypeError);function Rr(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return qf(e,t,s)}}function Nk(e){return function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return Qf(e,r)}}function nn(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fu;wg&&wg(e,null);let s=t.length;for(;s--;){let o=t[s];if(typeof o=="string"){const a=r(o);a!==o&&(yk(t)||(t[s]=a),o=a)}e[o]=!0}return e}function _k(e){for(let t=0;t<e.length;t++)Ls(e,t)||(e[t]=null);return e}function Qs(e){const t=Zf(null);for(const[r,s]of N1(e))Ls(e,r)&&(Array.isArray(s)?t[r]=_k(s):s&&typeof s=="object"&&s.constructor===Object?t[r]=Qs(s):t[r]=s);return t}function Cl(e,t){for(;e!==null;){const s=vk(e,t);if(s){if(s.get)return Rr(s.get);if(typeof s.value=="function")return Rr(s.value)}e=bk(e)}function r(){return null}return r}const zg=Ar(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Vp=Ar(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Kp=Ar(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Sk=Ar(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Yp=Ar(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ck=Ar(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),jg=Ar(["#text"]),Ng=Ar(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Gp=Ar(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_g=Ar(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vu=Ar(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ek=zs(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ik=zs(/<%[\w\W]*|[\w\W]*%>/gm),$k=zs(/\$\{[\w\W]*/gm),Mk=zs(/^data-[\-\w.\u00B7-\uFFFF]+$/),Tk=zs(/^aria-[\-\w]+$/),_1=zs(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Pk=zs(/^(?:\w+script|data):/i),Ak=zs(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),S1=zs(/^html$/i),Rk=zs(/^[a-z][.\w]*(-[.\w]+)+$/i);var Sg=Object.freeze({__proto__:null,ARIA_ATTR:Tk,ATTR_WHITESPACE:Ak,CUSTOM_ELEMENT:Rk,DATA_ATTR:Mk,DOCTYPE_NAME:S1,ERB_EXPR:Ik,IS_ALLOWED_URI:_1,IS_SCRIPT_OR_DATA:Pk,MUSTACHE_EXPR:Ek,TMPLIT_EXPR:$k});const El={element:1,text:3,progressingInstruction:7,comment:8,document:9},Dk=function(){return typeof window>"u"?null:window},Ok=function(t,r){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let s=null;const o="data-tt-policy-suffix";r&&r.hasAttribute(o)&&(s=r.getAttribute(o));const a="dompurify"+(s?"#"+s:"");try{return t.createPolicy(a,{createHTML(l){return l},createScriptURL(l){return l}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},Cg=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function C1(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dk();const t=Pt=>C1(Pt);if(t.version="3.3.1",t.removed=[],!e||!e.document||e.document.nodeType!==El.document||!e.Element)return t.isSupported=!1,t;let{document:r}=e;const s=r,o=s.currentScript,{DocumentFragment:a,HTMLTemplateElement:l,Node:u,Element:m,NodeFilter:v,NamedNodeMap:I=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:$,DOMParser:_,trustedTypes:b}=e,T=m.prototype,k=Cl(T,"cloneNode"),R=Cl(T,"remove"),x=Cl(T,"nextSibling"),w=Cl(T,"childNodes"),P=Cl(T,"parentNode");if(typeof l=="function"){const Pt=r.createElement("template");Pt.content&&Pt.content.ownerDocument&&(r=Pt.content.ownerDocument)}let L,Y="";const{implementation:oe,createNodeIterator:ie,createDocumentFragment:be,getElementsByTagName:ye}=r,{importNode:he}=s;let We=Cg();t.isSupported=typeof N1=="function"&&typeof P=="function"&&oe&&oe.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:ke,TMPLIT_EXPR:M,DATA_ATTR:xe,ARIA_ATTR:lt,IS_SCRIPT_OR_DATA:Se,ATTR_WHITESPACE:we,CUSTOM_ELEMENT:Ne}=Sg;let{IS_ALLOWED_URI:et}=Sg,ee=null;const ae=nn({},[...zg,...Vp,...Kp,...Yp,...jg]);let Te=null;const it=nn({},[...Ng,...Gp,..._g,...vu]);let Pe=Object.seal(Zf(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Gt=null,an=null;const Yt=Object.seal(Zf(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Jt=!0,$n=!0,pn=!1,mr=!0,Nn=!1,j=!0,Ce=!1,_e=!1,K=!1,W=!1,ue=!1,Oe=!1,Ve=!0,ve=!1;const nt="user-content-";let gt=!0,Ye=!1,It={},tn=null;const Xt=nn({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let cr=null;const Xr=nn({},["audio","video","img","source","image","track"]);let Qn=null;const Bn=nn({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),gn="http://www.w3.org/1998/Math/MathML",er="http://www.w3.org/2000/svg",Cr="http://www.w3.org/1999/xhtml";let Zt=Cr,Si=!1,on=null;const po=nn({},[gn,er,Cr],Wp);let tr=nn({},["mi","mo","mn","ms","mtext"]),Lr=nn({},["annotation-xml"]);const Jr=nn({},["title","style","font","a","script"]);let gr=null;const Ba=["application/xhtml+xml","text/html"],js="text/html";let dt=null,$t=null;const Wo=r.createElement("form"),Ci=function(q){return q instanceof RegExp||q instanceof Function},us=function(){let q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!($t&&$t===q)){if((!q||typeof q!="object")&&(q={}),q=Qs(q),gr=Ba.indexOf(q.PARSER_MEDIA_TYPE)===-1?js:q.PARSER_MEDIA_TYPE,dt=gr==="application/xhtml+xml"?Wp:Fu,ee=Ls(q,"ALLOWED_TAGS")?nn({},q.ALLOWED_TAGS,dt):ae,Te=Ls(q,"ALLOWED_ATTR")?nn({},q.ALLOWED_ATTR,dt):it,on=Ls(q,"ALLOWED_NAMESPACES")?nn({},q.ALLOWED_NAMESPACES,Wp):po,Qn=Ls(q,"ADD_URI_SAFE_ATTR")?nn(Qs(Bn),q.ADD_URI_SAFE_ATTR,dt):Bn,cr=Ls(q,"ADD_DATA_URI_TAGS")?nn(Qs(Xr),q.ADD_DATA_URI_TAGS,dt):Xr,tn=Ls(q,"FORBID_CONTENTS")?nn({},q.FORBID_CONTENTS,dt):Xt,Gt=Ls(q,"FORBID_TAGS")?nn({},q.FORBID_TAGS,dt):Qs({}),an=Ls(q,"FORBID_ATTR")?nn({},q.FORBID_ATTR,dt):Qs({}),It=Ls(q,"USE_PROFILES")?q.USE_PROFILES:!1,Jt=q.ALLOW_ARIA_ATTR!==!1,$n=q.ALLOW_DATA_ATTR!==!1,pn=q.ALLOW_UNKNOWN_PROTOCOLS||!1,mr=q.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Nn=q.SAFE_FOR_TEMPLATES||!1,j=q.SAFE_FOR_XML!==!1,Ce=q.WHOLE_DOCUMENT||!1,W=q.RETURN_DOM||!1,ue=q.RETURN_DOM_FRAGMENT||!1,Oe=q.RETURN_TRUSTED_TYPE||!1,K=q.FORCE_BODY||!1,Ve=q.SANITIZE_DOM!==!1,ve=q.SANITIZE_NAMED_PROPS||!1,gt=q.KEEP_CONTENT!==!1,Ye=q.IN_PLACE||!1,et=q.ALLOWED_URI_REGEXP||_1,Zt=q.NAMESPACE||Cr,tr=q.MATHML_TEXT_INTEGRATION_POINTS||tr,Lr=q.HTML_INTEGRATION_POINTS||Lr,Pe=q.CUSTOM_ELEMENT_HANDLING||{},q.CUSTOM_ELEMENT_HANDLING&&Ci(q.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Pe.tagNameCheck=q.CUSTOM_ELEMENT_HANDLING.tagNameCheck),q.CUSTOM_ELEMENT_HANDLING&&Ci(q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Pe.attributeNameCheck=q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),q.CUSTOM_ELEMENT_HANDLING&&typeof q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Pe.allowCustomizedBuiltInElements=q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Nn&&($n=!1),ue&&(W=!0),It&&(ee=nn({},jg),Te=[],It.html===!0&&(nn(ee,zg),nn(Te,Ng)),It.svg===!0&&(nn(ee,Vp),nn(Te,Gp),nn(Te,vu)),It.svgFilters===!0&&(nn(ee,Kp),nn(Te,Gp),nn(Te,vu)),It.mathMl===!0&&(nn(ee,Yp),nn(Te,_g),nn(Te,vu))),q.ADD_TAGS&&(typeof q.ADD_TAGS=="function"?Yt.tagCheck=q.ADD_TAGS:(ee===ae&&(ee=Qs(ee)),nn(ee,q.ADD_TAGS,dt))),q.ADD_ATTR&&(typeof q.ADD_ATTR=="function"?Yt.attributeCheck=q.ADD_ATTR:(Te===it&&(Te=Qs(Te)),nn(Te,q.ADD_ATTR,dt))),q.ADD_URI_SAFE_ATTR&&nn(Qn,q.ADD_URI_SAFE_ATTR,dt),q.FORBID_CONTENTS&&(tn===Xt&&(tn=Qs(tn)),nn(tn,q.FORBID_CONTENTS,dt)),q.ADD_FORBID_CONTENTS&&(tn===Xt&&(tn=Qs(tn)),nn(tn,q.ADD_FORBID_CONTENTS,dt)),gt&&(ee["#text"]=!0),Ce&&nn(ee,["html","head","body"]),ee.table&&(nn(ee,["tbody"]),delete Gt.tbody),q.TRUSTED_TYPES_POLICY){if(typeof q.TRUSTED_TYPES_POLICY.createHTML!="function")throw Sl('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof q.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Sl('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');L=q.TRUSTED_TYPES_POLICY,Y=L.createHTML("")}else L===void 0&&(L=Ok(b,o)),L!==null&&typeof Y=="string"&&(Y=L.createHTML(""));Ar&&Ar(q),$t=q}},ur=nn({},[...Vp,...Kp,...Sk]),fo=nn({},[...Yp,...Ck]),rh=function(q){let Je=P(q);(!Je||!Je.tagName)&&(Je={namespaceURI:Zt,tagName:"template"});const ht=Fu(q.tagName),_n=Fu(Je.tagName);return on[q.namespaceURI]?q.namespaceURI===er?Je.namespaceURI===Cr?ht==="svg":Je.namespaceURI===gn?ht==="svg"&&(_n==="annotation-xml"||tr[_n]):!!ur[ht]:q.namespaceURI===gn?Je.namespaceURI===Cr?ht==="math":Je.namespaceURI===er?ht==="math"&&Lr[_n]:!!fo[ht]:q.namespaceURI===Cr?Je.namespaceURI===er&&!Lr[_n]||Je.namespaceURI===gn&&!tr[_n]?!1:!fo[ht]&&(Jr[ht]||!ur[ht]):!!(gr==="application/xhtml+xml"&&on[q.namespaceURI]):!1},Ns=function(q){Nl(t.removed,{element:q});try{P(q).removeChild(q)}catch{R(q)}},Ei=function(q,Je){try{Nl(t.removed,{attribute:Je.getAttributeNode(q),from:Je})}catch{Nl(t.removed,{attribute:null,from:Je})}if(Je.removeAttribute(q),q==="is")if(W||ue)try{Ns(Je)}catch{}else try{Je.setAttribute(q,"")}catch{}},Pd=function(q){let Je=null,ht=null;if(K)q="<remove></remove>"+q;else{const Wn=Hp(q,/^[\r\n\t ]+/);ht=Wn&&Wn[0]}gr==="application/xhtml+xml"&&Zt===Cr&&(q='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+q+"</body></html>");const _n=L?L.createHTML(q):q;if(Zt===Cr)try{Je=new _().parseFromString(_n,gr)}catch{}if(!Je||!Je.documentElement){Je=oe.createDocument(Zt,"template",null);try{Je.documentElement.innerHTML=Si?Y:_n}catch{}}const rr=Je.body||Je.documentElement;return q&&ht&&rr.insertBefore(r.createTextNode(ht),rr.childNodes[0]||null),Zt===Cr?ye.call(Je,Ce?"html":"body")[0]:Ce?Je.documentElement:rr},wr=function(q){return ie.call(q.ownerDocument||q,q,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT|v.SHOW_PROCESSING_INSTRUCTION|v.SHOW_CDATA_SECTION,null)},_s=function(q){return q instanceof $&&(typeof q.nodeName!="string"||typeof q.textContent!="string"||typeof q.removeChild!="function"||!(q.attributes instanceof I)||typeof q.removeAttribute!="function"||typeof q.setAttribute!="function"||typeof q.namespaceURI!="string"||typeof q.insertBefore!="function"||typeof q.hasChildNodes!="function")},Ss=function(q){return typeof u=="function"&&q instanceof u};function Er(Pt,q,Je){bu(Pt,ht=>{ht.call(t,q,Je,$t)})}const oi=function(q){let Je=null;if(Er(We.beforeSanitizeElements,q,null),_s(q))return Ns(q),!0;const ht=dt(q.nodeName);if(Er(We.uponSanitizeElement,q,{tagName:ht,allowedTags:ee}),j&&q.hasChildNodes()&&!Ss(q.firstElementChild)&&Mr(/<[/\w!]/g,q.innerHTML)&&Mr(/<[/\w!]/g,q.textContent)||q.nodeType===El.progressingInstruction||j&&q.nodeType===El.comment&&Mr(/<[/\w]/g,q.data))return Ns(q),!0;if(!(Yt.tagCheck instanceof Function&&Yt.tagCheck(ht))&&(!ee[ht]||Gt[ht])){if(!Gt[ht]&&Ii(ht)&&(Pe.tagNameCheck instanceof RegExp&&Mr(Pe.tagNameCheck,ht)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(ht)))return!1;if(gt&&!tn[ht]){const _n=P(q)||q.parentNode,rr=w(q)||q.childNodes;if(rr&&_n){const Wn=rr.length;for(let sr=Wn-1;sr>=0;--sr){const Ur=k(rr[sr],!0);Ur.__removalCount=(q.__removalCount||0)+1,_n.insertBefore(Ur,x(q))}}}return Ns(q),!0}return q instanceof m&&!rh(q)||(ht==="noscript"||ht==="noembed"||ht==="noframes")&&Mr(/<\/no(script|embed|frames)/i,q.innerHTML)?(Ns(q),!0):(Nn&&q.nodeType===El.text&&(Je=q.textContent,bu([X,ke,M],_n=>{Je=_l(Je,_n," ")}),q.textContent!==Je&&(Nl(t.removed,{element:q.cloneNode()}),q.textContent=Je)),Er(We.afterSanitizeElements,q,null),!1)},Wa=function(q,Je,ht){if(Ve&&(Je==="id"||Je==="name")&&(ht in r||ht in Wo))return!1;if(!($n&&!an[Je]&&Mr(xe,Je))){if(!(Jt&&Mr(lt,Je))){if(!(Yt.attributeCheck instanceof Function&&Yt.attributeCheck(Je,q))){if(!Te[Je]||an[Je]){if(!(Ii(q)&&(Pe.tagNameCheck instanceof RegExp&&Mr(Pe.tagNameCheck,q)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(q))&&(Pe.attributeNameCheck instanceof RegExp&&Mr(Pe.attributeNameCheck,Je)||Pe.attributeNameCheck instanceof Function&&Pe.attributeNameCheck(Je,q))||Je==="is"&&Pe.allowCustomizedBuiltInElements&&(Pe.tagNameCheck instanceof RegExp&&Mr(Pe.tagNameCheck,ht)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(ht))))return!1}else if(!Qn[Je]){if(!Mr(et,_l(ht,we,""))){if(!((Je==="src"||Je==="xlink:href"||Je==="href")&&q!=="script"&&zk(ht,"data:")===0&&cr[q])){if(!(pn&&!Mr(Se,_l(ht,we,"")))){if(ht)return!1}}}}}}}return!0},Ii=function(q){return q!=="annotation-xml"&&Hp(q,Ne)},Ks=function(q){Er(We.beforeSanitizeAttributes,q,null);const{attributes:Je}=q;if(!Je||_s(q))return;const ht={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te,forceKeepAttr:void 0};let _n=Je.length;for(;_n--;){const rr=Je[_n],{name:Wn,namespaceURI:sr,value:Ur}=rr,Cs=dt(Wn),Ho=Ur;let Sn=Wn==="value"?Ho:jk(Ho);if(ht.attrName=Cs,ht.attrValue=Sn,ht.keepAttr=!0,ht.forceKeepAttr=void 0,Er(We.uponSanitizeAttribute,q,ht),Sn=ht.attrValue,ve&&(Cs==="id"||Cs==="name")&&(Ei(Wn,q),Sn=nt+Sn),j&&Mr(/((--!?|])>)|<\/(style|title|textarea)/i,Sn)){Ei(Wn,q);continue}if(Cs==="attributename"&&Hp(Sn,"href")){Ei(Wn,q);continue}if(ht.forceKeepAttr)continue;if(!ht.keepAttr){Ei(Wn,q);continue}if(!mr&&Mr(/\/>/i,Sn)){Ei(Wn,q);continue}Nn&&bu([X,ke,M],ho=>{Sn=_l(Sn,ho," ")});const xn=dt(q.nodeName);if(!Wa(xn,Cs,Sn)){Ei(Wn,q);continue}if(L&&typeof b=="object"&&typeof b.getAttributeType=="function"&&!sr)switch(b.getAttributeType(xn,Cs)){case"TrustedHTML":{Sn=L.createHTML(Sn);break}case"TrustedScriptURL":{Sn=L.createScriptURL(Sn);break}}if(Sn!==Ho)try{sr?q.setAttributeNS(sr,Wn,Sn):q.setAttribute(Wn,Sn),_s(q)?Ns(q):kg(t.removed)}catch{Ei(Wn,q)}}Er(We.afterSanitizeAttributes,q,null)},Ad=function Pt(q){let Je=null;const ht=wr(q);for(Er(We.beforeSanitizeShadowDOM,q,null);Je=ht.nextNode();)Er(We.uponSanitizeShadowNode,Je,null),oi(Je),Ks(Je),Je.content instanceof a&&Pt(Je.content);Er(We.afterSanitizeShadowDOM,q,null)};return t.sanitize=function(Pt){let q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Je=null,ht=null,_n=null,rr=null;if(Si=!Pt,Si&&(Pt="\x3C!-->"),typeof Pt!="string"&&!Ss(Pt))if(typeof Pt.toString=="function"){if(Pt=Pt.toString(),typeof Pt!="string")throw Sl("dirty is not a string, aborting")}else throw Sl("toString is not a function");if(!t.isSupported)return Pt;if(_e||us(q),t.removed=[],typeof Pt=="string"&&(Ye=!1),Ye){if(Pt.nodeName){const Ur=dt(Pt.nodeName);if(!ee[Ur]||Gt[Ur])throw Sl("root node is forbidden and cannot be sanitized in-place")}}else if(Pt instanceof u)Je=Pd("\x3C!---->"),ht=Je.ownerDocument.importNode(Pt,!0),ht.nodeType===El.element&&ht.nodeName==="BODY"||ht.nodeName==="HTML"?Je=ht:Je.appendChild(ht);else{if(!W&&!Nn&&!Ce&&Pt.indexOf("<")===-1)return L&&Oe?L.createHTML(Pt):Pt;if(Je=Pd(Pt),!Je)return W?null:Oe?Y:""}Je&&K&&Ns(Je.firstChild);const Wn=wr(Ye?Pt:Je);for(;_n=Wn.nextNode();)oi(_n),Ks(_n),_n.content instanceof a&&Ad(_n.content);if(Ye)return Pt;if(W){if(ue)for(rr=be.call(Je.ownerDocument);Je.firstChild;)rr.appendChild(Je.firstChild);else rr=Je;return(Te.shadowroot||Te.shadowrootmode)&&(rr=he.call(s,rr,!0)),rr}let sr=Ce?Je.outerHTML:Je.innerHTML;return Ce&&ee["!doctype"]&&Je.ownerDocument&&Je.ownerDocument.doctype&&Je.ownerDocument.doctype.name&&Mr(S1,Je.ownerDocument.doctype.name)&&(sr="<!DOCTYPE "+Je.ownerDocument.doctype.name+`>
`+sr),Nn&&bu([X,ke,M],Ur=>{sr=_l(sr,Ur," ")}),L&&Oe?L.createHTML(sr):sr},t.setConfig=function(){let Pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};us(Pt),_e=!0},t.clearConfig=function(){$t=null,_e=!1},t.isValidAttribute=function(Pt,q,Je){$t||us({});const ht=dt(Pt),_n=dt(q);return Wa(ht,_n,Je)},t.addHook=function(Pt,q){typeof q=="function"&&Nl(We[Pt],q)},t.removeHook=function(Pt,q){if(q!==void 0){const Je=wk(We[Pt],q);return Je===-1?void 0:kk(We[Pt],Je,1)[0]}return kg(We[Pt])},t.removeHooks=function(Pt){We[Pt]=[]},t.removeAllHooks=function(){We=Cg()},t}var Lk=C1();/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Uk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),jt=(e,t)=>{const r=D.forwardRef(({color:s="currentColor",size:o=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:u="",children:m,...v},I)=>D.createElement("svg",{ref:I,...Uk,width:o,height:o,stroke:s,strokeWidth:l?Number(a)*24/Number(o):a,className:["lucide",`lucide-${Fk(e)}`,u].join(" "),...v},[...t.map(([$,_])=>D.createElement($,_)),...Array.isArray(m)?m:[m]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=jt("ArrowRightSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"m12 16 4-4-4-4",key:"1i9zcv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=jt("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eg=jt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=jt("Brush",[["path",{d:"m9.06 11.9 8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08",key:"1styjt"}],["path",{d:"M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z",key:"z0l1mu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=jt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=jt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hk=jt("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ll=jt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=jt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vk=jt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=jt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xp=jt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=jt("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=jt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=jt("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=jt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tg=jt("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=jt("CopyPlus",[["line",{x1:"15",x2:"15",y1:"12",y2:"18",key:"1p7wdc"}],["line",{x1:"12",x2:"18",y1:"15",y2:"15",key:"1nscbv"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=jt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E1=jt("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pg=jt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=jt("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gk=jt("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xk=jt("FileSearch",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"1vg67v"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=jt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=jt("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=jt("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=jt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=jt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=jt("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=jt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qk=jt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=jt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=jt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=jt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=jt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=jt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=jt("Mic2",[["path",{d:"m12 8-9.04 9.06a2.82 2.82 0 1 0 3.98 3.98L16 12",key:"zoua8r"}],["circle",{cx:"17",cy:"7",r:"5",key:"1fomce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=jt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=jt("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=jt("PanelsTopLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=jt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=jt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=jt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=jt("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=jt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vi=jt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=jt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=jt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=jt("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=jt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=jt("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=jt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=jt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ml=jt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=jt("Split",[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=jt("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=jt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=jt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=jt("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=jt("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=jt("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=jt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ku=jt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=jt("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=jt("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=jt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=jt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Nu(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var I1={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(s,o,a){function l(v,I){if(!o[v]){if(!s[v]){var $=typeof Nu=="function"&&Nu;if(!I&&$)return $(v,!0);if(u)return u(v,!0);var _=new Error("Cannot find module '"+v+"'");throw _.code="MODULE_NOT_FOUND",_}var b=o[v]={exports:{}};s[v][0].call(b.exports,function(T){var k=s[v][1][T];return l(k||T)},b,b.exports,r,s,o,a)}return o[v].exports}for(var u=typeof Nu=="function"&&Nu,m=0;m<a.length;m++)l(a[m]);return l}({1:[function(r,s,o){var a=r("./utils"),l=r("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(m){for(var v,I,$,_,b,T,k,R=[],x=0,w=m.length,P=w,L=a.getTypeOf(m)!=="string";x<m.length;)P=w-x,$=L?(v=m[x++],I=x<w?m[x++]:0,x<w?m[x++]:0):(v=m.charCodeAt(x++),I=x<w?m.charCodeAt(x++):0,x<w?m.charCodeAt(x++):0),_=v>>2,b=(3&v)<<4|I>>4,T=1<P?(15&I)<<2|$>>6:64,k=2<P?63&$:64,R.push(u.charAt(_)+u.charAt(b)+u.charAt(T)+u.charAt(k));return R.join("")},o.decode=function(m){var v,I,$,_,b,T,k=0,R=0,x="data:";if(m.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var w,P=3*(m=m.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(m.charAt(m.length-1)===u.charAt(64)&&P--,m.charAt(m.length-2)===u.charAt(64)&&P--,P%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=l.uint8array?new Uint8Array(0|P):new Array(0|P);k<m.length;)v=u.indexOf(m.charAt(k++))<<2|(_=u.indexOf(m.charAt(k++)))>>4,I=(15&_)<<4|(b=u.indexOf(m.charAt(k++)))>>2,$=(3&b)<<6|(T=u.indexOf(m.charAt(k++))),w[R++]=v,b!==64&&(w[R++]=I),T!==64&&(w[R++]=$);return w}},{"./support":30,"./utils":32}],2:[function(r,s,o){var a=r("./external"),l=r("./stream/DataWorker"),u=r("./stream/Crc32Probe"),m=r("./stream/DataLengthProbe");function v(I,$,_,b,T){this.compressedSize=I,this.uncompressedSize=$,this.crc32=_,this.compression=b,this.compressedContent=T}v.prototype={getContentWorker:function(){var I=new l(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new m("data_length")),$=this;return I.on("end",function(){if(this.streamInfo.data_length!==$.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),I},getCompressedWorker:function(){return new l(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},v.createWorkerFrom=function(I,$,_){return I.pipe(new u).pipe(new m("uncompressedSize")).pipe($.compressWorker(_)).pipe(new m("compressedSize")).withStreamInfo("compression",$)},s.exports=v},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,s,o){var a=r("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},o.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,s,o){var a=r("./utils"),l=function(){for(var u,m=[],v=0;v<256;v++){u=v;for(var I=0;I<8;I++)u=1&u?3988292384^u>>>1:u>>>1;m[v]=u}return m}();s.exports=function(u,m){return u!==void 0&&u.length?a.getTypeOf(u)!=="string"?function(v,I,$,_){var b=l,T=_+$;v^=-1;for(var k=_;k<T;k++)v=v>>>8^b[255&(v^I[k])];return-1^v}(0|m,u,u.length,0):function(v,I,$,_){var b=l,T=_+$;v^=-1;for(var k=_;k<T;k++)v=v>>>8^b[255&(v^I.charCodeAt(k))];return-1^v}(0|m,u,u.length,0):0}},{"./utils":32}],5:[function(r,s,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(r,s,o){var a=null;a=typeof Promise<"u"?Promise:r("lie"),s.exports={Promise:a}},{lie:37}],7:[function(r,s,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=r("pako"),u=r("./utils"),m=r("./stream/GenericWorker"),v=a?"uint8array":"array";function I($,_){m.call(this,"FlateWorker/"+$),this._pako=null,this._pakoAction=$,this._pakoOptions=_,this.meta={}}o.magic="\b\0",u.inherits(I,m),I.prototype.processChunk=function($){this.meta=$.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(v,$.data),!1)},I.prototype.flush=function(){m.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},I.prototype.cleanUp=function(){m.prototype.cleanUp.call(this),this._pako=null},I.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var $=this;this._pako.onData=function(_){$.push({data:_,meta:$.meta})}},o.compressWorker=function($){return new I("Deflate",$)},o.uncompressWorker=function(){return new I("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,s,o){function a(b,T){var k,R="";for(k=0;k<T;k++)R+=String.fromCharCode(255&b),b>>>=8;return R}function l(b,T,k,R,x,w){var P,L,Y=b.file,oe=b.compression,ie=w!==v.utf8encode,be=u.transformTo("string",w(Y.name)),ye=u.transformTo("string",v.utf8encode(Y.name)),he=Y.comment,We=u.transformTo("string",w(he)),X=u.transformTo("string",v.utf8encode(he)),ke=ye.length!==Y.name.length,M=X.length!==he.length,xe="",lt="",Se="",we=Y.dir,Ne=Y.date,et={crc32:0,compressedSize:0,uncompressedSize:0};T&&!k||(et.crc32=b.crc32,et.compressedSize=b.compressedSize,et.uncompressedSize=b.uncompressedSize);var ee=0;T&&(ee|=8),ie||!ke&&!M||(ee|=2048);var ae=0,Te=0;we&&(ae|=16),x==="UNIX"?(Te=798,ae|=function(Pe,Gt){var an=Pe;return Pe||(an=Gt?16893:33204),(65535&an)<<16}(Y.unixPermissions,we)):(Te=20,ae|=function(Pe){return 63&(Pe||0)}(Y.dosPermissions)),P=Ne.getUTCHours(),P<<=6,P|=Ne.getUTCMinutes(),P<<=5,P|=Ne.getUTCSeconds()/2,L=Ne.getUTCFullYear()-1980,L<<=4,L|=Ne.getUTCMonth()+1,L<<=5,L|=Ne.getUTCDate(),ke&&(lt=a(1,1)+a(I(be),4)+ye,xe+="up"+a(lt.length,2)+lt),M&&(Se=a(1,1)+a(I(We),4)+X,xe+="uc"+a(Se.length,2)+Se);var it="";return it+=`
\0`,it+=a(ee,2),it+=oe.magic,it+=a(P,2),it+=a(L,2),it+=a(et.crc32,4),it+=a(et.compressedSize,4),it+=a(et.uncompressedSize,4),it+=a(be.length,2),it+=a(xe.length,2),{fileRecord:$.LOCAL_FILE_HEADER+it+be+xe,dirRecord:$.CENTRAL_FILE_HEADER+a(Te,2)+it+a(We.length,2)+"\0\0\0\0"+a(ae,4)+a(R,4)+be+xe+We}}var u=r("../utils"),m=r("../stream/GenericWorker"),v=r("../utf8"),I=r("../crc32"),$=r("../signature");function _(b,T,k,R){m.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=T,this.zipPlatform=k,this.encodeFileName=R,this.streamFiles=b,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(_,m),_.prototype.push=function(b){var T=b.meta.percent||0,k=this.entriesCount,R=this._sources.length;this.accumulate?this.contentBuffer.push(b):(this.bytesWritten+=b.data.length,m.prototype.push.call(this,{data:b.data,meta:{currentFile:this.currentFile,percent:k?(T+100*(k-R-1))/k:100}}))},_.prototype.openedSource=function(b){this.currentSourceOffset=this.bytesWritten,this.currentFile=b.file.name;var T=this.streamFiles&&!b.file.dir;if(T){var k=l(b,T,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:k.fileRecord,meta:{percent:0}})}else this.accumulate=!0},_.prototype.closedSource=function(b){this.accumulate=!1;var T=this.streamFiles&&!b.file.dir,k=l(b,T,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(k.dirRecord),T)this.push({data:function(R){return $.DATA_DESCRIPTOR+a(R.crc32,4)+a(R.compressedSize,4)+a(R.uncompressedSize,4)}(b),meta:{percent:100}});else for(this.push({data:k.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},_.prototype.flush=function(){for(var b=this.bytesWritten,T=0;T<this.dirRecords.length;T++)this.push({data:this.dirRecords[T],meta:{percent:100}});var k=this.bytesWritten-b,R=function(x,w,P,L,Y){var oe=u.transformTo("string",Y(L));return $.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(x,2)+a(x,2)+a(w,4)+a(P,4)+a(oe.length,2)+oe}(this.dirRecords.length,k,b,this.zipComment,this.encodeFileName);this.push({data:R,meta:{percent:100}})},_.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},_.prototype.registerPrevious=function(b){this._sources.push(b);var T=this;return b.on("data",function(k){T.processChunk(k)}),b.on("end",function(){T.closedSource(T.previous.streamInfo),T._sources.length?T.prepareNextSource():T.end()}),b.on("error",function(k){T.error(k)}),this},_.prototype.resume=function(){return!!m.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},_.prototype.error=function(b){var T=this._sources;if(!m.prototype.error.call(this,b))return!1;for(var k=0;k<T.length;k++)try{T[k].error(b)}catch{}return!0},_.prototype.lock=function(){m.prototype.lock.call(this);for(var b=this._sources,T=0;T<b.length;T++)b[T].lock()},s.exports=_},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,s,o){var a=r("../compressions"),l=r("./ZipFileWorker");o.generateWorker=function(u,m,v){var I=new l(m.streamFiles,v,m.platform,m.encodeFileName),$=0;try{u.forEach(function(_,b){$++;var T=function(w,P){var L=w||P,Y=a[L];if(!Y)throw new Error(L+" is not a valid compression method !");return Y}(b.options.compression,m.compression),k=b.options.compressionOptions||m.compressionOptions||{},R=b.dir,x=b.date;b._compressWorker(T,k).withStreamInfo("file",{name:_,dir:R,date:x,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(I)}),I.entriesCount=$}catch(_){I.error(_)}return I}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,s,o){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new a;for(var u in this)typeof this[u]!="function"&&(l[u]=this[u]);return l}}(a.prototype=r("./object")).loadAsync=r("./load"),a.support=r("./support"),a.defaults=r("./defaults"),a.version="3.10.1",a.loadAsync=function(l,u){return new a().loadAsync(l,u)},a.external=r("./external"),s.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,s,o){var a=r("./utils"),l=r("./external"),u=r("./utf8"),m=r("./zipEntries"),v=r("./stream/Crc32Probe"),I=r("./nodejsUtils");function $(_){return new l.Promise(function(b,T){var k=_.decompressed.getContentWorker().pipe(new v);k.on("error",function(R){T(R)}).on("end",function(){k.streamInfo.crc32!==_.decompressed.crc32?T(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}s.exports=function(_,b){var T=this;return b=a.extend(b||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),I.isNode&&I.isStream(_)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",_,!0,b.optimizedBinaryString,b.base64).then(function(k){var R=new m(b);return R.load(k),R}).then(function(k){var R=[l.Promise.resolve(k)],x=k.files;if(b.checkCRC32)for(var w=0;w<x.length;w++)R.push($(x[w]));return l.Promise.all(R)}).then(function(k){for(var R=k.shift(),x=R.files,w=0;w<x.length;w++){var P=x[w],L=P.fileNameStr,Y=a.resolve(P.fileNameStr);T.file(Y,P.decompressed,{binary:!0,optimizedBinaryString:!0,date:P.date,dir:P.dir,comment:P.fileCommentStr.length?P.fileCommentStr:null,unixPermissions:P.unixPermissions,dosPermissions:P.dosPermissions,createFolders:b.createFolders}),P.dir||(T.file(Y).unsafeOriginalName=L)}return R.zipComment.length&&(T.comment=R.zipComment),T})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,s,o){var a=r("../utils"),l=r("../stream/GenericWorker");function u(m,v){l.call(this,"Nodejs stream input adapter for "+m),this._upstreamEnded=!1,this._bindStream(v)}a.inherits(u,l),u.prototype._bindStream=function(m){var v=this;(this._stream=m).pause(),m.on("data",function(I){v.push({data:I,meta:{percent:0}})}).on("error",function(I){v.isPaused?this.generatedError=I:v.error(I)}).on("end",function(){v.isPaused?v._upstreamEnded=!0:v.end()})},u.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,s,o){var a=r("readable-stream").Readable;function l(u,m,v){a.call(this,m),this._helper=u;var I=this;u.on("data",function($,_){I.push($)||I._helper.pause(),v&&v(_)}).on("error",function($){I.emit("error",$)}).on("end",function(){I.push(null)})}r("../utils").inherits(l,a),l.prototype._read=function(){this._helper.resume()},s.exports=l},{"../utils":32,"readable-stream":16}],14:[function(r,s,o){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,l);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,l)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var l=new Buffer(a);return l.fill(0),l},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(r,s,o){function a(Y,oe,ie){var be,ye=u.getTypeOf(oe),he=u.extend(ie||{},I);he.date=he.date||new Date,he.compression!==null&&(he.compression=he.compression.toUpperCase()),typeof he.unixPermissions=="string"&&(he.unixPermissions=parseInt(he.unixPermissions,8)),he.unixPermissions&&16384&he.unixPermissions&&(he.dir=!0),he.dosPermissions&&16&he.dosPermissions&&(he.dir=!0),he.dir&&(Y=x(Y)),he.createFolders&&(be=R(Y))&&w.call(this,be,!0);var We=ye==="string"&&he.binary===!1&&he.base64===!1;ie&&ie.binary!==void 0||(he.binary=!We),(oe instanceof $&&oe.uncompressedSize===0||he.dir||!oe||oe.length===0)&&(he.base64=!1,he.binary=!0,oe="",he.compression="STORE",ye="string");var X=null;X=oe instanceof $||oe instanceof m?oe:T.isNode&&T.isStream(oe)?new k(Y,oe):u.prepareContent(Y,oe,he.binary,he.optimizedBinaryString,he.base64);var ke=new _(Y,X,he);this.files[Y]=ke}var l=r("./utf8"),u=r("./utils"),m=r("./stream/GenericWorker"),v=r("./stream/StreamHelper"),I=r("./defaults"),$=r("./compressedObject"),_=r("./zipObject"),b=r("./generate"),T=r("./nodejsUtils"),k=r("./nodejs/NodejsStreamInputAdapter"),R=function(Y){Y.slice(-1)==="/"&&(Y=Y.substring(0,Y.length-1));var oe=Y.lastIndexOf("/");return 0<oe?Y.substring(0,oe):""},x=function(Y){return Y.slice(-1)!=="/"&&(Y+="/"),Y},w=function(Y,oe){return oe=oe!==void 0?oe:I.createFolders,Y=x(Y),this.files[Y]||a.call(this,Y,null,{dir:!0,createFolders:oe}),this.files[Y]};function P(Y){return Object.prototype.toString.call(Y)==="[object RegExp]"}var L={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Y){var oe,ie,be;for(oe in this.files)be=this.files[oe],(ie=oe.slice(this.root.length,oe.length))&&oe.slice(0,this.root.length)===this.root&&Y(ie,be)},filter:function(Y){var oe=[];return this.forEach(function(ie,be){Y(ie,be)&&oe.push(be)}),oe},file:function(Y,oe,ie){if(arguments.length!==1)return Y=this.root+Y,a.call(this,Y,oe,ie),this;if(P(Y)){var be=Y;return this.filter(function(he,We){return!We.dir&&be.test(he)})}var ye=this.files[this.root+Y];return ye&&!ye.dir?ye:null},folder:function(Y){if(!Y)return this;if(P(Y))return this.filter(function(ye,he){return he.dir&&Y.test(ye)});var oe=this.root+Y,ie=w.call(this,oe),be=this.clone();return be.root=ie.name,be},remove:function(Y){Y=this.root+Y;var oe=this.files[Y];if(oe||(Y.slice(-1)!=="/"&&(Y+="/"),oe=this.files[Y]),oe&&!oe.dir)delete this.files[Y];else for(var ie=this.filter(function(ye,he){return he.name.slice(0,Y.length)===Y}),be=0;be<ie.length;be++)delete this.files[ie[be].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Y){var oe,ie={};try{if((ie=u.extend(Y||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=ie.type.toLowerCase(),ie.compression=ie.compression.toUpperCase(),ie.type==="binarystring"&&(ie.type="string"),!ie.type)throw new Error("No output type specified.");u.checkSupport(ie.type),ie.platform!=="darwin"&&ie.platform!=="freebsd"&&ie.platform!=="linux"&&ie.platform!=="sunos"||(ie.platform="UNIX"),ie.platform==="win32"&&(ie.platform="DOS");var be=ie.comment||this.comment||"";oe=b.generateWorker(this,ie,be)}catch(ye){(oe=new m("error")).error(ye)}return new v(oe,ie.type||"string",ie.mimeType)},generateAsync:function(Y,oe){return this.generateInternalStream(Y).accumulate(oe)},generateNodeStream:function(Y,oe){return(Y=Y||{}).type||(Y.type="nodebuffer"),this.generateInternalStream(Y).toNodejsStream(oe)}};s.exports=L},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,s,o){s.exports=r("stream")},{stream:void 0}],17:[function(r,s,o){var a=r("./DataReader");function l(u){a.call(this,u);for(var m=0;m<this.data.length;m++)u[m]=255&u[m]}r("../utils").inherits(l,a),l.prototype.byteAt=function(u){return this.data[this.zero+u]},l.prototype.lastIndexOfSignature=function(u){for(var m=u.charCodeAt(0),v=u.charCodeAt(1),I=u.charCodeAt(2),$=u.charCodeAt(3),_=this.length-4;0<=_;--_)if(this.data[_]===m&&this.data[_+1]===v&&this.data[_+2]===I&&this.data[_+3]===$)return _-this.zero;return-1},l.prototype.readAndCheckSignature=function(u){var m=u.charCodeAt(0),v=u.charCodeAt(1),I=u.charCodeAt(2),$=u.charCodeAt(3),_=this.readData(4);return m===_[0]&&v===_[1]&&I===_[2]&&$===_[3]},l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var m=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,m},s.exports=l},{"../utils":32,"./DataReader":18}],18:[function(r,s,o){var a=r("../utils");function l(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var m,v=0;for(this.checkOffset(u),m=this.index+u-1;m>=this.index;m--)v=(v<<8)+this.byteAt(m);return this.index+=u,v},readString:function(u){return a.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},s.exports=l},{"../utils":32}],19:[function(r,s,o){var a=r("./Uint8ArrayReader");function l(u){a.call(this,u)}r("../utils").inherits(l,a),l.prototype.readData=function(u){this.checkOffset(u);var m=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,m},s.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,s,o){var a=r("./DataReader");function l(u){a.call(this,u)}r("../utils").inherits(l,a),l.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},l.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},l.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},l.prototype.readData=function(u){this.checkOffset(u);var m=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,m},s.exports=l},{"../utils":32,"./DataReader":18}],21:[function(r,s,o){var a=r("./ArrayReader");function l(u){a.call(this,u)}r("../utils").inherits(l,a),l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var m=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,m},s.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(r,s,o){var a=r("../utils"),l=r("../support"),u=r("./ArrayReader"),m=r("./StringReader"),v=r("./NodeBufferReader"),I=r("./Uint8ArrayReader");s.exports=function($){var _=a.getTypeOf($);return a.checkSupport(_),_!=="string"||l.uint8array?_==="nodebuffer"?new v($):l.uint8array?new I(a.transformTo("uint8array",$)):new u(a.transformTo("array",$)):new m($)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,s,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,s,o){var a=r("./GenericWorker"),l=r("../utils");function u(m){a.call(this,"ConvertWorker to "+m),this.destType=m}l.inherits(u,a),u.prototype.processChunk=function(m){this.push({data:l.transformTo(this.destType,m.data),meta:m.meta})},s.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(r,s,o){var a=r("./GenericWorker"),l=r("../crc32");function u(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(u,a),u.prototype.processChunk=function(m){this.streamInfo.crc32=l(m.data,this.streamInfo.crc32||0),this.push(m)},s.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,s,o){var a=r("../utils"),l=r("./GenericWorker");function u(m){l.call(this,"DataLengthProbe for "+m),this.propName=m,this.withStreamInfo(m,0)}a.inherits(u,l),u.prototype.processChunk=function(m){if(m){var v=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=v+m.data.length}l.prototype.processChunk.call(this,m)},s.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(r,s,o){var a=r("../utils"),l=r("./GenericWorker");function u(m){l.call(this,"DataWorker");var v=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,m.then(function(I){v.dataIsReady=!0,v.data=I,v.max=I&&I.length||0,v.type=a.getTypeOf(I),v.isPaused||v._tickAndRepeat()},function(I){v.error(I)})}a.inherits(u,l),u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var m=null,v=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":m=this.data.substring(this.index,v);break;case"uint8array":m=this.data.subarray(this.index,v);break;case"array":case"nodebuffer":m=this.data.slice(this.index,v)}return this.index=v,this.push({data:m,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(r,s,o){function a(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,u){return this._listeners[l].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,u){if(this._listeners[l])for(var m=0;m<this._listeners[l].length;m++)this._listeners[l][m].call(this,u)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var u=this;return l.on("data",function(m){u.processChunk(m)}),l.on("end",function(){u.end()}),l.on("error",function(m){u.error(m)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,u){return this.extraStreamInfo[l]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},s.exports=a},{}],29:[function(r,s,o){var a=r("../utils"),l=r("./ConvertWorker"),u=r("./GenericWorker"),m=r("../base64"),v=r("../support"),I=r("../external"),$=null;if(v.nodestream)try{$=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function _(T,k){return new I.Promise(function(R,x){var w=[],P=T._internalType,L=T._outputType,Y=T._mimeType;T.on("data",function(oe,ie){w.push(oe),k&&k(ie)}).on("error",function(oe){w=[],x(oe)}).on("end",function(){try{var oe=function(ie,be,ye){switch(ie){case"blob":return a.newBlob(a.transformTo("arraybuffer",be),ye);case"base64":return m.encode(be);default:return a.transformTo(ie,be)}}(L,function(ie,be){var ye,he=0,We=null,X=0;for(ye=0;ye<be.length;ye++)X+=be[ye].length;switch(ie){case"string":return be.join("");case"array":return Array.prototype.concat.apply([],be);case"uint8array":for(We=new Uint8Array(X),ye=0;ye<be.length;ye++)We.set(be[ye],he),he+=be[ye].length;return We;case"nodebuffer":return Buffer.concat(be);default:throw new Error("concat : unsupported type '"+ie+"'")}}(P,w),Y);R(oe)}catch(ie){x(ie)}w=[]}).resume()})}function b(T,k,R){var x=k;switch(k){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=k,this._mimeType=R,a.checkSupport(x),this._worker=T.pipe(new l(x)),T.lock()}catch(w){this._worker=new u("error"),this._worker.error(w)}}b.prototype={accumulate:function(T){return _(this,T)},on:function(T,k){var R=this;return T==="data"?this._worker.on(T,function(x){k.call(R,x.data,x.meta)}):this._worker.on(T,function(){a.delay(k,arguments,R)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(T){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new $(this,{objectMode:this._outputType!=="nodebuffer"},T)}},s.exports=b},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,s,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var a=new ArrayBuffer(0);try{o.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(a),o.blob=l.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!r("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(r,s,o){for(var a=r("./utils"),l=r("./support"),u=r("./nodejsUtils"),m=r("./stream/GenericWorker"),v=new Array(256),I=0;I<256;I++)v[I]=252<=I?6:248<=I?5:240<=I?4:224<=I?3:192<=I?2:1;v[254]=v[254]=1;function $(){m.call(this,"utf-8 decode"),this.leftOver=null}function _(){m.call(this,"utf-8 encode")}o.utf8encode=function(b){return l.nodebuffer?u.newBufferFrom(b,"utf-8"):function(T){var k,R,x,w,P,L=T.length,Y=0;for(w=0;w<L;w++)(64512&(R=T.charCodeAt(w)))==55296&&w+1<L&&(64512&(x=T.charCodeAt(w+1)))==56320&&(R=65536+(R-55296<<10)+(x-56320),w++),Y+=R<128?1:R<2048?2:R<65536?3:4;for(k=l.uint8array?new Uint8Array(Y):new Array(Y),w=P=0;P<Y;w++)(64512&(R=T.charCodeAt(w)))==55296&&w+1<L&&(64512&(x=T.charCodeAt(w+1)))==56320&&(R=65536+(R-55296<<10)+(x-56320),w++),R<128?k[P++]=R:(R<2048?k[P++]=192|R>>>6:(R<65536?k[P++]=224|R>>>12:(k[P++]=240|R>>>18,k[P++]=128|R>>>12&63),k[P++]=128|R>>>6&63),k[P++]=128|63&R);return k}(b)},o.utf8decode=function(b){return l.nodebuffer?a.transformTo("nodebuffer",b).toString("utf-8"):function(T){var k,R,x,w,P=T.length,L=new Array(2*P);for(k=R=0;k<P;)if((x=T[k++])<128)L[R++]=x;else if(4<(w=v[x]))L[R++]=65533,k+=w-1;else{for(x&=w===2?31:w===3?15:7;1<w&&k<P;)x=x<<6|63&T[k++],w--;1<w?L[R++]=65533:x<65536?L[R++]=x:(x-=65536,L[R++]=55296|x>>10&1023,L[R++]=56320|1023&x)}return L.length!==R&&(L.subarray?L=L.subarray(0,R):L.length=R),a.applyFromCharCode(L)}(b=a.transformTo(l.uint8array?"uint8array":"array",b))},a.inherits($,m),$.prototype.processChunk=function(b){var T=a.transformTo(l.uint8array?"uint8array":"array",b.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var k=T;(T=new Uint8Array(k.length+this.leftOver.length)).set(this.leftOver,0),T.set(k,this.leftOver.length)}else T=this.leftOver.concat(T);this.leftOver=null}var R=function(w,P){var L;for((P=P||w.length)>w.length&&(P=w.length),L=P-1;0<=L&&(192&w[L])==128;)L--;return L<0||L===0?P:L+v[w[L]]>P?L:P}(T),x=T;R!==T.length&&(l.uint8array?(x=T.subarray(0,R),this.leftOver=T.subarray(R,T.length)):(x=T.slice(0,R),this.leftOver=T.slice(R,T.length))),this.push({data:o.utf8decode(x),meta:b.meta})},$.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=$,a.inherits(_,m),_.prototype.processChunk=function(b){this.push({data:o.utf8encode(b.data),meta:b.meta})},o.Utf8EncodeWorker=_},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,s,o){var a=r("./support"),l=r("./base64"),u=r("./nodejsUtils"),m=r("./external");function v(k){return k}function I(k,R){for(var x=0;x<k.length;++x)R[x]=255&k.charCodeAt(x);return R}r("setimmediate"),o.newBlob=function(k,R){o.checkSupport("blob");try{return new Blob([k],{type:R})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(k),x.getBlob(R)}catch{throw new Error("Bug : can't construct the Blob.")}}};var $={stringifyByChunk:function(k,R,x){var w=[],P=0,L=k.length;if(L<=x)return String.fromCharCode.apply(null,k);for(;P<L;)R==="array"||R==="nodebuffer"?w.push(String.fromCharCode.apply(null,k.slice(P,Math.min(P+x,L)))):w.push(String.fromCharCode.apply(null,k.subarray(P,Math.min(P+x,L)))),P+=x;return w.join("")},stringifyByChar:function(k){for(var R="",x=0;x<k.length;x++)R+=String.fromCharCode(k[x]);return R},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}}()}};function _(k){var R=65536,x=o.getTypeOf(k),w=!0;if(x==="uint8array"?w=$.applyCanBeUsed.uint8array:x==="nodebuffer"&&(w=$.applyCanBeUsed.nodebuffer),w)for(;1<R;)try{return $.stringifyByChunk(k,x,R)}catch{R=Math.floor(R/2)}return $.stringifyByChar(k)}function b(k,R){for(var x=0;x<k.length;x++)R[x]=k[x];return R}o.applyFromCharCode=_;var T={};T.string={string:v,array:function(k){return I(k,new Array(k.length))},arraybuffer:function(k){return T.string.uint8array(k).buffer},uint8array:function(k){return I(k,new Uint8Array(k.length))},nodebuffer:function(k){return I(k,u.allocBuffer(k.length))}},T.array={string:_,array:v,arraybuffer:function(k){return new Uint8Array(k).buffer},uint8array:function(k){return new Uint8Array(k)},nodebuffer:function(k){return u.newBufferFrom(k)}},T.arraybuffer={string:function(k){return _(new Uint8Array(k))},array:function(k){return b(new Uint8Array(k),new Array(k.byteLength))},arraybuffer:v,uint8array:function(k){return new Uint8Array(k)},nodebuffer:function(k){return u.newBufferFrom(new Uint8Array(k))}},T.uint8array={string:_,array:function(k){return b(k,new Array(k.length))},arraybuffer:function(k){return k.buffer},uint8array:v,nodebuffer:function(k){return u.newBufferFrom(k)}},T.nodebuffer={string:_,array:function(k){return b(k,new Array(k.length))},arraybuffer:function(k){return T.nodebuffer.uint8array(k).buffer},uint8array:function(k){return b(k,new Uint8Array(k.length))},nodebuffer:v},o.transformTo=function(k,R){if(R=R||"",!k)return R;o.checkSupport(k);var x=o.getTypeOf(R);return T[x][k](R)},o.resolve=function(k){for(var R=k.split("/"),x=[],w=0;w<R.length;w++){var P=R[w];P==="."||P===""&&w!==0&&w!==R.length-1||(P===".."?x.pop():x.push(P))}return x.join("/")},o.getTypeOf=function(k){return typeof k=="string"?"string":Object.prototype.toString.call(k)==="[object Array]"?"array":a.nodebuffer&&u.isBuffer(k)?"nodebuffer":a.uint8array&&k instanceof Uint8Array?"uint8array":a.arraybuffer&&k instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(k){if(!a[k.toLowerCase()])throw new Error(k+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(k){var R,x,w="";for(x=0;x<(k||"").length;x++)w+="\\x"+((R=k.charCodeAt(x))<16?"0":"")+R.toString(16).toUpperCase();return w},o.delay=function(k,R,x){setImmediate(function(){k.apply(x||null,R||[])})},o.inherits=function(k,R){function x(){}x.prototype=R.prototype,k.prototype=new x},o.extend=function(){var k,R,x={};for(k=0;k<arguments.length;k++)for(R in arguments[k])Object.prototype.hasOwnProperty.call(arguments[k],R)&&x[R]===void 0&&(x[R]=arguments[k][R]);return x},o.prepareContent=function(k,R,x,w,P){return m.Promise.resolve(R).then(function(L){return a.blob&&(L instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(L))!==-1)&&typeof FileReader<"u"?new m.Promise(function(Y,oe){var ie=new FileReader;ie.onload=function(be){Y(be.target.result)},ie.onerror=function(be){oe(be.target.error)},ie.readAsArrayBuffer(L)}):L}).then(function(L){var Y=o.getTypeOf(L);return Y?(Y==="arraybuffer"?L=o.transformTo("uint8array",L):Y==="string"&&(P?L=l.decode(L):x&&w!==!0&&(L=function(oe){return I(oe,a.uint8array?new Uint8Array(oe.length):new Array(oe.length))}(L))),L):m.Promise.reject(new Error("Can't read the data of '"+k+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,s,o){var a=r("./reader/readerFor"),l=r("./utils"),u=r("./signature"),m=r("./zipEntry"),v=r("./support");function I($){this.files=[],this.loadOptions=$}I.prototype={checkSignature:function($){if(!this.reader.readAndCheckSignature($)){this.reader.index-=4;var _=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(_)+", expected "+l.pretty($)+")")}},isSignature:function($,_){var b=this.reader.index;this.reader.setIndex($);var T=this.reader.readString(4)===_;return this.reader.setIndex(b),T},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var $=this.reader.readData(this.zipCommentLength),_=v.uint8array?"uint8array":"array",b=l.transformTo(_,$);this.zipComment=this.loadOptions.decodeFileName(b)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var $,_,b,T=this.zip64EndOfCentralSize-44;0<T;)$=this.reader.readInt(2),_=this.reader.readInt(4),b=this.reader.readData(_),this.zip64ExtensibleData[$]={id:$,length:_,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var $,_;for($=0;$<this.files.length;$++)_=this.files[$],this.reader.setIndex(_.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),_.readLocalPart(this.reader),_.handleUTF8(),_.processAttributes()},readCentralDir:function(){var $;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)($=new m({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push($);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var $=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if($<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex($);var _=$;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,($=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex($),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var b=this.centralDirOffset+this.centralDirSize;this.zip64&&(b+=20,b+=12+this.zip64EndOfCentralSize);var T=_-b;if(0<T)this.isSignature(_,u.CENTRAL_FILE_HEADER)||(this.reader.zero=T);else if(T<0)throw new Error("Corrupted zip: missing "+Math.abs(T)+" bytes.")},prepareReader:function($){this.reader=a($)},load:function($){this.prepareReader($),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=I},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,s,o){var a=r("./reader/readerFor"),l=r("./utils"),u=r("./compressedObject"),m=r("./crc32"),v=r("./utf8"),I=r("./compressions"),$=r("./support");function _(b,T){this.options=b,this.loadOptions=T}_.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(b){var T,k;if(b.skip(22),this.fileNameLength=b.readInt(2),k=b.readInt(2),this.fileName=b.readData(this.fileNameLength),b.skip(k),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((T=function(R){for(var x in I)if(Object.prototype.hasOwnProperty.call(I,x)&&I[x].magic===R)return I[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,T,b.readData(this.compressedSize))},readCentralPart:function(b){this.versionMadeBy=b.readInt(2),b.skip(2),this.bitFlag=b.readInt(2),this.compressionMethod=b.readString(2),this.date=b.readDate(),this.crc32=b.readInt(4),this.compressedSize=b.readInt(4),this.uncompressedSize=b.readInt(4);var T=b.readInt(2);if(this.extraFieldsLength=b.readInt(2),this.fileCommentLength=b.readInt(2),this.diskNumberStart=b.readInt(2),this.internalFileAttributes=b.readInt(2),this.externalFileAttributes=b.readInt(4),this.localHeaderOffset=b.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");b.skip(T),this.readExtraFields(b),this.parseZIP64ExtraField(b),this.fileComment=b.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var b=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),b==0&&(this.dosPermissions=63&this.externalFileAttributes),b==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var b=a(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=b.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=b.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=b.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=b.readInt(4))}},readExtraFields:function(b){var T,k,R,x=b.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});b.index+4<x;)T=b.readInt(2),k=b.readInt(2),R=b.readData(k),this.extraFields[T]={id:T,length:k,value:R};b.setIndex(x)},handleUTF8:function(){var b=$.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=v.utf8decode(this.fileName),this.fileCommentStr=v.utf8decode(this.fileComment);else{var T=this.findExtraFieldUnicodePath();if(T!==null)this.fileNameStr=T;else{var k=l.transformTo(b,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(k)}var R=this.findExtraFieldUnicodeComment();if(R!==null)this.fileCommentStr=R;else{var x=l.transformTo(b,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var b=this.extraFields[28789];if(b){var T=a(b.value);return T.readInt(1)!==1||m(this.fileName)!==T.readInt(4)?null:v.utf8decode(T.readData(b.length-5))}return null},findExtraFieldUnicodeComment:function(){var b=this.extraFields[25461];if(b){var T=a(b.value);return T.readInt(1)!==1||m(this.fileComment)!==T.readInt(4)?null:v.utf8decode(T.readData(b.length-5))}return null}},s.exports=_},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,s,o){function a(T,k,R){this.name=T,this.dir=R.dir,this.date=R.date,this.comment=R.comment,this.unixPermissions=R.unixPermissions,this.dosPermissions=R.dosPermissions,this._data=k,this._dataBinary=R.binary,this.options={compression:R.compression,compressionOptions:R.compressionOptions}}var l=r("./stream/StreamHelper"),u=r("./stream/DataWorker"),m=r("./utf8"),v=r("./compressedObject"),I=r("./stream/GenericWorker");a.prototype={internalStream:function(T){var k=null,R="string";try{if(!T)throw new Error("No output type specified.");var x=(R=T.toLowerCase())==="string"||R==="text";R!=="binarystring"&&R!=="text"||(R="string"),k=this._decompressWorker();var w=!this._dataBinary;w&&!x&&(k=k.pipe(new m.Utf8EncodeWorker)),!w&&x&&(k=k.pipe(new m.Utf8DecodeWorker))}catch(P){(k=new I("error")).error(P)}return new l(k,R,"")},async:function(T,k){return this.internalStream(T).accumulate(k)},nodeStream:function(T,k){return this.internalStream(T||"nodebuffer").toNodejsStream(k)},_compressWorker:function(T,k){if(this._data instanceof v&&this._data.compression.magic===T.magic)return this._data.getCompressedWorker();var R=this._decompressWorker();return this._dataBinary||(R=R.pipe(new m.Utf8EncodeWorker)),v.createWorkerFrom(R,T,k)},_decompressWorker:function(){return this._data instanceof v?this._data.getContentWorker():this._data instanceof I?this._data:new u(this._data)}};for(var $=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],_=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},b=0;b<$.length;b++)a.prototype[$[b]]=_;s.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,s,o){(function(a){var l,u,m=a.MutationObserver||a.WebKitMutationObserver;if(m){var v=0,I=new m(T),$=a.document.createTextNode("");I.observe($,{characterData:!0}),l=function(){$.data=v=++v%2}}else if(a.setImmediate||a.MessageChannel===void 0)l="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var k=a.document.createElement("script");k.onreadystatechange=function(){T(),k.onreadystatechange=null,k.parentNode.removeChild(k),k=null},a.document.documentElement.appendChild(k)}:function(){setTimeout(T,0)};else{var _=new a.MessageChannel;_.port1.onmessage=T,l=function(){_.port2.postMessage(0)}}var b=[];function T(){var k,R;u=!0;for(var x=b.length;x;){for(R=b,b=[],k=-1;++k<x;)R[k]();x=b.length}u=!1}s.exports=function(k){b.push(k)!==1||u||l()}}).call(this,typeof xi<"u"?xi:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,s,o){var a=r("immediate");function l(){}var u={},m=["REJECTED"],v=["FULFILLED"],I=["PENDING"];function $(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,x!==l&&k(this,x)}function _(x,w,P){this.promise=x,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof P=="function"&&(this.onRejected=P,this.callRejected=this.otherCallRejected)}function b(x,w,P){a(function(){var L;try{L=w(P)}catch(Y){return u.reject(x,Y)}L===x?u.reject(x,new TypeError("Cannot resolve promise with itself")):u.resolve(x,L)})}function T(x){var w=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof w=="function")return function(){w.apply(x,arguments)}}function k(x,w){var P=!1;function L(ie){P||(P=!0,u.reject(x,ie))}function Y(ie){P||(P=!0,u.resolve(x,ie))}var oe=R(function(){w(Y,L)});oe.status==="error"&&L(oe.value)}function R(x,w){var P={};try{P.value=x(w),P.status="success"}catch(L){P.status="error",P.value=L}return P}(s.exports=$).prototype.finally=function(x){if(typeof x!="function")return this;var w=this.constructor;return this.then(function(P){return w.resolve(x()).then(function(){return P})},function(P){return w.resolve(x()).then(function(){throw P})})},$.prototype.catch=function(x){return this.then(null,x)},$.prototype.then=function(x,w){if(typeof x!="function"&&this.state===v||typeof w!="function"&&this.state===m)return this;var P=new this.constructor(l);return this.state!==I?b(P,this.state===v?x:w,this.outcome):this.queue.push(new _(P,x,w)),P},_.prototype.callFulfilled=function(x){u.resolve(this.promise,x)},_.prototype.otherCallFulfilled=function(x){b(this.promise,this.onFulfilled,x)},_.prototype.callRejected=function(x){u.reject(this.promise,x)},_.prototype.otherCallRejected=function(x){b(this.promise,this.onRejected,x)},u.resolve=function(x,w){var P=R(T,w);if(P.status==="error")return u.reject(x,P.value);var L=P.value;if(L)k(x,L);else{x.state=v,x.outcome=w;for(var Y=-1,oe=x.queue.length;++Y<oe;)x.queue[Y].callFulfilled(w)}return x},u.reject=function(x,w){x.state=m,x.outcome=w;for(var P=-1,L=x.queue.length;++P<L;)x.queue[P].callRejected(w);return x},$.resolve=function(x){return x instanceof this?x:u.resolve(new this(l),x)},$.reject=function(x){var w=new this(l);return u.reject(w,x)},$.all=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=x.length,L=!1;if(!P)return this.resolve([]);for(var Y=new Array(P),oe=0,ie=-1,be=new this(l);++ie<P;)ye(x[ie],ie);return be;function ye(he,We){w.resolve(he).then(function(X){Y[We]=X,++oe!==P||L||(L=!0,u.resolve(be,Y))},function(X){L||(L=!0,u.reject(be,X))})}},$.race=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=x.length,L=!1;if(!P)return this.resolve([]);for(var Y=-1,oe=new this(l);++Y<P;)ie=x[Y],w.resolve(ie).then(function(be){L||(L=!0,u.resolve(oe,be))},function(be){L||(L=!0,u.reject(oe,be))});var ie;return oe}},{immediate:36}],38:[function(r,s,o){var a={};(0,r("./lib/utils/common").assign)(a,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),s.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,s,o){var a=r("./zlib/deflate"),l=r("./utils/common"),u=r("./utils/strings"),m=r("./zlib/messages"),v=r("./zlib/zstream"),I=Object.prototype.toString,$=0,_=-1,b=0,T=8;function k(x){if(!(this instanceof k))return new k(x);this.options=l.assign({level:_,method:T,chunkSize:16384,windowBits:15,memLevel:8,strategy:b,to:""},x||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var P=a.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(P!==$)throw new Error(m[P]);if(w.header&&a.deflateSetHeader(this.strm,w.header),w.dictionary){var L;if(L=typeof w.dictionary=="string"?u.string2buf(w.dictionary):I.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(P=a.deflateSetDictionary(this.strm,L))!==$)throw new Error(m[P]);this._dict_set=!0}}function R(x,w){var P=new k(w);if(P.push(x,!0),P.err)throw P.msg||m[P.err];return P.result}k.prototype.push=function(x,w){var P,L,Y=this.strm,oe=this.options.chunkSize;if(this.ended)return!1;L=w===~~w?w:w===!0?4:0,typeof x=="string"?Y.input=u.string2buf(x):I.call(x)==="[object ArrayBuffer]"?Y.input=new Uint8Array(x):Y.input=x,Y.next_in=0,Y.avail_in=Y.input.length;do{if(Y.avail_out===0&&(Y.output=new l.Buf8(oe),Y.next_out=0,Y.avail_out=oe),(P=a.deflate(Y,L))!==1&&P!==$)return this.onEnd(P),!(this.ended=!0);Y.avail_out!==0&&(Y.avail_in!==0||L!==4&&L!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(l.shrinkBuf(Y.output,Y.next_out))):this.onData(l.shrinkBuf(Y.output,Y.next_out)))}while((0<Y.avail_in||Y.avail_out===0)&&P!==1);return L===4?(P=a.deflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===$):L!==2||(this.onEnd($),!(Y.avail_out=0))},k.prototype.onData=function(x){this.chunks.push(x)},k.prototype.onEnd=function(x){x===$&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},o.Deflate=k,o.deflate=R,o.deflateRaw=function(x,w){return(w=w||{}).raw=!0,R(x,w)},o.gzip=function(x,w){return(w=w||{}).gzip=!0,R(x,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,s,o){var a=r("./zlib/inflate"),l=r("./utils/common"),u=r("./utils/strings"),m=r("./zlib/constants"),v=r("./zlib/messages"),I=r("./zlib/zstream"),$=r("./zlib/gzheader"),_=Object.prototype.toString;function b(k){if(!(this instanceof b))return new b(k);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},k||{});var R=this.options;R.raw&&0<=R.windowBits&&R.windowBits<16&&(R.windowBits=-R.windowBits,R.windowBits===0&&(R.windowBits=-15)),!(0<=R.windowBits&&R.windowBits<16)||k&&k.windowBits||(R.windowBits+=32),15<R.windowBits&&R.windowBits<48&&!(15&R.windowBits)&&(R.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var x=a.inflateInit2(this.strm,R.windowBits);if(x!==m.Z_OK)throw new Error(v[x]);this.header=new $,a.inflateGetHeader(this.strm,this.header)}function T(k,R){var x=new b(R);if(x.push(k,!0),x.err)throw x.msg||v[x.err];return x.result}b.prototype.push=function(k,R){var x,w,P,L,Y,oe,ie=this.strm,be=this.options.chunkSize,ye=this.options.dictionary,he=!1;if(this.ended)return!1;w=R===~~R?R:R===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof k=="string"?ie.input=u.binstring2buf(k):_.call(k)==="[object ArrayBuffer]"?ie.input=new Uint8Array(k):ie.input=k,ie.next_in=0,ie.avail_in=ie.input.length;do{if(ie.avail_out===0&&(ie.output=new l.Buf8(be),ie.next_out=0,ie.avail_out=be),(x=a.inflate(ie,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&ye&&(oe=typeof ye=="string"?u.string2buf(ye):_.call(ye)==="[object ArrayBuffer]"?new Uint8Array(ye):ye,x=a.inflateSetDictionary(this.strm,oe)),x===m.Z_BUF_ERROR&&he===!0&&(x=m.Z_OK,he=!1),x!==m.Z_STREAM_END&&x!==m.Z_OK)return this.onEnd(x),!(this.ended=!0);ie.next_out&&(ie.avail_out!==0&&x!==m.Z_STREAM_END&&(ie.avail_in!==0||w!==m.Z_FINISH&&w!==m.Z_SYNC_FLUSH)||(this.options.to==="string"?(P=u.utf8border(ie.output,ie.next_out),L=ie.next_out-P,Y=u.buf2string(ie.output,P),ie.next_out=L,ie.avail_out=be-L,L&&l.arraySet(ie.output,ie.output,P,L,0),this.onData(Y)):this.onData(l.shrinkBuf(ie.output,ie.next_out)))),ie.avail_in===0&&ie.avail_out===0&&(he=!0)}while((0<ie.avail_in||ie.avail_out===0)&&x!==m.Z_STREAM_END);return x===m.Z_STREAM_END&&(w=m.Z_FINISH),w===m.Z_FINISH?(x=a.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===m.Z_OK):w!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(ie.avail_out=0))},b.prototype.onData=function(k){this.chunks.push(k)},b.prototype.onEnd=function(k){k===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg},o.Inflate=b,o.inflate=T,o.inflateRaw=function(k,R){return(R=R||{}).raw=!0,T(k,R)},o.ungzip=T},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,s,o){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(m){for(var v=Array.prototype.slice.call(arguments,1);v.length;){var I=v.shift();if(I){if(typeof I!="object")throw new TypeError(I+"must be non-object");for(var $ in I)I.hasOwnProperty($)&&(m[$]=I[$])}}return m},o.shrinkBuf=function(m,v){return m.length===v?m:m.subarray?m.subarray(0,v):(m.length=v,m)};var l={arraySet:function(m,v,I,$,_){if(v.subarray&&m.subarray)m.set(v.subarray(I,I+$),_);else for(var b=0;b<$;b++)m[_+b]=v[I+b]},flattenChunks:function(m){var v,I,$,_,b,T;for(v=$=0,I=m.length;v<I;v++)$+=m[v].length;for(T=new Uint8Array($),v=_=0,I=m.length;v<I;v++)b=m[v],T.set(b,_),_+=b.length;return T}},u={arraySet:function(m,v,I,$,_){for(var b=0;b<$;b++)m[_+b]=v[I+b]},flattenChunks:function(m){return[].concat.apply([],m)}};o.setTyped=function(m){m?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,l)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,u))},o.setTyped(a)},{}],42:[function(r,s,o){var a=r("./common"),l=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var m=new a.Buf8(256),v=0;v<256;v++)m[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;function I($,_){if(_<65537&&($.subarray&&u||!$.subarray&&l))return String.fromCharCode.apply(null,a.shrinkBuf($,_));for(var b="",T=0;T<_;T++)b+=String.fromCharCode($[T]);return b}m[254]=m[254]=1,o.string2buf=function($){var _,b,T,k,R,x=$.length,w=0;for(k=0;k<x;k++)(64512&(b=$.charCodeAt(k)))==55296&&k+1<x&&(64512&(T=$.charCodeAt(k+1)))==56320&&(b=65536+(b-55296<<10)+(T-56320),k++),w+=b<128?1:b<2048?2:b<65536?3:4;for(_=new a.Buf8(w),k=R=0;R<w;k++)(64512&(b=$.charCodeAt(k)))==55296&&k+1<x&&(64512&(T=$.charCodeAt(k+1)))==56320&&(b=65536+(b-55296<<10)+(T-56320),k++),b<128?_[R++]=b:(b<2048?_[R++]=192|b>>>6:(b<65536?_[R++]=224|b>>>12:(_[R++]=240|b>>>18,_[R++]=128|b>>>12&63),_[R++]=128|b>>>6&63),_[R++]=128|63&b);return _},o.buf2binstring=function($){return I($,$.length)},o.binstring2buf=function($){for(var _=new a.Buf8($.length),b=0,T=_.length;b<T;b++)_[b]=$.charCodeAt(b);return _},o.buf2string=function($,_){var b,T,k,R,x=_||$.length,w=new Array(2*x);for(b=T=0;b<x;)if((k=$[b++])<128)w[T++]=k;else if(4<(R=m[k]))w[T++]=65533,b+=R-1;else{for(k&=R===2?31:R===3?15:7;1<R&&b<x;)k=k<<6|63&$[b++],R--;1<R?w[T++]=65533:k<65536?w[T++]=k:(k-=65536,w[T++]=55296|k>>10&1023,w[T++]=56320|1023&k)}return I(w,T)},o.utf8border=function($,_){var b;for((_=_||$.length)>$.length&&(_=$.length),b=_-1;0<=b&&(192&$[b])==128;)b--;return b<0||b===0?_:b+m[$[b]]>_?b:_}},{"./common":41}],43:[function(r,s,o){s.exports=function(a,l,u,m){for(var v=65535&a|0,I=a>>>16&65535|0,$=0;u!==0;){for(u-=$=2e3<u?2e3:u;I=I+(v=v+l[m++]|0)|0,--$;);v%=65521,I%=65521}return v|I<<16|0}},{}],44:[function(r,s,o){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,s,o){var a=function(){for(var l,u=[],m=0;m<256;m++){l=m;for(var v=0;v<8;v++)l=1&l?3988292384^l>>>1:l>>>1;u[m]=l}return u}();s.exports=function(l,u,m,v){var I=a,$=v+m;l^=-1;for(var _=v;_<$;_++)l=l>>>8^I[255&(l^u[_])];return-1^l}},{}],46:[function(r,s,o){var a,l=r("../utils/common"),u=r("./trees"),m=r("./adler32"),v=r("./crc32"),I=r("./messages"),$=0,_=4,b=0,T=-2,k=-1,R=4,x=2,w=8,P=9,L=286,Y=30,oe=19,ie=2*L+1,be=15,ye=3,he=258,We=he+ye+1,X=42,ke=113,M=1,xe=2,lt=3,Se=4;function we(j,Ce){return j.msg=I[Ce],Ce}function Ne(j){return(j<<1)-(4<j?9:0)}function et(j){for(var Ce=j.length;0<=--Ce;)j[Ce]=0}function ee(j){var Ce=j.state,_e=Ce.pending;_e>j.avail_out&&(_e=j.avail_out),_e!==0&&(l.arraySet(j.output,Ce.pending_buf,Ce.pending_out,_e,j.next_out),j.next_out+=_e,Ce.pending_out+=_e,j.total_out+=_e,j.avail_out-=_e,Ce.pending-=_e,Ce.pending===0&&(Ce.pending_out=0))}function ae(j,Ce){u._tr_flush_block(j,0<=j.block_start?j.block_start:-1,j.strstart-j.block_start,Ce),j.block_start=j.strstart,ee(j.strm)}function Te(j,Ce){j.pending_buf[j.pending++]=Ce}function it(j,Ce){j.pending_buf[j.pending++]=Ce>>>8&255,j.pending_buf[j.pending++]=255&Ce}function Pe(j,Ce){var _e,K,W=j.max_chain_length,ue=j.strstart,Oe=j.prev_length,Ve=j.nice_match,ve=j.strstart>j.w_size-We?j.strstart-(j.w_size-We):0,nt=j.window,gt=j.w_mask,Ye=j.prev,It=j.strstart+he,tn=nt[ue+Oe-1],Xt=nt[ue+Oe];j.prev_length>=j.good_match&&(W>>=2),Ve>j.lookahead&&(Ve=j.lookahead);do if(nt[(_e=Ce)+Oe]===Xt&&nt[_e+Oe-1]===tn&&nt[_e]===nt[ue]&&nt[++_e]===nt[ue+1]){ue+=2,_e++;do;while(nt[++ue]===nt[++_e]&&nt[++ue]===nt[++_e]&&nt[++ue]===nt[++_e]&&nt[++ue]===nt[++_e]&&nt[++ue]===nt[++_e]&&nt[++ue]===nt[++_e]&&nt[++ue]===nt[++_e]&&nt[++ue]===nt[++_e]&&ue<It);if(K=he-(It-ue),ue=It-he,Oe<K){if(j.match_start=Ce,Ve<=(Oe=K))break;tn=nt[ue+Oe-1],Xt=nt[ue+Oe]}}while((Ce=Ye[Ce&gt])>ve&&--W!=0);return Oe<=j.lookahead?Oe:j.lookahead}function Gt(j){var Ce,_e,K,W,ue,Oe,Ve,ve,nt,gt,Ye=j.w_size;do{if(W=j.window_size-j.lookahead-j.strstart,j.strstart>=Ye+(Ye-We)){for(l.arraySet(j.window,j.window,Ye,Ye,0),j.match_start-=Ye,j.strstart-=Ye,j.block_start-=Ye,Ce=_e=j.hash_size;K=j.head[--Ce],j.head[Ce]=Ye<=K?K-Ye:0,--_e;);for(Ce=_e=Ye;K=j.prev[--Ce],j.prev[Ce]=Ye<=K?K-Ye:0,--_e;);W+=Ye}if(j.strm.avail_in===0)break;if(Oe=j.strm,Ve=j.window,ve=j.strstart+j.lookahead,nt=W,gt=void 0,gt=Oe.avail_in,nt<gt&&(gt=nt),_e=gt===0?0:(Oe.avail_in-=gt,l.arraySet(Ve,Oe.input,Oe.next_in,gt,ve),Oe.state.wrap===1?Oe.adler=m(Oe.adler,Ve,gt,ve):Oe.state.wrap===2&&(Oe.adler=v(Oe.adler,Ve,gt,ve)),Oe.next_in+=gt,Oe.total_in+=gt,gt),j.lookahead+=_e,j.lookahead+j.insert>=ye)for(ue=j.strstart-j.insert,j.ins_h=j.window[ue],j.ins_h=(j.ins_h<<j.hash_shift^j.window[ue+1])&j.hash_mask;j.insert&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[ue+ye-1])&j.hash_mask,j.prev[ue&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=ue,ue++,j.insert--,!(j.lookahead+j.insert<ye)););}while(j.lookahead<We&&j.strm.avail_in!==0)}function an(j,Ce){for(var _e,K;;){if(j.lookahead<We){if(Gt(j),j.lookahead<We&&Ce===$)return M;if(j.lookahead===0)break}if(_e=0,j.lookahead>=ye&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+ye-1])&j.hash_mask,_e=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),_e!==0&&j.strstart-_e<=j.w_size-We&&(j.match_length=Pe(j,_e)),j.match_length>=ye)if(K=u._tr_tally(j,j.strstart-j.match_start,j.match_length-ye),j.lookahead-=j.match_length,j.match_length<=j.max_lazy_match&&j.lookahead>=ye){for(j.match_length--;j.strstart++,j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+ye-1])&j.hash_mask,_e=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart,--j.match_length!=0;);j.strstart++}else j.strstart+=j.match_length,j.match_length=0,j.ins_h=j.window[j.strstart],j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+1])&j.hash_mask;else K=u._tr_tally(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++;if(K&&(ae(j,!1),j.strm.avail_out===0))return M}return j.insert=j.strstart<ye-1?j.strstart:ye-1,Ce===_?(ae(j,!0),j.strm.avail_out===0?lt:Se):j.last_lit&&(ae(j,!1),j.strm.avail_out===0)?M:xe}function Yt(j,Ce){for(var _e,K,W;;){if(j.lookahead<We){if(Gt(j),j.lookahead<We&&Ce===$)return M;if(j.lookahead===0)break}if(_e=0,j.lookahead>=ye&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+ye-1])&j.hash_mask,_e=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),j.prev_length=j.match_length,j.prev_match=j.match_start,j.match_length=ye-1,_e!==0&&j.prev_length<j.max_lazy_match&&j.strstart-_e<=j.w_size-We&&(j.match_length=Pe(j,_e),j.match_length<=5&&(j.strategy===1||j.match_length===ye&&4096<j.strstart-j.match_start)&&(j.match_length=ye-1)),j.prev_length>=ye&&j.match_length<=j.prev_length){for(W=j.strstart+j.lookahead-ye,K=u._tr_tally(j,j.strstart-1-j.prev_match,j.prev_length-ye),j.lookahead-=j.prev_length-1,j.prev_length-=2;++j.strstart<=W&&(j.ins_h=(j.ins_h<<j.hash_shift^j.window[j.strstart+ye-1])&j.hash_mask,_e=j.prev[j.strstart&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=j.strstart),--j.prev_length!=0;);if(j.match_available=0,j.match_length=ye-1,j.strstart++,K&&(ae(j,!1),j.strm.avail_out===0))return M}else if(j.match_available){if((K=u._tr_tally(j,0,j.window[j.strstart-1]))&&ae(j,!1),j.strstart++,j.lookahead--,j.strm.avail_out===0)return M}else j.match_available=1,j.strstart++,j.lookahead--}return j.match_available&&(K=u._tr_tally(j,0,j.window[j.strstart-1]),j.match_available=0),j.insert=j.strstart<ye-1?j.strstart:ye-1,Ce===_?(ae(j,!0),j.strm.avail_out===0?lt:Se):j.last_lit&&(ae(j,!1),j.strm.avail_out===0)?M:xe}function Jt(j,Ce,_e,K,W){this.good_length=j,this.max_lazy=Ce,this.nice_length=_e,this.max_chain=K,this.func=W}function $n(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*ie),this.dyn_dtree=new l.Buf16(2*(2*Y+1)),this.bl_tree=new l.Buf16(2*(2*oe+1)),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(be+1),this.heap=new l.Buf16(2*L+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*L+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pn(j){var Ce;return j&&j.state?(j.total_in=j.total_out=0,j.data_type=x,(Ce=j.state).pending=0,Ce.pending_out=0,Ce.wrap<0&&(Ce.wrap=-Ce.wrap),Ce.status=Ce.wrap?X:ke,j.adler=Ce.wrap===2?0:1,Ce.last_flush=$,u._tr_init(Ce),b):we(j,T)}function mr(j){var Ce=pn(j);return Ce===b&&function(_e){_e.window_size=2*_e.w_size,et(_e.head),_e.max_lazy_match=a[_e.level].max_lazy,_e.good_match=a[_e.level].good_length,_e.nice_match=a[_e.level].nice_length,_e.max_chain_length=a[_e.level].max_chain,_e.strstart=0,_e.block_start=0,_e.lookahead=0,_e.insert=0,_e.match_length=_e.prev_length=ye-1,_e.match_available=0,_e.ins_h=0}(j.state),Ce}function Nn(j,Ce,_e,K,W,ue){if(!j)return T;var Oe=1;if(Ce===k&&(Ce=6),K<0?(Oe=0,K=-K):15<K&&(Oe=2,K-=16),W<1||P<W||_e!==w||K<8||15<K||Ce<0||9<Ce||ue<0||R<ue)return we(j,T);K===8&&(K=9);var Ve=new $n;return(j.state=Ve).strm=j,Ve.wrap=Oe,Ve.gzhead=null,Ve.w_bits=K,Ve.w_size=1<<Ve.w_bits,Ve.w_mask=Ve.w_size-1,Ve.hash_bits=W+7,Ve.hash_size=1<<Ve.hash_bits,Ve.hash_mask=Ve.hash_size-1,Ve.hash_shift=~~((Ve.hash_bits+ye-1)/ye),Ve.window=new l.Buf8(2*Ve.w_size),Ve.head=new l.Buf16(Ve.hash_size),Ve.prev=new l.Buf16(Ve.w_size),Ve.lit_bufsize=1<<W+6,Ve.pending_buf_size=4*Ve.lit_bufsize,Ve.pending_buf=new l.Buf8(Ve.pending_buf_size),Ve.d_buf=1*Ve.lit_bufsize,Ve.l_buf=3*Ve.lit_bufsize,Ve.level=Ce,Ve.strategy=ue,Ve.method=_e,mr(j)}a=[new Jt(0,0,0,0,function(j,Ce){var _e=65535;for(_e>j.pending_buf_size-5&&(_e=j.pending_buf_size-5);;){if(j.lookahead<=1){if(Gt(j),j.lookahead===0&&Ce===$)return M;if(j.lookahead===0)break}j.strstart+=j.lookahead,j.lookahead=0;var K=j.block_start+_e;if((j.strstart===0||j.strstart>=K)&&(j.lookahead=j.strstart-K,j.strstart=K,ae(j,!1),j.strm.avail_out===0)||j.strstart-j.block_start>=j.w_size-We&&(ae(j,!1),j.strm.avail_out===0))return M}return j.insert=0,Ce===_?(ae(j,!0),j.strm.avail_out===0?lt:Se):(j.strstart>j.block_start&&(ae(j,!1),j.strm.avail_out),M)}),new Jt(4,4,8,4,an),new Jt(4,5,16,8,an),new Jt(4,6,32,32,an),new Jt(4,4,16,16,Yt),new Jt(8,16,32,32,Yt),new Jt(8,16,128,128,Yt),new Jt(8,32,128,256,Yt),new Jt(32,128,258,1024,Yt),new Jt(32,258,258,4096,Yt)],o.deflateInit=function(j,Ce){return Nn(j,Ce,w,15,8,0)},o.deflateInit2=Nn,o.deflateReset=mr,o.deflateResetKeep=pn,o.deflateSetHeader=function(j,Ce){return j&&j.state?j.state.wrap!==2?T:(j.state.gzhead=Ce,b):T},o.deflate=function(j,Ce){var _e,K,W,ue;if(!j||!j.state||5<Ce||Ce<0)return j?we(j,T):T;if(K=j.state,!j.output||!j.input&&j.avail_in!==0||K.status===666&&Ce!==_)return we(j,j.avail_out===0?-5:T);if(K.strm=j,_e=K.last_flush,K.last_flush=Ce,K.status===X)if(K.wrap===2)j.adler=0,Te(K,31),Te(K,139),Te(K,8),K.gzhead?(Te(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(K.gzhead.extra?4:0)+(K.gzhead.name?8:0)+(K.gzhead.comment?16:0)),Te(K,255&K.gzhead.time),Te(K,K.gzhead.time>>8&255),Te(K,K.gzhead.time>>16&255),Te(K,K.gzhead.time>>24&255),Te(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),Te(K,255&K.gzhead.os),K.gzhead.extra&&K.gzhead.extra.length&&(Te(K,255&K.gzhead.extra.length),Te(K,K.gzhead.extra.length>>8&255)),K.gzhead.hcrc&&(j.adler=v(j.adler,K.pending_buf,K.pending,0)),K.gzindex=0,K.status=69):(Te(K,0),Te(K,0),Te(K,0),Te(K,0),Te(K,0),Te(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),Te(K,3),K.status=ke);else{var Oe=w+(K.w_bits-8<<4)<<8;Oe|=(2<=K.strategy||K.level<2?0:K.level<6?1:K.level===6?2:3)<<6,K.strstart!==0&&(Oe|=32),Oe+=31-Oe%31,K.status=ke,it(K,Oe),K.strstart!==0&&(it(K,j.adler>>>16),it(K,65535&j.adler)),j.adler=1}if(K.status===69)if(K.gzhead.extra){for(W=K.pending;K.gzindex<(65535&K.gzhead.extra.length)&&(K.pending!==K.pending_buf_size||(K.gzhead.hcrc&&K.pending>W&&(j.adler=v(j.adler,K.pending_buf,K.pending-W,W)),ee(j),W=K.pending,K.pending!==K.pending_buf_size));)Te(K,255&K.gzhead.extra[K.gzindex]),K.gzindex++;K.gzhead.hcrc&&K.pending>W&&(j.adler=v(j.adler,K.pending_buf,K.pending-W,W)),K.gzindex===K.gzhead.extra.length&&(K.gzindex=0,K.status=73)}else K.status=73;if(K.status===73)if(K.gzhead.name){W=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>W&&(j.adler=v(j.adler,K.pending_buf,K.pending-W,W)),ee(j),W=K.pending,K.pending===K.pending_buf_size)){ue=1;break}ue=K.gzindex<K.gzhead.name.length?255&K.gzhead.name.charCodeAt(K.gzindex++):0,Te(K,ue)}while(ue!==0);K.gzhead.hcrc&&K.pending>W&&(j.adler=v(j.adler,K.pending_buf,K.pending-W,W)),ue===0&&(K.gzindex=0,K.status=91)}else K.status=91;if(K.status===91)if(K.gzhead.comment){W=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>W&&(j.adler=v(j.adler,K.pending_buf,K.pending-W,W)),ee(j),W=K.pending,K.pending===K.pending_buf_size)){ue=1;break}ue=K.gzindex<K.gzhead.comment.length?255&K.gzhead.comment.charCodeAt(K.gzindex++):0,Te(K,ue)}while(ue!==0);K.gzhead.hcrc&&K.pending>W&&(j.adler=v(j.adler,K.pending_buf,K.pending-W,W)),ue===0&&(K.status=103)}else K.status=103;if(K.status===103&&(K.gzhead.hcrc?(K.pending+2>K.pending_buf_size&&ee(j),K.pending+2<=K.pending_buf_size&&(Te(K,255&j.adler),Te(K,j.adler>>8&255),j.adler=0,K.status=ke)):K.status=ke),K.pending!==0){if(ee(j),j.avail_out===0)return K.last_flush=-1,b}else if(j.avail_in===0&&Ne(Ce)<=Ne(_e)&&Ce!==_)return we(j,-5);if(K.status===666&&j.avail_in!==0)return we(j,-5);if(j.avail_in!==0||K.lookahead!==0||Ce!==$&&K.status!==666){var Ve=K.strategy===2?function(ve,nt){for(var gt;;){if(ve.lookahead===0&&(Gt(ve),ve.lookahead===0)){if(nt===$)return M;break}if(ve.match_length=0,gt=u._tr_tally(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++,gt&&(ae(ve,!1),ve.strm.avail_out===0))return M}return ve.insert=0,nt===_?(ae(ve,!0),ve.strm.avail_out===0?lt:Se):ve.last_lit&&(ae(ve,!1),ve.strm.avail_out===0)?M:xe}(K,Ce):K.strategy===3?function(ve,nt){for(var gt,Ye,It,tn,Xt=ve.window;;){if(ve.lookahead<=he){if(Gt(ve),ve.lookahead<=he&&nt===$)return M;if(ve.lookahead===0)break}if(ve.match_length=0,ve.lookahead>=ye&&0<ve.strstart&&(Ye=Xt[It=ve.strstart-1])===Xt[++It]&&Ye===Xt[++It]&&Ye===Xt[++It]){tn=ve.strstart+he;do;while(Ye===Xt[++It]&&Ye===Xt[++It]&&Ye===Xt[++It]&&Ye===Xt[++It]&&Ye===Xt[++It]&&Ye===Xt[++It]&&Ye===Xt[++It]&&Ye===Xt[++It]&&It<tn);ve.match_length=he-(tn-It),ve.match_length>ve.lookahead&&(ve.match_length=ve.lookahead)}if(ve.match_length>=ye?(gt=u._tr_tally(ve,1,ve.match_length-ye),ve.lookahead-=ve.match_length,ve.strstart+=ve.match_length,ve.match_length=0):(gt=u._tr_tally(ve,0,ve.window[ve.strstart]),ve.lookahead--,ve.strstart++),gt&&(ae(ve,!1),ve.strm.avail_out===0))return M}return ve.insert=0,nt===_?(ae(ve,!0),ve.strm.avail_out===0?lt:Se):ve.last_lit&&(ae(ve,!1),ve.strm.avail_out===0)?M:xe}(K,Ce):a[K.level].func(K,Ce);if(Ve!==lt&&Ve!==Se||(K.status=666),Ve===M||Ve===lt)return j.avail_out===0&&(K.last_flush=-1),b;if(Ve===xe&&(Ce===1?u._tr_align(K):Ce!==5&&(u._tr_stored_block(K,0,0,!1),Ce===3&&(et(K.head),K.lookahead===0&&(K.strstart=0,K.block_start=0,K.insert=0))),ee(j),j.avail_out===0))return K.last_flush=-1,b}return Ce!==_?b:K.wrap<=0?1:(K.wrap===2?(Te(K,255&j.adler),Te(K,j.adler>>8&255),Te(K,j.adler>>16&255),Te(K,j.adler>>24&255),Te(K,255&j.total_in),Te(K,j.total_in>>8&255),Te(K,j.total_in>>16&255),Te(K,j.total_in>>24&255)):(it(K,j.adler>>>16),it(K,65535&j.adler)),ee(j),0<K.wrap&&(K.wrap=-K.wrap),K.pending!==0?b:1)},o.deflateEnd=function(j){var Ce;return j&&j.state?(Ce=j.state.status)!==X&&Ce!==69&&Ce!==73&&Ce!==91&&Ce!==103&&Ce!==ke&&Ce!==666?we(j,T):(j.state=null,Ce===ke?we(j,-3):b):T},o.deflateSetDictionary=function(j,Ce){var _e,K,W,ue,Oe,Ve,ve,nt,gt=Ce.length;if(!j||!j.state||(ue=(_e=j.state).wrap)===2||ue===1&&_e.status!==X||_e.lookahead)return T;for(ue===1&&(j.adler=m(j.adler,Ce,gt,0)),_e.wrap=0,gt>=_e.w_size&&(ue===0&&(et(_e.head),_e.strstart=0,_e.block_start=0,_e.insert=0),nt=new l.Buf8(_e.w_size),l.arraySet(nt,Ce,gt-_e.w_size,_e.w_size,0),Ce=nt,gt=_e.w_size),Oe=j.avail_in,Ve=j.next_in,ve=j.input,j.avail_in=gt,j.next_in=0,j.input=Ce,Gt(_e);_e.lookahead>=ye;){for(K=_e.strstart,W=_e.lookahead-(ye-1);_e.ins_h=(_e.ins_h<<_e.hash_shift^_e.window[K+ye-1])&_e.hash_mask,_e.prev[K&_e.w_mask]=_e.head[_e.ins_h],_e.head[_e.ins_h]=K,K++,--W;);_e.strstart=K,_e.lookahead=ye-1,Gt(_e)}return _e.strstart+=_e.lookahead,_e.block_start=_e.strstart,_e.insert=_e.lookahead,_e.lookahead=0,_e.match_length=_e.prev_length=ye-1,_e.match_available=0,j.next_in=Ve,j.input=ve,j.avail_in=Oe,_e.wrap=ue,b},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,s,o){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,s,o){s.exports=function(a,l){var u,m,v,I,$,_,b,T,k,R,x,w,P,L,Y,oe,ie,be,ye,he,We,X,ke,M,xe;u=a.state,m=a.next_in,M=a.input,v=m+(a.avail_in-5),I=a.next_out,xe=a.output,$=I-(l-a.avail_out),_=I+(a.avail_out-257),b=u.dmax,T=u.wsize,k=u.whave,R=u.wnext,x=u.window,w=u.hold,P=u.bits,L=u.lencode,Y=u.distcode,oe=(1<<u.lenbits)-1,ie=(1<<u.distbits)-1;e:do{P<15&&(w+=M[m++]<<P,P+=8,w+=M[m++]<<P,P+=8),be=L[w&oe];t:for(;;){if(w>>>=ye=be>>>24,P-=ye,(ye=be>>>16&255)===0)xe[I++]=65535&be;else{if(!(16&ye)){if(!(64&ye)){be=L[(65535&be)+(w&(1<<ye)-1)];continue t}if(32&ye){u.mode=12;break e}a.msg="invalid literal/length code",u.mode=30;break e}he=65535&be,(ye&=15)&&(P<ye&&(w+=M[m++]<<P,P+=8),he+=w&(1<<ye)-1,w>>>=ye,P-=ye),P<15&&(w+=M[m++]<<P,P+=8,w+=M[m++]<<P,P+=8),be=Y[w&ie];n:for(;;){if(w>>>=ye=be>>>24,P-=ye,!(16&(ye=be>>>16&255))){if(!(64&ye)){be=Y[(65535&be)+(w&(1<<ye)-1)];continue n}a.msg="invalid distance code",u.mode=30;break e}if(We=65535&be,P<(ye&=15)&&(w+=M[m++]<<P,(P+=8)<ye&&(w+=M[m++]<<P,P+=8)),b<(We+=w&(1<<ye)-1)){a.msg="invalid distance too far back",u.mode=30;break e}if(w>>>=ye,P-=ye,(ye=I-$)<We){if(k<(ye=We-ye)&&u.sane){a.msg="invalid distance too far back",u.mode=30;break e}if(ke=x,(X=0)===R){if(X+=T-ye,ye<he){for(he-=ye;xe[I++]=x[X++],--ye;);X=I-We,ke=xe}}else if(R<ye){if(X+=T+R-ye,(ye-=R)<he){for(he-=ye;xe[I++]=x[X++],--ye;);if(X=0,R<he){for(he-=ye=R;xe[I++]=x[X++],--ye;);X=I-We,ke=xe}}}else if(X+=R-ye,ye<he){for(he-=ye;xe[I++]=x[X++],--ye;);X=I-We,ke=xe}for(;2<he;)xe[I++]=ke[X++],xe[I++]=ke[X++],xe[I++]=ke[X++],he-=3;he&&(xe[I++]=ke[X++],1<he&&(xe[I++]=ke[X++]))}else{for(X=I-We;xe[I++]=xe[X++],xe[I++]=xe[X++],xe[I++]=xe[X++],2<(he-=3););he&&(xe[I++]=xe[X++],1<he&&(xe[I++]=xe[X++]))}break}}break}}while(m<v&&I<_);m-=he=P>>3,w&=(1<<(P-=he<<3))-1,a.next_in=m,a.next_out=I,a.avail_in=m<v?v-m+5:5-(m-v),a.avail_out=I<_?_-I+257:257-(I-_),u.hold=w,u.bits=P}},{}],49:[function(r,s,o){var a=r("../utils/common"),l=r("./adler32"),u=r("./crc32"),m=r("./inffast"),v=r("./inftrees"),I=1,$=2,_=0,b=-2,T=1,k=852,R=592;function x(X){return(X>>>24&255)+(X>>>8&65280)+((65280&X)<<8)+((255&X)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function P(X){var ke;return X&&X.state?(ke=X.state,X.total_in=X.total_out=ke.total=0,X.msg="",ke.wrap&&(X.adler=1&ke.wrap),ke.mode=T,ke.last=0,ke.havedict=0,ke.dmax=32768,ke.head=null,ke.hold=0,ke.bits=0,ke.lencode=ke.lendyn=new a.Buf32(k),ke.distcode=ke.distdyn=new a.Buf32(R),ke.sane=1,ke.back=-1,_):b}function L(X){var ke;return X&&X.state?((ke=X.state).wsize=0,ke.whave=0,ke.wnext=0,P(X)):b}function Y(X,ke){var M,xe;return X&&X.state?(xe=X.state,ke<0?(M=0,ke=-ke):(M=1+(ke>>4),ke<48&&(ke&=15)),ke&&(ke<8||15<ke)?b:(xe.window!==null&&xe.wbits!==ke&&(xe.window=null),xe.wrap=M,xe.wbits=ke,L(X))):b}function oe(X,ke){var M,xe;return X?(xe=new w,(X.state=xe).window=null,(M=Y(X,ke))!==_&&(X.state=null),M):b}var ie,be,ye=!0;function he(X){if(ye){var ke;for(ie=new a.Buf32(512),be=new a.Buf32(32),ke=0;ke<144;)X.lens[ke++]=8;for(;ke<256;)X.lens[ke++]=9;for(;ke<280;)X.lens[ke++]=7;for(;ke<288;)X.lens[ke++]=8;for(v(I,X.lens,0,288,ie,0,X.work,{bits:9}),ke=0;ke<32;)X.lens[ke++]=5;v($,X.lens,0,32,be,0,X.work,{bits:5}),ye=!1}X.lencode=ie,X.lenbits=9,X.distcode=be,X.distbits=5}function We(X,ke,M,xe){var lt,Se=X.state;return Se.window===null&&(Se.wsize=1<<Se.wbits,Se.wnext=0,Se.whave=0,Se.window=new a.Buf8(Se.wsize)),xe>=Se.wsize?(a.arraySet(Se.window,ke,M-Se.wsize,Se.wsize,0),Se.wnext=0,Se.whave=Se.wsize):(xe<(lt=Se.wsize-Se.wnext)&&(lt=xe),a.arraySet(Se.window,ke,M-xe,lt,Se.wnext),(xe-=lt)?(a.arraySet(Se.window,ke,M-xe,xe,0),Se.wnext=xe,Se.whave=Se.wsize):(Se.wnext+=lt,Se.wnext===Se.wsize&&(Se.wnext=0),Se.whave<Se.wsize&&(Se.whave+=lt))),0}o.inflateReset=L,o.inflateReset2=Y,o.inflateResetKeep=P,o.inflateInit=function(X){return oe(X,15)},o.inflateInit2=oe,o.inflate=function(X,ke){var M,xe,lt,Se,we,Ne,et,ee,ae,Te,it,Pe,Gt,an,Yt,Jt,$n,pn,mr,Nn,j,Ce,_e,K,W=0,ue=new a.Buf8(4),Oe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!X||!X.state||!X.output||!X.input&&X.avail_in!==0)return b;(M=X.state).mode===12&&(M.mode=13),we=X.next_out,lt=X.output,et=X.avail_out,Se=X.next_in,xe=X.input,Ne=X.avail_in,ee=M.hold,ae=M.bits,Te=Ne,it=et,Ce=_;e:for(;;)switch(M.mode){case T:if(M.wrap===0){M.mode=13;break}for(;ae<16;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if(2&M.wrap&&ee===35615){ue[M.check=0]=255&ee,ue[1]=ee>>>8&255,M.check=u(M.check,ue,2,0),ae=ee=0,M.mode=2;break}if(M.flags=0,M.head&&(M.head.done=!1),!(1&M.wrap)||(((255&ee)<<8)+(ee>>8))%31){X.msg="incorrect header check",M.mode=30;break}if((15&ee)!=8){X.msg="unknown compression method",M.mode=30;break}if(ae-=4,j=8+(15&(ee>>>=4)),M.wbits===0)M.wbits=j;else if(j>M.wbits){X.msg="invalid window size",M.mode=30;break}M.dmax=1<<j,X.adler=M.check=1,M.mode=512&ee?10:12,ae=ee=0;break;case 2:for(;ae<16;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if(M.flags=ee,(255&M.flags)!=8){X.msg="unknown compression method",M.mode=30;break}if(57344&M.flags){X.msg="unknown header flags set",M.mode=30;break}M.head&&(M.head.text=ee>>8&1),512&M.flags&&(ue[0]=255&ee,ue[1]=ee>>>8&255,M.check=u(M.check,ue,2,0)),ae=ee=0,M.mode=3;case 3:for(;ae<32;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}M.head&&(M.head.time=ee),512&M.flags&&(ue[0]=255&ee,ue[1]=ee>>>8&255,ue[2]=ee>>>16&255,ue[3]=ee>>>24&255,M.check=u(M.check,ue,4,0)),ae=ee=0,M.mode=4;case 4:for(;ae<16;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}M.head&&(M.head.xflags=255&ee,M.head.os=ee>>8),512&M.flags&&(ue[0]=255&ee,ue[1]=ee>>>8&255,M.check=u(M.check,ue,2,0)),ae=ee=0,M.mode=5;case 5:if(1024&M.flags){for(;ae<16;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}M.length=ee,M.head&&(M.head.extra_len=ee),512&M.flags&&(ue[0]=255&ee,ue[1]=ee>>>8&255,M.check=u(M.check,ue,2,0)),ae=ee=0}else M.head&&(M.head.extra=null);M.mode=6;case 6:if(1024&M.flags&&(Ne<(Pe=M.length)&&(Pe=Ne),Pe&&(M.head&&(j=M.head.extra_len-M.length,M.head.extra||(M.head.extra=new Array(M.head.extra_len)),a.arraySet(M.head.extra,xe,Se,Pe,j)),512&M.flags&&(M.check=u(M.check,xe,Pe,Se)),Ne-=Pe,Se+=Pe,M.length-=Pe),M.length))break e;M.length=0,M.mode=7;case 7:if(2048&M.flags){if(Ne===0)break e;for(Pe=0;j=xe[Se+Pe++],M.head&&j&&M.length<65536&&(M.head.name+=String.fromCharCode(j)),j&&Pe<Ne;);if(512&M.flags&&(M.check=u(M.check,xe,Pe,Se)),Ne-=Pe,Se+=Pe,j)break e}else M.head&&(M.head.name=null);M.length=0,M.mode=8;case 8:if(4096&M.flags){if(Ne===0)break e;for(Pe=0;j=xe[Se+Pe++],M.head&&j&&M.length<65536&&(M.head.comment+=String.fromCharCode(j)),j&&Pe<Ne;);if(512&M.flags&&(M.check=u(M.check,xe,Pe,Se)),Ne-=Pe,Se+=Pe,j)break e}else M.head&&(M.head.comment=null);M.mode=9;case 9:if(512&M.flags){for(;ae<16;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if(ee!==(65535&M.check)){X.msg="header crc mismatch",M.mode=30;break}ae=ee=0}M.head&&(M.head.hcrc=M.flags>>9&1,M.head.done=!0),X.adler=M.check=0,M.mode=12;break;case 10:for(;ae<32;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}X.adler=M.check=x(ee),ae=ee=0,M.mode=11;case 11:if(M.havedict===0)return X.next_out=we,X.avail_out=et,X.next_in=Se,X.avail_in=Ne,M.hold=ee,M.bits=ae,2;X.adler=M.check=1,M.mode=12;case 12:if(ke===5||ke===6)break e;case 13:if(M.last){ee>>>=7&ae,ae-=7&ae,M.mode=27;break}for(;ae<3;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}switch(M.last=1&ee,ae-=1,3&(ee>>>=1)){case 0:M.mode=14;break;case 1:if(he(M),M.mode=20,ke!==6)break;ee>>>=2,ae-=2;break e;case 2:M.mode=17;break;case 3:X.msg="invalid block type",M.mode=30}ee>>>=2,ae-=2;break;case 14:for(ee>>>=7&ae,ae-=7&ae;ae<32;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if((65535&ee)!=(ee>>>16^65535)){X.msg="invalid stored block lengths",M.mode=30;break}if(M.length=65535&ee,ae=ee=0,M.mode=15,ke===6)break e;case 15:M.mode=16;case 16:if(Pe=M.length){if(Ne<Pe&&(Pe=Ne),et<Pe&&(Pe=et),Pe===0)break e;a.arraySet(lt,xe,Se,Pe,we),Ne-=Pe,Se+=Pe,et-=Pe,we+=Pe,M.length-=Pe;break}M.mode=12;break;case 17:for(;ae<14;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if(M.nlen=257+(31&ee),ee>>>=5,ae-=5,M.ndist=1+(31&ee),ee>>>=5,ae-=5,M.ncode=4+(15&ee),ee>>>=4,ae-=4,286<M.nlen||30<M.ndist){X.msg="too many length or distance symbols",M.mode=30;break}M.have=0,M.mode=18;case 18:for(;M.have<M.ncode;){for(;ae<3;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}M.lens[Oe[M.have++]]=7&ee,ee>>>=3,ae-=3}for(;M.have<19;)M.lens[Oe[M.have++]]=0;if(M.lencode=M.lendyn,M.lenbits=7,_e={bits:M.lenbits},Ce=v(0,M.lens,0,19,M.lencode,0,M.work,_e),M.lenbits=_e.bits,Ce){X.msg="invalid code lengths set",M.mode=30;break}M.have=0,M.mode=19;case 19:for(;M.have<M.nlen+M.ndist;){for(;Jt=(W=M.lencode[ee&(1<<M.lenbits)-1])>>>16&255,$n=65535&W,!((Yt=W>>>24)<=ae);){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if($n<16)ee>>>=Yt,ae-=Yt,M.lens[M.have++]=$n;else{if($n===16){for(K=Yt+2;ae<K;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if(ee>>>=Yt,ae-=Yt,M.have===0){X.msg="invalid bit length repeat",M.mode=30;break}j=M.lens[M.have-1],Pe=3+(3&ee),ee>>>=2,ae-=2}else if($n===17){for(K=Yt+3;ae<K;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}ae-=Yt,j=0,Pe=3+(7&(ee>>>=Yt)),ee>>>=3,ae-=3}else{for(K=Yt+7;ae<K;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}ae-=Yt,j=0,Pe=11+(127&(ee>>>=Yt)),ee>>>=7,ae-=7}if(M.have+Pe>M.nlen+M.ndist){X.msg="invalid bit length repeat",M.mode=30;break}for(;Pe--;)M.lens[M.have++]=j}}if(M.mode===30)break;if(M.lens[256]===0){X.msg="invalid code -- missing end-of-block",M.mode=30;break}if(M.lenbits=9,_e={bits:M.lenbits},Ce=v(I,M.lens,0,M.nlen,M.lencode,0,M.work,_e),M.lenbits=_e.bits,Ce){X.msg="invalid literal/lengths set",M.mode=30;break}if(M.distbits=6,M.distcode=M.distdyn,_e={bits:M.distbits},Ce=v($,M.lens,M.nlen,M.ndist,M.distcode,0,M.work,_e),M.distbits=_e.bits,Ce){X.msg="invalid distances set",M.mode=30;break}if(M.mode=20,ke===6)break e;case 20:M.mode=21;case 21:if(6<=Ne&&258<=et){X.next_out=we,X.avail_out=et,X.next_in=Se,X.avail_in=Ne,M.hold=ee,M.bits=ae,m(X,it),we=X.next_out,lt=X.output,et=X.avail_out,Se=X.next_in,xe=X.input,Ne=X.avail_in,ee=M.hold,ae=M.bits,M.mode===12&&(M.back=-1);break}for(M.back=0;Jt=(W=M.lencode[ee&(1<<M.lenbits)-1])>>>16&255,$n=65535&W,!((Yt=W>>>24)<=ae);){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if(Jt&&!(240&Jt)){for(pn=Yt,mr=Jt,Nn=$n;Jt=(W=M.lencode[Nn+((ee&(1<<pn+mr)-1)>>pn)])>>>16&255,$n=65535&W,!(pn+(Yt=W>>>24)<=ae);){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}ee>>>=pn,ae-=pn,M.back+=pn}if(ee>>>=Yt,ae-=Yt,M.back+=Yt,M.length=$n,Jt===0){M.mode=26;break}if(32&Jt){M.back=-1,M.mode=12;break}if(64&Jt){X.msg="invalid literal/length code",M.mode=30;break}M.extra=15&Jt,M.mode=22;case 22:if(M.extra){for(K=M.extra;ae<K;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}M.length+=ee&(1<<M.extra)-1,ee>>>=M.extra,ae-=M.extra,M.back+=M.extra}M.was=M.length,M.mode=23;case 23:for(;Jt=(W=M.distcode[ee&(1<<M.distbits)-1])>>>16&255,$n=65535&W,!((Yt=W>>>24)<=ae);){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if(!(240&Jt)){for(pn=Yt,mr=Jt,Nn=$n;Jt=(W=M.distcode[Nn+((ee&(1<<pn+mr)-1)>>pn)])>>>16&255,$n=65535&W,!(pn+(Yt=W>>>24)<=ae);){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}ee>>>=pn,ae-=pn,M.back+=pn}if(ee>>>=Yt,ae-=Yt,M.back+=Yt,64&Jt){X.msg="invalid distance code",M.mode=30;break}M.offset=$n,M.extra=15&Jt,M.mode=24;case 24:if(M.extra){for(K=M.extra;ae<K;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}M.offset+=ee&(1<<M.extra)-1,ee>>>=M.extra,ae-=M.extra,M.back+=M.extra}if(M.offset>M.dmax){X.msg="invalid distance too far back",M.mode=30;break}M.mode=25;case 25:if(et===0)break e;if(Pe=it-et,M.offset>Pe){if((Pe=M.offset-Pe)>M.whave&&M.sane){X.msg="invalid distance too far back",M.mode=30;break}Gt=Pe>M.wnext?(Pe-=M.wnext,M.wsize-Pe):M.wnext-Pe,Pe>M.length&&(Pe=M.length),an=M.window}else an=lt,Gt=we-M.offset,Pe=M.length;for(et<Pe&&(Pe=et),et-=Pe,M.length-=Pe;lt[we++]=an[Gt++],--Pe;);M.length===0&&(M.mode=21);break;case 26:if(et===0)break e;lt[we++]=M.length,et--,M.mode=21;break;case 27:if(M.wrap){for(;ae<32;){if(Ne===0)break e;Ne--,ee|=xe[Se++]<<ae,ae+=8}if(it-=et,X.total_out+=it,M.total+=it,it&&(X.adler=M.check=M.flags?u(M.check,lt,it,we-it):l(M.check,lt,it,we-it)),it=et,(M.flags?ee:x(ee))!==M.check){X.msg="incorrect data check",M.mode=30;break}ae=ee=0}M.mode=28;case 28:if(M.wrap&&M.flags){for(;ae<32;){if(Ne===0)break e;Ne--,ee+=xe[Se++]<<ae,ae+=8}if(ee!==(4294967295&M.total)){X.msg="incorrect length check",M.mode=30;break}ae=ee=0}M.mode=29;case 29:Ce=1;break e;case 30:Ce=-3;break e;case 31:return-4;case 32:default:return b}return X.next_out=we,X.avail_out=et,X.next_in=Se,X.avail_in=Ne,M.hold=ee,M.bits=ae,(M.wsize||it!==X.avail_out&&M.mode<30&&(M.mode<27||ke!==4))&&We(X,X.output,X.next_out,it-X.avail_out)?(M.mode=31,-4):(Te-=X.avail_in,it-=X.avail_out,X.total_in+=Te,X.total_out+=it,M.total+=it,M.wrap&&it&&(X.adler=M.check=M.flags?u(M.check,lt,it,X.next_out-it):l(M.check,lt,it,X.next_out-it)),X.data_type=M.bits+(M.last?64:0)+(M.mode===12?128:0)+(M.mode===20||M.mode===15?256:0),(Te==0&&it===0||ke===4)&&Ce===_&&(Ce=-5),Ce)},o.inflateEnd=function(X){if(!X||!X.state)return b;var ke=X.state;return ke.window&&(ke.window=null),X.state=null,_},o.inflateGetHeader=function(X,ke){var M;return X&&X.state&&2&(M=X.state).wrap?((M.head=ke).done=!1,_):b},o.inflateSetDictionary=function(X,ke){var M,xe=ke.length;return X&&X.state?(M=X.state).wrap!==0&&M.mode!==11?b:M.mode===11&&l(1,ke,xe,0)!==M.check?-3:We(X,ke,xe,xe)?(M.mode=31,-4):(M.havedict=1,_):b},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,s,o){var a=r("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],m=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],v=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(I,$,_,b,T,k,R,x){var w,P,L,Y,oe,ie,be,ye,he,We=x.bits,X=0,ke=0,M=0,xe=0,lt=0,Se=0,we=0,Ne=0,et=0,ee=0,ae=null,Te=0,it=new a.Buf16(16),Pe=new a.Buf16(16),Gt=null,an=0;for(X=0;X<=15;X++)it[X]=0;for(ke=0;ke<b;ke++)it[$[_+ke]]++;for(lt=We,xe=15;1<=xe&&it[xe]===0;xe--);if(xe<lt&&(lt=xe),xe===0)return T[k++]=20971520,T[k++]=20971520,x.bits=1,0;for(M=1;M<xe&&it[M]===0;M++);for(lt<M&&(lt=M),X=Ne=1;X<=15;X++)if(Ne<<=1,(Ne-=it[X])<0)return-1;if(0<Ne&&(I===0||xe!==1))return-1;for(Pe[1]=0,X=1;X<15;X++)Pe[X+1]=Pe[X]+it[X];for(ke=0;ke<b;ke++)$[_+ke]!==0&&(R[Pe[$[_+ke]]++]=ke);if(ie=I===0?(ae=Gt=R,19):I===1?(ae=l,Te-=257,Gt=u,an-=257,256):(ae=m,Gt=v,-1),X=M,oe=k,we=ke=ee=0,L=-1,Y=(et=1<<(Se=lt))-1,I===1&&852<et||I===2&&592<et)return 1;for(;;){for(be=X-we,he=R[ke]<ie?(ye=0,R[ke]):R[ke]>ie?(ye=Gt[an+R[ke]],ae[Te+R[ke]]):(ye=96,0),w=1<<X-we,M=P=1<<Se;T[oe+(ee>>we)+(P-=w)]=be<<24|ye<<16|he|0,P!==0;);for(w=1<<X-1;ee&w;)w>>=1;if(w!==0?(ee&=w-1,ee+=w):ee=0,ke++,--it[X]==0){if(X===xe)break;X=$[_+R[ke]]}if(lt<X&&(ee&Y)!==L){for(we===0&&(we=lt),oe+=M,Ne=1<<(Se=X-we);Se+we<xe&&!((Ne-=it[Se+we])<=0);)Se++,Ne<<=1;if(et+=1<<Se,I===1&&852<et||I===2&&592<et)return 1;T[L=ee&Y]=lt<<24|Se<<16|oe-k|0}}return ee!==0&&(T[oe+ee]=X-we<<24|64<<16|0),x.bits=lt,0}},{"../utils/common":41}],51:[function(r,s,o){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,s,o){var a=r("../utils/common"),l=0,u=1;function m(W){for(var ue=W.length;0<=--ue;)W[ue]=0}var v=0,I=29,$=256,_=$+1+I,b=30,T=19,k=2*_+1,R=15,x=16,w=7,P=256,L=16,Y=17,oe=18,ie=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],be=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],he=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],We=new Array(2*(_+2));m(We);var X=new Array(2*b);m(X);var ke=new Array(512);m(ke);var M=new Array(256);m(M);var xe=new Array(I);m(xe);var lt,Se,we,Ne=new Array(b);function et(W,ue,Oe,Ve,ve){this.static_tree=W,this.extra_bits=ue,this.extra_base=Oe,this.elems=Ve,this.max_length=ve,this.has_stree=W&&W.length}function ee(W,ue){this.dyn_tree=W,this.max_code=0,this.stat_desc=ue}function ae(W){return W<256?ke[W]:ke[256+(W>>>7)]}function Te(W,ue){W.pending_buf[W.pending++]=255&ue,W.pending_buf[W.pending++]=ue>>>8&255}function it(W,ue,Oe){W.bi_valid>x-Oe?(W.bi_buf|=ue<<W.bi_valid&65535,Te(W,W.bi_buf),W.bi_buf=ue>>x-W.bi_valid,W.bi_valid+=Oe-x):(W.bi_buf|=ue<<W.bi_valid&65535,W.bi_valid+=Oe)}function Pe(W,ue,Oe){it(W,Oe[2*ue],Oe[2*ue+1])}function Gt(W,ue){for(var Oe=0;Oe|=1&W,W>>>=1,Oe<<=1,0<--ue;);return Oe>>>1}function an(W,ue,Oe){var Ve,ve,nt=new Array(R+1),gt=0;for(Ve=1;Ve<=R;Ve++)nt[Ve]=gt=gt+Oe[Ve-1]<<1;for(ve=0;ve<=ue;ve++){var Ye=W[2*ve+1];Ye!==0&&(W[2*ve]=Gt(nt[Ye]++,Ye))}}function Yt(W){var ue;for(ue=0;ue<_;ue++)W.dyn_ltree[2*ue]=0;for(ue=0;ue<b;ue++)W.dyn_dtree[2*ue]=0;for(ue=0;ue<T;ue++)W.bl_tree[2*ue]=0;W.dyn_ltree[2*P]=1,W.opt_len=W.static_len=0,W.last_lit=W.matches=0}function Jt(W){8<W.bi_valid?Te(W,W.bi_buf):0<W.bi_valid&&(W.pending_buf[W.pending++]=W.bi_buf),W.bi_buf=0,W.bi_valid=0}function $n(W,ue,Oe,Ve){var ve=2*ue,nt=2*Oe;return W[ve]<W[nt]||W[ve]===W[nt]&&Ve[ue]<=Ve[Oe]}function pn(W,ue,Oe){for(var Ve=W.heap[Oe],ve=Oe<<1;ve<=W.heap_len&&(ve<W.heap_len&&$n(ue,W.heap[ve+1],W.heap[ve],W.depth)&&ve++,!$n(ue,Ve,W.heap[ve],W.depth));)W.heap[Oe]=W.heap[ve],Oe=ve,ve<<=1;W.heap[Oe]=Ve}function mr(W,ue,Oe){var Ve,ve,nt,gt,Ye=0;if(W.last_lit!==0)for(;Ve=W.pending_buf[W.d_buf+2*Ye]<<8|W.pending_buf[W.d_buf+2*Ye+1],ve=W.pending_buf[W.l_buf+Ye],Ye++,Ve===0?Pe(W,ve,ue):(Pe(W,(nt=M[ve])+$+1,ue),(gt=ie[nt])!==0&&it(W,ve-=xe[nt],gt),Pe(W,nt=ae(--Ve),Oe),(gt=be[nt])!==0&&it(W,Ve-=Ne[nt],gt)),Ye<W.last_lit;);Pe(W,P,ue)}function Nn(W,ue){var Oe,Ve,ve,nt=ue.dyn_tree,gt=ue.stat_desc.static_tree,Ye=ue.stat_desc.has_stree,It=ue.stat_desc.elems,tn=-1;for(W.heap_len=0,W.heap_max=k,Oe=0;Oe<It;Oe++)nt[2*Oe]!==0?(W.heap[++W.heap_len]=tn=Oe,W.depth[Oe]=0):nt[2*Oe+1]=0;for(;W.heap_len<2;)nt[2*(ve=W.heap[++W.heap_len]=tn<2?++tn:0)]=1,W.depth[ve]=0,W.opt_len--,Ye&&(W.static_len-=gt[2*ve+1]);for(ue.max_code=tn,Oe=W.heap_len>>1;1<=Oe;Oe--)pn(W,nt,Oe);for(ve=It;Oe=W.heap[1],W.heap[1]=W.heap[W.heap_len--],pn(W,nt,1),Ve=W.heap[1],W.heap[--W.heap_max]=Oe,W.heap[--W.heap_max]=Ve,nt[2*ve]=nt[2*Oe]+nt[2*Ve],W.depth[ve]=(W.depth[Oe]>=W.depth[Ve]?W.depth[Oe]:W.depth[Ve])+1,nt[2*Oe+1]=nt[2*Ve+1]=ve,W.heap[1]=ve++,pn(W,nt,1),2<=W.heap_len;);W.heap[--W.heap_max]=W.heap[1],function(Xt,cr){var Xr,Qn,Bn,gn,er,Cr,Zt=cr.dyn_tree,Si=cr.max_code,on=cr.stat_desc.static_tree,po=cr.stat_desc.has_stree,tr=cr.stat_desc.extra_bits,Lr=cr.stat_desc.extra_base,Jr=cr.stat_desc.max_length,gr=0;for(gn=0;gn<=R;gn++)Xt.bl_count[gn]=0;for(Zt[2*Xt.heap[Xt.heap_max]+1]=0,Xr=Xt.heap_max+1;Xr<k;Xr++)Jr<(gn=Zt[2*Zt[2*(Qn=Xt.heap[Xr])+1]+1]+1)&&(gn=Jr,gr++),Zt[2*Qn+1]=gn,Si<Qn||(Xt.bl_count[gn]++,er=0,Lr<=Qn&&(er=tr[Qn-Lr]),Cr=Zt[2*Qn],Xt.opt_len+=Cr*(gn+er),po&&(Xt.static_len+=Cr*(on[2*Qn+1]+er)));if(gr!==0){do{for(gn=Jr-1;Xt.bl_count[gn]===0;)gn--;Xt.bl_count[gn]--,Xt.bl_count[gn+1]+=2,Xt.bl_count[Jr]--,gr-=2}while(0<gr);for(gn=Jr;gn!==0;gn--)for(Qn=Xt.bl_count[gn];Qn!==0;)Si<(Bn=Xt.heap[--Xr])||(Zt[2*Bn+1]!==gn&&(Xt.opt_len+=(gn-Zt[2*Bn+1])*Zt[2*Bn],Zt[2*Bn+1]=gn),Qn--)}}(W,ue),an(nt,tn,W.bl_count)}function j(W,ue,Oe){var Ve,ve,nt=-1,gt=ue[1],Ye=0,It=7,tn=4;for(gt===0&&(It=138,tn=3),ue[2*(Oe+1)+1]=65535,Ve=0;Ve<=Oe;Ve++)ve=gt,gt=ue[2*(Ve+1)+1],++Ye<It&&ve===gt||(Ye<tn?W.bl_tree[2*ve]+=Ye:ve!==0?(ve!==nt&&W.bl_tree[2*ve]++,W.bl_tree[2*L]++):Ye<=10?W.bl_tree[2*Y]++:W.bl_tree[2*oe]++,nt=ve,tn=(Ye=0)===gt?(It=138,3):ve===gt?(It=6,3):(It=7,4))}function Ce(W,ue,Oe){var Ve,ve,nt=-1,gt=ue[1],Ye=0,It=7,tn=4;for(gt===0&&(It=138,tn=3),Ve=0;Ve<=Oe;Ve++)if(ve=gt,gt=ue[2*(Ve+1)+1],!(++Ye<It&&ve===gt)){if(Ye<tn)for(;Pe(W,ve,W.bl_tree),--Ye!=0;);else ve!==0?(ve!==nt&&(Pe(W,ve,W.bl_tree),Ye--),Pe(W,L,W.bl_tree),it(W,Ye-3,2)):Ye<=10?(Pe(W,Y,W.bl_tree),it(W,Ye-3,3)):(Pe(W,oe,W.bl_tree),it(W,Ye-11,7));nt=ve,tn=(Ye=0)===gt?(It=138,3):ve===gt?(It=6,3):(It=7,4)}}m(Ne);var _e=!1;function K(W,ue,Oe,Ve){it(W,(v<<1)+(Ve?1:0),3),function(ve,nt,gt,Ye){Jt(ve),Te(ve,gt),Te(ve,~gt),a.arraySet(ve.pending_buf,ve.window,nt,gt,ve.pending),ve.pending+=gt}(W,ue,Oe)}o._tr_init=function(W){_e||(function(){var ue,Oe,Ve,ve,nt,gt=new Array(R+1);for(ve=Ve=0;ve<I-1;ve++)for(xe[ve]=Ve,ue=0;ue<1<<ie[ve];ue++)M[Ve++]=ve;for(M[Ve-1]=ve,ve=nt=0;ve<16;ve++)for(Ne[ve]=nt,ue=0;ue<1<<be[ve];ue++)ke[nt++]=ve;for(nt>>=7;ve<b;ve++)for(Ne[ve]=nt<<7,ue=0;ue<1<<be[ve]-7;ue++)ke[256+nt++]=ve;for(Oe=0;Oe<=R;Oe++)gt[Oe]=0;for(ue=0;ue<=143;)We[2*ue+1]=8,ue++,gt[8]++;for(;ue<=255;)We[2*ue+1]=9,ue++,gt[9]++;for(;ue<=279;)We[2*ue+1]=7,ue++,gt[7]++;for(;ue<=287;)We[2*ue+1]=8,ue++,gt[8]++;for(an(We,_+1,gt),ue=0;ue<b;ue++)X[2*ue+1]=5,X[2*ue]=Gt(ue,5);lt=new et(We,ie,$+1,_,R),Se=new et(X,be,0,b,R),we=new et(new Array(0),ye,0,T,w)}(),_e=!0),W.l_desc=new ee(W.dyn_ltree,lt),W.d_desc=new ee(W.dyn_dtree,Se),W.bl_desc=new ee(W.bl_tree,we),W.bi_buf=0,W.bi_valid=0,Yt(W)},o._tr_stored_block=K,o._tr_flush_block=function(W,ue,Oe,Ve){var ve,nt,gt=0;0<W.level?(W.strm.data_type===2&&(W.strm.data_type=function(Ye){var It,tn=4093624447;for(It=0;It<=31;It++,tn>>>=1)if(1&tn&&Ye.dyn_ltree[2*It]!==0)return l;if(Ye.dyn_ltree[18]!==0||Ye.dyn_ltree[20]!==0||Ye.dyn_ltree[26]!==0)return u;for(It=32;It<$;It++)if(Ye.dyn_ltree[2*It]!==0)return u;return l}(W)),Nn(W,W.l_desc),Nn(W,W.d_desc),gt=function(Ye){var It;for(j(Ye,Ye.dyn_ltree,Ye.l_desc.max_code),j(Ye,Ye.dyn_dtree,Ye.d_desc.max_code),Nn(Ye,Ye.bl_desc),It=T-1;3<=It&&Ye.bl_tree[2*he[It]+1]===0;It--);return Ye.opt_len+=3*(It+1)+5+5+4,It}(W),ve=W.opt_len+3+7>>>3,(nt=W.static_len+3+7>>>3)<=ve&&(ve=nt)):ve=nt=Oe+5,Oe+4<=ve&&ue!==-1?K(W,ue,Oe,Ve):W.strategy===4||nt===ve?(it(W,2+(Ve?1:0),3),mr(W,We,X)):(it(W,4+(Ve?1:0),3),function(Ye,It,tn,Xt){var cr;for(it(Ye,It-257,5),it(Ye,tn-1,5),it(Ye,Xt-4,4),cr=0;cr<Xt;cr++)it(Ye,Ye.bl_tree[2*he[cr]+1],3);Ce(Ye,Ye.dyn_ltree,It-1),Ce(Ye,Ye.dyn_dtree,tn-1)}(W,W.l_desc.max_code+1,W.d_desc.max_code+1,gt+1),mr(W,W.dyn_ltree,W.dyn_dtree)),Yt(W),Ve&&Jt(W)},o._tr_tally=function(W,ue,Oe){return W.pending_buf[W.d_buf+2*W.last_lit]=ue>>>8&255,W.pending_buf[W.d_buf+2*W.last_lit+1]=255&ue,W.pending_buf[W.l_buf+W.last_lit]=255&Oe,W.last_lit++,ue===0?W.dyn_ltree[2*Oe]++:(W.matches++,ue--,W.dyn_ltree[2*(M[Oe]+$+1)]++,W.dyn_dtree[2*ae(ue)]++),W.last_lit===W.lit_bufsize-1},o._tr_align=function(W){it(W,2,3),Pe(W,P,We),function(ue){ue.bi_valid===16?(Te(ue,ue.bi_buf),ue.bi_buf=0,ue.bi_valid=0):8<=ue.bi_valid&&(ue.pending_buf[ue.pending++]=255&ue.bi_buf,ue.bi_buf>>=8,ue.bi_valid-=8)}(W)}},{"../utils/common":41}],53:[function(r,s,o){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,s,o){(function(a){(function(l,u){if(!l.setImmediate){var m,v,I,$,_=1,b={},T=!1,k=l.document,R=Object.getPrototypeOf&&Object.getPrototypeOf(l);R=R&&R.setTimeout?R:l,m={}.toString.call(l.process)==="[object process]"?function(L){process.nextTick(function(){w(L)})}:function(){if(l.postMessage&&!l.importScripts){var L=!0,Y=l.onmessage;return l.onmessage=function(){L=!1},l.postMessage("","*"),l.onmessage=Y,L}}()?($="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",P,!1):l.attachEvent("onmessage",P),function(L){l.postMessage($+L,"*")}):l.MessageChannel?((I=new MessageChannel).port1.onmessage=function(L){w(L.data)},function(L){I.port2.postMessage(L)}):k&&"onreadystatechange"in k.createElement("script")?(v=k.documentElement,function(L){var Y=k.createElement("script");Y.onreadystatechange=function(){w(L),Y.onreadystatechange=null,v.removeChild(Y),Y=null},v.appendChild(Y)}):function(L){setTimeout(w,0,L)},R.setImmediate=function(L){typeof L!="function"&&(L=new Function(""+L));for(var Y=new Array(arguments.length-1),oe=0;oe<Y.length;oe++)Y[oe]=arguments[oe+1];var ie={callback:L,args:Y};return b[_]=ie,m(_),_++},R.clearImmediate=x}function x(L){delete b[L]}function w(L){if(T)setTimeout(w,0,L);else{var Y=b[L];if(Y){T=!0;try{(function(oe){var ie=oe.callback,be=oe.args;switch(be.length){case 0:ie();break;case 1:ie(be[0]);break;case 2:ie(be[0],be[1]);break;case 3:ie(be[0],be[1],be[2]);break;default:ie.apply(u,be)}})(Y)}finally{x(L),T=!1}}}}function P(L){L.source===l&&typeof L.data=="string"&&L.data.indexOf($)===0&&w(+L.data.slice($.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof xi<"u"?xi:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(I1);var mz=I1.exports;const gz=ex(mz);var $1={exports:{}};(function(e,t){(function(r,s){s()})(xi,function(){function r(v,I){return typeof I>"u"?I={autoBom:!1}:typeof I!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),I={autoBom:!I}),I.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(v.type)?new Blob(["\uFEFF",v],{type:v.type}):v}function s(v,I,$){var _=new XMLHttpRequest;_.open("GET",v),_.responseType="blob",_.onload=function(){m(_.response,I,$)},_.onerror=function(){console.error("could not download file")},_.send()}function o(v){var I=new XMLHttpRequest;I.open("HEAD",v,!1);try{I.send()}catch{}return 200<=I.status&&299>=I.status}function a(v){try{v.dispatchEvent(new MouseEvent("click"))}catch{var I=document.createEvent("MouseEvents");I.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),v.dispatchEvent(I)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof xi=="object"&&xi.global===xi?xi:void 0,u=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(v,I,$){var _=l.URL||l.webkitURL,b=document.createElement("a");I=I||v.name||"download",b.download=I,b.rel="noopener",typeof v=="string"?(b.href=v,b.origin===location.origin?a(b):o(b.href)?s(v,I,$):a(b,b.target="_blank")):(b.href=_.createObjectURL(v),setTimeout(function(){_.revokeObjectURL(b.href)},4e4),setTimeout(function(){a(b)},0))}:"msSaveOrOpenBlob"in navigator?function(v,I,$){if(I=I||v.name||"download",typeof v!="string")navigator.msSaveOrOpenBlob(r(v,$),I);else if(o(v))s(v,I,$);else{var _=document.createElement("a");_.href=v,_.target="_blank",setTimeout(function(){a(_)})}}:function(v,I,$,_){if(_=_||open("","_blank"),_&&(_.document.title=_.document.body.innerText="downloading..."),typeof v=="string")return s(v,I,$);var b=v.type==="application/octet-stream",T=/constructor/i.test(l.HTMLElement)||l.safari,k=/CriOS\/[\d]+/.test(navigator.userAgent);if((k||b&&T||u)&&typeof FileReader<"u"){var R=new FileReader;R.onloadend=function(){var P=R.result;P=k?P:P.replace(/^data:[^;]*;/,"data:attachment/file;"),_?_.location.href=P:location=P,_=null},R.readAsDataURL(v)}else{var x=l.URL||l.webkitURL,w=x.createObjectURL(v);_?_.location=w:location.href=w,_=null,setTimeout(function(){x.revokeObjectURL(w)},4e4)}});l.saveAs=m.saveAs=m,e.exports=m})})($1);var xz=$1.exports;(function(){const e=console.error,t=console.warn,r=console.log,s=o=>{for(let a of o){let l="";if(typeof a=="string"?l=a:a&&typeof a=="object"?a.message?l=a.message:a.toString?l=a.toString():l=JSON.stringify(a):a!=null&&(l=String(a)),l.includes("Unable to preventDefault inside passive event listener")||l.includes("passive event listener invocation")||l.includes("preventDefault")&&l.includes("passive"))return!0}return!1};console.error=function(...o){s(o)||e.apply(console,o)},console.warn=function(...o){s(o)||t.apply(console,o)},console.log=function(...o){s(o)||r.apply(console,o)}})();const yz=({canvasRef:e,isDrawing:t})=>{const[r,s]=D.useState(""),o=D.useRef(null),a=D.useCallback(()=>{e.current&&s(e.current.toDataURL())},[e]);return D.useEffect(()=>{e.current&&a()},[e,a]),D.useEffect(()=>{if(!t){a();return}const l=()=>{a(),t&&(o.current=requestAnimationFrame(l))};return o.current=requestAnimationFrame(l),()=>{o.current&&cancelAnimationFrame(o.current)}},[t,a]),r?i.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"rgba(255, 0, 0, 0.3)",mixBlendMode:"multiply",WebkitMaskImage:`url(${r})`,maskImage:`url(${r})`,WebkitMaskSize:"100% 100%",maskSize:"100% 100%",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}}):null},yi=(()=>{const e="tapnow_images_db",r="images";let s=null,o=null;const a=new Map,l=()=>o||(o=new Promise((b,T)=>{if(!window.indexedDB){console.warn("[LocalImageManager] IndexedDB not supported, falling back to memory"),b(null);return}const k=indexedDB.open(e,1);k.onerror=R=>{console.error("[LocalImageManager] IndexedDB init failed:",R.target.error),b(null)},k.onsuccess=R=>{s=R.target.result,console.log("[LocalImageManager] IndexedDB initialized"),b(s)},k.onupgradeneeded=R=>{const x=R.target.result;x.objectStoreNames.contains(r)||(x.createObjectStore(r,{keyPath:"id"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("[LocalImageManager] Object store created"))}}),o),u=()=>`img_${Date.now()}_${Math.random().toString(36).substring(2,9)}`;return{saveImage:async(b,T=null)=>{const k=await l();if(!k)return null;const R=T||u();return new Promise((x,w)=>{var P;try{let L;if(typeof b=="string"&&b.startsWith("data:")){const ye=b.split(","),he=((P=ye[0].match(/:(.*?);/))==null?void 0:P[1])||"image/png",We=atob(ye[1]),X=new Uint8Array(We.length);for(let ke=0;ke<We.length;ke++)X[ke]=We.charCodeAt(ke);L=new Blob([X],{type:he})}else if(b instanceof Blob)L=b;else{console.warn("[LocalImageManager] Invalid data type for saveImage"),x(null);return}const oe=k.transaction([r],"readwrite").objectStore(r),ie={id:R,blob:L,timestamp:Date.now(),size:L.size},be=oe.put(ie);be.onsuccess=()=>{x(R)},be.onerror=ye=>{console.error("[LocalImageManager] Save failed:",ye.target.error),x(null)}}catch(L){console.error("[LocalImageManager] Save error:",L),x(null)}})},getImage:async b=>{if(a.has(b))return a.get(b);const T=await l();return T?new Promise(k=>{try{const w=T.transaction([r],"readonly").objectStore(r).get(b);w.onsuccess=()=>{const P=w.result;if(P&&P.blob){const L=new FileReader;L.onloadend=()=>{const Y=L.result;a.set(b,Y),k(Y)},L.onerror=()=>{console.error("[LocalImageManager] Failed to convert blob to base64"),k(null)},L.readAsDataURL(P.blob)}else k(null)},w.onerror=()=>k(null)}catch(R){console.error("[LocalImageManager] Get error:",R),k(null)}}):null},deleteImage:async b=>{const T=await l();if(!T)return!1;if(a.has(b)){const k=a.get(b);k&&k.startsWith("blob:")&&URL.revokeObjectURL(k),a.delete(b)}return new Promise(k=>{const w=T.transaction([r],"readwrite").objectStore(r).delete(b);w.onsuccess=()=>k(!0),w.onerror=()=>k(!1)})},getStats:async()=>{const b=await l();return b?new Promise(T=>{const x=b.transaction([r],"readonly").objectStore(r).getAll();x.onsuccess=()=>{const w=x.result||[],P=w.reduce((L,Y)=>L+(Y.size||0),0);T({count:w.length,totalSize:P})},x.onerror=()=>T({count:0,totalSize:0})}):{count:0,totalSize:0}},isImageId:b=>typeof b=="string"&&b.startsWith("img_"),initDB:l}})();window.LocalImageManager=yi;const Vn=({src:e,className:t,alt:r,onError:s,onLoad:o,...a})=>{const[l,u]=D.useState(null),[m,v]=D.useState(!1),[I,$]=D.useState(!1),_=D.useRef(null);return D.useEffect(()=>{if(!e||e.startsWith("blob:")||e.startsWith("http://")||e.startsWith("https://")){u(e),$(!1);return}if(yi.isImageId(e)){$(!0),(async()=>{try{const T=await yi.getImage(e);T?(_.current=T,u(T)):(console.warn(`[LazyBase64Image] Image not found in IDB: ${e}`),v(!0))}catch(T){console.error("[LazyBase64Image] IDB resolve failed:",T),v(!0)}$(!1)})();return}return e.startsWith("data:")?(async()=>{try{const k=await(await fetch(e)).blob(),R=URL.createObjectURL(k);_.current=R,u(R)}catch(T){console.error("Base64Blob",T),v(!0),u(e)}})():u(e),()=>{_.current&&_.current.startsWith("blob:")&&(URL.revokeObjectURL(_.current),_.current=null)}},[e]),I||m&&!l||!l||yi.isImageId(l)?null:i.jsx("img",{src:l,className:t,alt:r,onError:s,onLoad:o,...a})},bz=({visible:e,progress:t,status:r,type:s})=>e?i.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40 backdrop-blur-[2px] animate-in fade-in duration-300 pointer-events-none select-none",children:i.jsxs("div",{className:"relative bg-[#09090b]/90 border border-white/10 rounded-2xl p-8 shadow-2xl flex flex-col items-center min-w-[300px] backdrop-blur-xl",children:[i.jsx("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 w-20 h-20 bg-blue-500/20 blur-[50px] rounded-full pointer-events-none"}),i.jsxs("div",{className:"flex flex-col items-center gap-1 mb-6 z-10",children:[i.jsx("span",{className:"font-mono text-[10px] tracking-[0.3em] uppercase text-zinc-500",children:s==="import"?"DATA INGESTION":"SYSTEM ARCHIVING"}),i.jsxs("div",{className:"text-4xl font-bold text-zinc-200 tracking-tighter font-sans",children:[t.toFixed(0),i.jsx("span",{className:"text-sm text-zinc-500 ml-1",children:"%"})]})]}),i.jsx("div",{className:"relative w-full h-[2px] bg-zinc-800 rounded-full overflow-hidden mb-4",children:i.jsx("div",{className:"absolute top-0 left-0 h-full bg-white shadow-[0_0_10px_rgba(255,255,255,0.5)] transition-all duration-100 ease-linear",style:{width:`${t}%`}})}),i.jsx("span",{className:"text-[10px] font-mono text-zinc-400 tracking-widest uppercase animate-pulse",children:r})]})}):null,Bg=D.memo(({item:e,theme:t,lightboxItem:r,onDelete:s,onClick:o,onContextMenu:a,onImageClick:l,onImageContextMenu:u,onRefresh:m,performanceMode:v,localServerUrl:I,localCacheServerConnected:$,onCacheMissing:_,isSelected:b,onSelect:T,providers:k,defaultProviders:R})=>{var be,ye;const x=e.localCacheUrl||(e.localCacheMap?Object.values(e.localCacheMap)[0]:null),w=!!($&&x),P=e.thumbnailUrl||null,L=he=>w?x:P||he,[Y,oe]=D.useState(null);D.useEffect(()=>{const he=e.url||e.originalUrl||e.mjOriginalUrl;oe(w?x:he)},[e.url,e.originalUrl,e.mjOriginalUrl,w,x]);const ie=D.useRef({url:null,time:0});return D.useEffect(()=>{if(!w||!x)return;const he=Date.now();ie.current.url===x&&he-ie.current.time<1e4||(ie.current={url:x,time:he},fetch(x,{method:"HEAD"}).then(We=>{We.ok||_&&_(e.id,x)}).catch(()=>{_&&_(e.id,x)}))},[w,x,e.id,_]),i.jsxs("div",{className:`group rounded-lg overflow-hidden border relative cursor-pointer transition-colors ${b?"border-blue-500 ring-2 ring-blue-500/30":t==="dark"?"bg-zinc-900 border-zinc-800 hover:border-blue-500/50":"bg-white border-zinc-200 hover:border-blue-500/50"}`,style:{contentVisibility:"auto",containIntrinsicSize:"1px 300px"},onClick:o,onContextMenu:a,children:[w&&i.jsx("div",{className:"absolute top-1 left-1 z-10 px-1 py-0.5 rounded text-[8px] bg-black/60 text-green-300",children:""}),!w&&v!=="off"&&P&&i.jsx("div",{className:`absolute top-1 left-1 z-10 px-1 py-0.5 rounded text-[8px] bg-black/60 ${v==="ultra"?"text-orange-400":"text-zinc-400"}`,children:v==="ultra"?"":""}),T&&i.jsx("button",{onClick:he=>{he.stopPropagation(),he.preventDefault(),T(e.id)},className:`absolute bottom-2 right-2 z-20 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all ${b?"bg-green-500 border-green-400 opacity-100":"border-white/60 bg-black/50 opacity-100 hover:bg-black/70"}`,title:b?"":"",children:b&&i.jsx(Ol,{size:16,className:"text-white"})}),i.jsxs("div",{className:`bg-black relative ${e.mjImages&&(e.mjImages.length===4||e.mjImages.length>1)||e.mjNeedsSplit&&((ye=(be=e.apiConfig)==null?void 0:be.modelId)!=null&&ye.includes("mj"))?(()=>{const he=e.mjRatio||"1:1";return he==="16:9"?"aspect-video":he==="9:16"?"aspect-[9/16]":he==="4:3"?"aspect-[4/3]":he==="3:4"?"aspect-[3/4]":he==="21:9"?"aspect-[21/9]":"aspect-square"})():"aspect-video"}`,children:[e.status==="completed"?e.mjImages&&(e.mjImages.length===4||e.mjImages.length>1)?i.jsx("div",{className:`w-full h-full grid gap-0.5 p-0.5 ${e.mjImages.length===4?"grid-cols-2 grid-rows-2":"grid-cols-2"}`,children:e.mjImages.map((he,We)=>{e.mjImageInfo&&e.mjImageInfo[We];const ke=($&&e.localCacheMap?e.localCacheMap[he]:null)||(e.mjThumbnails&&e.mjThumbnails[We]?e.mjThumbnails[We]:he);return i.jsxs("div",{onClick:M=>l&&l(M,e,he,We),onContextMenu:M=>u&&u(M,e,he,We),className:`relative w-full h-full cursor-pointer border-2 transition-all overflow-hidden ${e.selectedMjImageIndex===We&&r&&r.id===e.id?"border-blue-500 scale-95":"border-transparent hover:border-blue-500/50"}`,children:[i.jsx(Vn,{src:ke,loading:"lazy",className:"w-full h-full object-contain",alt:` ${We+1}`,onError:M=>{console.error(` ${We+1} `),_&&_(e.id,ke),M.target.style.display="none"}}),e.selectedMjImageIndex===We&&r&&r.id===e.id&&i.jsx("div",{className:"absolute top-1 right-1 w-3 h-3 bg-blue-500 rounded-full flex items-center justify-center z-10",children:i.jsx("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},We)})}):e.type==="image"?i.jsx(Vn,{src:L(e.url||e.originalUrl||e.mjOriginalUrl),loading:"lazy",className:"w-full h-full object-cover",alt:e.prompt||"",onError:he=>{console.error(":",e.url||e.originalUrl||e.mjOriginalUrl),_&&_(e.id,L(e.url||e.originalUrl||e.mjOriginalUrl)),he.target.style.display="none"}}):i.jsx("video",{src:Y||e.url||e.originalUrl,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,preload:"metadata",onError:()=>{const he=e.url||e.originalUrl||e.mjOriginalUrl;w&&he&&Y===x?(oe(he),_&&_(e.id,x)):console.error(":",he)}}):i.jsx("div",{className:"w-full h-full flex items-center justify-center",children:i.jsx(hi,{className:"animate-spin text-zinc-600"})}),i.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-zinc-800",children:i.jsx("div",{className:"h-full bg-blue-500 transition-all",style:{width:`${e.progress}%`}})})]}),i.jsxs("div",{className:"px-3 py-2 text-[11px]",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx("span",{className:`line-clamp-2 ${t==="dark"?"text-zinc-300":"text-zinc-700"}`,children:e.prompt||"Untitled"}),i.jsxs("div",{className:"flex items-center gap-1 shrink-0 ml-1",children:[e.type==="video"&&(e.status==="generating"||e.status==="failed")&&i.jsx("button",{onClick:he=>{he.stopPropagation(),m&&m(e)},className:`shrink-0 p-0.5 ${t==="dark"?"text-zinc-500 hover:text-white":"text-zinc-400 hover:text-zinc-900"}`,title:"",children:i.jsx(Bu,{size:12})}),i.jsx("button",{onClick:he=>{he.stopPropagation(),s&&s(e.id)},className:`shrink-0 p-0.5 ${t==="dark"?"text-zinc-500 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,title:"",children:i.jsx(Os,{size:12})})]})]}),e.status==="failed"&&e.errorMsg&&i.jsx("p",{className:"text-[9px] text-red-500 mt-1 break-words whitespace-pre-wrap",children:e.errorMsg.split(`
`).map((he,We)=>i.jsxs("span",{children:[he,We<e.errorMsg.split(`
`).length-1&&i.jsx("br",{})]},We))}),e.status==="generating"&&i.jsx("p",{className:"text-[9px] text-blue-500 mt-1",children:e.errorMsg||"..."}),i.jsx("div",{className:"h-1.5"}),i.jsxs("div",{className:"flex flex-col w-full",children:[i.jsx("span",{className:t==="dark"?"text-zinc-500":"text-zinc-400",children:(()=>{const he=e.hasInputImages===!0,We=e.type==="video",X=We?he?"":"":he?"":"",ke=e.resolution||(e.width&&e.height?`${e.width}x${e.height}`:null);return[X,e.ratio||e.mjRatio,ke,We&&e.duration?`${e.duration}s`:null].filter(Boolean).join("  ")})()}),i.jsxs("span",{className:t==="dark"?"text-zinc-500":"text-zinc-400",children:[e.time,"  ",i.jsx("span",{title:e.provider,children:e.modelName}),typeof e.durationMs=="number"&&e.durationMs>0&&i.jsxs(i.Fragment,{children:["   ",(e.durationMs/1e3).toFixed(1),"s"]})]})]})]})]})},(e,t)=>{var r,s;return e.item===t.item&&e.theme===t.theme&&((r=e.lightboxItem)==null?void 0:r.id)===((s=t.lightboxItem)==null?void 0:s.id)&&e.isSelected===t.isSelected}),vz=({nodeId:e,imageUrl:t,imageDimensions:r,isActive:s,onClose:o,onSave:a,theme:l,view:u,maskContent:m,onUpdateNode:v})=>{const I=D.useRef(null),$=D.useRef(null),_=D.useRef(null),[b,T]=D.useState(30),[k,R]=D.useState(!1),[x,w]=D.useState([]),[P,L]=D.useState(-1),Y=10;D.useEffect(()=>{if(!s||!I.current||!r)return;const xe=I.current,lt=xe.getContext("2d");if($.current=lt,xe.width=r.w,xe.height=r.h,lt.clearRect(0,0,xe.width,xe.height),m){const Se=new Image;Se.onload=()=>{lt.drawImage(Se,0,0),oe()},Se.src=m}else oe()},[s,r,e,m]);const oe=()=>{if(!I.current||!$.current)return;const xe=I.current,Se=$.current.getImageData(0,0,xe.width,xe.height),we=x.slice(0,P+1);we.push(Se),we.length>Y&&we.shift(),w(we),L(we.length-1)},ie=xe=>{if(!I.current)return null;const lt=I.current,Se=lt.getBoundingClientRect(),we=xe.clientX-Se.left,Ne=xe.clientY-Se.top,et=lt.width/Se.width,ee=lt.height/Se.height;return{x:Math.round(we*et),y:Math.round(Ne*ee)}},be=xe=>{if(!k||!I.current||!$.current)return;const lt=ie(xe);if(!lt)return;const Se=$.current;Se.globalCompositeOperation="source-over",Se.strokeStyle="#FFFFFF",Se.fillStyle="#FFFFFF",Se.lineWidth=b,Se.lineCap="round",Se.lineJoin="round",_.current?(Se.beginPath(),Se.moveTo(_.current.x,_.current.y),Se.lineTo(lt.x,lt.y),Se.stroke()):(Se.beginPath(),Se.arc(lt.x,lt.y,b/2,0,Math.PI*2),Se.fill()),_.current=lt},ye=xe=>{xe.button===0&&(xe.preventDefault(),xe.stopPropagation(),_.current=null,R(!0),oe(),be(xe))},he=xe=>{k&&(xe.preventDefault(),xe.stopPropagation(),be(xe))},We=xe=>{k&&(xe.preventDefault(),xe.stopPropagation(),R(!1),_.current=null,oe())},X=()=>{if(P<=0||!I.current||!$.current)return;const xe=P-1;L(xe),$.current.putImageData(x[xe],0,0)},ke=()=>{if(!I.current||!$.current)return;$.current.clearRect(0,0,I.current.width,I.current.height),oe()},M=()=>{if(!I.current)return;const lt=I.current.toDataURL("image/png");v&&v(e,{maskContent:lt,isMasking:!1}),a&&a(lt),o&&o()};return D.useEffect(()=>{if(!s)return;const xe=lt=>{(lt.ctrlKey||lt.metaKey)&&lt.key==="z"&&!lt.shiftKey&&(lt.preventDefault(),X())};return window.addEventListener("keydown",xe),()=>window.removeEventListener("keydown",xe)},[s,P,x]),!s||!t||!r?null:i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"absolute inset-0 z-50 pointer-events-auto",style:{mixBlendMode:"normal"},onMouseDown:xe=>xe.stopPropagation(),onMouseMove:xe=>xe.stopPropagation(),onMouseUp:xe=>xe.stopPropagation(),children:[i.jsx("canvas",{ref:I,className:"absolute inset-0 w-full h-full",style:{opacity:.5,mixBlendMode:"multiply",cursor:"crosshair",pointerEvents:"auto",imageRendering:"pixelated"},onMouseDown:ye,onMouseMove:he,onMouseUp:We,onMouseLeave:We}),i.jsx(yz,{canvasRef:I,isDrawing:k})]}),f1.createPortal(i.jsxs("div",{className:`fixed bottom-4 left-1/2 -translate-x-1/2 flex flex-row items-center gap-4 p-2 rounded-full border backdrop-blur-md shadow-xl z-[9999] ${l==="dark"?"bg-zinc-900/90 border-zinc-700 text-zinc-200":"bg-white/90 border-zinc-300 text-zinc-800"}`,onMouseDown:xe=>xe.stopPropagation(),children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-[10px] font-medium whitespace-nowrap",children:""}),i.jsx("input",{type:"range",min:"10",max:"150",value:b,onChange:xe=>T(Number(xe.target.value)),className:"w-20",onMouseDown:xe=>xe.stopPropagation()}),i.jsxs("span",{className:"text-[10px] w-8 text-right whitespace-nowrap",children:[b,"px"]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:X,disabled:P<=0,className:`p-1.5 rounded-full transition-colors ${l==="dark"?"hover:bg-zinc-800 disabled:opacity-50 disabled:cursor-not-allowed":"hover:bg-zinc-100 disabled:opacity-50 disabled:cursor-not-allowed"}`,title:" (Ctrl+Z)",children:i.jsx(pz,{size:14})}),i.jsx("button",{onClick:ke,className:`p-1.5 rounded-full transition-colors ${l==="dark"?"hover:bg-zinc-800":"hover:bg-zinc-100"}`,title:"",children:i.jsx(E1,{size:14})}),i.jsx("button",{onClick:M,className:"p-1.5 rounded-full bg-blue-600 hover:bg-blue-500 text-white transition-colors",title:"/",children:i.jsx(Ll,{size:14})})]})]}),document.body)]})},wz=`
        /*  */
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }
        
        /*  */
        #canvas-bg {
            transform: translateZ(0);
            backface-visibility: hidden;
            perspective: 1000px;
        }
        
        /*  */
        #canvas-bg > div[style*="transform"] {
            transform: translateZ(0);
            will-change: transform;
        }
        
        /*  */
        .node-wrapper {
            transform: translateZ(0);
            backface-visibility: hidden;
            contain: layout style;
            will-change: transform, left, top;
        }
        
        /*  -  */
        .node-wrapper img,
        .node-wrapper video {
            image-rendering: auto;
            image-rendering: -webkit-optimize-contrast;
            transform: translateZ(0);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            pointer-events: none;
        }
        
        /*  */
        svg {
            shape-rendering: geometricPrecision;
            text-rendering: optimizeLegibility;
        }
        
        /*  */
        .perf-mode .node-wrapper {
            box-shadow: none !important;
            backdrop-filter: none !important;
            border-radius: 0 !important;
            transition: none !important;
        }
        .perf-mode .connection-group {
            opacity: 1 !important;
        }
        
        /*  */
        .interacting .node-wrapper img {
            image-rendering: pixelated;
        }
        .interacting .connection-group {
            display: none;
            pointer-events: none;
        }
        
        .custom-scrollbar::-webkit-scrollbar { width: 4px; height: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 2px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #52525b; }
        .resize-handle { cursor: nwse-resize; opacity: 0; transition: opacity 0.2s; }
        .node-wrapper:hover .resize-handle { opacity: 1; }
        
        /*  */
        .connector { position: absolute; top: 50%; transform: translateY(-50%); width: 0.9rem; height: 0.9rem; background-color: #27272a; border: 1px solid #71717a; color: #a1a1aa; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: crosshair; transition: all 0.2s; z-index: 30; opacity: 0; pointer-events: auto; }
        .node-wrapper:hover .connector { opacity: 1; }
        .connector:hover, .connector.active { background-color: #d4d4d8; border-color: #fff; transform: translateY(-50%) scale(1.2); opacity: 1; color: #000; }
        .connector-right { right: -0.45rem; }
        
        /*  */
        .input-point { position: absolute; top: 50%; transform: translateY(-50%); left: -0.25rem; width: 0.5rem; height: 0.5rem; background-color: #52525b; border-radius: 50%; border: 1px solid #18181b; transition: all 0.2s; z-index: 20; cursor: crosshair; }
        .node-wrapper:hover .input-point { background-color: #a1a1aa; }
        .input-point.connected { background-color: #60a5fa; box-shadow: 0 0 6px #60a5fa; }
        .input-point.active { background-color: #60a5fa; border-color: #fff; transform: translateY(-50%) scale(1.3); box-shadow: 0 0 8px #60a5fa; }

        /* Lightbox & Overlay */
        .lightbox-overlay { background-color: rgba(0, 0, 0, 0.95); backdrop-filter: blur(5px); }
        
        /* Stack Items */
        .thumb-stack-item {
             transition: transform 0.2s, z-index 0.2s;
        }
        .thumb-stack-item:hover {
            transform: scale(1.1) translateY(-2px);
            z-index: 10 !important;
            border-color: #60a5fa;
        }

        /*  */
        .connection-delete {
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: auto; /*  */
        }
        /*  */
        .connection-group:hover .connection-delete {
            opacity: 1;
        }

        /*  */
        .drop-zone {
            border: 2px dashed transparent;
            transition: all 0.3s;
        }
        .drop-zone.drag-over {
            border-color: #60a5fa;
            background-color: rgba(96, 165, 250, 0.1);
        }

        /* Markdown Styles for Chat */
        .markdown-body { font-size: 13px; line-height: 1.5; color: #e4e4e7; word-wrap: break-word; user-select: text !important; cursor: text; }
        .markdown-body * { user-select: text !important; cursor: text; }
        .markdown-body pre { background: #27272a; padding: 10px; border-radius: 6px; overflow-x: auto; margin: 8px 0; white-space: pre-wrap; word-wrap: break-word; user-select: text !important; cursor: text; }
        .markdown-body code { font-family: monospace; background: #3f3f46; padding: 2px 4px; border-radius: 4px; font-size: 12px; user-select: text !important; cursor: text; }
        .markdown-body pre code { background: transparent; padding: 0; color: #a1a1aa; user-select: text !important; cursor: text; }
        .markdown-body p { margin-bottom: 8px; user-select: text !important; cursor: text; }
        .markdown-body ul, .markdown-body ol { margin-left: 20px; margin-bottom: 8px; list-style: disc; user-select: text !important; cursor: text; }
        .markdown-body li { user-select: text !important; cursor: text; }
        .markdown-body video { max-width: 100%; border-radius: 0.5rem; margin-top: 0.5rem; }
        .markdown-body table { border-collapse: collapse; width: 100%; margin: 12px 0; }
        .markdown-body table th, .markdown-body table td { border: 1px solid #3f3f46; padding: 8px 12px; text-align: left; }
        .markdown-body table th { background-color: #3f3f46; font-weight: 600; }
        .markdown-body table tr:nth-child(even) { background-color: #27272a; }
        .theme-light .markdown-body table th, .theme-light .markdown-body table td { border-color: #d4d4d8; }
        .theme-light .markdown-body table th { background-color: #e4e4e7; }
        .theme-light .markdown-body table tr:nth-child(even) { background-color: #f4f4f5; }
        .theme-light .markdown-body { color: #18181b; }
        .theme-light .markdown-body pre { background: #f4f4f5; color: #18181b; }
        .theme-light .markdown-body code { background: #e4e4e7; color: #18181b; }
        .theme-light .markdown-body pre code { color: #18181b; }
        `,kz=4e3,zz=4e3,xr="https://ai.comfly.chat",jz="http://localhost:5100",qp={openai:{key:"",url:xr},google:{key:"",url:xr},deepseek:{key:"",url:xr},flux:{key:"",url:xr},midjourney:{key:"",url:"https://api.midjourney.com"},jimeng:{key:"",url:jz},grok:{key:"",url:"https://ai.t8star.cn"}},Wg=[{id:"gpt-5.1",provider:"openai",type:"Chat"},{id:"gpt-5.2",provider:"openai",type:"Chat"},{id:"gpt-4o",provider:"openai",type:"Chat"},{id:"deepseek-v3-1-250821",provider:"deepseek",type:"Chat"},{id:"gemini-3-pro-preview",provider:"google",type:"Chat"},{id:"MJ V6",provider:"midjourney",type:"Image"},{id:"flux-kontext-pro",provider:"flux",type:"Image"},{id:"gpt-4o-image",provider:"openai",type:"Image"},{id:"jimeng-4.5",provider:"jimeng",type:"Image"},{id:"jimeng-4.1",provider:"jimeng",type:"Image"},{id:"jimeng-4.0",provider:"jimeng",type:"Image"},{id:"jimeng-3.1",provider:"jimeng",type:"Image"},{id:"jimeng-3.0",provider:"jimeng",type:"Image"},{id:"jimeng-2.1",provider:"jimeng",type:"Image"},{id:"jimeng-xl-pro",provider:"jimeng",type:"Image"},{id:"nanobananapro",provider:"jimeng",type:"Image"},{id:"nanobanana",provider:"jimeng",type:"Image"},{id:"sora-2",provider:"openai",type:"Video",durations:["5s","10s"]},{id:"sora-2-pro",provider:"openai",type:"Video",durations:["15s","25s"]},{id:"jimeng-video-3.5-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-veo3",provider:"jimeng",type:"Video",durations:["8s"]},{id:"jimeng-video-veo3.1",provider:"jimeng",type:"Video",durations:["8s"]},{id:"jimeng-video-sora2",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-3.0-fast",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-2.0-pro",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"jimeng-video-2.0",provider:"jimeng",type:"Video",durations:["5s","10s"]},{id:"grok-video-3",provider:"grok",type:"Video",durations:["8s","5s"]}],t0=["Auto","1:1","16:9","9:16","4:3","3:4","21:9","3:2","2:3"],Nz=["3:2","2:3","1:1"],M1=["1080P","720P"],Hg="tapnow_prompt_library",Vg="3x3 gridKeep character strictly consistent9Character Sheet",Kg="UpscaleSharpeningDenoisingBest quality, 8k, masterpiece, highres, ultra detailed, sharp focus, image restoration, upscale, faithful to original.",Yg=`you are a veteran Hollywood storyboard artist with years of experience. You have the ability to accurately analyze character features and scene characteristics based on images. Provide me with the most suitable camera angles and storyboards. Strictly base this on the uploaded character and scene images, while maintaining a consistent visual style.

MANDATORY LAYOUT: Create a precise 3x3 GRID containing exactly 9 distinct panels.

- The output image MUST be a single image divided into a 3 (rows) by 3 (columns) matrix.
- There must be EXACTLY 3 horizontal rows and 3 vertical columns.
- Each panel must be completely separated by a thin, distinct, solid black line.
- DO NOT create a collage. DO NOT overlap images. DO NOT create random sizes. 
- The grid structure must be perfectly aligned for slicing.

Subject Content: "[]"

Styling Instructions:
- Each panel shows the SAME subject/scene from a DIFFERENT angle (e.g., Front, Side, Back, Action, Close-up).
- Maintain perfect consistency of the character/object across all panels.
- Cinematic lighting, high fidelity, 8k resolution.

Negative Constraints:
- No text, no captions, no UI elements.
- No watermarks.
- No broken grid lines.`,Gg=`(strictly mimic source image art style:1.5), (same visual style:1.4),
score_9, score_8_up, masterpiece, best quality, (character sheet:1.4), (reference sheet:1.3), (consistent art style:1.3), matching visual style, 

[Structure & General Annotations]:
multiple views, full body central figure, clean background, 
(heavy annotation:1.4), (text labels with arrows:1.3), handwriting, data readout,

[SPECIAL CHARACTER DESCRIPTION AREA]:
(prominent character profile text box:1.6), (dedicated biography section:1.5), large descriptive text block,
[],

[Clothing Breakdown]:
(clothing breakdown:1.5), (outfit decomposition:1.4), garment analysis, (floating apparel:1.3), 
displaying outerwear, displaying upper body garment, displaying lower body garment, 

[Footwear Focus]:
(detailed footwear display:1.5), (floating shoes:1.4), shoe design breakdown, focus on shoes, 

[Inventory & Details]:
(inventory knolling:1.2), open container, personal accessories, organized items display, expression panels`,Xg=`# Directive: Create a "Rich Narrative Mood Board" (8-Grid Layout)

## 1. PROJECT INPUT 

**A. [Story & Concept / ]**
> []

**B. [Key Symbols /  (Optional)]**
> []

**C. [Color Preferences /  (Optional)]**
> []

**D. [Reference Images / ]**
> (See attached images / )

---

## 2. Role Definition
Act as a **Senior Art Director**. Synthesize the Input above into a single, cohesive, high-density **Visual Mood Board** using a complex **8-Panel Asymmetrical Grid Layout**.

## 3. Layout Mapping (Strict Adherence)
You must design a visual composition that tells the story through **8 distinct panels** within one image. **Do not** generate random grids. Map the content exactly as follows:

* **Panel 1 (The World):** A wide, cinematic establishing shot of the environment (based on Input A).
* **Panel 2 (The Protagonist):** A portrait close-up (based on reference images), focusing on micro-expressions.
* **Panel 3 (The Metaphor):** An **abstract symbolic object** representing the core theme (based on Input B).
* **Panel 4 (The Palette):** A graphical **Color Palette Strip** showcasing 5 specific colors extracted from the scene.
* **Panel 5 (The Texture):** Extreme macro close-up of a material surface (e.g., rust, skin, fabric) to add tactile richness.
* **Panel 6 (The Motion):** A motion-blurred or long-exposure shot representing time/chaos.
* **Panel 7 (The Detail):** A focused shot of a specific prop or accessory relevant to the plot.
* **Panel 8 (The AI Art Interpretation - CRITICAL):** This is your **free creative space**. Generate an artistic, surreal, or abstract re-interpretation of the story's emotion. **Do not just copy the inputs.** Create a "Vibe Image" (e.g., Double Exposure, Oil Painting style, or abstract geometry) that captures the *soul* of the narrative.

## 4. Execution Requirements
* **Composition Style:** High-end Editorial / Magazine Layout. Clean, thin white borders.
* **Visual Unity:** All panels must share the same lighting conditions and color grading logic (Unified Aesthetic).
* **Task:** Provide the **Final English Image Prompt** that explicitly describes this 8-grid layout, ensuring Panel 8 stands out as an artistic variation.`,Jg=["gemini-image","qwen-image","doubao-seedream","jimeng","hailuo-02","kling-v1-6","wan-2.5"],Zg=e=>e&&e.includes("grok")?Nz:t0,qg=["Auto","1K","2K","4K"],Tl=e=>{const t=String(e||"").toUpperCase();return t==="AUTO"?"Auto":t==="1K"?"1K":t==="2K"?"2K":t==="4K"?"4K":"2K"},_z=["Auto",...M1],Ul=e=>{const t=String(e||"").trim();if(!t)return"720P";if(t==="")return"Auto";const r=t.toUpperCase();return r==="AUTO"?"Auto":r==="1080P"?"1080P":"720P"},_u=e=>{const t=Ul(e);return t==="Auto"?"":t==="1080P"?"1080p":"720p"},Qp=e=>e&&e.includes("jimeng-4.5")?["2K","4K"]:qg,ef=[{label:"MJ V7",value:"--v 7"},{label:"MJ V6.1",value:"--v 6.1"},{label:"MJ V6",value:"--v 6"},{label:"MJ V5.2",value:"--v 5.2"},{label:"MJ V5.1",value:"--v 5.1"},{label:"Niji V6",value:"--niji 6"},{label:"Niji V5",value:"--niji 5"},{label:"Niji V4",value:"--niji 4"}],T1=(e,t)=>{let r=1024,s=1024;if(t==="1080P"?(r=1920,s=1080):t==="720P"?(r=1280,s=720):t==="2K"?(r=2048,s=2048):t==="4K"&&(r=3840,s=2160),e==="Auto")return{str:`${r}x${s}`,w:r,h:s};const[o,a]=e.split(":").map(Number);if(!o||!a)return{str:"1024x1024",w:1024,h:1024};let l,u;return Math.abs(o-a)<.1?(l=r,u=s):o>a?(l=t==="Auto"||t==="1K"?1280:r,u=Math.round(l*(a/o))):(u=t==="Auto"||t==="1K"?1280:r,l=Math.round(u*(o/a))),l=Math.round(l/16)*16,u=Math.round(u/16)*16,{str:`${l}x${u}`,w:l,h:u}},Sz=(e,t,r)=>{const{str:s,w:o,h:a}=T1(t,r);return e.includes("minimax")?{sizeStr:r==="4K"?"1080p":"720p",w:o,h:a}:e.includes("jimeng")||e.includes("veo")?{sizeStr:t,w:o,h:a}:e.includes("grok")?{sizeStr:t,w:o,h:a}:{sizeStr:s,w:o,h:a}},Wr=e=>new Promise((t,r)=>{const s=new Image;s.onload=()=>t({w:s.naturalWidth,h:s.naturalHeight}),s.onerror=()=>r(new Error("Failed to load image")),s.src=e}),Un=e=>{if(!e)return!1;if(e.startsWith("data:video")||e.includes("force_video_display=true"))return!0;const t=e.split(".").pop().split("?")[0].toLowerCase();return["mp4","webm","ogg","mov"].includes(t)},Qg=e=>new Promise((t,r)=>{const s=document.createElement("video");s.preload="metadata",s.muted=!0,s.playsInline=!0,s.onloadedmetadata=()=>{t({duration:Number(s.duration)||0,w:s.videoWidth||0,h:s.videoHeight||0})},s.onerror=()=>r(new Error("")),s.src=e}),Cz=(e,{fps:t=2}={})=>new Promise((r,s)=>{const o=document.createElement("video"),a=document.createElement("canvas"),l=a.getContext("2d");o.muted=!0,o.playsInline=!0,o.crossOrigin="anonymous",o.src=e;const u=[],m=()=>s(new Error(""));o.onerror=m,o.onloadedmetadata=()=>{const v=Number(o.duration)||0;if(!v||!isFinite(v)){s(new Error(""));return}a.width=o.videoWidth||1280,a.height=o.videoHeight||720;const I=1/Math.max(.1,t);let $=0;const _=()=>{l.drawImage(o,0,0,a.width,a.height),u.push({time:Number($.toFixed(2)),url:a.toDataURL("image/jpeg",.82)}),$+=I,$<=v?o.currentTime=Math.min($,v):r(u)};o.onseeked=_,o.currentTime=0}}),Ez=xd.memo(({img1:e,img2:t})=>{const[r,s]=D.useState(50),o=D.useRef(null),[a,l]=D.useState(!1),u=D.useRef(),m=D.useCallback($=>{o.current&&(u.current||(u.current=requestAnimationFrame(()=>{if(!o.current)return;const _=o.current.getBoundingClientRect(),b=$.touches?$.touches[0].clientX:$.clientX,T=Math.max(0,Math.min(b-_.left,_.width));s(T/_.width*100),u.current=null})))},[]);D.useEffect(()=>()=>{u.current&&cancelAnimationFrame(u.current)},[]);const v=e,I=t||e;return v?i.jsxs("div",{ref:o,className:"relative w-full h-full cursor-col-resize overflow-hidden group rounded-lg select-none shadow-2xl border border-zinc-800 bg-[#09090b]",onMouseMove:m,onTouchMove:m,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[i.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none",style:{backgroundImage:"conic-gradient(#333 90deg, transparent 90deg), conic-gradient(transparent 90deg, #333 90deg)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"}}),i.jsx("img",{src:v,loading:"lazy",decoding:"async",className:"absolute inset-0 w-full h-full object-contain pointer-events-none select-none",draggable:!1}),i.jsx("div",{className:"absolute inset-0 w-full h-full overflow-hidden pointer-events-none select-none",style:{clipPath:`inset(0 0 0 ${r}%)`},children:i.jsx("img",{src:I,loading:"lazy",decoding:"async",className:"absolute inset-0 w-full h-full object-contain",draggable:!1})}),i.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white/80 shadow-[0_0_10px_rgba(0,0,0,0.5)] pointer-events-none",style:{left:`${r}%`},children:i.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 bg-white rounded-full shadow-lg flex items-center justify-center text-black",children:i.jsx(e0,{size:12,className:"rotate-90"})})}),i.jsx("div",{className:`absolute bottom-2 left-2 bg-black/70 text-white text-[10px] font-medium px-2 py-0.5 rounded border border-white/10 transition-opacity duration-200 pointer-events-none ${a?"opacity-100":"opacity-60"}`,children:""}),i.jsx("div",{className:`absolute bottom-2 right-2 bg-blue-600/80 text-white text-[10px] font-medium px-2 py-0.5 rounded border border-white/10 transition-opacity duration-200 pointer-events-none ${a?"opacity-100":"opacity-60"}`,children:""})]}):i.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-zinc-500 bg-zinc-900/50 rounded-lg border border-zinc-800 border-dashed pointer-events-none",children:[i.jsx(e0,{size:24,className:"mb-2 opacity-50"}),i.jsx("span",{className:"text-xs font-medium",children:""})]})}),Su=xd.memo(({children:e,onClick:t,className:r="",variant:s="primary",icon:o,disabled:a=!1,title:l=""})=>{const u="flex items-center justify-center px-3 py-1.5 rounded-lg transition-all duration-200 font-medium text-xs select-none disabled:opacity-50 disabled:cursor-not-allowed",m={primary:"bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20 active:scale-95",secondary:"bg-zinc-800 hover:bg-zinc-700 text-zinc-300 border border-zinc-700 active:scale-95",ghost:"bg-transparent hover:bg-zinc-800 text-zinc-400 hover:text-white",danger:"bg-red-900/30 hover:bg-red-800 text-red-200 border border-red-800 active:scale-95"};return i.jsxs("button",{onClick:t,disabled:a,className:`${u} ${m[s]} ${r}`,title:l,children:[o&&i.jsx(o,{size:14,className:e?"mr-1.5":""}),e]})}),Cu=(e,t)=>{let r;return function(...o){const a=()=>{clearTimeout(r),e(...o)};clearTimeout(r),r=setTimeout(a,t)}},Iz=({isOpen:e,onClose:t,title:r,children:s,theme:o="dark"})=>{if(!e)return null;const a=o==="dark";return i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm",onMouseDown:t,children:i.jsxs("div",{className:`rounded-xl shadow-2xl w-[680px] max-w-[90vw] overflow-hidden animate-in fade-in zoom-in-95 duration-200 flex flex-col max-h-[85vh] border ${a?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,onMouseDown:l=>l.stopPropagation(),onClick:l=>l.stopPropagation(),children:[i.jsxs("div",{className:`flex items-center justify-between p-5 border-b shrink-0 ${a?"border-zinc-800/50":"border-zinc-200"}`,children:[i.jsx("h3",{className:`font-bold text-lg ${a?"text-white":"text-zinc-900"}`,children:r}),i.jsx("button",{onClick:t,className:a?"text-zinc-500 hover:text-white":"text-zinc-500 hover:text-zinc-900",children:i.jsx(ns,{size:20})})]}),i.jsx("div",{className:`p-0 overflow-y-auto custom-scrollbar flex-1 ${a?"bg-[#09090b]":"bg-white"}`,children:s})]})})},$z=({item:e,onClose:t,onNavigate:r,onShotNavigate:s,onHistoryNavigate:o})=>{var _;if(!e)return null;const a=D.useRef(e);D.useEffect(()=>{a.current=e},[e]);const l=e.type==="video"||e.url&&Un(e.url),u=D.useMemo(()=>{const b=[],T=k=>{k&&!b.includes(k)&&b.push(k)};return T(e.url),l||T(e.thumbnailUrl),T(e.originalUrl),T(e.mjOriginalUrl),b},[e,l]),[m,v]=D.useState(0);D.useEffect(()=>{v(0)},[e,u.length]);const I=u[m]||e.url,$=D.useCallback(()=>{v(b=>b<u.length-1?b+1:b)},[u.length]);return D.useEffect(()=>{if(!e)return;const b=T=>{const k=a.current;if(k&&!(T.target.tagName==="INPUT"||T.target.tagName==="TEXTAREA"))if(T.key==="ArrowLeft"||T.key==="Left"){if(!k.mjImages||k.mjImages.length<=1)return;T.preventDefault(),T.stopPropagation();const R=k.selectedMjImageIndex!==void 0?k.selectedMjImageIndex:0,x=R>0?R-1:k.mjImages.length-1;x>=0&&x<k.mjImages.length&&r&&(a.current={...k,selectedMjImageIndex:x,url:k.mjImages[x]},r(x))}else if(T.key==="ArrowRight"||T.key==="Right"){if(!k.mjImages||k.mjImages.length<=1)return;T.preventDefault(),T.stopPropagation();const R=k.selectedMjImageIndex!==void 0?k.selectedMjImageIndex:0,x=R<k.mjImages.length-1?R+1:0;x>=0&&x<k.mjImages.length&&r&&(a.current={...k,selectedMjImageIndex:x,url:k.mjImages[x]},r(x))}else if(T.key==="ArrowUp"||T.key==="Up")if(T.preventDefault(),T.stopPropagation(),k.storyboardContext&&s){const{shotIndex:R,allShots:x}=k.storyboardContext;R>0&&s(R-1,x)}else o&&o(-1);else if(T.key==="ArrowDown"||T.key==="Down")if(T.preventDefault(),T.stopPropagation(),k.storyboardContext&&s){const{shotIndex:R,allShots:x}=k.storyboardContext;R<x.length-1&&s(R+1,x)}else o&&o(1);else(T.key==="Escape"||T.key==="Esc")&&(T.preventDefault(),T.stopPropagation(),t&&t())};return window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)}},[e,r,s,o]),i.jsxs("div",{className:"fixed inset-0 z-[200] lightbox-overlay flex flex-col items-center justify-center animate-in fade-in duration-200",onClick:t,children:[i.jsx("button",{className:"absolute top-4 right-4 text-white/70 hover:text-white p-2 bg-black/50 rounded-full transition-colors",onClick:t,children:i.jsx(ns,{size:24})}),i.jsxs("div",{className:"max-w-[90vw] max-h-[85vh] relative",onClick:b=>b.stopPropagation(),children:[e.type==="image"?i.jsx(Vn,{src:I,alt:e.prompt,className:"max-w-full max-h-[85vh] rounded-lg shadow-2xl object-contain",onError:$}):i.jsx("video",{src:I,controls:!0,autoPlay:!0,className:"max-w-full max-h-[85vh] rounded-lg shadow-2xl",poster:e.thumbnailUrl||void 0,onError:$}),i.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 bg-black/60 backdrop-blur-md px-6 py-3 rounded-full text-white text-sm font-medium border border-white/10 text-center shadow-2xl",children:[i.jsx("div",{className:"line-clamp-1 max-w-xl",children:e.prompt}),i.jsxs("div",{className:"text-[10px] text-zinc-400 mt-1",children:[e.width,"x",e.height,"  ",e.id,e.mjImages&&e.mjImages.length>1&&i.jsxs("span",{className:"ml-2",children:["(",(e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0)+1,"/",e.mjImages.length,")"]}),e.storyboardContext&&i.jsxs("span",{className:"ml-2 text-blue-400",children:["Shot ",e.storyboardContext.shotIndex+1,"/",((_=e.storyboardContext.allShots)==null?void 0:_.length)||1]})]})]}),e.mjImages&&e.mjImages.length>1&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/70 hover:text-white p-3 bg-black/50 rounded-full transition-colors",onClick:b=>{b.stopPropagation();const T=e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0,k=T>0?T-1:e.mjImages.length-1;r&&r(k)},title:" ()",children:i.jsx(Vk,{size:24})}),i.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-white/70 hover:text-white p-3 bg-black/50 rounded-full transition-colors",onClick:b=>{b.stopPropagation();const T=e.selectedMjImageIndex!==void 0?e.selectedMjImageIndex:0,k=T<e.mjImages.length-1?T+1:0;r&&r(k)},title:" ()",children:i.jsx(fa,{size:24})})]})]})]})};function Mz(){var nm,rm;const[e,t]=D.useState(()=>{try{return localStorage.getItem("tapnow_theme")||"dark"}catch{return"dark"}}),[r,s]=D.useState([]),o=D.useCallback((n,c="info",d=3e3)=>{const f=Date.now();s(p=>[...p,{id:f,message:n,type:c}]),setTimeout(()=>{s(p=>p.filter(h=>h.id!==f))},d)},[]);D.useEffect(()=>{const n=document.createElement("style");return n.innerText=wz,document.head.appendChild(n),()=>{document.head.removeChild(n)}},[]),D.useEffect(()=>{try{localStorage.setItem("tapnow_theme",e)}catch{}const n=document.documentElement;e==="dark"?(n.classList.add("theme-dark"),n.classList.remove("theme-light"),document.body.style.backgroundColor="#09090b"):(n.classList.add("theme-light"),n.classList.remove("theme-dark"),document.body.style.backgroundColor="#f4f4f5")},[e]),D.useEffect(()=>{const n=setInterval(()=>{try{const c={nodes:Br.current,connections:sl.current,timestamp:Date.now()};localStorage.setItem("tapnow_autosave",JSON.stringify(c)),console.log("[AutoSave] ",new Date().toLocaleTimeString())}catch(c){console.warn("[AutoSave] :",c.message)}},6e4);return()=>clearInterval(n)},[]),D.useEffect(()=>{const n=c=>{if(Br.current&&Br.current.length>0)return c.preventDefault(),c.returnValue="",c.returnValue};return window.addEventListener("beforeunload",n),()=>window.removeEventListener("beforeunload",n)},[]);const[a,l]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_autosave");if(n)return JSON.parse(n).nodes||[];const c=localStorage.getItem("tapnow_nodes");return c?JSON.parse(c):[]}catch{return[]}}),[u,m]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_autosave");if(n)return JSON.parse(n).connections||[];const c=localStorage.getItem("tapnow_connections");return c?JSON.parse(c):[]}catch{return[]}}),[v,I]=D.useState(()=>{const n=localStorage.getItem("tapnow_max_undo_steps");return n?Math.min(30,Math.max(1,parseInt(n)||5)):5}),[$,_]=D.useState([]),[b,T]=D.useState([]),k=D.useRef(!1),[R,x]=D.useState(null),[w,P]=D.useState(null),[L,Y]=D.useState(null),[oe,ie]=D.useState([]),[be,ye]=D.useState(0),[he,We]=D.useState(()=>parseInt(localStorage.getItem("tapnow_batch_concurrency")||"1")),X=D.useRef(new Set),ke=D.useRef("idle");D.useEffect(()=>{localStorage.setItem("tapnow_batch_concurrency",he)},[he]);const M=D.useCallback(()=>{k.current||(_(n=>[...n,{nodes:JSON.parse(JSON.stringify(a)),connections:JSON.parse(JSON.stringify(u))}].slice(-v)),T([]))},[a,u]),xe=D.useRef(M);D.useEffect(()=>{xe.current=M},[M]),D.useEffect(()=>{if(oe.length===0){ke.current="idle",X.current.clear();return}let n=0;const c=[],d=Date.now(),f=6e4;if(a.forEach(y=>{var N;(N=y.settings)!=null&&N.shots&&y.settings.shots.forEach(S=>{S.status==="generating"&&(n++,S.generationStartTime&&d-S.generationStartTime>f&&c.push({nodeId:y.id,shotId:S.id}));const C=`${y.id}:${S.id}`;X.current.has(C)&&(S.status==="generating"||S.status==="done"||S.status==="failed")&&X.current.delete(C)})}),c.length>0&&(console.warn(`[Batch] ${c.length} tasks timed out (>${f/1e3}s). Auto-marking as failed.`),c.forEach(({nodeId:y,shotId:N})=>{qt(y,N,{status:"failed",errorMsg:"60s"},{onlyIfStatus:"generating"})}),n-=c.length),n+X.current.size>0){ke.current="running";return}if(ke.current==="running"){ke.current="cooling",setTimeout(()=>{ke.current="idle",ye(y=>y+1)},1e3);return}if(ke.current==="cooling")return;const h=he===0?oe.length:he,g=oe.slice(0,h),z=oe.slice(h);g.length>0&&(ie(z),ke.current="running",g.forEach(y=>{var C,E;X.current.add(`${y.nodeId}:${y.shotId}`);const N=a.find(H=>H.id===y.nodeId),S=(E=(C=N==null?void 0:N.settings)==null?void 0:C.shots)==null?void 0:E.find(H=>H.id===y.shotId);S&&(y.mode==="image"?Gh(y.nodeId,S):Yh(y.nodeId,S))}))},[oe,a,he,be]),D.useEffect(()=>{if(oe.length===0)return;const n=setInterval(()=>{ye(c=>c+1)},5e3);return()=>clearInterval(n)},[oe.length>0]);const lt=D.useCallback(()=>{if($.length===0)return;k.current=!0;const n=$[$.length-1];T(c=>[...c,{nodes:JSON.parse(JSON.stringify(a)),connections:JSON.parse(JSON.stringify(u))}]),l(n.nodes),m(n.connections),_(c=>c.slice(0,-1)),setTimeout(()=>{k.current=!1},100)},[$,a,u]),Se=D.useCallback(()=>{if(b.length===0)return;k.current=!0;const n=b[b.length-1];_(c=>[...c,{nodes:JSON.parse(JSON.stringify(a)),connections:JSON.parse(JSON.stringify(u))}]),l(n.nodes),m(n.connections),T(c=>c.slice(0,-1)),setTimeout(()=>{k.current=!1},100)},[b,a,u]);D.useEffect(()=>{const n=c=>{(c.ctrlKey||c.metaKey)&&c.key==="z"&&(c.shiftKey?(c.preventDefault(),Se()):(c.preventDefault(),lt()))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[lt,Se]);const[we,Ne]=D.useState({x:0,y:0,zoom:1}),et=D.useRef({x:0,y:0,zoom:1});D.useRef(null),D.useRef(new Map),D.useRef(new Map);const[ee,ae]=D.useState(null),[Te,it]=D.useState(()=>{const n=localStorage.getItem("tapnow_api_configs");if(n)try{let c=JSON.parse(n);c=c.map(p=>{if(p.modelName&&p.modelName!==p.id)return{id:p.modelName,provider:p.provider,type:p.type,...p.durations?{durations:p.durations}:{}};const{displayName:h,modelName:g,isCustom:z,...y}=p;return y}),c=c.filter(p=>!Jg.includes(p.id));const d=new Map;return c.forEach(p=>{p.id&&d.set(p.id,p)}),Wg.filter(p=>p.type==="Chat").forEach(p=>{d.has(p.id)||d.set(p.id,p)}),c=Array.from(d.values()),c=c.map(p=>p._uid?p:{...p,_uid:`uid-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}),c}catch(c){console.error("[V3.6.0]  apiConfigs :",c)}return Wg.map(c=>({...c,_uid:`uid-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}))}),[Pe,Gt]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_providers");if(n)return JSON.parse(n)}catch(n){console.error(" providers :",n)}return{...qp}});D.useEffect(()=>{try{localStorage.setItem("tapnow_providers",JSON.stringify(Pe))}catch(n){console.error(" providers :",n)}},[Pe]),D.useCallback(n=>{const c=Te.find(f=>f.id===n);if(!c)return{key:"",url:xr,id:n};const d=Pe[c.provider]||{};return{...c,modelName:c.id,key:d.key||"",url:d.url||xr}},[Te,Pe]);const[an,Yt]=D.useState(()=>localStorage.getItem("tapnow_global_key")||""),[Jt,$n]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_api_blacklist");if(!n)return{};const c=JSON.parse(n),d=new Date().toDateString();return c.date!==d?{}:c.blacklist||{}}catch{return{}}});D.useEffect(()=>{try{localStorage.setItem("tapnow_api_blacklist",JSON.stringify({date:new Date().toDateString(),blacklist:Jt}))}catch{}},[Jt]);const pn=D.useRef(Jt);D.useEffect(()=>{pn.current=Jt},[Jt]);const mr=(n,c)=>{if(!n)return;const d={date:new Date().toDateString(),reason:c,timestamp:Date.now()},f=pn.current||{};pn.current={...f,[n]:d},$n(p=>({...p,[n]:d}))},[Nn,j]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_api_suspend");if(!n)return{};const c=JSON.parse(n),d=Date.now();return Object.fromEntries(Object.entries(c).filter(([,f])=>d-f.timestamp<60*60*1e3))}catch{return{}}});D.useEffect(()=>{try{localStorage.setItem("tapnow_api_suspend",JSON.stringify(Nn))}catch{}},[Nn]);const Ce=D.useRef(Nn);D.useEffect(()=>{Ce.current=Nn},[Nn]);const _e=(n,c,d=60*60*1e3)=>{if(!n)return;const f={reason:c,timestamp:Date.now(),ttl:d};Ce.current={...Ce.current,[n]:f},j(p=>({...p,[n]:f}))},K=n=>{var d;const c=(d=Ce.current)==null?void 0:d[n];return c?Date.now()-c.timestamp<(c.ttl||60*60*1e3):!1},W=D.useRef([]),ue=2*60*1e3,Oe=10,Ve=()=>{const n=Date.now(),c=W.current.filter(d=>n-d<ue);return W.current=c,c.length>=Oe},ve=()=>{W.current.push(Date.now())},[nt,gt]=D.useState(()=>{const n=localStorage.getItem("tapnow_jimeng_use_local_file");return n!==null?n==="true":!0}),[Ye,It]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_nodes");return!n||JSON.parse(n).length===0?(localStorage.removeItem("tapnow_project_name"),""):localStorage.getItem("tapnow_project_name")||""}catch{return""}}),[tn,Xt]=D.useState(!1),cr=D.useRef(null),[Xr,Qn]=D.useState({visible:!1,progress:0,status:"",type:"import"}),[Bn,gn]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_history_performance_mode");return n!==null?n==="true"?"normal":n==="false"?"off":n||"normal":localStorage.getItem("tapnow_performance_mode")||"normal"}catch{return"normal"}}),[er,Cr]=D.useState(()=>{try{return localStorage.getItem("tapnow_global_performance_mode")||"off"}catch{return"off"}}),[Zt,Si]=D.useState(()=>localStorage.getItem("tapnow_local_server_url")||"http://127.0.0.1:9527"),[on,po]=D.useState(!1),[tr,Lr]=D.useState({savePath:"",imageSavePath:"",videoSavePath:"",convertPngToJpg:!0,jpgQuality:95,pilAvailable:!1}),Jr=D.useRef(new Map),gr=D.useRef(new Set),Ba=D.useRef(new Map),js=D.useRef(new Map);D.useEffect(()=>{localStorage.setItem("tapnow_performance_mode",Bn),localStorage.setItem("tapnow_history_performance_mode",Bn)},[Bn]),D.useEffect(()=>{localStorage.setItem("tapnow_global_performance_mode",er)},[er]),D.useEffect(()=>{localStorage.setItem("tapnow_local_server_url",Zt)},[Zt]);const[dt,$t]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_history");return n?JSON.parse(n).map(d=>{var f,p;return d.mjNeedsSplit&&d.mjOriginalUrl&&((p=(f=d.apiConfig)==null?void 0:f.modelId)!=null&&p.includes("mj"))?{...d,url:d.mjOriginalUrl,mjImages:null,mjNeedsSplit:!0}:d}):[]}catch(n){return console.error(":",n),[]}}),[Wo]=D.useState(()=>Date.now()),[Ci,us]=D.useState({active:!1,current:0,total:0,filename:""}),[ur,fo]=D.useState(new Set),[rh,Ns]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_auto_save_config");return n?JSON.parse(n):{enabled:!1,interval:5,folderPath:""}}catch{return{enabled:!1,interval:5,folderPath:""}}}),[Ei,Pd]=D.useState(!1),[wr,_s]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_chat_sessions");return n?JSON.parse(n):[{id:"default",title:"",messages:[]}]}catch{return[{id:"default",title:"",messages:[]}]}}),[Ss,Er]=D.useState("default"),[oi,Wa]=D.useState(""),[Ii,Ks]=D.useState(!1),[Ad,Pt]=D.useState(400),[q,Je]=D.useState([]),[ht,_n]=D.useState(()=>{try{return localStorage.getItem("tapnow_chat_model")||"gemini-3-pro"}catch{return"gemini-3-pro"}}),[rr,Wn]=D.useState(!1),[sr,Ur]=D.useState(null),[Cs,Ho]=D.useState(!1);D.useEffect(()=>{try{localStorage.setItem("tapnow_chat_model",ht)}catch{}},[ht]);const[Sn,xn]=D.useState(null),ho=D.useRef(Sn);D.useEffect(()=>{ho.current=Sn},[Sn]);const[Ha,sh]=D.useState(()=>{try{const n=localStorage.getItem(Hg),c=n?JSON.parse(n):[],d=[{id:"grid-default",name:"",prompt:Vg},{id:"upscale-default",name:"",prompt:Kg},{id:"moodboard-default",name:"",prompt:Xg},{id:"storyboard-default",name:"",prompt:Yg},{id:"character-sheet-default",name:"",prompt:Gg}],f=new Set((c||[]).map(h=>h.id)),p=[...c];return d.forEach(h=>{const g=p.some(z=>z.name===h.name);!f.has(h.id)&&!g&&p.unshift(h)}),p}catch{return[{id:"grid-default",name:"",prompt:Vg},{id:"upscale-default",name:"",prompt:Kg},{id:"moodboard-default",name:"",prompt:Xg},{id:"storyboard-default",name:"",prompt:Yg},{id:"character-sheet-default",name:"",prompt:Gg}]}}),[kc,Rd]=D.useState({name:"",prompt:""}),[ih,P1]=D.useState(!1),[Dd,A1]=D.useState(!1);D.useEffect(()=>{try{localStorage.setItem(Hg,JSON.stringify(Ha))}catch{}},[Ha]);const[Vo,Va]=D.useState(!1),[Od,Ka]=D.useState(!1),[Fr,Ya]=D.useState(null),[Ko,zc]=D.useState(null),[Dn,Yo]=D.useState(null),[hn,ds]=D.useState(null),[ps,fs]=D.useState(null),[Ld,Es]=D.useState({x:0,y:0}),[Go,$i]=D.useState(null),[Tz,oh]=D.useState(!1),[ah,Ud]=D.useState({});D.useEffect(()=>{const n=setInterval(()=>{const c=Date.now(),d={};let f=!1;Br.current&&Br.current.forEach(p=>{var h;p.type==="storyboard-node"&&((h=p.settings)!=null&&h.shots)&&p.settings.shots.forEach(g=>{if(g.status==="generating"&&g.generationStartTime){const z=(c-g.generationStartTime)/1e3;d[`${p.id}-${g.id}`]=`${z.toFixed(1)}s`,f=!0}})}),f&&Ud(d)},100);return()=>clearInterval(n)},[]);const[Mi,Fd]=D.useState(!1),[Is,Bd]=D.useState(null),[Cn,Ir]=D.useState(new Set),ai=D.useRef(!1),[dr,Xo]=D.useState({x:0,y:0,worldX:0,worldY:0,visible:!1}),[R1,Ti]=D.useState(!1),[Wd,Hd]=D.useState({visible:!1,x:0,y:0}),[kr,$s]=D.useState({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null}),[Zr,Ga]=D.useState({nodeId:null,shotId:null}),[Pi,Vd]=D.useState({visible:!1,x:0,y:0,nodeId:null,frame:null}),[Ai,lh]=D.useState({visible:!1,x:0,y:0,item:null}),[Xa,ch]=D.useState({visible:!1,x:0,y:0,nodeId:null}),[D1,qr]=D.useState(!1),[jc,Nc]=D.useState(!1),[uh,O1]=D.useState(!1),[Pz,Kd]=D.useState(-1),[dh,Jo]=D.useState(!1),[On,Zo]=D.useState(()=>{try{const n=localStorage.getItem("tapnow_characters");return n?JSON.parse(n):[]}catch(n){return console.error(":",n),[]}}),[L1,Ja]=D.useState(!1),[li,_c]=D.useState("url"),[qo,Sc]=D.useState(""),[Qo,Cc]=D.useState(""),[ea,ph]=D.useState(1),[ta,fh]=D.useState(3),[Za,qa]=D.useState(""),[Yd,na]=D.useState(!1),[hh,Qa]=D.useState(null),[mh,Ec]=D.useState({}),[U1,Ic]=D.useState(!1),[ir,mo]=D.useState(new Set),[gh,Gd]=D.useState(!1),[F1,B1]=D.useState("select"),[Ke,ln]=D.useState(null),[zn,Zn]=D.useState(null),[el,Xd]=D.useState({}),[ra,$c]=D.useState(null),[W1,Jd]=D.useState(null),[xh,Zd]=D.useState(null),[qd,tl]=D.useState({}),[yh,H1]=D.useState({}),[Ri,Qd]=D.useState(()=>{try{return localStorage.getItem("tapnow_last_image_model")||"nano-banana"}catch{return"nano-banana"}}),[go,ep]=D.useState(()=>{try{return localStorage.getItem("tapnow_last_video_model")||"sora-2"}catch{return"sora-2"}}),[ci,V1]=D.useState(()=>{try{return localStorage.getItem("tapnow_last_ratio")||"1:1"}catch{return"1:1"}}),[xo,K1]=D.useState(()=>{try{return Tl(localStorage.getItem("tapnow_last_image_res")||"2K")}catch{return"2K"}}),[sa,bh]=D.useState(()=>{try{return Ul(localStorage.getItem("tapnow_last_video_res")||"720P")}catch{return"720P"}}),[Y1,G1]=D.useState(()=>{try{return localStorage.getItem("tapnow_last_segment_duration")||"3"}catch{return"3"}}),[X1,J1]=D.useState(()=>{try{return localStorage.getItem("tapnow_last_analyze_model")||"gemini-3-pro"}catch{return"gemini-3-pro"}}),[Di,tp]=D.useState(()=>{try{return localStorage.getItem("tapnow_last_extract_model")||""}catch{return""}});D.useEffect(()=>{const n=(Zt||"").replace(/\/+$/,"");if(!n){po(!1);return}const c=async()=>{try{const f=await fetch(`${n}/ping`,{method:"GET"});if(f.ok){const p=await f.json();po(!0),Lr(h=>({...h,savePath:zr(p.save_path||h.savePath||""),imageSavePath:zr(p.image_save_path||""),videoSavePath:zr(p.video_save_path||""),convertPngToJpg:p.convert_png_to_jpg!==!1,jpgQuality:p.jpg_quality||h.jpgQuality,pilAvailable:p.pil_available||!1}));return}}catch{}po(!1)};c();const d=setInterval(c,3e4);return()=>clearInterval(d)},[Zt]),D.useEffect(()=>{l(n=>n.map(c=>{var f,p;if(c.type!=="local-save"||(f=c.settings)!=null&&f.serverUrl)return c;const d=on?"connected":"disconnected";return((p=c.settings)==null?void 0:p.serverStatus)===d?c:{...c,settings:{...c.settings,serverStatus:d}}}))},[on]);const Ys=D.useCallback(n=>n?n.replace(/[<>:"/\\|?*\x00-\x1F]/g,"_").replace(/\s+/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"").slice(0,120):"",[]),zr=D.useCallback(n=>n?/^[a-zA-Z]:/.test(n)?n.replace(/\//g,"\\").replace(/\\+/g,"\\").trim():n.trim():"",[]),Qr=D.useCallback(n=>{if(!n)return null;try{const d=n.split("?")[0].split("/"),p=d[d.length-1].replace(/\.[^.]+$/,"");return Ys(p||"")||null}catch{return null}},[Ys]),ia=D.useCallback((n,c="")=>{if(!n||!n.startsWith("data:"))return c;const d=n.match(/^data:([^;]+);/i);if(!d)return c;const f=d[1].toLowerCase();return{"image/jpeg":".jpg","image/jpg":".jpg","image/png":".png","image/webp":".webp","image/gif":".gif","video/mp4":".mp4","video/webm":".webm","video/quicktime":".mov"}[f]||c},[]),Mc=D.useCallback((n,c="")=>{if(!n)return c;const f=n.split("?")[0].split("#")[0].match(/\.([a-zA-Z0-9]+)$/);if(!f)return c;const p=`.${f[1].toLowerCase()}`;return p===".jpeg"?".jpg":p},[]),Tc=D.useCallback((n,c)=>{const d=Qr(n);return d||Ys(c||"")||`cache_${Date.now()}`},[Qr,Ys]),np=D.useCallback(async(n,c="normal")=>{const d=c==="ultra"?{maxSize:80,jpegQuality:.3}:{maxSize:150,jpegQuality:.6};return new Promise(f=>{try{const p=new Image;p.crossOrigin="anonymous",p.onload=()=>{const h=document.createElement("canvas");let g=p.naturalWidth,z=p.naturalHeight;g>z?g>d.maxSize&&(z=z*d.maxSize/g,g=d.maxSize):z>d.maxSize&&(g=g*d.maxSize/z,z=d.maxSize),h.width=g,h.height=z,h.getContext("2d").drawImage(p,0,0,g,z),f(h.toDataURL("image/jpeg",d.jpegQuality))},p.onerror=()=>f(null),p.src=n}catch{f(null)}})},[]),Pc=D.useCallback(async(n,c,d="history",f={})=>{if(!on)return null;const p=(Zt||"").replace(/\/+$/,"");if(!p)return null;try{const g=(f!=null&&f.forceId?Ys(n||""):"")||Tc(c,n);let z=c;if(!c.startsWith("data:")){const C=await(await fetch(c)).blob();z=await new Promise(E=>{const H=new FileReader;H.onloadend=()=>E(H.result),H.readAsDataURL(C)})}const y=ia(z,Mc(c,".jpg")),N=await fetch(`${p}/save-cache`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:g,content:z,category:d,ext:y,type:"image"})});if(N.ok){const S=await N.json();if(S.success)return{url:S.url,path:S.path}}}catch(h){console.warn("[] :",h)}return null},[on,Zt,Tc,ia,Mc,Ys]),vh=D.useCallback(async(n,c,d="history")=>{if(!on)return null;const f=(Zt||"").replace(/\/+$/,"");if(!f)return null;try{const p=Tc(c,n),g=await(await fetch(c)).blob(),z=await new Promise(S=>{const C=new FileReader;C.onloadend=()=>S(C.result),C.readAsDataURL(g)}),y=ia(z,Mc(c,".mp4")),N=await fetch(`${f}/save-cache`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:p,content:z,category:d,ext:y,type:"video"})});if(N.ok){const S=await N.json();if(S.success)return{url:S.url,path:S.path}}}catch(p){console.warn("[] :",p)}return null},[on,Zt,Tc,ia,Mc]),nl=D.useCallback(async(n,c={})=>{const d=c.silent===!0,f=(Zt||"").replace(/\/+$/,"");if(!f)return d||o("","error"),!1;const p={...n};p.save_path&&(p.save_path=zr(p.save_path)),p.image_save_path&&(p.image_save_path=zr(p.image_save_path)),p.video_save_path&&(p.video_save_path=zr(p.video_save_path));try{const h=await fetch(`${f}/config`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!h.ok){const z=await h.text();throw new Error(z||"")}const g=await h.json();return g!=null&&g.config&&Lr(z=>({...z,savePath:zr(g.config.save_path||z.savePath||""),imageSavePath:zr(g.config.image_save_path||""),videoSavePath:zr(g.config.video_save_path||""),convertPngToJpg:g.config.convert_png_to_jpg!==!1,jpgQuality:g.config.jpg_quality||z.jpgQuality})),d||o((g==null?void 0:g.message)||"","success",2e3),!0}catch(h){return d||o(`: ${h.message||""}`,"error",2e3),!1}},[Zt,o,zr]),Z1=D.useCallback(()=>{gr.current=new Set,Jr.current=new Map,Ba.current=new Map,js.current=new Map,$t(n=>n.map(c=>({...c,localCacheUrl:null,localFilePath:null,localCacheMap:null}))),Zo(n=>n.map(c=>({...c,localCacheUrl:null,localFilePath:null}))),o("","success")},[o]),wh=D.useCallback((n,c)=>{if(n){if(c)for(const[d,f]of js.current.entries())f===c&&js.current.delete(d);$t(d=>d.map(f=>{if(f.id!==n)return f;if(!c)return{...f,localCacheUrl:null,localFilePath:null,localCacheMap:null};let p=f.localCacheMap?{...f.localCacheMap}:null;p&&p[c]&&delete p[c];const h=p?Object.keys(p):[],g=f.localCacheUrl===c?h.length>0?p[h[0]]:null:f.localCacheUrl;return{...f,localCacheUrl:g||null,localFilePath:g?f.localFilePath:null,localCacheMap:h.length>0?p:null}}))}},[]),ui=D.useCallback((n,c=null)=>n?c?on&&n.localCacheMap&&n.localCacheMap[c]?n.localCacheMap[c]:c:(on?n.localCacheUrl||(n.localCacheMap?Object.values(n.localCacheMap)[0]:null):null)||n.url||n.originalUrl||n.mjOriginalUrl||"":"",[on]),hs=D.useCallback((n,c=null)=>{if(!n)return"";if(c){if(on&&n.localCacheMap&&n.localCacheMap[c])return n.localCacheMap[c];if(n.mjImages&&n.mjThumbnails){const f=n.mjImages.indexOf(c);if(f>=0&&n.mjThumbnails[f])return n.mjThumbnails[f]}return c}return(on?n.localCacheUrl||(n.localCacheMap?Object.values(n.localCacheMap)[0]:null):null)||n.thumbnailUrl||n.url||n.originalUrl||n.mjOriginalUrl||""},[on]),kh=D.useCallback((n,c)=>{const d=document.createElement("input");d.type="file",d.setAttribute("webkitdirectory",""),d.setAttribute("directory",""),d.multiple=!0,d.onchange=()=>{const f=d.files&&d.files[0];if(!f)return;const p=f.path||"";if(!p){o("","warning",3e3);return}const h=p.replace(/[\\/][^\\/]+$/,""),g=zr(h);Lr(z=>({...z,[n]:g})),nl({[c]:g},{silent:!0}),o("","success",2e3)},d.click()},[zr,nl,o]);D.useEffect(()=>{if(Bn==="off")return;const c=setTimeout(async()=>{const d=Bn==="ultra"?"ultra":"normal",p=dt.filter(h=>h.status==="completed"&&h.type==="image"&&(h.url||h.originalUrl||h.mjOriginalUrl)&&!h.thumbnailUrl).slice(0,5);if(p.length!==0)for(const h of p)try{const g=h.url||h.originalUrl||h.mjOriginalUrl;if(!g)continue;let z=Jr.current.get(g);z||(z=await np(g,d),z&&Jr.current.set(g,z));let y=null;h.mjImages&&h.mjImages.length>0&&(y=await Promise.all(h.mjImages.map(async N=>{if(!N)return null;const S=Jr.current.get(N);if(S)return S;const C=await np(N,d);return C&&Jr.current.set(N,C),C}))),(z||y)&&$t(N=>N.map(S=>S.id===h.id?{...S,thumbnailUrl:z||S.thumbnailUrl,mjThumbnails:y||S.mjThumbnails}:S))}catch(g){console.warn("[] :",g)}},100);return()=>clearTimeout(c)},[Bn,dt,np]),D.useEffect(()=>{if(!on)return;const c=setTimeout(async()=>{for(const d of On)if(!d.localCacheUrl&&!(!d.profile_picture_url||d.profile_picture_url.startsWith("blob:")))try{const f=await Pc(d.id,d.profile_picture_url,"characters");f&&Zo(p=>p.map(h=>h.id===d.id?{...h,localCacheUrl:f.url,localFilePath:f.path}:h))}catch(f){console.warn("[] :",d.username,f)}},2e3);return()=>clearTimeout(c)},[On,on,Pc]),D.useEffect(()=>{if(!on)return;const c=setTimeout(async()=>{const d=(Zt||"").replace(/\/+$/,"");if(!d)return;const f="history";for(const p of dt){if(p.status!=="completed"||p.type!=="image")continue;let h=p.localCacheUrl||null,g=p.localFilePath||null,z=p.localCacheMap?{...p.localCacheMap}:{},y=!1;const N=h||(Object.keys(z).length>0?Object.values(z)[0]:null);if(N){const A=Date.now(),U=Ba.current.get(p.id)||0;if(A-U>3e4){Ba.current.set(p.id,A);let V=!1;try{(await fetch(N,{method:"HEAD"})).ok||(V=!0)}catch{V=!0}V&&(z&&Object.keys(z).length>0&&Object.entries(z).forEach(([F,Q])=>{js.current.get(F)===Q&&js.current.delete(F)}),h=null,g=null,z={},y=!0,gr.current.delete(p.id))}}const S=p.mjImages&&p.mjImages.length>0?p.mjImages:p.output_images&&p.output_images.length>0?p.output_images:[p.url||p.originalUrl||p.mjOriginalUrl].filter(Boolean),C=[...new Set(S.filter(Boolean))];if(C.length===0)continue;const E=C.length>1,H=C.reduce((A,U)=>z[U]?A+1:A,0);if(!(gr.current.has(p.id)&&H>=C.length)){gr.current.add(p.id);for(let A=0;A<C.length;A++){const U=C[A];if(!U||U.startsWith("blob:")||U.includes("..."))continue;if(js.current.has(U)){const G=js.current.get(U);G&&!z[U]&&(z[U]=G,y=!0),!h&&G&&(h=G);continue}const V=Ys(`${p.id}-${A}`)||`${p.id}-${A}`,F=E?V:Qr(U)||V;let Q=!1;for(const G of[".jpg",".png"])try{const pe=`${f}/${F}${G}`,J=`${d}/file/${pe}`;if((await fetch(J,{method:"HEAD"})).ok){js.current.set(U,J),z[U]=J,y=!0,h||(h=J,g=pe),Q=!0;break}}catch{}if(!Q)try{const G=await Pc(`${p.id}-${A}`,U,"history",{forceId:E});G&&(js.current.set(U,G.url),z[U]=G.url,y=!0,h||(h=G.url,g=G.path))}catch(G){console.warn("[] :",p.id,G)}}if(y||h!==p.localCacheUrl){const A=Object.keys(z).length>0?z:null;$t(U=>U.map(V=>V.id===p.id?{...V,localCacheUrl:h||null,localFilePath:g||null,localCacheMap:A}:V))}}}},3e3);return()=>clearTimeout(c)},[dt,on,Pc,Qr,Ys,tr.imageSavePath,tr.savePath,Zt]),D.useEffect(()=>{if(!on)return;const c=setTimeout(async()=>{const d=(Zt||"").replace(/\/+$/,"");if(d)for(const f of dt){if(f.status!=="completed"||f.type!=="video"||f.localCacheUrl||gr.current.has(f.id))continue;gr.current.add(f.id);const p=f.url||f.originalUrl;if(p&&(p.includes("localhost:")||p.includes("127.0.0.1:")))continue;const g=[p?Qr(p):null,f.id].filter(Boolean);let z=!1;const y="history";for(const N of g){if(z)break;try{const S=`${y}/${N}.mp4`,C=`${d}/file/${S}`;(await fetch(C,{method:"HEAD"})).ok&&($t(H=>H.map(A=>A.id===f.id?{...A,localCacheUrl:C,localFilePath:S}:A)),z=!0)}catch{}}if(!z&&!(!p||p.startsWith("blob:")||p.includes("...")))try{const N=await vh(f.id,p,"history");N&&$t(S=>S.map(C=>C.id===f.id?{...C,localCacheUrl:N.url,localFilePath:N.path}:C))}catch(N){console.warn("[] :",f.id,N)}}},5e3);return()=>clearTimeout(c)},[dt,on,vh,Qr,tr.videoSavePath,tr.savePath,Zt]);const Gs=D.useRef(null),rl=D.useRef({x:0,y:0}),zh=D.useRef(null),Br=D.useRef(a),Oi=D.useRef(ee),Xs=D.useRef(Cn),sl=D.useRef(u),Ac=D.useRef({}),di=D.useRef(null),oa=D.useRef(!1),pi=D.useRef(null),Js=D.useRef(null),Li=D.useRef(null),il=D.useRef(null);D.useEffect(()=>{localStorage.setItem("tapnow_api_configs",JSON.stringify(Te))},[Te]);const rp=D.useCallback(n=>{M(),l(c=>c.filter(d=>d.id!==n)),m(c=>c.filter(d=>d.from!==n&&d.to!==n)),ee===n&&ae(null)},[ee,M]),Be=D.useCallback((n,c)=>{l(d=>d.map(f=>f.id===n?{...f,settings:{...f.settings,...c}}:f))},[]),ol=(n,c)=>{if(!c)return;const d=new FileReader;d.onload=async f=>{const p=f.target.result;let h={duration:0,w:0,h:0};try{h=await Qg(p)}catch(g){console.warn("",g)}l(g=>g.map(z=>z.id===n?{...z,content:p,videoMeta:h,frames:[],selectedKeyframes:[],extractingFrames:!1,videoFileName:c.name}:z))},d.readAsDataURL(c)};D.useEffect(()=>{const n=c=>{if(!(c.target.tagName==="INPUT"||c.target.tagName==="TEXTAREA"||c.target.isContentEditable)&&(c.key==="Delete"||c.key==="Del")){c.preventDefault(),c.stopPropagation();const d=Oi.current,f=Xs.current;if(d)rp(d),ae(null);else if(f&&f.size>0){xe.current&&xe.current();const p=new Set(f);l(h=>h.filter(g=>!p.has(g.id))),m(h=>h.filter(g=>!p.has(g.from)&&!p.has(g.to))),Ir(new Set)}}};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]);const jh=D.useMemo(()=>Cu(n=>{try{localStorage.setItem("tapnow_characters",JSON.stringify(n))}catch(c){console.error(":",c)}},500),[]);D.useEffect(()=>{jh(On)},[On,jh]),D.useEffect(()=>{Qa(null)},[qo,Qo,li]),D.useEffect(()=>{if(!jc){Kd(-1);return}const n=c=>{c.target.tagName==="INPUT"||c.target.tagName==="TEXTAREA"||Sn||(c.key==="ArrowUp"||c.key==="Up"?(c.preventDefault(),c.stopPropagation(),Kd(d=>{const f=d<=0?dt.length-1:d-1,p=dt[f],h=hs(p);return h&&xn({...p,url:h,storyboardContext:null}),f})):c.key==="ArrowDown"||c.key==="Down"?(c.preventDefault(),c.stopPropagation(),Kd(d=>{const f=d>=dt.length-1?0:d+1,p=dt[f],h=hs(p);return h&&xn({...p,url:h,storyboardContext:null}),f})):(c.key==="Escape"||c.key==="Esc")&&(c.preventDefault(),c.stopPropagation(),Nc(!1)))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[jc,dt,Sn,hs]);const al=D.useMemo(()=>Cu(n=>{try{localStorage.setItem("tapnow_history",JSON.stringify(n))}catch(c){console.error(":",c);try{const d=n.map(f=>{var p;return{id:f.id,type:f.type,url:f.url,prompt:((p=f.prompt)==null?void 0:p.substring(0,200))||"",time:f.time,status:f.status,modelName:f.modelName,width:f.width,height:f.height,ratio:f.ratio,mjImages:f.mjImages,selectedMjImageIndex:f.selectedMjImageIndex,mjRatio:f.mjRatio,mjNeedsSplit:f.mjNeedsSplit,mjImageInfo:f.mjImageInfo}});localStorage.setItem("tapnow_history",JSON.stringify(d))}catch(d){console.error(":",d);try{const f=n.map(p=>{var h;return{id:p.id,type:p.type,url:p.url,prompt:((h=p.prompt)==null?void 0:h.substring(0,100))||"",time:p.time,status:p.status,modelName:p.modelName}});al(f)}catch(f){console.error(":",f)}}}},1e3),[]),Nh=D.useMemo(()=>Cu(n=>{localStorage.setItem("tapnow_global_key",n)},1e3),[]);D.useEffect(()=>{Nh(an)},[an,Nh]),D.useEffect(()=>{try{const n=dt.map(c=>{var p,h,g,z;const d={...c},f=((h=(p=c.apiConfig)==null?void 0:p.modelId)==null?void 0:h.includes("mj"))||((z=(g=c.modelName)==null?void 0:g.toLowerCase())==null?void 0:z.includes("midjourney"));return c.mjImages&&c.mjImages.length===4&&f&&(d.mjImages=null,d.mjNeedsSplit=!0,d.mjOriginalUrl=c.mjOriginalUrl||c.url),c.url&&c.url.startsWith("data:")&&c.url.length>5e3&&(d.url=c.url.substring(0,100)+"..."),delete d.mjImageInfo,d});al(n)}catch(n){console.error(":",n);try{const c=dt.slice(0,20).map(d=>{const f={...d};return f.url&&f.url.startsWith("data:")&&(f.url=f.url.substring(0,100)+"..."),f.mjImages&&(f.mjImages=null),f.mjImageInfo&&delete f.mjImageInfo,f});al(c)}catch(c){console.error(":",c);try{const d=dt.slice(0,10).map(f=>{var p;return{id:f.id,type:f.type,prompt:(p=f.prompt)==null?void 0:p.substring(0,100),time:f.time,status:f.status,modelName:f.modelName}});al(d)}catch(d){console.error(":",d)}}}},[dt,al]);const _h=D.useMemo(()=>Cu(n=>{try{localStorage.setItem("tapnow_chat_sessions",JSON.stringify(n))}catch{}},1e3),[]);D.useEffect(()=>{_h(wr)},[wr,_h]),D.useEffect(()=>{Br.current=a,Oi.current=ee,Xs.current=Cn,sl.current=u,ai.current=Mi},[a,ee,Cn,u,Mi]);const At=D.useMemo(()=>{const n=new Map;return a.forEach(c=>{n.set(c.id,c)}),n},[a]),fn=D.useMemo(()=>{const n=new Map;return Te.forEach(c=>{n.set(c.id,c)}),n},[Te]),es=D.useCallback(n=>{const c=fn.get(n);if(!c)return{key:an,url:xr.replace(/\/+$/,""),modelName:n,displayName:n};const d=Pe[c.provider],f=(d==null?void 0:d.key)||an,p=((d==null?void 0:d.url)||xr).replace(/\/+$/,"");return{key:f,url:p,modelName:c.modelName,displayName:c.displayName,provider:c.provider,type:c.type}},[fn,Pe,an]),Rc=D.useCallback(n=>{if(!n)return"";const c=fn.get(n);return(c==null?void 0:c.displayName)||(c==null?void 0:c.modelName)||(c==null?void 0:c.id)||n},[fn]),pr=D.useMemo(()=>{const n={};return Object.entries(Pe).forEach(([c])=>{n[c]={name:c,models:[]}}),Te.forEach(c=>{if(Jg.includes(c.id))return;const d=c.provider||"Other";n[d]||(n[d]={name:d,models:[]}),n[d].models.push(c)}),n},[Te,Pe]),yo=D.useMemo(()=>{const n=new Map;return dt.forEach(c=>{n.set(c.id,c)}),n},[dt]),Dc=D.useMemo(()=>{if(!Gs.current)return a;const n=Gs.current.getBoundingClientRect(),c=200,d=et.current,f=(-d.x-c)/d.zoom,p=(n.width-d.x+c)/d.zoom,h=(-d.y-c)/d.zoom,g=(n.height-d.y+c)/d.zoom;return a.filter(z=>{const y=z.x+(z.width||0),N=z.y+(z.height||0);return z.x<p&&y>f&&z.y<g&&N>h})},[a,we.x,we.y,we.zoom]);D.useCallback(n=>n>=.8?"high":n>=.4?"medium":"low",[]),D.useEffect(()=>{et.current=we},[we]);const Ui=D.useMemo(()=>{const n={to:new Map,from:new Map};return u.forEach(c=>{n.to.has(c.to)||n.to.set(c.to,[]),n.to.get(c.to).push(c),n.from.has(c.from)||n.from.set(c.from,[]),n.from.get(c.from).push(c)}),n},[u]),sp=D.useCallback(n=>{const c=[],d=new Set,f=Ui.to.get(n)||[],p=(h,g="image",z={})=>{if(!h)return;const y=`${g}:${h}`;d.has(y)||(d.add(y),c.push({url:h,type:g,...z}))};return f.forEach(h=>{var z,y,N,S,C;const g=At.get(h.from);if(g){if(g.type==="gen-image"||g.type==="gen-video"){const E=dt.find(A=>A.sourceNodeId===g.id&&A.status==="completed");if(!E)return;const H=E.prompt||((z=g.settings)==null?void 0:z.prompt)||((y=g.settings)==null?void 0:y.videoPrompt)||"";if(E.mjImages&&E.mjImages.length>0)E.mjImages.forEach(A=>p(A,E.type||"image",{prompt:H,originalUrl:E.mjOriginalUrl||E.originalUrl||A}));else if(E.output_images&&E.output_images.length>0)E.output_images.forEach(A=>p(A,E.type||"image",{prompt:H,originalUrl:E.originalUrl||A}));else{const A=E.url||E.originalUrl||E.mjOriginalUrl;A&&p(A,E.type||(g.type==="gen-video"?"video":"image"),{prompt:H,originalUrl:E.originalUrl||A})}return}if(g.type==="storyboard-node"){const E=((N=g.settings)==null?void 0:N.shots)||[],H=((S=g.settings)==null?void 0:S.mode)||"video",A=((C=g.settings)==null?void 0:C.projectTitle)||"";E.forEach(U=>{if(U.outputEnabled)if(H==="image")if(U.output_images&&U.output_images.length>0)U.output_images.forEach(V=>{p(V,"image",{prompt:U.prompt||U.description||"",projectTitle:A,originalUrl:V})});else{const V=U.selectedImageIndex??-1;V>=0&&U.output_images&&U.output_images[V]&&p(U.output_images[V],"image",{prompt:U.prompt||U.description||"",projectTitle:A,originalUrl:U.output_images[V]})}else{const V=U.output_url||U.image_url;V&&p(V,Un(V)?"video":"image",{prompt:U.prompt||U.description||"",projectTitle:A,originalUrl:V})}});return}if(g.type==="video-input"){const E=g.selectedKeyframes&&g.selectedKeyframes.length>0?g.selectedKeyframes.map(H=>H.url):[];E.length>0?E.forEach(H=>p(H,"image",{name:g.videoFileName||"",originalUrl:H})):g.frames&&g.frames.length>0&&p(g.frames[0].url,"image",{name:g.videoFileName||"",originalUrl:g.frames[0].url});return}if(g.type==="input-image"||g.type==="preview"){g.content&&p(g.content,Un(g.content)?"video":"image",{name:g.title||"",originalUrl:g.content}),g.previewMjImages&&g.previewMjImages.forEach(E=>p(E,"image",{name:g.title||"",originalUrl:E}));return}}}),c},[Ui,At,dt]);D.useEffect(()=>{const n=setInterval(()=>{const c=Date.now(),d=dt.filter(p=>p.sourceNodeId&&p.status==="generating"&&p.startTime),f={};d.forEach(p=>{const h=Math.floor((c-p.startTime)/100);f[p.sourceNodeId]=h/10}),H1(f)},500);return()=>clearInterval(n)},[dt]);const Oc=D.useRef(new Set);D.useEffect(()=>{dt.forEach(n=>{var c,d;if(n.mjNeedsSplit&&n.mjOriginalUrl&&((d=(c=n.apiConfig)==null?void 0:c.modelId)!=null&&d.includes("mj"))&&n.status==="completed"){if(Oc.current.has(n.id))return;Oc.current.add(n.id),setTimeout(()=>{let f=n.mjRatio||"1:1";if(n.prompt&&n.prompt.includes("--ar ")){const p=n.prompt.match(/--ar\s+([\d:]+)/);p&&p[1]&&(f=p[1])}Bh(n.mjOriginalUrl,f).then(p=>{const h=p.map(y=>typeof y=="string"?y:y.url),g=p[0],z=typeof g=="string"?g:g.url;$t(y=>y.map(N=>N.id===n.id?{...N,mjImages:h,url:z,selectedMjImageIndex:0,mjRatio:f,mjNeedsSplit:!1,mjImageInfo:p.map(S=>typeof S=="string"?null:{width:S.width,height:S.height,ratio:S.ratio})}:N)),Oc.current.delete(n.id)}).catch(p=>{console.error("Midjourney: :",p),Oc.current.delete(n.id),$t(h=>h.map(g=>g.id===n.id?{...g,mjNeedsSplit:!0}:g))})},500)}})},[dt]);const Sh=D.useCallback(async(n=[])=>{const c=[],d=new Map,f=new Set;for(let p=0;p<n.length;p++){const h=n[p],g=h==null?void 0:h.url;if(g&&!f.has(g)){f.add(g);try{let z=g;if(!g.startsWith("data:")){const F=await(await fetch(g)).blob();z=await new Promise(Q=>{const G=new FileReader;G.onloadend=()=>Q(G.result),G.readAsDataURL(F)})}const y=h.type==="video"||g.startsWith("data:video")||Un(g),N=ia(z,y?".mp4":".png"),C=[h.projectTitle||(Ye&&Ye!==""?Ye:""),h.prompt].filter(Boolean).join("-")||Qr(g)||h.name||"tapnow";let E=Ys(C)||"tapnow";E=E.slice(0,80);const H=(d.get(E)||0)+1;d.set(E,H);const A=h.dedupeKey||h.originalUrl||g,U=Qr(A)||A;c.push({filename:`${E}-${H}${N}`,content:z,sourceUrl:g,dedupeKey:U,scopedKey:h.scopedKey||""})}catch(z){console.warn("[] :",z)}}}return c},[ia,Qr,Ys,Ye]),Lc=D.useCallback(n=>{var d;return(((d=n==null?void 0:n.settings)==null?void 0:d.serverUrl)||Zt||"").trim().replace(/\/+$/,"")},[Zt]),ip=D.useCallback(async(n,c,d={})=>{var Q,G,pe,J,ge;const f=d.silent===!0,p=Lc(n);if(!p){f||o("","error");return}const h=((Q=n.settings)==null?void 0:Q.lastSavedUrls)||[],g=(((G=n.settings)==null?void 0:G.subfolder)||"").trim(),z=`${p}::${g}`,y=c.map(le=>{if(!le)return le;const ne=le.dedupeKey||le.originalUrl||le.url,te=ne?Qr(ne)||ne:"",$e=te?`${z}::${te}`:"",st=!g&&te&&h.includes(te),Ue=$e&&h.includes($e)||st;return{...le,dedupeKey:te,scopedKey:$e,isDuplicate:Ue}}),N=y.filter(le=>(le==null?void 0:le.url)&&le.scopedKey&&!le.isDuplicate),S=y.filter(le=>(le==null?void 0:le.url)&&le.scopedKey&&le.isDuplicate).length;if(N.length===0){f||o("","success");return}const C=await Sh(N);if(C.length===0){f||o("","warning");return}let E;try{E=await fetch(`${p}/save-batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:C,subfolder:((pe=n.settings)==null?void 0:pe.subfolder)||""})})}catch(le){throw f||o("","error"),le}if(!E.ok){const le=await E.text();throw new Error(le||"")}const H=await E.json(),A=H.results||[],U=A.map((le,ne)=>{var te,$e;return le!=null&&le.success?((te=C[ne])==null?void 0:te.scopedKey)||(($e=N[ne])==null?void 0:$e.scopedKey):null}).filter(Boolean),V=Array.from(new Set([...((J=n.settings)==null?void 0:J.lastSavedUrls)||[],...U]));Be(n.id,{lastSavedUrls:V,lastSaved:new Date().toLocaleString(),savedFiles:[...((ge=n.settings)==null?void 0:ge.savedFiles)||[],...A.map(le=>le.path).filter(Boolean)]});const F=A.filter(le=>le.success).length;if(!f){const le=S>0?` ${S} `:"";o(H.message||` ${F} ${le}`,"success")}},[Sh,Qr,Lc,o]),q1=D.useCallback(async(n,c)=>{const d=(c||Zt||"").trim().replace(/\/+$/,"");if(!d){o("","warning");return}Be(n,{serverStatus:"checking"});try{if((await fetch(`${d}/ping`,{method:"GET"})).ok){Be(n,{serverStatus:"connected"}),o("","success");return}}catch{}Be(n,{serverStatus:"disconnected"}),o("","error")},[Zt,o,Be]),op=D.useRef(new Set);D.useEffect(()=>{const n=a.filter(c=>{var d;return c.type==="local-save"&&((d=c.settings)==null?void 0:d.autoSave)});n.length!==0&&n.forEach(async c=>{var N,S;const d=Lc(c);if(!d)return;const f=sp(c.id);if(f.length===0)return;const p=((N=c.settings)==null?void 0:N.lastSavedUrls)||[],h=(((S=c.settings)==null?void 0:S.subfolder)||"").trim(),g=`${d}::${h}`,z=f.filter(C=>{const E=(C==null?void 0:C.originalUrl)||(C==null?void 0:C.url),H=E?Qr(E)||E:"",A=H?`${g}::${H}`:"",U=!h&&H&&p.includes(H),V=A&&p.includes(A)||U;return A&&!V});if(z.length===0)return;const y=`${c.id}-${z.map(C=>C.url).join("|")}`;op.current.has(y)||(op.current.add(y),setTimeout(async()=>{try{await ip(c,z,{silent:!0})}catch(C){console.error(":",C)}finally{op.current.delete(y)}},1e3))})},[a,dt,sp,ip,Lc,Qr]);const Q1=n=>{n.preventDefault(),Ch(!0)},[Uc,Ch]=D.useState(!1),Fc=D.useCallback(n=>{if(!Uc)return;const c=window.innerWidth-n.clientX;Pt(Math.max(300,Math.min(c,800)))},[Uc]),Bc=D.useCallback(()=>{Ch(!1)},[]);D.useEffect(()=>{const n=console.error,c=console.warn,d=f=>{const p=f.map(h=>typeof h=="string"?h:h&&h.toString?h.toString():"").join(" ");return p.includes("Unable to preventDefault")||p.includes("passive event listener")||p.includes("preventDefault")&&p.includes("passive")};return console.error=function(...f){d(f)||n.apply(console,f)},console.warn=function(...f){d(f)||c.apply(console,f)},()=>{console.error=n,console.warn=c}},[]),D.useEffect(()=>{const n=d=>{if(d.ctrlKey)try{d.cancelable&&(d.preventDefault(),d.stopPropagation())}catch{}},c={passive:!1,capture:!0};return window.addEventListener("wheel",n,c),document.addEventListener("wheel",n,c),window.addEventListener("mousewheel",n,c),document.addEventListener("mousewheel",n,c),()=>{window.removeEventListener("wheel",n,c),document.removeEventListener("wheel",n,c),window.removeEventListener("mousewheel",n,c),document.removeEventListener("mousewheel",n,c)}},[]),D.useEffect(()=>{const n=Gs.current;if(!n)return;const c=d=>{if(d.ctrlKey){try{d.cancelable&&(d.preventDefault(),d.stopPropagation())}catch{}return}const f=d.target;let p=!1,h=null;if(f.tagName==="TEXTAREA"&&f.scrollHeight>f.clientHeight){try{d.cancelable&&d.preventDefault()}catch{}const S=f.scrollHeight-f.clientHeight,C=f.scrollTop,E=Math.max(0,Math.min(S,C+d.deltaY));f.scrollTop=E;return}let g=f;for(;g&&g!==n;){if(g.classList){const S=g.classList.contains("flex")&&g.classList.contains("flex-col")&&g.classList.contains("h-full")&&g.classList.contains("rounded-xl")&&g.classList.contains("overflow-hidden");if(g.classList.contains("video-input-container")||g.classList.contains("video-analyze-container")||S){if(p=!0,S)h=g.querySelector(".flex-1.overflow-y-auto.custom-scrollbar"),h||(h=g.querySelector(".flex-1.overflow-y-auto"));else if(h=g.querySelector('.overflow-y-auto, .custom-scrollbar, [class*="overflow-y"]'),!h){const H=window.getComputedStyle(g);(H.overflowY==="auto"||H.overflowY==="scroll"||g.classList.contains("custom-scrollbar"))&&(h=g)}break}const C=g.closest(".video-input-container, .video-analyze-container");if(C){if(p=!0,h=C.querySelector('.overflow-y-auto, .custom-scrollbar, [class*="overflow-y"]'),!h){const H=window.getComputedStyle(C);(H.overflowY==="auto"||H.overflowY==="scroll")&&(h=C)}break}const E=g.closest(".flex.flex-col.h-full.rounded-xl.overflow-hidden");if(E){p=!0,h=E.querySelector(".flex-1.overflow-y-auto.custom-scrollbar"),h||(h=E.querySelector(".flex-1.overflow-y-auto"));break}}g=g.parentElement}if(p&&h){try{d.cancelable&&(d.preventDefault(),d.stopPropagation())}catch{}const S=h.scrollHeight-h.clientHeight,C=h.scrollTop,E=Math.max(0,Math.min(S,C+d.deltaY));h.scrollTop=E;return}try{d.cancelable&&d.preventDefault()}catch{}const z=n.getBoundingClientRect(),y=d.clientX-z.left,N=d.clientY-z.top;Ne(S=>{const C=d.deltaY>0?.9:1.1;let E=Math.min(Math.max(S.zoom*C,.2),3);const H=E/S.zoom;return{zoom:E,x:y-(y-S.x)*H,y:N-(N-S.y)*H}})};return n.addEventListener("wheel",c,{passive:!1}),()=>{n.removeEventListener("wheel",c)}},[we]),D.useEffect(()=>(Uc?(window.addEventListener("mousemove",Fc),window.addEventListener("mouseup",Bc)):(window.removeEventListener("mousemove",Fc),window.removeEventListener("mouseup",Bc)),()=>{window.removeEventListener("mousemove",Fc),window.removeEventListener("mouseup",Bc)}),[Uc,Fc,Bc]);const mn=D.useCallback((n,c)=>{var h;const d=(h=Gs.current)==null?void 0:h.getBoundingClientRect(),f=d?n-d.left:n,p=d?c-d.top:c;return{x:(f-we.x)/we.zoom,y:(p-we.y)/we.zoom}},[we]),eb=n=>{var c;if((n.button===0||n.button===1)&&n.currentTarget.id==="canvas-bg"){const d=n.target;if(d&&(d.tagName==="INPUT"||d.tagName==="TEXTAREA"||d.tagName==="SELECT"||d.tagName==="BUTTON"||d.isContentEditable||d.closest('input, textarea, select, button, [contenteditable="true"]')))return;const f=window.getSelection();if(f&&f.toString().length>0&&f.removeAllRanges(),n.button===0&&(n.ctrlKey||n.metaKey)){n.preventDefault(),Fd(!0),ai.current=!0,Va(!1);const p=(c=Gs.current)==null?void 0:c.getBoundingClientRect(),h=n.clientX-((p==null?void 0:p.left)||0),g=n.clientY-((p==null?void 0:p.top)||0);Bd({startX:h,startY:g,endX:h,endY:g}),Ir(new Set),ae(null);return}ai.current||(Va(!0),oa.current=!0,Ka(!1),rl.current={x:n.clientX,y:n.clientY})}},Wc=D.useRef(null),ms=D.useRef(null),Fi=D.useRef(null),ll=D.useCallback(()=>{if(Fi.current){const d=Fi.current,f=new Map(d.map(({nodeId:p})=>[p,!0]));l(p=>{if(p.length>50&&d.length>10){const h=new Map;p.forEach((y,N)=>{f.has(y.id)&&h.set(y.id,N)});const g=[...p];let z=!1;return d.forEach(({nodeId:y,updater:N})=>{const S=h.get(y);if(S!==void 0){const C=N(g[S]);C!==g[S]&&(g[S]=C,z=!0)}}),z?g:p}else{const h=[...p];let g=!1;return d.forEach(({nodeId:z,updater:y})=>{const N=h.findIndex(S=>S.id===z);if(N!==-1){const S=y(h[N]);S!==h[N]&&(h[N]=S,g=!0)}}),g?h:p}}),Fi.current=null,ms.current=null;return}if(!Wc.current){ms.current=null;return}const{nodeId:n,updater:c}=Wc.current;l(d=>{const f=d.findIndex(g=>g.id===n);if(f===-1)return d;const p=c(d[f]);if(p===d[f])return d;const h=[...d];return h[f]=p,h}),Wc.current=null,ms.current=null},[]),ap=D.useCallback((n,c)=>{Wc.current={nodeId:n,updater:c},ms.current||(ms.current=requestAnimationFrame(ll))},[ll]),Eh=D.useCallback(n=>{if(Fi.current&&ms.current){const c=Fi.current,d=new Map;c.forEach(({nodeId:f,updater:p})=>{d.set(f,p)}),n.forEach(({nodeId:f,updater:p})=>{d.set(f,p)}),Fi.current=Array.from(d.entries()).map(([f,p])=>({nodeId:f,updater:p}))}else Fi.current=n;ms.current||(ms.current=requestAnimationFrame(ll))},[ll]);D.useEffect(()=>()=>{ms.current&&cancelAnimationFrame(ms.current),pi.current&&cancelAnimationFrame(pi.current)},[]);const cl=D.useRef(null),Hc=D.useRef(null),Ih=D.useCallback(n=>{var p;const{clientX:c,clientY:d}=n,f=mn(c,d);if(Es(f),Mi||ai.current){Mi||Fd(!0);const h=(p=Gs.current)==null?void 0:p.getBoundingClientRect(),g=c-((h==null?void 0:h.left)||0),z=d-((h==null?void 0:h.top)||0);Bd(y=>y?{...y,endX:g,endY:z}:null),Hc.current={endX:g,endY:z,rect:h},cl.current||(cl.current=requestAnimationFrame(()=>{if(!Hc.current){cl.current=null;return}const{endX:y,endY:N,rect:S}=Hc.current,C=Is;if(!C){cl.current=null;return}const E=Math.min(C.startX,y),H=Math.min(C.startY,N),A=Math.max(C.startX,y),U=Math.max(C.startY,N),V=mn(E+((S==null?void 0:S.left)||0),H+((S==null?void 0:S.top)||0)),F=mn(A+((S==null?void 0:S.left)||0),U+((S==null?void 0:S.top)||0)),Q=Br.current,G=new Set;Q.forEach(pe=>{const J=pe.x+(pe.width||260),ge=pe.y+(pe.height||200);pe.x<F.x&&J>V.x&&pe.y<F.y&&ge>V.y&&G.add(pe.id)}),Ir(G),Hc.current=null,cl.current=null}));return}if((Vo||oa.current)&&!ai.current){Ka(!0);const h=c-rl.current.x,g=d-rl.current.y;if(Math.abs(h)<1&&Math.abs(g)<1)return;Js.current?(Js.current.dx+=h,Js.current.dy+=g):Js.current={dx:h,dy:g},pi.current||(pi.current=requestAnimationFrame(()=>{if(!Js.current){pi.current=null;return}const{dx:z,dy:y}=Js.current;Ne(N=>{const S=Math.max(.2,Math.min(3,N.zoom)),C=S<.5||S>2.5?1e3:100;return{...N,zoom:S,x:Math.round((N.x+z)*C)/C,y:Math.round((N.y+y)*C)/C}}),Js.current=null,pi.current=null})),rl.current={x:c,y:d};return}if(Ko)ap(Ko,h=>({...h,width:Math.max(250,f.x-h.x),height:Math.max(250,f.y-h.y)}));else if(Fr){const h=Math.max(.2,Math.min(3,we.zoom)),g=n.movementX/h,z=n.movementY/h,y=h<.5||h>2.5?.5:1;if(Math.abs(g)<y&&Math.abs(z)<y)return;const N=Xs.current;if(N&&N.size>1&&N.has(Fr)){const S=Br.current,C=Math.max(.2,Math.min(3,we.zoom));(!Li.current||il.current!==null&&Math.abs(il.current-C)>.01)&&(Li.current={mouseX:c,mouseY:d,nodes:new Map(Array.from(N).map(U=>{const V=S.find(F=>F.id===U);return V?[U,{x:V.x,y:V.y}]:null}).filter(Boolean))}),il.current=C;const E=(c-Li.current.mouseX)/C,H=(d-Li.current.mouseY)/C,A=Array.from(Li.current.nodes.entries()).map(([U,V])=>({nodeId:U,updater:F=>({...F,x:V.x+E,y:V.y+H})}));Eh(A)}else Li.current=null,ap(Fr,S=>({...S,x:S.x+g,y:S.y+z}))}},[Vo,Mi,Is,Fr,Ko,mn,we.zoom,ap,Eh]),$h=()=>{if(pi.current&&(cancelAnimationFrame(pi.current),pi.current=null),Js.current){const{dx:n,dy:c}=Js.current;Ne(d=>{const f=Math.max(.2,Math.min(3,d.zoom)),p=f<.5||f>2.5?1e3:100;return{...d,zoom:f,x:Math.round((d.x+n)*p)/p,y:Math.round((d.y+c)*p)/p}}),Js.current=null}if(Fi.current&&ms.current&&(cancelAnimationFrame(ms.current),ll()),Mi||ai.current){if(Fd(!1),ai.current=!1,Bd(null),Cn.size===1){const n=Array.from(Cn)[0];ae(n)}else Cn.size===0&&ae(null);Ka(!1),Va(!1),oa.current=!1,Li.current=null,il.current=null;return}(Vo||oa.current)&&(Va(!1),oa.current=!1,Ka(!1),!Dn&&!hn&&!Fr&&!Ko&&(ae(null),Ir(new Set),Xo(n=>({...n,visible:!1})),ln(null),$s(n=>({...n,visible:!1})))),!Dn&&!hn&&(Ya(null),zc(null),Li.current=null,il.current=null),Ka(!1),ai.current=!1,rl.current={x:0,y:0}};D.useEffect(()=>{if(!(Vo||oa.current||Od||Fr||Ko||Mi||ai.current||Dn||hn))return;const c=f=>{f.movementX===void 0&&(f.movementX=0),f.movementY===void 0&&(f.movementY=0),Ih(f)},d=()=>{$h()};return window.addEventListener("pointermove",c,{passive:!1}),window.addEventListener("pointerup",d,{passive:!1}),()=>{window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",d)}},[Vo,Od,Fr,Ko,Mi,Dn,hn,Ih,$h]);const Ms=D.useCallback((n,c,d="default")=>{if(c.stopPropagation(),Dn&&Dn!==n)u.some(p=>p.from===Dn&&p.to===n&&(p.inputType||"default")===d)||(d!=="default"&&m(p=>p.filter(h=>!(h.to===n&&(h.inputType||"default")===d))),m(p=>[...p,{id:`conn-${Date.now()}`,from:Dn,to:n,inputType:d!=="default"?d:void 0}]));else if(hn&&hn!==n){const f=ps||d;u.some(h=>h.from===n&&h.to===hn&&(h.inputType||"default")===f)||(f!=="default"&&m(h=>h.filter(g=>!(g.to===hn&&(g.inputType||"default")===f))),m(h=>[...h,{id:`conn-${Date.now()}`,from:n,to:hn,inputType:f!=="default"?f:void 0}]))}Yo(null),ds(null),fs(null),$i(null),Va(!1),Ya(null),zc(null)},[Dn,hn,ps,u]),tb=n=>{if(Dn){const c=mn(n.clientX,n.clientY);Xo({visible:!0,x:n.clientX,y:n.clientY,worldX:c.x,worldY:c.y,sourceNodeId:Dn}),Ti(!1),Yo(null)}else if(hn){const c=mn(n.clientX,n.clientY);Xo({visible:!0,x:n.clientX,y:n.clientY,worldX:c.x,worldY:c.y,targetNodeId:hn,inputType:ps}),Ti(!1),ds(null),fs(null)}},nb=n=>{if(n.currentTarget.id==="canvas-bg"){const c=mn(n.clientX,n.clientY);Xo({visible:!0,x:n.clientX,y:n.clientY,worldX:c.x,worldY:c.y,sourceNodeId:void 0}),Ti(!1)}},rb=n=>{n.preventDefault(),n.stopPropagation(),(Cn.size>0||ee)&&Hd({visible:!0,x:n.clientX,y:n.clientY})},Mh=D.useMemo(()=>{const n=new Map;return u.forEach(c=>{var h,g;const d=c.inputType||"default";n.has(c.to)||n.set(c.to,new Map);const f=n.get(c.to);f.has(d)||f.set(d,[]);const p=At.get(c.from);if(p){let z=[];if(p.type==="video-input"){const y=p.selectedKeyframes&&p.selectedKeyframes.length>0?p.selectedKeyframes.map(N=>N.url):[];y.length>0?z=y:p.frames&&p.frames.length>0&&(z=[p.frames[0].url])}else if(p.type==="input-image"||p.type==="gen-image"||p.type==="preview")p.content&&z.push(p.content),p.previewMjImages&&z.push(...p.previewMjImages);else if(p.type==="storyboard-node"){const y=((h=p.settings)==null?void 0:h.shots)||[],N=((g=p.settings)==null?void 0:g.mode)||"video";y.forEach(S=>{if(S.outputEnabled)if(N==="image"){const C=S.selectedImageIndex??-1;C>=0&&S.output_images&&S.output_images.length>0&&S.output_images[C]&&z.push(S.output_images[C])}else S.output_url?z.push(S.output_url):S.image_url&&z.push(S.image_url)})}z.length>0&&f.get(d).push(...z)}}),n},[u,At,a,Zr]),Th=D.useCallback((n,c="default")=>{const d=Mh.get(n);return d?d.get(c)||[]:[]},[Mh]),Ph=D.useMemo(()=>{const n=new Map;return u.forEach(c=>{var d,f,p;if(!n.has(c.to)){const h=At.get(c.from);if(h){if(h.type==="video-input")n.set(c.to,h);else if(h.type==="input-image"){const g={...h,type:"input-image-as-video",videoFileName:"",videoMeta:{duration:0},frames:h.content?[{time:0,url:h.content}]:[],selectedKeyframes:h.content?[{time:0,url:h.content}]:[],isImageInput:!0};n.set(c.to,g)}else if(h.type==="storyboard-node"){const g=((d=h.settings)==null?void 0:d.shots)||[],z=((f=h.settings)==null?void 0:f.mode)||"video",y=((p=h.settings)==null?void 0:p.projectTitle)||"",N=[];g.forEach((C,E)=>{if(!C.outputEnabled)return;let H=null,A=C.image_filename||`${E+1}`;if(z==="image"){const U=C.selectedImageIndex??-1;U>=0&&C.output_images&&C.output_images[U]&&(H=C.output_images[U])}else H=C.output_url||C.image_url;H&&N.push({time:E,url:H,filename:A})});const S={...h,type:"storyboard-as-video",videoFileName:y,videoMeta:{duration:g.length},frames:N,selectedKeyframes:N,isStoryboardInput:!0};n.set(c.to,S)}}}}),n},[u,At]),ul=D.useCallback(n=>Ph.get(n)||null,[Ph]),sb=D.useCallback(n=>{for(const c of u)if(c.to===n){const d=At.get(c.from);if(d&&d.type==="video-analyze")return d}return null},[u,At]),dl=D.useCallback(n=>{const c=[];return u.forEach(d=>{var f;if(d.to===n){const p=At.get(d.from);if(p&&p.type==="text-node"){const h=((f=p.settings)==null?void 0:f.text)||"";h&&c.push(h)}}}),c},[u,At]),Ah=D.useMemo(()=>{const n=new Map;return u.forEach(c=>{const d=c.inputType||"default",f=`${c.to}:${d}`;if(!n.has(f)){const p=At.get(c.from);if(p){let h=null;if(p.type==="video-input"){const g=p.selectedKeyframes&&p.selectedKeyframes.length>0?p.selectedKeyframes[0].url:null;g?h=g:p.frames&&p.frames[0]&&(h=p.frames[0].url)}else p.type==="input-image"&&p.content&&(h=p.content);h&&n.set(f,h)}}}),n},[u,At,a]),Vc=D.useCallback((n,c)=>{const d=`${n}:${c||"default"}`;return Ah.get(d)||null},[Ah]),Zs=(n,c,d="image",f=null,p=null,h=null)=>{if(!c&&(!p||p.length===0))return;let g=f;if(!g){const y=yo.get(n);g=y==null?void 0:y.sourceNodeId}if(!g){console.warn("[Tapnow] updatePreviewFromTask:  sourceNodeId for taskId:",n);return}setTimeout(()=>{var N;const y=At.get(g);if(y&&(y.type==="gen-image"||y.type==="gen-video")){const S=u.filter(C=>C.to===g);for(const C of S){const E=At.get(C.from),H=E&&E.type==="storyboard-node"?E:null;if(H&&((N=H.settings)!=null&&N.shots)){const A=H.settings.shots.find(U=>U.status==="generating");if(A){const U=c||(p&&p.length>0?p[0]:null);if(U){qt(H.id,A.id,{image_url:U,image_filename:h||A.image_filename,status:"done"});break}}}}}},0);const z=sl.current;l(y=>{const N=z.filter(S=>S.from===g).map(S=>S.to);return N.length?y.map(S=>N.includes(S.id)&&S.type==="preview"?{...S,content:c||(p&&p.length>0?p[0]:c),previewType:d,previewMjImages:p,previewFilename:h||S.previewFilename||""}:S):y})},Rh=n=>{$t(c=>{const d=c.filter(f=>f.id!==n);try{localStorage.setItem("tapnow_history",JSON.stringify(d))}catch(f){console.error(":",f)}return d}),kr.item&&kr.item.id===n&&$s({visible:!1,x:0,y:0,item:null})},Dh=(n,c)=>it(d=>d.map(f=>f.id===n?{...f,...c}:f)),ib=n=>it(c=>c.filter(d=>d.id!==n)),ob=async n=>{Zd(n),tl(f=>({...f,[n]:"idle"}));const{key:c,url:d}=es(n);if(!c){tl(f=>({...f,[n]:"error"})),Zd(null);return}try{(await fetch(`${d}/v1/models`,{method:"GET",headers:{Authorization:`Bearer ${c}`}})).ok?tl(p=>({...p,[n]:"success"})):tl(p=>({...p,[n]:"error"}))}catch{tl(f=>({...f,[n]:"error"}))}Zd(null)},Ts=n=>{if(!n)return"bg-zinc-600";const c=qd[n];if(c==="success")return"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.8)]";if(c==="error")return"bg-red-500";const{key:d}=es(n);return d?"bg-zinc-400":"bg-zinc-700"},aa=D.useMemo(()=>wr.find(n=>n.id===Ss)||wr[0],[wr,Ss]),ab=()=>{var n;(n=zh.current)==null||n.scrollIntoView({behavior:"smooth"})};D.useEffect(()=>{ab()},[aa==null?void 0:aa.messages,Ii]);const lb=()=>{const n=`chat-${Date.now()}`,c={id:n,title:"",messages:[]};_s(d=>[c,...d]),Er(n)},cb=(n,c)=>{n.stopPropagation();const d=wr.filter(f=>f.id!==c);d.length===0?(_s([{id:"default",title:"",messages:[]}]),Er("default")):(_s(d),Ss===c&&Er(d[0].id))},ub=n=>{Array.from(n.target.files).forEach(d=>{const f=new FileReader;f.onload=p=>{var A;const h=p.target.result,g=((A=d.name.split(".").pop())==null?void 0:A.toLowerCase())||"",z=d.type.startsWith("image/"),y=d.type.startsWith("video/"),N=d.type.startsWith("audio/"),S=d.type==="application/pdf"||g==="pdf",C=["doc","docx"].includes(g)||d.type.includes("word"),E=["xls","xlsx"].includes(g)||d.type.includes("excel")||d.type.includes("spreadsheet"),H=["js","jsx","ts","tsx","py","java","cpp","c","html","css","json","xml","yaml","yml","md","txt","sh","bash"].includes(g);Je(U=>[...U,{name:d.name,type:d.type,content:h,isImage:z,isVideo:y,isAudio:N,isPDF:S,isDoc:C,isExcel:E,isCode:H,fileExt:g}])},d.type.startsWith("image/")||d.type.startsWith("video/")||d.type.startsWith("audio/")||d.type==="application/pdf"?f.readAsDataURL(d):d.name.match(/\.(txt|md|js|jsx|ts|tsx|py|html|css|json|csv|xml|yaml|yml|sh|bash|java|cpp|c)$/i)?f.readAsText(d):f.readAsDataURL(d)}),n.target.value=""},db=n=>{Je(c=>c.filter((d,f)=>f!==n))},Oh=async()=>{var H,A,U,V,F,Q,G,pe,J,ge,le;if(!oi.trim()&&q.length===0||Cs)return;const n=fn.get(ht),{key:c,url:d,modelName:f}=es(ht);if(!c){alert(" API  Key"),qr(!0);return}const p=Ss||((H=wr[0])==null?void 0:H.id),h=wr.find(ne=>ne.id===p)||wr[0],g=(h==null?void 0:h.messages)||[];h&&h.id!==Ss&&Er(h.id),Ho(!0);const z={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"user",content:oi,files:[...q],timestamp:Date.now(),modelId:ht};_s(ne=>ne.map(te=>te.id===p?{...te,messages:[...te.messages,z],title:te.messages.length===0?oi.slice(0,20):te.title}:te)),Wa(""),Je([]);const y=[...g,z],N=20,S=y.length>N?y.slice(-N):y;let C=[{role:"system",content:"AI"},...S.map(ne=>({role:ne.role,content:ne.content}))];const E=[];z.content&&E.push({type:"text",text:z.content}),z.files.forEach(ne=>{const te=((n==null?void 0:n.modelName)??"").toLowerCase().includes("gemini");ne.isImage?E.push({type:"image_url",image_url:{url:ne.content}}):ne.isVideo?te?E.push({type:"image_url",image_url:{url:ne.content}}):E.push({type:"text",text:`
[User attached video: ${ne.name}]
`}):ne.isAudio?E.push({type:"text",text:`
[User attached audio: ${ne.name}]
`}):ne.isPDF||ne.isDoc||ne.isExcel?E.push({type:"text",text:`
[User attached document: ${ne.name} (${ne.isPDF?"PDF":ne.isDoc?"Word":"Excel"})]
`}):ne.isCode||ne.content&&typeof ne.content=="string"&&ne.content.length<5e4?E.push({type:"text",text:`
[File: ${ne.name}]
\`\`\`${ne.fileExt||"text"}
${ne.content}
\`\`\`
`}):E.push({type:"text",text:`
[User attached file: ${ne.name}]
`})}),C.push({role:"user",content:E});try{const ne=await fetch(`${d}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({model:f||ht,messages:C,stream:!1})});if(!ne.ok){const Ue=await ne.text();throw new Error(Ue||`API Error: ${ne.status}`)}const te=await ne.json();let $e=null;te.choices&&te.choices.length>0?$e=(U=(A=te.choices[0])==null?void 0:A.message)==null?void 0:U.content:te.content?$e=te.content:te.text?$e=te.text:te.message?$e=typeof te.message=="string"?te.message:te.message.content:te.result?$e=typeof te.result=="string"?te.result:te.result.content:(G=(Q=(F=(V=te.data)==null?void 0:V.choices)==null?void 0:F[0])==null?void 0:Q.message)!=null&&G.content?$e=te.data.choices[0].message.content:(pe=te.data)!=null&&pe.content?$e=te.data.content:(J=te.data)!=null&&J.text?$e=te.data.text:(ge=te.data)!=null&&ge.message?$e=typeof te.data.message=="string"?te.data.message:te.data.message.content:(le=te.data)!=null&&le.result&&($e=typeof te.data.result=="string"?te.data.result:te.data.result.content),(!$e||$e.trim()==="")&&(console.error("[] API :",te),$e="No response");const st={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"assistant",content:$e,timestamp:Date.now(),modelId:ht};_s(Ue=>Ue.map(Ze=>Ze.id===Ss?{...Ze,messages:[...Ze.messages,st]}:Ze))}catch(ne){console.error("Chat Error",ne);const te={id:`msg-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,role:"assistant",content:`Error: ${ne.message}`,isError:!0,timestamp:Date.now()};_s($e=>$e.map(st=>st.id===Ss?{...st,messages:[...st.messages,te]}:st))}finally{Ho(!1)}},Ps=async n=>await(await fetch(n)).blob(),Hn=async n=>{if(n.startsWith("data:"))return n.split(",")[1];const c=await Ps(n);return new Promise((d,f)=>{const p=new FileReader;p.onloadend=()=>{const h=p.result;d(h.split(",")[1])},p.onerror=f,p.readAsDataURL(c)})},lp=n=>new Promise((c,d)=>{const f=new FileReader;f.onloadend=()=>c(f.result),f.onerror=d,f.readAsDataURL(n)}),Lh=async(n,c=2048,d=8)=>new Promise((f,p)=>{const h=new Image;h.crossOrigin="anonymous",h.onload=()=>{var V,F;const g=h.width,z=h.height;let y=g,N=z;if(g>c||z>c){const Q=c/Math.max(g,z);y=Math.floor(g*Q),N=Math.floor(z*Q)}const S=document.createElement("canvas");S.width=y,S.height=N;const C=S.getContext("2d");C.imageSmoothingEnabled=!0,C.imageSmoothingQuality="high",C.drawImage(h,0,0,y,N);let E=.92,H=S.toDataURL("image/jpeg",E);(((V=H.split(",")[1])==null?void 0:V.length)||0)*3/4/(1024*1024)>d&&(E=.75,H=S.toDataURL("image/jpeg",E),(F=H.split(",")[1])!=null&&F.length),f(H)},h.onerror=g=>{console.error("Midjourney: ",g),f(n)},h.src=n}),pb=async(n,c,d)=>{try{const p=(await Promise.all(n.map(async(S,C)=>{if(S.startsWith("data:"))try{return await Lh(S,2048,8)}catch(E){return console.error(`Midjourney: [${C}]`,E),S}else try{const E=await Ps(S),H=await lp(E);return await Lh(H,2048,8)}catch(E){throw console.error(`Midjourney: [${C}]URL`,E),E}}))).map((S,C)=>{let E=S;if(typeof E!="string")throw new Error(`base64[${C}]`);E.includes(",")?E=E.split(",")[1]:E.startsWith("data:")&&(E=E.replace(/^data:[^;]*;base64,?/i,""));const H=E.length;E=E.replace(/[^A-Za-z0-9+/=]/g,"");const A=E.length;if(!E||E.length<100)throw new Error(`base64[${C}]: ${(E==null?void 0:E.length)||0}`);const U=/^[A-Za-z0-9+/]+={0,2}$/;if(!U.test(E))throw console.error(`Midjourney: base64[${C}]: ${E.length}, 50: ${E.substring(0,50)}`),new Error(`invalid_base64_format: base64[${C}]`);const V=E.length%4;if(V!==0&&(E=E.replace(/=+$/,""),E+="=".repeat(4-V),!U.test(E)))throw console.error(`Midjourney: base64[${C}]: ${E.length}`),new Error(`invalid_base64_format: base64[${C}]`);try{const Q=atob(E);if(!Q||Q.length===0)throw new Error("base64")}catch(Q){throw console.error(`Midjourney: base64[${C}]:`,Q),new Error(`invalid_base64_format: base64[${C}]`)}return`data:image/jpeg;base64,${E}`}),h=`${c}/mj/submit/upload-discord-images`;p.forEach((S,C)=>{if(!S||typeof S!="string")throw new Error(`base64[${C}]`);if(!S.startsWith("data:image/"))throw new Error(`base64[${C}]data URL`);let E="";if(S.includes(","))E=S.split(",")[1];else throw new Error(`base64[${C}]data URL`);if(!E||E.length<100)throw new Error(`base64[${C}]`);if(!/^[A-Za-z0-9+/]+={0,2}$/.test(E))throw console.error(`Midjourney: base64[${C}]`),new Error(`base64[${C}]`);if(E.length%4!==0)throw new Error(`base64[${C}]4: ${E.length}`);try{atob(E)}catch(A){throw new Error(`base64[${C}]: ${A.message}`)}});const z=JSON.stringify({base64Array:p}),y=await fetch(h,{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:z});if(!y.ok){let S="";try{S=await y.text();try{const C=JSON.parse(S);throw new Error(`: ${y.status} - ${C.description||C.message||S}`)}catch{throw new Error(`: ${y.status} - ${S}`)}}catch(C){throw new Error(`: ${y.status} - ${C.message||S}`)}}const N=await y.json();if(N.code===1&&N.result&&Array.isArray(N.result))return N.result;{const S=N.description||N.message||"";throw console.error("Midjourney: :",N),new Error(S)}}catch(f){throw console.error("Midjourney: :",f),f}},cp=async(n,c=1920,d=1920)=>new Promise((f,p)=>{const h=new Image;h.crossOrigin="anonymous",h.onload=()=>{const g=h.width,z=h.height;if(g<=c&&z<=d){n.startsWith("data:")?f(n):Hn(n).then(H=>{f(`data:image/png;base64,${H}`)}).catch(p);return}let y=g,N=z;if(g>c||z>d){const H=Math.min(c/g,d/z);y=Math.round(g*H),N=Math.round(z*H),y=y%2===0?y:y-1,N=N%2===0?N:N-1}const S=document.createElement("canvas");S.width=y,S.height=N;const C=S.getContext("2d");C.imageSmoothingEnabled=!0,C.imageSmoothingQuality="high",C.drawImage(h,0,0,y,N);const E=S.toDataURL("image/png",.95);f(E)},h.onerror=g=>{console.error("Veo: ",g),p(new Error(""))},n.startsWith("data:")||n.startsWith("blob:")?h.src=n:Ps(n).then(g=>{const z=URL.createObjectURL(g);h.src=z}).catch(p)}),up=D.useCallback(n=>{m(c=>c.filter(f=>f.id!==n))},[]),fb=(n,c)=>{c.preventDefault(),c.stopPropagation(),c.currentTarget.classList.remove("drag-over");const f=Array.from(c.dataTransfer.files).filter(p=>p.type.startsWith("image/"));if(f.length>0){const p=f[0],h=new FileReader;h.onload=async g=>{const z=g.target.result;let y={w:0,h:0};try{y=await Wr(z)}catch{}M(),l(N=>N.map(S=>S.id===n?{...S,content:z,dimensions:y}:S))},h.readAsDataURL(p)}},Uh=D.useCallback(async(n,c)=>{var h;const d=At.get(n);if(!d)return;const f=Array.from(c||[]).filter(g=>g.type.startsWith("image/"));if(f.length===0)return;const p=await Promise.all(f.map(g=>new Promise(z=>{const y=new FileReader;y.onloadend=()=>z(y.result),y.readAsDataURL(g)})));Be(n,{referenceImages:[...((h=d.settings)==null?void 0:h.referenceImages)||[],...p]})},[At,Be]),hb=(n,c)=>{var d,f;c.preventDefault(),c.stopPropagation(),c.currentTarget.classList.remove("drag-over"),(f=(d=c.dataTransfer)==null?void 0:d.files)!=null&&f.length&&Uh(n,c.dataTransfer.files)},Fh=(n,c)=>{const d=c.target.files;d&&d.length>0&&Uh(n,d),c.target.value=""},dp=n=>{n.preventDefault(),n.stopPropagation(),n.currentTarget.classList.add("drag-over")},pp=n=>{n.preventDefault(),n.stopPropagation(),n.currentTarget.classList.remove("drag-over")};D.useEffect(()=>{const n=async f=>{const p=f.target;if(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.isContentEditable){const N=window.getSelection();if(N&&N.toString().trim())return;f.preventDefault();return}const g=Oi.current,z=Xs.current,y=g?[g]:z&&z.size>0?Array.from(z):[];if(y.length>0){f.preventDefault(),f.stopPropagation();const N=Br.current.filter(E=>y.includes(E.id)),C=sl.current.filter(E=>y.includes(E.from)||y.includes(E.to)).filter(E=>y.includes(E.from)&&y.includes(E.to));di.current={nodes:N.map(E=>({...E})),connections:C.map(E=>({...E})),timestamp:Date.now()}}},c=async f=>{const p=f.target;if(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.isContentEditable)return;const g=Oi.current;let z=null;if(g&&(z=Br.current.find(y=>y.id===g)),z&&(z.type==="input-image"||z.type==="video-input")){const y=Array.from(f.clipboardData.items),N=y.find(C=>C.type.startsWith("image/")),S=y.find(C=>C.type.startsWith("video/"));if(N&&z.type==="input-image"){f.preventDefault();const C=N.getAsFile();if(C){const E=new FileReader;E.onload=async H=>{const A=H.target.result;let U={w:0,h:0};try{U=await Wr(A)}catch{}M(),l(V=>V.map(F=>F.id===z.id?{...F,content:A,dimensions:U}:F))},E.readAsDataURL(C)}return}else if(S&&z.type==="video-input"){f.preventDefault();const C=S.getAsFile();C&&ol(z.id,C);return}}if(di.current&&di.current.nodes&&di.current.nodes.length>0){f.preventDefault(),f.stopPropagation();const y=di.current,N=Gs.current;let S=0,C=0;if(N){const te=N.getBoundingClientRect(),$e=(te.left+te.width/2-we.x)/we.zoom,st=(te.top+te.height/2-we.y)/we.zoom;S=$e,C=st}const E=y.nodes;if(E.length===0)return;const H=Math.min(...E.map(te=>te.x||0)),A=Math.min(...E.map(te=>te.y||0)),U=Math.max(...E.map(te=>(te.x||0)+(te.width||0))),V=Math.max(...E.map(te=>(te.y||0)+(te.height||0))),F=(H+U)/2,Q=(A+V)/2,G=S-F,pe=C-Q,J=new Map,ge=Date.now();y.nodes.forEach((te,$e)=>{const st=`node-${ge}-${$e}-${Math.random().toString(36).substr(2,9)}`;J.set(te.id,st)});const le=y.nodes.map(te=>({...te,id:J.get(te.id),x:te.x+G,y:te.y+pe})),ne=(y.connections||[]).filter(te=>te&&J.has(te.from)&&J.has(te.to)).map((te,$e)=>({...te,id:`conn-${ge}-${$e}-${Math.random().toString(36).substr(2,9)}`,from:J.get(te.from),to:J.get(te.to)}));M(),l(te=>[...te,...le]),m(te=>[...te,...ne]),le.length===1?(ae(le[0].id),Ir(new Set([le[0].id]))):le.length>1&&(ae(null),Ir(new Set(le.map(te=>te.id))))}},d=f=>{const p=f.target;if(!(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.isContentEditable)&&(f.ctrlKey||f.metaKey)&&f.key==="v"){const g=Oi.current;if(g){const z=Br.current.find(y=>y.id===g);if(z&&(z.type==="input-image"||z.type==="video-input"))return}if(di.current&&di.current.nodes&&di.current.nodes.length>0){f.preventDefault(),f.stopPropagation();const z=di.current,y=Gs.current;let N=0,S=0;if(y){const ne=y.getBoundingClientRect(),te=(ne.left+ne.width/2-we.x)/we.zoom,$e=(ne.top+ne.height/2-we.y)/we.zoom;N=te,S=$e}const C=z.nodes;if(C.length===0)return;const E=Math.min(...C.map(ne=>ne.x||0)),H=Math.min(...C.map(ne=>ne.y||0)),A=Math.max(...C.map(ne=>(ne.x||0)+(ne.width||0))),U=Math.max(...C.map(ne=>(ne.y||0)+(ne.height||0))),V=(E+A)/2,F=(H+U)/2,Q=N-V,G=S-F,pe=new Map,J=Date.now();z.nodes.forEach((ne,te)=>{const $e=`node-${J}-${te}-${Math.random().toString(36).substr(2,9)}`;pe.set(ne.id,$e)});const ge=z.nodes.map(ne=>({...ne,id:pe.get(ne.id),x:ne.x+Q,y:ne.y+G})),le=(z.connections||[]).filter(ne=>ne&&pe.has(ne.from)&&pe.has(ne.to)).map((ne,te)=>({...ne,id:`conn-${J}-${te}-${Math.random().toString(36).substr(2,9)}`,from:pe.get(ne.from),to:pe.get(ne.to)}));M(),l(ne=>[...ne,...ge]),m(ne=>[...ne,...le]),ge.length===1?(ae(ge[0].id),Ir(new Set([ge[0].id]))):ge.length>1&&(ae(null),Ir(new Set(ge.map(ne=>ne.id))))}}};return window.addEventListener("copy",n),window.addEventListener("paste",c),window.addEventListener("keydown",d),()=>{window.removeEventListener("copy",n),window.removeEventListener("paste",c),window.removeEventListener("keydown",d)}},[Be,ol,l,m,ae,Ir,we]);const Bi=async(n,c,d,f,p,h,g=0)=>{if(g>90){$t(S=>S.map(C=>C.id===c?{...C,status:"failed",errorMsg:"Veo "}:C));const N=Mn.current.get(c);N&&(qt(N.nodeId,N.shotId,{status:"draft"}),Mn.current.delete(c));return}fetch(`${d}/v2/videos/generations/${n}`,{method:"GET",headers:{Authorization:`Bearer ${f}`}}).then(async N=>{var V,F,Q,G,pe,J,ge,le;const S=await N.text();let C;try{C=JSON.parse(S)}catch{setTimeout(()=>Bi(n,c,d,f,p,h,g+1),4e3);return}const E=((V=C==null?void 0:C.data)==null?void 0:V.status)||(C==null?void 0:C.status)||((F=C==null?void 0:C.data)==null?void 0:F.task_status),H=((Q=C==null?void 0:C.data)==null?void 0:Q.progress)||(C==null?void 0:C.progress)||"0%",A=((G=C==null?void 0:C.data)==null?void 0:G.fail_reason)||(C==null?void 0:C.fail_reason)||"";if(E==="SUCCESS"||E==="succeeded"||E==="FINISHED"||E==="completed"){const ne=((pe=C==null?void 0:C.data)==null?void 0:pe.output)||(C==null?void 0:C.output)||((J=C==null?void 0:C.data)==null?void 0:J.video_url)||(C==null?void 0:C.video_url)||((le=(ge=C==null?void 0:C.data)==null?void 0:ge.data)==null?void 0:le.output);if(!ne){console.warn("[Tapnow] Veo: URL",C),$t($e=>$e.map(st=>st.id===c?{...st,status:"failed",errorMsg:"URL"}:st));return}const te=Date.now();$t($e=>{const st=$e.find(bt=>bt.id===c),Ue=st==null?void 0:st.sourceNodeId,Ze=st==null?void 0:st.ratio,xt=te-((st==null?void 0:st.startTime)||te);let yt=p,_t=h;return(async()=>{try{const bt=await Qg(ne);if(bt&&bt.w>0&&bt.h>0){const Wt=bt.w,Bt=bt.h;if(Ze==="16:9"){const rn=Wt/Bt,O=16/9;Math.abs(rn-O)>.1?(console.warn(`[Tapnow] Veo:  ${rn.toFixed(2)}  16:9 (${O.toFixed(2)})`),console.warn(`[Tapnow] Veo: : ${Wt}x${Bt}, : 16:9`),console.warn(`[Tapnow] Veo:  16:9 : ${p}x${Math.round(p/(16/9))}`),yt=p,_t=Math.round(p/(16/9))):(yt=Wt,_t=Bt)}else if(Ze==="9:16"){const rn=Wt/Bt,O=9/16;Math.abs(rn-O)>.1?(console.warn(`[Tapnow] Veo:  ${rn.toFixed(2)}  9:16 (${O.toFixed(2)})`),console.warn(`[Tapnow] Veo: : ${Wt}x${Bt}, : 9:16`),console.warn(`[Tapnow] Veo:  9:16 : ${Math.round(h*(9/16))}x${h}`),yt=Math.round(h*(9/16)),_t=h):(yt=Wt,_t=Bt)}else yt=Wt,_t=Bt;$t(rn=>rn.map(O=>O.id===c?{...O,status:"completed",progress:100,url:ne,width:yt,height:_t,durationMs:xt,ratio:Ze||O.ratio}:O));const Ht=Mn.current.get(c);Ht?(qt(Ht.nodeId,Ht.shotId,{video_url:ne,status:"done",durationCost:xt/1e3}),Mn.current.delete(c)):Ue&&setTimeout(()=>{Zs(c,ne,"video",Ue)},0)}}catch(bt){console.warn("[Tapnow] Veo: ",bt);let Wt=p,Bt=h;if(Ze==="16:9"){const rn=Wt/Bt;Math.abs(rn-16/9)>.1&&(Bt=Math.round(Wt/(16/9)))}else if(Ze==="9:16"){const rn=Wt/Bt;Math.abs(rn-9/16)>.1&&(Wt=Math.round(Bt*(9/16)))}$t(rn=>rn.map(O=>O.id===c?{...O,status:"completed",progress:100,url:ne,width:Wt,height:Bt,durationMs:xt,ratio:Ze||O.ratio}:O));const Ht=Mn.current.get(c);Ht?(qt(Ht.nodeId,Ht.shotId,{video_url:ne,status:"done",durationCost:xt/1e3}),Mn.current.delete(c)):Ue&&setTimeout(()=>{Zs(c,ne,"video",Ue)},0)}})(),$e});return}if(E==="FAILED"||E==="ERROR"||E==="CANCELLED"){let ne=`: ${E}`;if(A)try{const $e=typeof A=="string"?JSON.parse(A):A;ne=($e==null?void 0:$e.message)||($e==null?void 0:$e.code)||A}catch{ne=A||ne}console.error("[Tapnow] Veo: ",{status:E,failReason:A,errorMsg:ne}),$t($e=>$e.map(st=>st.id===c?{...st,status:"failed",errorMsg:ne}:st));const te=Mn.current.get(c);if(te){const $e=yo.get(c),st=$e?Date.now()-$e.startTime:0;qt(te.nodeId,te.shotId,{status:"failed",errorMsg:ne,durationCost:st/1e3}),Mn.current.delete(c)}return}if(E==="NOT_START"||E==="PENDING"||E==="QUEUED"){const ne=parseInt(H)||0;$t(te=>te.map($e=>$e.id===c?{...$e,status:"generating",progress:Math.max(5,ne),errorMsg:E==="NOT_START"?"...":void 0}:$e)),setTimeout(()=>Bi(n,c,d,f,p,h,g+1),4e3);return}const U=parseInt(H)||Math.min(95,g*2+10);$t(ne=>ne.map(te=>te.id===c?{...te,status:"generating",progress:U}:te)),setTimeout(()=>Bi(n,c,d,f,p,h,g+1),4e3)}).catch(N=>setTimeout(()=>Bi(n,c,d,f,p,h,g+1),4e3))},bo=(n,c,d,f,p,h,g="",z=0)=>{if(!n||n==="null"||n==="undefined"){console.error(`[Poll Error] Invalid JobId: ${n} for task ${c}`),$t(C=>C.map(E=>E.id===c?{...E,status:"failed",errorMsg:"Task failed: No Job ID returned",durationMs:Date.now()-(E.startTime||Date.now())}:E));return}const y=g==="sora-2-pro"?360:80,N=5e3;if(z>y){$t(E=>E.map(H=>H.id===c?{...H,status:"failed",errorMsg:"Sora "}:H));const C=Mn.current.get(c);C&&(qt(C.nodeId,C.shotId,{status:"draft"}),Mn.current.delete(c));return}const S=g!=null&&g.includes("grok")?`${d}/v2/videos/generations/${encodeURIComponent(n)}`:`${d}/v1/videos/${encodeURIComponent(n)}`;fetch(S,{method:"GET",headers:{Authorization:`Bearer ${f}`}}).then(C=>{if(!C.ok)throw new Error(`HTTP ${C.status}: ${C.statusText}`);return C.text()}).then(C=>{var A,U,V,F,Q;let E;try{E=JSON.parse(C)}catch(G){console.error("[Tapnow] Sora/Grok Poll JSON :",G,C),setTimeout(()=>bo(n,c,d,f,p,h,g,z+1),N);return}const H=((A=E==null?void 0:E.data)==null?void 0:A.status)||(E==null?void 0:E.status)||((U=E==null?void 0:E.data)==null?void 0:U.task_status)||(E==null?void 0:E.task_status);if(H==="SUCCESS"||H==="succeeded"||H==="FINISHED"||H==="completed"){const G=((V=E==null?void 0:E.data)==null?void 0:V.output)||(E==null?void 0:E.output)||((F=E==null?void 0:E.data)==null?void 0:F.video_url)||((Q=E==null?void 0:E.data)==null?void 0:Q.url)||(E==null?void 0:E.video_url)||(E==null?void 0:E.url);if(!G){$t(le=>le.map(ne=>ne.id===c?{...ne,status:"failed",errorMsg:"URL"}:ne));return}const pe=Date.now(),J=yo.get(c);J==null||J.sourceNodeId;const ge=pe-((J==null?void 0:J.startTime)||pe);$t(le=>{const ne=le.map($e=>$e.id===c?{...$e,status:"completed",progress:100,url:G,width:p,height:h,durationMs:ge}:$e),te=Mn.current.get(c);if(te)qt(te.nodeId,te.shotId,{video_url:G,status:"done",durationCost:ge/1e3}),Mn.current.delete(c);else{const $e=ne.find(st=>st.id===c);$e!=null&&$e.sourceNodeId?setTimeout(()=>{Zs(c,G,"video",$e.sourceNodeId)},0):console.warn("[Tapnow] Sora:  sourceNodeId",{taskId:c,updatedItem:$e})}return ne});return}if(H==="FAILED"||H==="ERROR"||H==="CANCELLED"){$t(le=>le.map(ne=>ne.id===c?{...ne,status:"failed",errorMsg:`: ${H}`}:ne));const G=Date.now(),pe=yo.get(c),J=G-((pe==null?void 0:pe.startTime)||G),ge=Mn.current.get(c);ge&&(qt(ge.nodeId,ge.shotId,{status:"failed",errorMsg:`: ${H}`,durationCost:J/1e3}),Mn.current.delete(c));return}$t(G=>G.map(pe=>pe.id===c?{...pe,status:"generating",progress:Math.min(95,(pe.progress||10)+2)}:pe)),setTimeout(()=>bo(n,c,d,f,p,h,g,z+1),N)}).catch(C=>{console.error("[Tapnow] Sora/Grok Poll :",C),z<y-5?setTimeout(()=>bo(n,c,d,f,p,h,g,z+1),N):$t(E=>E.map(H=>H.id===c?{...H,status:"failed",errorMsg:`: ${C.message||""}`}:H))})},Bh=async(n,c="1:1")=>new Promise((d,f)=>{const p=new Image;p.crossOrigin="anonymous";const h=setTimeout(()=>{f(new Error(""))},3e4);p.onload=()=>{clearTimeout(h);try{const g=document.createElement("canvas"),z=g.getContext("2d"),y=Math.floor(p.width/2),N=Math.floor(p.height/2),S=y/N,C=[];for(let E=0;E<2;E++)for(let H=0;H<2;H++){const A=Math.max(0,Math.min(H*y,p.width-y)),U=Math.max(0,Math.min(E*N,p.height-N)),V=Math.min(y,p.width-A),F=Math.min(N,p.height-U);g.width=V,g.height=F,z.fillStyle="#ffffff",z.fillRect(0,0,V,F),z.drawImage(p,A,U,V,F,0,0,V,F);const Q=g.toDataURL("image/png");C.push({url:Q,width:V,height:F,ratio:S})}d(C)}catch(g){console.error("Midjourney: :",g),f(g)}},p.onerror=g=>{clearTimeout(h),console.error("Midjourney: Failed to load image for splitting:",g),f(new Error(""))},p.src=n}),Kc=(n,c,d,f,p,h,g,z=0,y=!1)=>{const N=y?160:300,S=5e3;if(z>N){const H=y?800:1500;$t(A=>A.map(U=>U.id===n?{...U,status:"failed",errorMsg:`${H}`}:U));return}const E=`${d.replace(/\/+$/,"")}/v1/images/tasks/${c}`;fetch(E,{method:"GET",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}}).then(H=>H.text()).then(H=>{var J,ge,le,ne,te,$e,st,Ue,Ze;let A;try{A=JSON.parse(H)}catch(xt){console.error("[Async Image] Failed to parse response:",xt),setTimeout(()=>Kc(n,c,d,f,p,h,g,z+1,y),delayMs);return}const U=(((J=A==null?void 0:A.data)==null?void 0:J.status)||(A==null?void 0:A.status)||"").toUpperCase();console.log("[Async Image] :",U,":",{hasData:!!(A!=null&&A.data),hasDataData:!!((ge=A==null?void 0:A.data)!=null&&ge.data),hasDataStatus:!!((le=A==null?void 0:A.data)!=null&&le.status),hasStatus:!!(A!=null&&A.status),dataKeys:A?Object.keys(A):[]});let V=[];if((ne=A==null?void 0:A.data)!=null&&ne.data&&Array.isArray(A.data.data)&&A.data.data.length>0?V=A.data.data:(te=A==null?void 0:A.data)!=null&&te.images&&Array.isArray(A.data.images)&&A.data.images.length>0?V=A.data.images:A!=null&&A.images&&Array.isArray(A.images)&&A.images.length>0?V=A.images:A!=null&&A.data&&Array.isArray(A.data)&&A.data.length>0&&(V=A.data),V.length===0){if(($e=A==null?void 0:A.data)!=null&&$e.data&&Array.isArray(A.data.data)&&A.data.data.length>0){const xt=A.data.data[0];if(xt!=null&&xt.revised_prompt){const yt=xt.revised_prompt.match(/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/);yt&&yt[1]&&(V=[{url:yt[1]}])}}if(V.length===0&&((st=A==null?void 0:A.data)!=null&&st.revised_prompt)){const xt=A.data.revised_prompt.match(/!\[.*?\]\((https?:\/\/[^\s\)]+)\)/);xt&&xt[1]&&(V=[{url:xt[1]}])}if(V.length===0&&((Ue=A==null?void 0:A.data)!=null&&Ue.data)&&Array.isArray(A.data.data)&&A.data.data.length>0){const xt=A.data.data.filter(yt=>(yt==null?void 0:yt.url)||(yt==null?void 0:yt.image_url)||(yt==null?void 0:yt.imageUrl));xt.length>0&&(V=xt)}if(V.length===0&&(U==="COMPLETED"||U==="SUCCESS"||U==="FINISHED"||U==="DONE")){const xt=(_t,bt=0,Wt=new WeakSet)=>{if(bt>5||!_t||typeof _t!="object"||Wt.has(_t))return null;Wt.add(_t);const Bt=["url","image_url","imageUrl","image","src","link","href"];for(const Ht of Bt)if(_t[Ht]&&typeof _t[Ht]=="string"&&_t[Ht].startsWith("http"))return _t[Ht];if(Array.isArray(_t)&&_t.length>0){const Ht=xt(_t[0],bt+1,Wt);if(Ht)return Ht}for(const Ht in _t)if(_t.hasOwnProperty(Ht)&&!Bt.includes(Ht)){const rn=xt(_t[Ht],bt+1,Wt);if(rn)return rn}return null},yt=xt(A);yt?V=[{url:yt}]:console.warn("[Async Image] URL:",JSON.stringify(A,null,2).substring(0,500))}}const F=(A==null?void 0:A.message)||(A==null?void 0:A.error)||(A==null?void 0:A.fail_reason)||"";$t(xt=>{const yt=xt.map(bt=>{var Wt,Bt,Ht,rn,O,de,Fe,mt,Ct,Ot,wt,Lt;if(bt.id===n)if(U==="COMPLETED"||U==="SUCCESS"||U==="FINISHED"||U==="DONE"){const pt=bt.sourceNodeId||g;if(V&&V.length>0){const ft=V.map(kt=>typeof kt=="string"?kt:(kt==null?void 0:kt.url)||(kt==null?void 0:kt.image_url)||(kt==null?void 0:kt.imageUrl)||"").filter(Boolean);if(ft.length>0){const kt=ft[0];if(Mn.current.has(n)){const Rt=Mn.current.get(n);Rt&&Rt.isImageMode?(qt(Rt.nodeId,Rt.shotId,{output_images:ft,output_url:kt,selectedImageIndex:0,outputEnabled:!1,status:"done",durationCost:ot?ot/1e3:0}),Mn.current.delete(n)):console.warn("[V3.7.30 Async Debug] ")}let ot=null;const Mt=((Wt=A==null?void 0:A.data)==null?void 0:Wt.duration)||((Bt=A==null?void 0:A.data)==null?void 0:Bt.cost_time)||((Ht=A==null?void 0:A.data)==null?void 0:Ht.elapsed_time)||((rn=A==null?void 0:A.data)==null?void 0:rn.time_cost)||((O=A==null?void 0:A.data)==null?void 0:O.spent_time)||(A==null?void 0:A.duration)||(A==null?void 0:A.cost_time)||(A==null?void 0:A.elapsed_time)||(A==null?void 0:A.time_cost)||(A==null?void 0:A.spent_time);if(Mt!=null){if(typeof Mt=="number")ot=Mt<1e4?Mt*1e3:Mt;else if(typeof Mt=="string"){const Rt=Mt.match(/(\d+\.?\d*)\s*(s|ms||)/i);if(Rt){const zt=parseFloat(Rt[1]),yn=Rt[2].toLowerCase();ot=yn==="s"||yn===""?zt*1e3:zt}else{const zt=parseFloat(Mt);isNaN(zt)||(ot=zt<1e4?zt*1e3:zt)}}}if(ot===null){const Rt=Date.now();ot=Rt-(bt.startTime||Rt)}console.log("[Async Image] UI:",{taskId:n,url:kt,sourceNodeId:pt,imageCount:ft.length,durationMs:ot,backendDuration:Mt,frontendCalculated:ot===null?null:Date.now()-(bt.startTime||Date.now())});const Dt=pt||bt.sourceNodeId;return console.log("[Async Image] ",{taskId:n,url:kt,sourceNodeId:Dt,savedSourceNodeId:pt,hItemSourceNodeId:bt.sourceNodeId,imageCount:ft.length}),requestAnimationFrame(()=>{Zs(n,kt,"image",Dt,ft.length>1?ft:null)}),{...bt,status:"completed",progress:100,url:kt,width:p,height:h,durationMs:ot,errorMsg:null,sourceNodeId:pt||bt.sourceNodeId,...ft.length>1?{mjImages:ft,selectedMjImageIndex:0}:{}}}else console.error("[Async Image] URL:",V)}else{console.error("[Async Image] :",{status:U,hasData:!!(A!=null&&A.data),hasDataData:!!((de=A==null?void 0:A.data)!=null&&de.data),fullData:JSON.stringify(A,null,2).substring(0,1e3)});const ft=(ot,Mt=0)=>{if(Mt>5||!ot||typeof ot!="object")return null;if(ot.url&&typeof ot.url=="string"&&ot.url.startsWith("http"))return ot.url;if(ot.image_url&&typeof ot.image_url=="string"&&ot.image_url.startsWith("http"))return ot.image_url;if(ot.imageUrl&&typeof ot.imageUrl=="string"&&ot.imageUrl.startsWith("http"))return ot.imageUrl;for(const Dt in ot)if(ot.hasOwnProperty(Dt)){const Rt=ft(ot[Dt],Mt+1);if(Rt)return Rt}return null},kt=ft(A);if(kt){let ot=null;const Mt=((Fe=A==null?void 0:A.data)==null?void 0:Fe.duration)||((mt=A==null?void 0:A.data)==null?void 0:mt.cost_time)||((Ct=A==null?void 0:A.data)==null?void 0:Ct.elapsed_time)||((Ot=A==null?void 0:A.data)==null?void 0:Ot.time_cost)||((wt=A==null?void 0:A.data)==null?void 0:wt.spent_time)||(A==null?void 0:A.duration)||(A==null?void 0:A.cost_time)||(A==null?void 0:A.elapsed_time)||(A==null?void 0:A.time_cost)||(A==null?void 0:A.spent_time);if(Mt!=null){if(typeof Mt=="number")ot=Mt<1e4?Mt*1e3:Mt;else if(typeof Mt=="string"){const Rt=Mt.match(/(\d+\.?\d*)\s*(s|ms||)/i);if(Rt){const zt=parseFloat(Rt[1]),yn=Rt[2].toLowerCase();ot=yn==="s"||yn===""?zt*1e3:zt}else{const zt=parseFloat(Mt);isNaN(zt)||(ot=zt<1e4?zt*1e3:zt)}}}if(ot===null){const Rt=Date.now();ot=Rt-(bt.startTime||Rt)}const Dt=pt||bt.sourceNodeId;return console.log("[Async Image] ",{taskId:n,url:kt,sourceNodeId:Dt,savedSourceNodeId:pt,hItemSourceNodeId:bt.sourceNodeId}),requestAnimationFrame(()=>{Zs(n,kt,"image",Dt,null)}),{...bt,status:"completed",progress:100,url:kt,width:p,height:h,durationMs:ot,errorMsg:null,sourceNodeId:pt||bt.sourceNodeId}}}return{...bt,status:"failed",errorMsg:F||""}}else if(U==="FAILED"||U==="ERROR"||U==="CANCELLED"||U==="FAILURE"){if(Mn.current.has(n)){const pt=Mn.current.get(n),ft=Date.now(),kt=ft-(bt.startTime||ft);qt(pt.nodeId,pt.shotId,{status:"failed",errorMsg:F||`: ${U}`,durationCost:kt/1e3}),Mn.current.delete(n)}return{...bt,status:"failed",errorMsg:F||`: ${U}`}}else if(U==="PENDING"||U==="PROCESSING"||U==="GENERATING"||U==="IN_PROGRESS"||U==="RUNNING"){let pt=10+z*2;if((Lt=A==null?void 0:A.data)!=null&&Lt.progress){const ft=String(A.data.progress);ft.includes("%")?pt=parseInt(ft.replace("%",""),10)||pt:typeof A.data.progress=="number"&&(pt=A.data.progress)}else if(A!=null&&A.progress){const ft=String(A.progress);ft.includes("%")?pt=parseInt(ft.replace("%",""),10)||pt:typeof A.progress=="number"&&(pt=A.progress)}return pt=Math.min(95,Math.max(10,pt)),{...bt,status:"generating",progress:pt,errorMsg:null}}else{const pt=Math.min(90,10+z*1.5);return{...bt,status:"generating",progress:pt,errorMsg:null}}return bt}),_t=yt.find(bt=>bt.id===n);return _t!=null&&_t.progress,yt});const Q=(((Ze=A==null?void 0:A.data)==null?void 0:Ze.status)||(A==null?void 0:A.status)||"").toUpperCase();!(Q==="COMPLETED"||Q==="SUCCESS"||Q==="FINISHED"||Q==="DONE")&&!(Q==="FAILED"||Q==="ERROR"||Q==="CANCELLED"||Q==="FAILURE")&&$t(xt=>{const yt=xt.find(Wt=>Wt.id===n),_t=(yt==null?void 0:yt.progress)||10;let bt=S;return _t>=90?bt=1e3:_t>=70?bt=2e3:_t>=50?bt=3e3:z>50&&!y&&(bt=1e4),setTimeout(()=>{Kc(n,c,d,f,p,h,g,z+1,y)},bt),xt})}).catch(H=>{console.error("[Async Image] Poll error:",H),setTimeout(()=>Kc(n,c,d,f,p,h,g,z+1,y),S)})},Yc=(n,c,d,f,p="fast",h,g,z=0)=>{if(z>120){$t(S=>S.map(C=>C.id===c?{...C,status:"failed",errorMsg:"Midjourney "}:C));return}fetch(`${d}/${p}/mj/task/${n}/fetch`,{method:"GET",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}}).then(S=>S.text()).then(S=>{let C;try{C=JSON.parse(S)}catch(Q){console.error("Midjourney: Failed to parse response:",Q),setTimeout(()=>Yc(n,c,d,f,p,h,g,z+1),5e3);return}const E=(C==null?void 0:C.status)||"",H=(C==null?void 0:C.progress)||"0%",A=(C==null?void 0:C.imageUrl)||"",U=(C==null?void 0:C.failReason)||"",V=(C==null?void 0:C.buttons)||[];let F=0;typeof H=="string"&&H.includes("%")?F=parseInt(H.replace("%",""),10)||0:typeof H=="number"&&(F=H),$t(Q=>Q.map(G=>{var pe,J,ge,le,ne,te,$e;if(G.id===c){let st=G.status,Ue=G.errorMsg,Ze=F;if(E==="SUCCESS"||E==="FINISHED"){if(st="completed",Ze=100,Ue=null,A&&((J=(pe=G.apiConfig)==null?void 0:pe.modelId)!=null&&J.includes("mj"))&&((ge=G.apiConfig)==null?void 0:ge.modelId)!=="mj-zoom"){let yt="1:1";if(G.prompt&&G.prompt.includes("--ar ")){const Bt=G.prompt.match(/--ar\s+([\d:]+)/);Bt&&Bt[1]&&(yt=Bt[1])}$t(Bt=>Bt.map(Ht=>Ht.id===c?{...Ht,url:A,mjRatio:yt,mjOriginalUrl:A,mjNeedsSplit:!0}:Ht));const _t=G.sourceNodeId;_t?setTimeout(()=>{Zs(c,A,"image",_t)},0):console.warn("[Tapnow] Midjourney:  sourceNodeId",{taskId:c,hItem:G}),setTimeout(()=>{Bh(A,yt).then(Bt=>{const Ht=Bt.map(de=>typeof de=="string"?de:de.url),rn=Bt[0],O=typeof rn=="string"?rn:rn.url;$t(de=>de.map(Fe=>Fe.id===c?{...Fe,mjImages:Ht,url:O,selectedMjImageIndex:0,mjRatio:yt,mjOriginalUrl:A,mjNeedsSplit:!1,mjImageInfo:Bt.map(mt=>typeof mt=="string"?null:{width:mt.width,height:mt.height,ratio:mt.ratio})}:Fe))}).catch(Bt=>{console.error("Midjourney: Failed to split image:",Bt),$t(Ht=>Ht.map(rn=>rn.id===c?{...rn,url:A,mjRatio:yt,mjOriginalUrl:A,mjNeedsSplit:!0}:rn))})},300);const bt=Date.now(),Wt=bt-(G.startTime||bt);return{...G,status:st,progress:Ze,errorMsg:Ue,url:A,width:h,height:g,mjButtons:V,mjOriginalUrl:A,durationMs:Wt}}}else E==="FAILURE"||E==="ERROR"||E==="CANCELLED"?(st="failed",Ue=U||`: ${E}`):E==="NOT_START"||E==="SUBMITTED"||E==="IN_PROGRESS"||E==="MODAL"?(st="generating",Ue=null,Ze===0&&(Ze=5)):(st="generating",Ue=null,Ze=Math.min(95,(G.progress||5)+2));const xt={...G,status:st,progress:Ze,errorMsg:Ue,url:A||G.url,width:h,height:g,mjButtons:V};if((E==="SUCCESS"||E==="FINISHED")&&A&&(!((ne=(le=G.apiConfig)==null?void 0:le.modelId)!=null&&ne.includes("mj"))||((te=G.apiConfig)==null?void 0:te.modelId)==="mj-zoom")){G.sourceNodeId?(($e=G.apiConfig)==null?void 0:$e.modelId)==="mj-zoom"?l(bt=>bt.map(Wt=>Wt.id===G.sourceNodeId&&Wt.type==="expand-image"?{...Wt,content:A}:Wt)):Zs(c,A,"image",G.sourceNodeId):console.warn("[Tapnow] :  sourceNodeId",{taskId:c,hItem:G});const yt=Date.now(),_t=yt-(G.startTime||yt);xt.durationMs=_t}return xt}return G})),!(E==="SUCCESS"||E==="FINISHED")&&(E==="FAILURE"||E==="ERROR"||E==="CANCELLED"||setTimeout(()=>Yc(n,c,d,f,p,h,g,z+1),5e3))}).catch(S=>{console.error(`[Tapnow] Midjourney Poll Fetch Error for task ${c}:`,S),$t(C=>C.map(E=>E.id===c?{...E,status:"failed",errorMsg:`: ${S.message}`}:E)),z<3&&setTimeout(()=>Yc(n,c,d,f,p,h,g,z+1),5e3)})},mb=async n=>{if(!n)return null;try{const c=new Image;c.crossOrigin="anonymous",await new Promise((p,h)=>{c.onload=p,c.onerror=h,c.src=n});const d=document.createElement("canvas");d.width=c.width,d.height=c.height;const f=d.getContext("2d");return f.fillStyle="#000000",f.fillRect(0,0,d.width,d.height),f.globalCompositeOperation="destination-out",f.drawImage(c,0,0),new Promise((p,h)=>{d.toBlob(g=>{g?p(g):h(new Error(""))},"image/png")})}catch(c){return console.error("[Inpainting] :",c),null}},vo=async(n,c,d,f,p={})=>{var Ze,xt,yt,_t,bt,Wt,Bt,Ht,rn,O,de,Fe,mt,Ct,Ot,wt,Lt,pt,ft,kt,ot,Mt,Dt,Rt,zt,yn,En,Z;let h=[];const g=Array.isArray(d)?d:d?[d]:[];if(g.length>0)try{h=await Promise.all(g.map(async re=>{if(yi.isImageId(re)){const Ie=await yi.getImage(re);return Ie||(console.warn(`[startGeneration] Failed to resolve IDB image: ${re}`),re)}return re}))}catch(re){console.error("[startGeneration] Error resolving images:",re),h=g}const z=h,y=z.length>0?z[0]:void 0;if(!n&&!y){alert("");return}let N=null;f&&f.startsWith("storyboard-")&&f.includes("-shot-")?N=null:N=a.find(re=>re.id===f);let S=null,C=N==null?void 0:N.maskContent;if(!C){let re=u.find(Ie=>Ie.to===f&&(!Ie.inputType||Ie.inputType==="default"));if(re||(re=u.find(Ie=>Ie.to===f)),re){const Ie=At.get(re.from);Ie&&Ie.maskContent&&(C=Ie.maskContent)}}C&&(S=await mb(C),S||console.warn("[Inpainting] "));const E=p.model||((Ze=N==null?void 0:N.settings)==null?void 0:Ze.model)||(c==="image"?"nano-banana":"sora-2"),H=es(E);let A=H.key,U=A;if(A&&A.includes(",")){const re=A.split(",").map(se=>se.trim()).filter(se=>se),Ie=pn.current||{},at=re.filter(se=>!Ie[se]);at.length>0?U=at[Math.floor(Math.random()*at.length)]:re.length>0&&(U=re[Math.floor(Math.random()*re.length)],console.warn(` [Load Balancing] All ${re.length} keys are blacklisted, using random selection`))}U&&console.log(`[API Select] Using Key ending in ...${U.slice(-4)}`);let V=H.url,F=V;if(V.includes(",")){const re=V.split(",").map(Ie=>Ie.trim()).filter(Ie=>Ie);re.length>0&&(F=re[Math.floor(Math.random()*re.length)])}if(!U){alert(" API Key"),qr(!0);return}n&&(E.includes("sora")||E==="sora-2"||E==="sora-2-pro")&&(n=n.replace(/@([a-zA-Z0-9_\.]+)(?![a-zA-Z0-9_\.])/g,(re,Ie)=>`@{${Ie}}`),n=n.replace(/@\{([^\}]+)\}/g,(re,Ie)=>` @{${Ie}} `).replace(/\s{2,}/g," ").trim());let Q=p.ratio||((xt=N==null?void 0:N.settings)==null?void 0:xt.ratio)||(E.includes("grok")?"3:2":"1:1"),G=p.resolution||((yt=N==null?void 0:N.settings)==null?void 0:yt.resolution)||(c==="video"?"720P":"2K"),pe=G;c==="image"&&(G=Tl(G),pe=G),c==="video"&&(G=Ul(G),pe=G==="Auto"?"720P":G);let{sizeStr:J,w:ge,h:le}=Sz(E,Q,pe);if(G==="Auto"&&Q==="Auto"&&y)try{const re=await Wr(y),Ie=Math.round(re.w/64)*64,at=Math.round(re.h/64)*64;ge=Ie,le=at,J=`${Ie}x${at}`}catch(re){console.error("Auto Res Error",re)}else if(!ge||!le){const re=T1(Q,G);ge=re.w,le=re.h,J=re.str}if(y&&Q==="Auto"&&["1K","2K","4K"].includes(G))try{const re=await Wr(y),Ie=G==="4K"?4096:G==="2K"?2048:1024,at=Math.max(re.w,re.h)||1,se=Ie/at;let Ae=Math.round(re.w*se/16)*16,vt=Math.round(re.h*se/16)*16;Ae=Math.max(16,Ae),vt=Math.max(16,vt),ge=Ae,le=vt,J=`${Ae}x${vt}`}catch(re){console.error("Auto+K Upscale Error",re)}let ne=p.duration?String(p.duration).replace("s",""):((bt=(_t=N==null?void 0:N.settings)==null?void 0:_t.duration)==null?void 0:bt.replace("s",""))||"5";E.includes("veo")&&(ne="8"),E.includes("jimeng")&&!["5","10"].includes(String(ne))&&(ne="5");const te=p._existingTaskId||`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,$e=()=>{const re=fn.get(E);return E.includes("jimeng")?E:(re==null?void 0:re.displayName)||H.provider||E},st=Date.now(),Ue=(N==null?void 0:N.id)||f||null;if(p._isRetry||$t(re=>[{id:te,type:c,url:"",prompt:n||(y?`Img2${c==="image"?"Img":"Vid"}`:"Untitled"),time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),status:"generating",progress:5,modelName:$e(),width:ge,height:le,remoteTaskId:null,apiConfig:{modelId:E,baseUrl:F,apiKey:U},provider:H.provider,sourceNodeId:Ue,startTime:st,durationMs:null,ratio:Q,resolution:G,duration:c==="video"?ne:null,hasInputImages:z.length>0},...re]),Ue&&Ue.startsWith("storyboard-")&&Ue.includes("-shot-")){const re=Ue.split("-shot-");if(re.length===2){const Ie=re[1],at=re[0].startsWith("storyboard-img-"),se=at?re[0].replace("storyboard-img-",""):re[0].replace("storyboard-","");Mn.current.set(te,{nodeId:se,shotId:Ie,isImageMode:at})}}p._isRetry||requestAnimationFrame(()=>{setTimeout(()=>{Nc(!0)},0)});try{if(c==="image"){let re=`${F}/v1/images/generations`,Ie,at=!1;const se=fn.get(E),Ae=(E.includes("banana")||E.includes("edit")||E.includes("qwen"))&&!(E.includes("nano-banana-2")||((se==null?void 0:se.modelName)??"").includes("nano-banana-2")),vt=E.includes("gpt")||((se==null?void 0:se.modelName)??"").includes("gpt-image")||((se==null?void 0:se.provider)??"").toLowerCase().includes("gpt-4o image"),Qt=E.includes("flux")||((se==null?void 0:se.modelName)??"").includes("flux-kontext"),ct=((se==null?void 0:se.modelName)??"").includes("nano-banana-2")||E.includes("nano-banana-2"),bn=E.includes("mj")||((se==null?void 0:se.provider)??"").toLowerCase().includes("midjourney"),Kt=E.includes("jimeng")||((se==null?void 0:se.modelName)??"").includes("jimeng")||(se==null?void 0:se.provider)==="jimeng",B=()=>{var Ee;return E.includes("jimeng-4.5")?"jimeng-4.5":E.includes("jimeng-4.1")?"jimeng-4.1":E.includes("jimeng-4.0")?"jimeng-4.0":E.includes("jimeng-3.1")?"jimeng-3.1":E.includes("jimeng-3.0")?"jimeng-3.0":(Ee=se==null?void 0:se.modelName)!=null&&Ee.includes("jimeng")?se.modelName:"jimeng-4.5"},Me=(()=>{if(ct)return G==="4K"?"4K":G==="2K"?"2K":"1K"})(),Ge=Q==="Auto"?void 0:Q;if(z.length>0&&Ae){re=`${F}/v1/images/edits`,at=!0;const Ee=new FormData;Ee.append("model",(se==null?void 0:se.modelName)||"nano-banana"),Ee.append("prompt",n||"enhance"),Ee.append("n","1"),Ee.append("size",J),Ge&&Ee.append("aspect_ratio",Ge),Me&&Ee.append("image_size",Me);const Le=z.map(Et=>Ps(Et));(await Promise.all(Le)).forEach((Et,Ft)=>{Ee.append("image",Et,`input_${Ft}.png`)}),S&&Ee.append("mask",S,"mask.png"),Ie=Ee}else if(Qt){re=`${F}/v1/images/edits`,at=!0;const Ee=new FormData;Ee.append("model",(se==null?void 0:se.modelName)||"flux-kontext-pro"),Ee.append("prompt",n||""),Ge&&Ee.append("aspect_ratio",Ge),J&&Ee.append("size",J);const Le=z.length>0?z:y?[y]:[];if(Le.length>0){const Qe=Le.map(Ft=>Ps(Ft));(await Promise.all(Qe)).forEach((Ft,Vt)=>Ee.append("image",Ft,`flux_ref_${Vt}.png`))}S&&Ee.append("mask",S,"mask.png"),Ie=Ee}else if(vt){let Ee=n||"";const Le={model:(se==null?void 0:se.modelName)||"gpt-4o-image",prompt:Ee,n:1,size:J,aspect_ratio:Q,response_format:"url"};if(z.length>0){const Qe=z.map(Ft=>Hn(Ft)),Et=await Promise.all(Qe);Le.image=Et.map(Ft=>`data:image/png;base64,${Ft}`)}Ie=Le}else if(ct)if(z.length>0){re=`${F}/v1/images/edits?async=true`,at=!0;const Le=new FormData;Le.append("model",(se==null?void 0:se.modelName)||"nano-banana-2"),Le.append("prompt",n||""),Le.append("response_format","url"),Ge&&Le.append("aspect_ratio",Ge),Me&&Le.append("image_size",Me);const Qe=z.map(Ft=>Ps(Ft));(await Promise.all(Qe)).forEach((Ft,Vt)=>{Le.append("image",Ft,`input_${Vt}.png`)}),S&&Le.append("mask",S,"mask.png"),Ie=Le}else{re=`${F}/v1/images/generations?async=true`;const Le={model:(se==null?void 0:se.modelName)||"nano-banana-2",prompt:n||"",response_format:"url",...Ge?{aspect_ratio:Ge}:{},...Me?{image_size:Me}:{}};if(y){const Qe=y.trim();if(Qe.startsWith("http"))Le.image=[Qe];else if(Qe.startsWith("data:"))Le.image=[Qe];else{const Et=await Hn(Qe);Le.image=[`data:image/png;base64,${Et}`]}}Ie=Le}else if(bn){const Ee=((Wt=N==null?void 0:N.settings)==null?void 0:Wt.mjMode)||"fast",Le=((Bt=N==null?void 0:N.settings)==null?void 0:Bt.mjVersion)||"--v 7";let Qe=n||"";Q&&Q!=="Auto"&&(Qe.includes("--ar ")||(Qe=`${Qe} --ar ${Q}`.trim()));const Et=Vc(f,"oref"),Ft=Vc(f,"sref"),Vt=[],un=new Map;let Ln=null,Xn=null,Tn=[];const fi=Et||((Ht=N==null?void 0:N.settings)==null?void 0:Ht.mjOref)&&N.settings.mjOref.trim();if(fi&&fi.trim()){let vn=fi.trim();vn.startsWith("http")?Ln=vn:vn.startsWith("data:")?(Vt.push(vn),un.set("oref",Vt.length-1)):Ln=vn}const la=Ft||((rn=N==null?void 0:N.settings)==null?void 0:rn.mjSref)&&N.settings.mjSref.trim();if(la&&la.trim()){let vn=la.trim();vn.startsWith("http")?Xn=vn:vn.startsWith("data:")?(Vt.push(vn),un.set("sref",Vt.length-1)):Xn=vn}if(z.length>0)for(const vn of z)!(Et&&vn===Et)&&!(Ft&&vn===Ft)&&(vn.startsWith("http")?Tn.push(vn):vn.startsWith("data:")?(Vt.push(vn),un.set(`default_${Tn.length}`,Vt.length-1),Tn.push(null)):Tn.push(vn));if(Vt.length>0)try{const vn=await pb(Vt,F,U);un.has("oref")&&(Ln=vn[un.get("oref")]),un.has("sref")&&(Xn=vn[un.get("sref")]);for(let gs=0;gs<Tn.length;gs++)if(Tn[gs]===null){const jo=`default_${gs}`;un.has(jo)&&(Tn[gs]=vn[un.get(jo)])}}catch(vn){$t(gs=>gs.map(jo=>jo.id===te?{...jo,status:"failed",progress:0,errorMsg:`: ${vn.message}`}:jo));return}Tn=Tn.filter(vn=>vn!==null);let or="";Tn.length>0&&(or=Tn.join(" ")+" "),or+=Qe.trim(),!or.includes("--v ")&&!or.includes("--niji ")&&(or=`${or} ${Le}`.trim()),Q&&Q!=="Auto"&&!or.includes("--ar ")&&(or=`${or} --ar ${Q}`.trim()),Ln&&!or.includes("--oref ")&&(or=`${or} --oref ${Ln}`.trim()),(O=N==null?void 0:N.settings)!=null&&O.mjOw&&N.settings.mjOw>0&&!or.includes("--ow ")&&(or=`${or} --ow ${Math.min(1e3,Math.max(1,N.settings.mjOw))}`.trim()),Xn&&!or.includes("--sref ")&&(or=`${or} --sref ${Xn}`.trim()),re=`${F}/${Ee}/mj/submit/imagine`,Ie={prompt:or,base64Array:[]};const mp=await fetch(re,{method:"POST",headers:{Authorization:`Bearer ${U}`,"Content-Type":"application/json"},body:JSON.stringify(Ie)}),sm=await mp.text();if(!mp.ok)throw new Error(sm||`Midjourney API error: ${mp.status}`);let ml=JSON.parse(sm);if(ml.code!==1&&ml.code!==22)throw new Error(ml.description||`Midjourney: code ${ml.code}`);const gp=ml.result;if(!gp)throw new Error("ID");$t(vn=>vn.map(gs=>gs.id===te?{...gs,remoteTaskId:gp,status:"generating",progress:5}:gs)),Yc(gp,te,F,U,Ee,ge,le);return}else if(Kt)if(z.length>0){if(re=`${F}/v1/images/compositions`,!n||n.trim()==="")throw new Error("");let Ee=Q,Le="2k";if(Q==="Auto"&&y)try{const Vt=await Wr(y),un=[{name:"1:1",value:1},{name:"4:3",value:4/3},{name:"3:4",value:3/4},{name:"16:9",value:16/9},{name:"9:16",value:9/16},{name:"3:2",value:3/2},{name:"2:3",value:2/3},{name:"21:9",value:21/9}],Ln=Vt.w/Vt.h;let Xn=un[0],Tn=Math.abs(Ln-Xn.value);for(const fi of un){const la=Math.abs(Ln-fi.value);la<Tn&&(Tn=la,Xn=fi)}if(Ee=Xn.name,G==="Auto"){const fi=Math.max(Vt.w,Vt.h);Le=fi<=1024?"1k":fi<=2048?"2k":"4k"}}catch{Ee="1:1"}else Ee=Q==="Auto"?"1:1":Q;G!=="Auto"&&(Le=G==="1K"?"1k":G==="2K"?"2k":"4k");const Qe=z.map(async Vt=>{if(Vt.startsWith("blob:"))try{const un=await fetch(Vt);if(un.ok){const Ln=await un.blob();return await new Promise(Xn=>{const Tn=new FileReader;Tn.onloadend=()=>{Xn(Tn.result)},Tn.readAsDataURL(Ln)})}else throw new Error("Blob ")}catch(un){throw console.error(" Blob URL :",un),new Error("Blob URL")}if(Vt.startsWith("http"))try{const un=await fetch(Vt);if(!un.ok)throw new Error(`HTTP ${un.status}: URL`);const Ln=await un.blob();return await new Promise(Xn=>{const Tn=new FileReader;Tn.onloadend=()=>Xn(Tn.result),Tn.readAsDataURL(Ln)})}catch(un){throw new Error(`: ${un.message}`)}return Vt}),Et=await Promise.all(Qe);Ie={model:B(),prompt:n.trim(),images:Et,ratio:Ee,resolution:Le,response_format:"url"}}else{re=`${F}/v1/images/generations`;const Ee=Q==="Auto"?"1:1":Q;let Le="2k";if(G==="1K"?Le="1k":G==="2K"?Le="2k":G==="4K"&&(Le="4k"),!n||n.trim()==="")throw new Error("");Ie={model:B(),prompt:n.trim(),ratio:Ee,resolution:Le,response_format:"url"}}else Ie={model:(se==null?void 0:se.modelName)||E,prompt:n,n:1,size:J,response_format:"url"};const qe=async(Ee,Le)=>{const Qe=at?{Authorization:`Bearer ${Ee} `}:{Authorization:`Bearer ${Ee} `,"Content-Type":"application/json"};let Et;re.startsWith("http")?Le!==F&&re.includes(F)?Et=re.replace(F,Le):Et=re:Et=`${Le.replace(/\/+$/,"")}${re.startsWith("/")?re:"/"+re} `;const Ft=at?Ie:JSON.stringify(Ie);return await fetch(Et,{method:"POST",headers:Qe,body:Ft})},ut=A&&A.includes(",")?A.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee):[A||an],Nt=V.includes(",")?V.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee):[(V||xr).replace(/\/+$/,"")],rt=Ee=>{for(let Le=Ee.length-1;Le>0;Le--){const Qe=Math.floor(Math.random()*(Le+1));[Ee[Le],Ee[Qe]]=[Ee[Qe],Ee[Le]]}return Ee};ut.length>1&&rt(ut),Nt.length>1&&rt(Nt);let je,fe,me,ce,He=!1;const Xe=pn.current||{},Re=[];for(const Ee of ut)if(!Xe[Ee]&&!K(Ee))for(const Le of Nt)Re.push({key:Ee,url:Le});if(Re.length===0&&ut.length>0){console.warn("[Blacklist] All specified keys are blacklisted. Trying anyway with all available keys to avoid total failure.");for(const Ee of ut)for(const Le of Nt)Re.push({key:Ee,url:Le})}Re.length>1&&rt(Re);for(const Ee of Re)try{if(je=await qe(Ee.key,Ee.url),je.status===401||je.status===402||je.status===403){const Qe=je.status===402?" (402)":je.status===401?" (401)":" (403)";console.warn(`[API Failover] Key ending in ...${Ee.key.slice(-4)} failed with status ${je.status}. Trying next...`),mr(Ee.key,Qe),ce=new Error(`API returned ${je.status}: ${Qe}`);continue}me=await je.text();try{fe=JSON.parse(me)}catch{}let Le=fe==null?void 0:fe.code;if(fe!=null&&fe.message&&typeof fe.message=="string"){const Qe=fe.message.match(/:\s*(\d+)/);Qe&&(Le=parseInt(Qe[1],10))}if(Kt&&fe&&fe.code,Kt&&(Le===1e3||fe!=null&&fe.message&&fe.message.toLowerCase().includes("invalid parameter")))throw console.error(` [API Fatal]  (1000): ${fe.message}`),new Error(`: ${fe.message||"Invalid parameter"} ( 1000)`);if(Kt&&(Le===34010105||fe!=null&&fe.message&&fe.message.includes("34010105"))){console.warn(` [API Suspend] Key ending in ...${Ee.key.slice(-4)}  (34010105) 60 `),_e(Ee.key," (34010105)",60*60*1e3),ce=new Error(":  session ( 34010105)");continue}if(Kt&&Le===1006){if(ve(),Ve())throw new Error(" : ");const Qe=" (1006)";console.warn(` [API Blacklist] Key ending in ...${Ee.key.slice(-4)}  (1006)`),mr(Ee.key,Qe),ce=new Error(`Jimeng Error: ${fe.message||"Not enough credits"}`);continue}He=!0;break}catch(Le){if(Le.message.includes("")||Le.message.includes(""))throw Le;console.warn(`[API Failover] Network/Parse request failed for ...${Ee.key.slice(-4)}. Error: ${Le.message}`),ce=Le}if(!He||!je&&!me){const Ee=ce?ce.message:"All API combinations failed.";throw new Error(Ee)}if(!fe&&me)try{fe=JSON.parse(me)}catch{throw new Error(`: ${me.substring(0,100)}`)}if(!je.ok){let Ee=(fe==null?void 0:fe.message)||((de=fe==null?void 0:fe.error)==null?void 0:de.message)||me;throw vt&&je.status===500&&(Ee=`GPT - 4o (500): ${((Fe=fe==null?void 0:fe.error)==null?void 0:Fe.message)||(fe==null?void 0:fe.error)||(fe==null?void 0:fe.message)||me} 


1.API Key 
2.(${(se==null?void 0:se.modelName)||"gpt-4o-image"}) 
3.
4.`,$t(Qe=>Qe.map(Et=>Et.id===te?{...Et,status:"failed",progress:0,errorMsg:Ee}:Et))),new Error(Ee)}if(Kt&&(fe==null?void 0:fe.code)!==void 0&&fe.code!==0&&fe.code!==1&&fe.code!==200)throw new Error(fe.message||`API: ${fe.code} `);if(ct&&(fe!=null&&fe.task_id||typeof(fe==null?void 0:fe.data)=="string"&&fe.data.startsWith("task-"))){const Ee=fe.task_id||fe.data;$t(Le=>Le.map(Qe=>Qe.id===te?{...Qe,status:"generating",progress:10,remoteTaskId:Ee}:Qe)),Kc(te,Ee,F,U,ge,le,Ue,0,!0);return}let De=[];if(fe!=null&&fe.data&&Array.isArray(fe.data)?De=fe.data.map(Ee=>Ee.url||Ee.image_url||Ee).filter(Ee=>typeof Ee=="string"):(mt=fe==null?void 0:fe.data)!=null&&mt.data&&Array.isArray(fe.data.data)&&(De=fe.data.data.map(Ee=>Ee.url).filter(Boolean)),De.length===0)throw new Error("URL");const Ut=De[0],cn=Date.now()-st,en=Mn.current.get(te);en&&(en.isImageMode?qt(en.nodeId,en.shotId,{output_images:De,output_url:De[0],selectedImageIndex:0,outputEnabled:!1,status:"done"}):console.warn("[V3.7.30 Debug] "),Mn.current.delete(te)),$t(Ee=>Ee.map(Qe=>{if(Qe.id===te){const Et={...Qe,status:"completed",progress:100,url:Ut,width:ge,height:le,durationMs:cn,mjImages:De.length>1?De:null,selectedMjImageIndex:0};return Et.sourceNodeId&&!en&&setTimeout(()=>{Zs(te,Ut,"image",Et.sourceNodeId,Et.mjImages)},0),Et}return Qe}));return}if(c==="video"){const re=fn.get(E);if(E.includes("veo")){const je=`${F} /v2/videos / generations`;let fe=[];if(z&&z.length>0)fe=await Promise.all(z.filter(Xe=>Xe&&typeof Xe=="string"&&Xe.trim().length>0).map(async Xe=>{const Re=Xe.trim();if(Re.startsWith("http://")||Re.startsWith("https://"))try{const De=await Wr(Re);return De.w>1920||De.h>1920?await cp(Re,1920,1920):Re}catch(De){return console.warn("Veo: URL",De),Re}try{const De=await Wr(Re);return De.w>1920||De.h>1920?await cp(Re,1920,1920):Re.startsWith("data:")?Re:Re.startsWith("blob:")?`data: image / png; base64, ${await Hn(Re)} `:Re.length>100&&!Re.includes("://")&&!Re.startsWith("data:")?`data: image / png; base64, ${Re} `:`data: image / png; base64, ${await Hn(Re)} `}catch(De){throw console.error("Veo: Failed to process image:",De),new Error(`: ${Re.substring(0,50)}...`)}}));else if(y){const Xe=y.trim();try{const Re=await Wr(Xe);Re.w>1920||Re.h>1920?fe=[await cp(Xe,1920,1920)]:Xe.startsWith("http://")||Xe.startsWith("https://")?fe=[Xe]:Xe.startsWith("data:")?fe=[Xe]:Xe.startsWith("blob:")?fe=[`data: image / png; base64, ${await Hn(Xe)} `]:Xe.length>100&&!Xe.includes("://")&&!Xe.startsWith("data:")?fe=[`data: image / png; base64, ${Xe} `]:fe=[`data: image / png; base64, ${await Hn(Xe)} `]}catch(Re){throw console.error("Veo: Failed to process source image:",Re),new Error(`: ${Re.message} `)}}if(fe.length===0&&((z==null?void 0:z.length)>0||y))throw console.error("Veo: images ",{connectedImages:z,sourceImage:y}),new Error("");const me=fe.filter((Xe,Re)=>!Xe||typeof Xe!="string"?(console.warn(`Veo:  ${Re}: `),!1):Xe==="base64_data"||Xe.trim()==="base64_data"?(console.warn(`Veo:  ${Re}: base64_data`),!1):!0);if(me.length===0&&((z==null?void 0:z.length)>0||y))throw console.error("Veo: ",{images:fe,connectedImages:z,sourceImage:y}),new Error("");let ce=null;if(Q&&Q!=="Auto")if(Q==="16:9"||Q==="9:16")ce=Q;else{const Xe=ge/le;Math.abs(Xe-16/9)<Math.abs(Xe-9/16)?ce="16:9":ce="9:16"}const He={model:(re==null?void 0:re.modelName)||"veo3.1",prompt:n,enhance_prompt:!1,images:me.length>0?me:[],...ce?{aspect_ratio:ce}:{}};console.log("Veo: ",{endpoint:je,model:He.model,prompt:((Ct=He.prompt)==null?void 0:Ct.substring(0,50))+"...",imagesCount:He.images.length,firstImageType:He.images[0]?He.images[0].startsWith("http")?"HTTP URL":He.images[0].startsWith("data:")?"Data URL":"Unknown":"empty",firstImagePreview:He.images[0]?He.images[0].startsWith("http")?He.images[0].substring(0,80):He.images[0].substring(0,100):"empty",aspect_ratio:He.aspect_ratio,payloadSize:JSON.stringify(He).length});try{const Xe=await fetch(je,{method:"POST",headers:{Authorization:`Bearer ${U} `,"Content-Type":"application/json"},body:JSON.stringify(He)}),Re=await Xe.text();if(!Xe.ok)throw console.error("Veo: ",{status:Xe.status,text:Re}),new Error(Re||`Veo error: ${Xe.status} `);const De=JSON.parse(Re),Ut=((Ot=De==null?void 0:De.data)==null?void 0:Ot.id)||(De==null?void 0:De.id)||(De==null?void 0:De.task_id)||((wt=De==null?void 0:De.data)==null?void 0:wt.task_id);if(!Ut)throw console.error("Veo:  JobId",De),new Error("Veo No JobId");$t(Tt=>Tt.map(cn=>cn.id===te?{...cn,status:"generating",progress:10}:cn)),Bi(Ut,te,F,U,ge,le);return}catch(Xe){throw console.error("Veo: ",Xe),$t(Re=>Re.map(De=>De.id===te?{...De,status:"failed",errorMsg:Xe.message||""}:De)),Xe}}let Ie="",at;const se={Authorization:`Bearer ${U} `},Ae=(()=>{if(ne==null)return 8;const je=String(ne).trim().replace(/[^\d]/g,""),fe=parseInt(je,10);return Number.isFinite(fe)&&fe>0?fe:8})();if(E.includes("grok")){const je=`${F} /v2/videos / generations`,fe=parseInt(ne,10),me=Q&&Q!=="Auto"?Q:"3:2",ce=G&&G!=="Auto"?G:"1080P",He={model:(re==null?void 0:re.modelName)||"grok-video-3",prompt:n,ratio:me,resolution:ce};if(Number.isFinite(fe)&&fe>0&&(He.duration=fe),y)try{let Tt="";if(y.startsWith("data:"))Tt=y;else{const cn=await Ps(y);Tt=await new Promise((en,Ee)=>{const Le=new FileReader;Le.onloadend=()=>en(Le.result),Le.onerror=Ee,Le.readAsDataURL(cn)})}He.images=[Tt]}catch(Tt){console.error("Grok Image Conversion Failed:",Tt),alert("");return}const Xe=await fetch(je,{method:"POST",headers:{Authorization:`Bearer ${U} `,"Content-Type":"application/json"},body:JSON.stringify(He)}),Re=await Xe.text();if(!Xe.ok)throw console.error("[Grok API Error]",Re),new Error(Re||`Grok API error: ${Xe.status} `);let De;try{De=JSON.parse(Re)}catch{throw new Error("API  JSON ")}const Ut=((Lt=De==null?void 0:De.data)==null?void 0:Lt.id)||(De==null?void 0:De.id)||(De==null?void 0:De.task_id);if(!Ut)throw console.error("Grok No Task ID:",De),new Error("API  Task ID");$t(Tt=>Tt.map(cn=>cn.id===te?{...cn,status:"generating",progress:10,remoteTaskId:Ut}:cn)),bo(Ut,te,F,U,ge,le,E);return}if(y){const je=new FormData,fe=await Ps(y);if(E.includes("sora")){Ie=`${F} /v1/videos`;let me=n.replace(/@\{([^\}]+)\}/g,(ce,He)=>`@${He} `);je.append("model",(re==null?void 0:re.modelName)||"sora-2"),je.append("prompt",me),je.append("seconds",ne),je.append("size",J),E==="sora-2"&&(p.isHD||(pt=N==null?void 0:N.settings)!=null&&pt.isHD)&&je.append("quality","hd"),je.append("input_reference",fe,"ref.png"),je.append("image",fe,"ref.png")}else if(E.includes("jimeng")){Ie=`${F}/v1/videos/generations`,je.append("model",(re==null?void 0:re.modelName)||E||"jimeng-video-3.0"),je.append("prompt",n),je.append("duration",parseInt(ne));const me=Q==="Auto"?"1:1":Q;je.append("ratio",me);const ce=_u(G);ce&&je.append("resolution",ce);const He=z.filter(Boolean).slice(0,2),Xe=await Promise.all(He.map(Re=>Ps(Re)));Xe[0]&&je.append("image_file_1",Xe[0],"first.png"),Xe[1]&&je.append("image_file_2",Xe[1],"last.png")}else E.includes("grok")?(Ie=`${F} /v1/videos`,je.append("model",(re==null?void 0:re.modelName)||"grok-video-3"),je.append("prompt",n),je.append("aspect_ratio",Q),je.append("duration",Ae),je.append("image",fe,"input.png")):(Ie=`${F} /v1/videos`,je.append("model",re==null?void 0:re.modelName),je.append("prompt",n),je.append("image",fe,"input.png"),je.append("size",J));at=je}else if(se["Content-Type"]="application/json",E.includes("sora")){delete se["Content-Type"],Ie=`${F} /v1/videos`;const je=new FormData;let fe=n.replace(/@\{([^\}]+)\}/g,(me,ce)=>`@${ce} `);je.append("model",(re==null?void 0:re.modelName)||"sora-2"),je.append("prompt",fe),je.append("seconds",ne),je.append("size",J),E==="sora-2"&&(p.isHD||(ft=N==null?void 0:N.settings)!=null&&ft.isHD)&&je.append("quality","hd"),at=je}else if(E.includes("jimeng")){Ie=`${F}/v1/videos/generations`;const je=Q==="Auto"?"1:1":Q,fe=_u(G),me={model:(re==null?void 0:re.modelName)||E||"jimeng-video-3.0",prompt:n,duration:parseInt(ne),ratio:je};fe&&(me.resolution=fe),at=JSON.stringify(me)}else E.includes("grok")?(Ie=`${F} /v1/videos`,at=JSON.stringify({model:(re==null?void 0:re.modelName)||"grok-video-3",prompt:n,aspect_ratio:Q,duration:Ae})):(Ie=`${F} /minimax/v1 / video_generation`,at=JSON.stringify({model:re==null?void 0:re.modelName,prompt:n,resolution:J}));const vt=await fetch(Ie,{method:"POST",headers:at instanceof FormData?{Authorization:se.Authorization}:se,body:at}),Qt=await vt.text();if(!vt.ok)throw new Error(Qt||`Video API error: ${vt.status} `);const ct=JSON.parse(Qt),bn=(ct==null?void 0:ct.code)||((kt=ct==null?void 0:ct.data)==null?void 0:kt.code),Kt=(ct==null?void 0:ct.message)||((ot=ct==null?void 0:ct.data)==null?void 0:ot.message)||"";let B=bn;const ze=Kt.match(/[:]\s*(\d+)/);if(ze&&(B=parseInt(ze[1],10)),B===1e3)throw console.error(` [Video API]  (1000): ${Kt}`),new Error(`: ${Kt||"Invalid parameter"} ( 1000)`);const Ge=B===1006,qe=bn===-2001&&Kt.includes("34010105");if(bn===-2008||Kt.includes("2060")){let je=" ";throw Kt.includes(": 30")&&(je+="\\n\\n \\n \\n \\n \\n "),Kt.includes("2060")&&(je+="\\n\\n: 2060 ()"),new Error(je)}if(Ge||qe){const je=Ge?" (1006)":" (34010105)";console.warn(` [Video API] Key ending in ...${U.slice(-4)} failed: ${je}. Adding to blacklist.`),mr(U,je);const fe=new Error(`RETRY_WITH_NEW_KEY: ${Kt}`);throw fe.shouldRetry=!0,fe}const Nt=(ct==null?void 0:ct.video_url)||(ct==null?void 0:ct.url)||((Mt=ct==null?void 0:ct.data)==null?void 0:Mt.video_url)||((Dt=ct==null?void 0:ct.data)==null?void 0:Dt.url)||Array.isArray(ct==null?void 0:ct.data)&&((Rt=ct.data[0])==null?void 0:Rt.url);if(Nt){const je=Date.now(),fe=yo.get(te),me=fe==null?void 0:fe.sourceNodeId,ce=je-((fe==null?void 0:fe.startTime)||je);$t(He=>{const Xe=He.map(De=>De.id===te?{...De,status:"completed",progress:100,url:Nt,width:ge,height:le,durationMs:ce}:De),Re=Mn.current.get(te);if(Re)qt(Re.nodeId,Re.shotId,{video_url:Nt,status:"done",durationCost:ce/1e3}),Mn.current.delete(te);else{const De=Xe.find(Ut=>Ut.id===te);De!=null&&De.sourceNodeId?setTimeout(()=>{Zs(te,Nt,"video",De.sourceNodeId)},0):console.warn("[Tapnow] :  sourceNodeId",{taskId:te,updatedItem:De})}return Xe});return}const rt=((zt=ct==null?void 0:ct.data)==null?void 0:zt.id)||(ct==null?void 0:ct.id)||(ct==null?void 0:ct.task_id)||((yn=ct==null?void 0:ct.data)==null?void 0:yn.task_id)||(ct==null?void 0:ct.job_id)||((En=ct==null?void 0:ct.data)==null?void 0:En.job_id);if(!rt)throw new Error(`No Task/Job ID returned. Response: ${JSON.stringify(ct).substring(0,200)}`);E.includes("veo")?Bi(rt,te,F,U,ge,le):bo(rt,te,F,U,ge,le,E)}}catch(re){if(re.shouldRetry)return vo(n,c,d,f,{...p,_isRetry:!0,_existingTaskId:te});console.error("[CONSOLE_ERROR]",re);const Ie=Date.now(),at=dt.find(vt=>vt.id===te),se=at!=null&&at.startTime?Ie-at.startTime:0;let Ae=(re==null?void 0:re.message)||"";try{if(typeof Ae=="string"&&Ae.trim().startsWith("{")){const vt=JSON.parse(Ae);(Z=vt==null?void 0:vt.error)!=null&&Z.message?Ae=vt.error.message:vt!=null&&vt.error?Ae=typeof vt.error=="string"?vt.error:JSON.stringify(vt.error):vt!=null&&vt.message&&(Ae=vt.message)}(Ae.includes("Cannot find module")||Ae.includes("octetstream")||Ae.includes("MODULE_NOT_FOUND"))&&(!Ae.includes("API")&&!Ae.includes("")?Ae=` API

${Ae.replace(/[:].*?[:]/g,"").trim()} 

 
1.jimeng - api.exe
2.Dockerdocker pull ghcr.io / iptag / jimeng - api: latest`:Ae.includes("")||(Ae=Ae+`

 
1. jimeng-api.exe
2. Dockerdocker pull ghcr.io/iptag/jimeng-api:latest`))}catch{(Ae.includes("Cannot find module")||Ae.includes("octetstream")||Ae.includes("MODULE_NOT_FOUND"))&&!Ae.includes("API")&&!Ae.includes("")&&(Ae=` API

 
1.jimeng - api.exe
2.Dockerdocker pull ghcr.io / iptag / jimeng - api: latest`)}$t(vt=>vt.map(Qt=>Qt.id===te?{...Qt,status:"failed",errorMsg:Ae,durationMs:se}:Qt))}},gb=()=>{t(n=>n==="dark"?"light":"dark")},xb=async()=>{const n=Br.current,c=Oi.current,d=Xs.current,f=n.filter(p=>(c===p.id||d&&d.has(p.id))&&(p.type==="input-image"||p.type==="video-input"||p.type==="preview")&&p.content);if(f.length===0){alert("");return}for(const p of f)try{const h=p.content;if(!h||typeof h!="string"&&!h.startsWith("data:")){console.warn(` ${p.id} URL: `,h);continue}const g=await fetch(h);if(!g.ok)throw new Error(`HTTP ${g.status}: ${g.statusText} `);const z=await g.blob(),y=URL.createObjectURL(z),N=document.createElement("a");N.href=y;let S=".png";p.type==="preview"?p.previewType==="video"?S=".mp4":S=Un(h)?".mp4":".png":p.type==="video-input"?S=".mp4":S=Un(h)?".mp4":".png";const C=`${p.id}${S} `;N.download=C,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(y),await new Promise(E=>setTimeout(E,100))}catch(h){console.error(` ${p.id} : `,h)}},Gc=()=>{const n=new Date;return new Date(n.getTime()+8*60*60*1e3).toISOString()},Xc=()=>{const n=new Date,c=new Date(n.getTime()+8*60*60*1e3),d=c.getUTCFullYear(),f=String(c.getUTCMonth()+1).padStart(2,"0"),p=String(c.getUTCDate()).padStart(2,"0"),h=String(c.getUTCHours()).padStart(2,"0"),g=String(c.getUTCMinutes()).padStart(2,"0"),z=String(c.getUTCSeconds()).padStart(2,"0");return`${d} -${f} -${p}T${h} -${g} -${z} `},yb=async()=>{try{if(!window.showSaveFilePicker){if(!confirm(`

/>500MB Chrome  Edge 

`))return;const y=(J,ge)=>ge===void 0?null:ge,N=JSON.parse(JSON.stringify(a,y)),S=async J=>{if(J==null)return J;if(typeof J=="string"&&J.startsWith("blob:"))try{const ge=await Ps(J);return await lp(ge)}catch(ge){return console.error(" Blob URL :",ge),J}if(Array.isArray(J))return await Promise.all(J.map(ge=>S(ge)));if(typeof J=="object"){const ge={};for(const le in J)J.hasOwnProperty(le)&&(ge[le]=await S(J[le]));return ge}return J},C=await S(N),E=JSON.parse(JSON.stringify(On,y)),H=await S(E),A={version:"2.5.7",projectName:Ye,nodes:C,connections:u,view:we,history:dt,chatSessions:wr,characterLibrary:H,timestamp:Gc()},U=JSON.stringify(A,y,2),V=new Blob([U],{type:"application/json"}),F=URL.createObjectURL(V),Q=document.createElement("a");Q.href=F;const G=Xc(),pe=`${Ye||""}_${G}.json`;Q.download=pe,document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(F),alert("");return}const n=Xc(),d=await(await window.showSaveFilePicker({suggestedName:`${Ye||""}_${n}.json`,types:[{description:"JSON File",accept:{"application/json":[".json"]}}]})).createWritable(),f=(z,y)=>y===void 0?null:y,p=async z=>{const y={...z};if(y.content&&typeof y.content=="string"&&y.content.startsWith("blob:"))try{const N=await Hn(y.content),S=Un(y.content)?"video/mp4":"image/png";y.content=`data:${S}; base64, ${N} `}catch(N){console.error(" content :",N)}if(y.maskContent&&typeof y.maskContent=="string"&&y.maskContent.startsWith("blob:"))try{const N=await Hn(y.maskContent);y.maskContent=`data: image / png; base64, ${N} `}catch(N){console.error(" maskContent :",N)}if(Array.isArray(y.selectedKeyframes))for(let N=0;N<y.selectedKeyframes.length;N++){const S=y.selectedKeyframes[N];if(S&&S.url&&typeof S.url=="string"&&S.url.startsWith("blob:"))try{const C=await Hn(S.url);S.url=`data: image / png; base64, ${C} `}catch(C){console.error(":",C)}}if(Array.isArray(y.frames))for(let N=0;N<y.frames.length;N++){const S=y.frames[N];if(S&&S.url&&typeof S.url=="string"&&S.url.startsWith("blob:"))try{const C=await Hn(S.url);S.url=`data: image / png; base64, ${C} `}catch(C){console.error(":",C)}}if(Array.isArray(y.previewMjImages))for(let N=0;N<y.previewMjImages.length;N++){const S=y.previewMjImages[N];if(S&&typeof S=="string"&&S.startsWith("blob:"))try{const C=await Hn(S);y.previewMjImages[N]=`data:image/png;base64,${C}`}catch(C){console.error(" previewMjImages :",C)}}return y},h=async z=>{const y={...z};if(y.url&&typeof y.url=="string"&&y.url.startsWith("blob:"))try{const N=await Hn(y.url),S=y.type==="video"?"video/mp4":"image/png";y.url=`data:${S}; base64, ${N} `}catch(N){console.error(" url :",N)}if(y.mjOriginalUrl&&typeof y.mjOriginalUrl=="string"&&y.mjOriginalUrl.startsWith("blob:"))try{const N=await Hn(y.mjOriginalUrl);y.mjOriginalUrl=`data: image / png; base64, ${N} `}catch(N){console.error(" mjOriginalUrl :",N)}if(Array.isArray(y.mjImages))for(let N=0;N<y.mjImages.length;N++){const S=y.mjImages[N];if(S&&typeof S=="string"&&S.startsWith("blob:"))try{const C=await Hn(S);y.mjImages[N]=`data: image / png; base64, ${C} `}catch(C){console.error(" mjImages :",C)}}return y},g=async z=>{const y={...z};if(y.avatar&&typeof y.avatar=="string"&&y.avatar.startsWith("blob:"))try{const N=await Hn(y.avatar);y.avatar=`data: image / png; base64, ${N} `}catch(N){console.error(" avatar :",N)}if(y.profile_picture_url&&typeof y.profile_picture_url=="string"&&y.profile_picture_url.startsWith("blob:"))try{const N=await Hn(y.profile_picture_url);y.profile_picture_url=`data: image / png; base64, ${N} `}catch(N){console.error(" profile_picture_url :",N)}return y};await d.write(`{
    
  "version": "2.5.7", 
  "projectName": ${JSON.stringify(Ye||"")}, 
  "nodes": [
`);for(let z=0;z<a.length;z++){const y=a[z],N=await p(y),S=JSON.stringify(N,f,2),C=z===0?S.split(`
`).join(`
    `):"    "+S.split(`
`).join(`
    `);await d.write(C),z<a.length-1?await d.write(`,
`):await d.write(`
`)}await d.write(`  ], 
  "connections": ${JSON.stringify(u,f,2)}, 
  "view": ${JSON.stringify(we,f,2)}, 
  "history": [
`);for(let z=0;z<dt.length;z++){const y=dt[z],N=await h(y),S=JSON.stringify(N,f,2),C=z===0?S.split(`
`).join(`
    `):"    "+S.split(`
`).join(`
    `);await d.write(C),z<dt.length-1?await d.write(`,
`):await d.write(`
`)}await d.write(`  ], 
  "chatSessions": ${JSON.stringify(wr,f,2)}, 
  "characterLibrary": [
`);for(let z=0;z<On.length;z++){const y=On[z],N=await g(y),S=JSON.stringify(N,f,2),C=z===0?S.split(`
`).join(`
    `):"    "+S.split(`
`).join(`
    `);await d.write(C),z<On.length-1?await d.write(`,
`):await d.write(`
`)}await d.write(`  ], 
  "timestamp": ${JSON.stringify(Gc())} 

} `),await d.close(),alert("")}catch(n){if(console.error(":",n),n.name==="AbortError")return;alert(": "+(n.message||""))}},bb=async()=>{try{Hd({visible:!1,x:0,y:0});const n=Cn.size>0?Cn:ee?new Set([ee]):new Set;if(n.size===0){alert("");return}const c=a.filter(y=>n.has(y.id)),d=u.filter(y=>n.has(y.from)&&n.has(y.to));if(!window.showSaveFilePicker){if(!confirm(`

`))return;const N=(G,pe)=>pe===void 0?null:pe,S=JSON.parse(JSON.stringify(c,N)),C=async G=>{if(G==null)return G;if(typeof G=="string"&&G.startsWith("blob:"))try{const pe=await Ps(G);return await lp(pe)}catch(pe){return console.error(" Blob URL :",pe),G}if(Array.isArray(G))return await Promise.all(G.map(pe=>C(pe)));if(typeof G=="object"){const pe={};for(const J in G)G.hasOwnProperty(J)&&(pe[J]=await C(G[J]));return pe}return G},H={version:"3.7.36c",type:"workflow",nodes:await C(S),connections:d,timestamp:Gc()},A=JSON.stringify(H,N,2),U=new Blob([A],{type:"application/json"}),V=URL.createObjectURL(U),F=document.createElement("a");F.href=V;const Q=Xc();F.download=`_${Q}.json`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(V),alert("");return}const f=Xc(),h=await(await window.showSaveFilePicker({suggestedName:`_${f}.json`,types:[{description:"JSON File",accept:{"application/json":[".json"]}}]})).createWritable(),g=(y,N)=>N===void 0?null:N,z=async y=>{const N={...y};if(N.content&&typeof N.content=="string"&&N.content.startsWith("blob:"))try{const S=await Hn(N.content),C=Un(N.content)?"video/mp4":"image/png";N.content=`data:${C};base64,${S}`}catch(S){console.error(" content :",S)}if(N.maskContent&&typeof N.maskContent=="string"&&N.maskContent.startsWith("blob:"))try{const S=await Hn(N.maskContent);N.maskContent=`data:image/png;base64,${S}`}catch(S){console.error(" maskContent :",S)}if(Array.isArray(N.selectedKeyframes))for(let S=0;S<N.selectedKeyframes.length;S++){const C=N.selectedKeyframes[S];if(C&&C.url&&typeof C.url=="string"&&C.url.startsWith("blob:"))try{const E=await Hn(C.url);C.url=`data:image/png;base64,${E}`}catch(E){console.error(":",E)}}if(Array.isArray(N.frames))for(let S=0;S<N.frames.length;S++){const C=N.frames[S];if(C&&C.url&&typeof C.url=="string"&&C.url.startsWith("blob:"))try{const E=await Hn(C.url);C.url=`data:image/png;base64,${E}`}catch(E){console.error(":",E)}}if(Array.isArray(N.previewMjImages))for(let S=0;S<N.previewMjImages.length;S++){const C=N.previewMjImages[S];if(C&&typeof C=="string"&&C.startsWith("blob:"))try{const E=await Hn(C);N.previewMjImages[S]=`data:image/png;base64,${E}`}catch(E){console.error(":",E)}}return N};await h.write(`{
  "version": "3.7.36c",
  "type": "workflow",
  "nodes": [
`);for(let y=0;y<c.length;y++){const N=await z(c[y]),C=JSON.stringify(N,g,4).split(`
`).map(E=>"    "+E).join(`
`);await h.write(C),y<c.length-1?await h.write(`,
`):await h.write(`
`)}await h.write(`  ],
  "connections": ${JSON.stringify(d,g,2)},
  "timestamp": ${JSON.stringify(Gc())}
}`),await h.close(),alert("")}catch(n){if(console.error(":",n),n.name==="AbortError")return;alert(": "+(n.message||""))}},vb=async()=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async c=>{const d=c.target.files[0];if(d)try{const f=await d.text(),p=JSON.parse(f);if(p.type!=="workflow"){alert(`

""`);return}if(!p.nodes||p.nodes.length===0){alert("");return}let h=[];const g=(Zt||"http://127.0.0.1:9527").replace(/\/+$/,"");try{if(g){const F=await fetch(`${g}/list-files`);if(F.ok){const Q=await F.json();Q.success&&Q.files&&(h=Q.files,console.log(`[]  ${h.length} `))}}}catch{console.log("[] ")}const z=F=>{if(!h.length||!F)return null;try{const Q=F.split(",")[1];if(!Q)return null;const G=Math.floor(Q.length*.75),pe=G*.05,J=h.find(ge=>Math.abs(ge.size-G)<pe);if(J)return`${g}/file/${encodeURIComponent(J.rel_path)}`}catch{}return null},y=async F=>{const Q=[F];for(;Q.length>0;){const G=Q.pop();if(!(!G||typeof G!="object"))for(const pe in G){const J=G[pe];if(typeof J=="string"&&(J.startsWith("data:image/")||J.startsWith("data:video/")))try{const ge=z(J);if(ge&&(await fetch(ge,{method:"HEAD"})).ok){G[pe]=ge;continue}const ne=await(await fetch(J)).blob();G[pe]=URL.createObjectURL(ne)}catch{}else typeof J=="object"&&J!==null&&Q.push(J)}}return F},N=new Map;p.nodes.forEach(F=>{N.set(F.id,`node-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)});const S=Gs.current;let C=100,E=100;if(S){const F=S.getBoundingClientRect(),Q=F.width/2,G=F.height/2,pe=mn(Q+F.left,G+F.top);C=pe.x,E=pe.y}let H=1/0,A=1/0;p.nodes.forEach(F=>{F.x<H&&(H=F.x),F.y<A&&(A=F.y)});const U=[];for(const F of p.nodes){const Q=await y({...F});Q.id=N.get(F.id),Q.x=F.x-H+C,Q.y=F.y-A+E,U.push(Q)}const V=(p.connections||[]).map(F=>({...F,from:N.get(F.from),to:N.get(F.to)})).filter(F=>F.from&&F.to);l(F=>[...F,...U]),m(F=>[...F,...V]),Ir(new Set(U.map(F=>F.id))),alert(`

 ${U.length}  ${V.length} `)}catch(f){console.error(":",f),alert(": "+(f.message||"JSON"))}},n.click()},wb=()=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async c=>{const d=c.target.files[0];if(!d)return;Qn({visible:!0,progress:0,status:"INITIALIZING...",type:"import"});let f=[];const p=(Zt||"http://127.0.0.1:9527").replace(/\/+$/,"");try{if(p){const U=await fetch(`${p}/list-files`);if(U.ok){const V=await U.json();V.success&&V.files&&(f=V.files,console.log(`[]  ${f.length} `))}}}catch{console.log("[] ")}const h=U=>{if(!f.length||!U)return null;try{const V=U.split(",")[1];if(!V)return null;const F=Math.floor(V.length*.75),Q=F*.05,G=f.find(pe=>Math.abs(pe.size-F)<Q);if(G)return`${p}/file/${encodeURIComponent(G.rel_path)}`}catch{}return null},g={nodes:[],history:[],connections:[],chatSessions:[],characterLibrary:[],projectName:"",view:null};let z=null,y="",N="",S=0,C=!1,E=0;const H=d.size,A=async U=>{const V=[U];for(;V.length>0;){const F=V.pop();if(!(!F||typeof F!="object"))for(const Q in F){const G=F[Q];if(typeof G=="string"&&(G.startsWith("data:image/")||G.startsWith("data:video/")))try{const pe=h(G);if(pe&&(await fetch(pe,{method:"HEAD"})).ok){F[Q]=pe;continue}const ge=await(await fetch(G)).blob();F[Q]=URL.createObjectURL(ge)}catch{}else typeof G=="object"&&G!==null&&V.push(G)}}return U};try{const V=d.stream().pipeThrough(new TextDecoderStream).getReader();for(;;){const{value:F,done:Q}=await V.read();if(Q)break;if(E+=F.length,Math.random()>.95){const G=Math.min(99,E/H*100);Qn(pe=>({...pe,progress:G,status:`PROCESSING ${(E/1024/1024).toFixed(0)} MB`}))}for(y+=F;;){const G=y.indexOf(`
`);if(G===-1)break;const pe=y.substring(0,G);y=y.substring(G+1);const J=pe.trim();if(J){if(J.includes('"nodes": [')){z="nodes";continue}if(J.includes('"history": [')){z="history";continue}if(J.includes('"connections": [')){z="connections";continue}if(J.includes('"chatSessions": [')){z="chatSessions";continue}if(J.includes('"characterLibrary": [')){z="characterLibrary";continue}if((J==="],"||J==="]")&&S===0){z=null,N="",C=!1;continue}if(!z){if(J.startsWith('"projectName":'))try{const ge=J.match(/"projectName":\s*(.+)/);ge&&(g.projectName=JSON.parse(ge[1].replace(/,$/,"")))}catch{}if(J.startsWith('"view":'))try{const ge=J.match(/"view":\s*(.+)/);ge&&ge[1].endsWith("}")&&(g.view=JSON.parse(ge[1].replace(/,$/,"")))}catch{}continue}if(z){for(let ge of pe)ge==="{"&&(S++,C=!0),ge==="}"&&S--;if(N+=pe+`
`,C&&S===0){let ge=N.trim();ge.endsWith(",")&&(ge=ge.slice(0,-1));try{const le=JSON.parse(ge);(z==="nodes"||z==="history"||z==="characterLibrary")&&await A(le),z==="nodes"&&le.id?(le.settings||(le.settings={}),g.nodes.push(le)):z==="history"?g.history.push(le):z==="connections"?g.connections.push(le):z==="chatSessions"?g.chatSessions.push(le):z==="characterLibrary"&&g.characterLibrary.push(le)}catch{}N="",C=!1}}}}}Qn(F=>({...F,progress:100,status:"FINALIZING..."})),setTimeout(()=>{It(g.projectName||""),g.view&&Ne(g.view),g.connections.length>0&&m(g.connections),g.chatSessions.length>0&&_s(g.chatSessions),g.characterLibrary.length>0&&Zo(g.characterLibrary),g.nodes.length>0&&l(g.nodes),g.history.length>0&&$t(g.history),Qn(F=>({...F,visible:!1})),alert(`
${g.nodes.length} `)},200)}catch(U){console.error(":",U),Qn(V=>({...V,visible:!1})),alert(`: ${U.message} `)}},n.click()},$r=(n,c,d,f,p=void 0,h=void 0,g=void 0,z=void 0)=>{M();const y=n==="gen-video"?{w:380,h:420}:n==="gen-image"?{w:440,h:340}:n==="video-input"?{w:580,h:460}:n==="video-analyze"?{w:480,h:500}:n==="storyboard-node"?{w:720,h:500}:n==="image-compare"?{w:400,h:300}:n==="preview"?{w:320,h:260}:n==="text-node"?{w:280,h:200}:n==="novel-input"?{w:400,h:500}:n==="extract-characters-scenes"?{w:400,h:500}:n==="character-description"||n==="scene-description"?{w:400,h:400}:n==="create-character"||n==="create-scene"?{w:350,h:300}:n==="generate-character-video"||n==="generate-scene-video"?{w:400,h:450}:n==="generate-character-image"||n==="generate-scene-image"?{w:400,h:450}:n==="local-save"?{w:320,h:380}:{w:260,h:260},N={id:`node - ${Date.now()} `,type:n,x:c-y.w/2,y:d-y.h/2,width:y.w,height:y.h,content:p,...h?{dimensions:h}:{},settings:n==="gen-image"?{model:Ri,ratio:ci,resolution:xo,prompt:""}:n==="gen-video"?{model:go,duration:"5s",ratio:ci,resolution:sa,videoPrompt:""}:n==="video-analyze"?{model:X1,segmentDuration:parseInt(Y1),analysisMode:"manual",voiceoverResults:[],analysisResults:[]}:n==="storyboard-node"?{projectTitle:"",shots:[]}:n==="text-node"?{text:p||""}:n==="novel-input"?{content:""}:n==="extract-characters-scenes"?{model:Di||"",analysisResults:null,lastAnalyzed:null,isAnalyzing:!1,progress:0,errorMsg:null}:n==="character-description"||n==="scene-description"?{characterId:"",characterName:"",role:"",age:"",gender:"",sceneId:"",sceneName:"",description:"",prompt:"",mode:"video",style:"none",imageModel:Ri,imageRatio:ci||"16:9",imageResolution:xo,referenceImages:[],chatModel:Di||"",isEnhancing:!1}:n==="create-character"||n==="create-scene"?{name:"",startSecond:1,endSecond:3,isCreating:!1,createProgress:0,createError:null}:n==="generate-character-video"||n==="generate-scene-video"?{model:go,duration:"15s",ratio:ci||"16:9",resolution:sa,videoPrompt:"",referenceImages:[],sourceType:"",sourceId:"",isGenerating:!1,progress:0,error:null}:n==="generate-character-image"||n==="generate-scene-image"?{model:Ri,ratio:ci||"16:9",resolution:xo,prompt:"",referenceImages:[],chatModel:Di||"",imageUrls:[],selectedImageIndex:null,isGenerating:!1,progress:0,error:null}:n==="local-save"?{serverUrl:Zt,savePath:"",subfolder:"",autoSave:!1,serverStatus:on?"connected":"disconnected",lastSaved:null,savedFiles:[],lastSavedUrls:[]}:{}};return l(S=>[...S,N]),f&&m(S=>[...S,{id:`conn - ${Date.now()} `,from:f,to:N.id}]),g&&m(S=>z&&z!=="default"?[...S.filter(E=>!(E.to===g&&(E.inputType||"default")===z)),{id:`conn - ${Date.now()} `,from:N.id,to:g,inputType:z!=="default"?z:void 0}]:[...S,{id:`conn - ${Date.now()} `,from:N.id,to:g}]),Xo(S=>({...S,visible:!1})),Ti(!1),Yo(null),ds(null),fs(null),N},kb=n=>{if(!n)return"";if(typeof n=="number")return`${n}`;const c=String(n).trim();return c?c.includes("")||c.includes("")?c:`${c}`:""},zb=[{value:"none",label:""},{value:"2d-anime",label:"2D"},{value:"3d-anime",label:"3D"},{value:"realistic",label:""},{value:"selfie",label:""},{value:"news",label:""},{value:"manga",label:""}],jb=D.useCallback(n=>{switch(n){case"2d-anime":return"2D";case"3d-anime":return"3D";case"realistic":return"";case"selfie":return"";case"news":return"";case"manga":return"";default:return""}},[]),Wh=n=>{if(!n)return"";let c=n.replace(/360/g,"");return["",""].forEach(f=>{const p=c.indexOf(f);p!==-1&&(c=c.slice(0,p))}),c},Hh=n=>n&&(n.includes("360")?n:`${n}360`),wo=D.useCallback((n,c="video")=>{const d=(n==null?void 0:n.name)||(n==null?void 0:n.characterName)||"",f=((n==null?void 0:n.role)||(n==null?void 0:n.identity)||(n==null?void 0:n.profession)||"").trim(),p=((n==null?void 0:n.description)||(n==null?void 0:n.appearance)||"").trim(),h=kb(n==null?void 0:n.age),g=n!=null&&n.gender?String(n.gender).trim():"",z=`${h}${g}`.trim()||"",y=[f,p].filter(Boolean).join(""),N=y?`${y}`:"",S=f||p?`${f||p}`:"",C=`${d}${z}${N}`,E=`${C}${d}${S}`;return c==="video"?`${E}360`:C},[]),pl=D.useCallback(n=>{const c=(n==null?void 0:n.location)||(n==null?void 0:n.name)||(n==null?void 0:n.sceneName)||"",d=(n==null?void 0:n.description)||"";return c?`${c}${d}`:d},[]),Vh=async(n,c)=>{var U,V,F,Q,G,pe;const d=At.get(n);if(!d||d.type!=="character-description"&&d.type!=="scene-description")return;const f=((U=d.settings)==null?void 0:U.chatModel)||Di||"";if(!f){o("","warning",3e3),ln({nodeId:n,type:"desc-model"});return}const p=es(f);if(!p.key){o(" API Key","error",4e3),qr(!0);return}const h=(((V=d.settings)==null?void 0:V.prompt)||"").trim();if(!h){o("","warning",3e3);return}const g=fn.get(f),z=(p.url||xr).replace(/\/+$/,""),y=(g==null?void 0:g.modelName)||f,N=d.type==="character-description",S='"[]"',C="";let E="",H=h,A=.7;N&&c==="filter"?(E=S,A=.3):!N&&c==="enhance"?(E=C,A=.3):E=c==="enhance"?"JSON":"//JSON",Be(n,{isEnhancing:!0});try{const J=await fetch(`${z}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${p.key}`,"Content-Type":"application/json"},body:JSON.stringify({model:y,messages:[{role:"system",content:E},{role:"user",content:H}],temperature:A})});if(!J.ok){let te="";try{const $e=await J.json();te=((F=$e==null?void 0:$e.error)==null?void 0:F.message)||($e==null?void 0:$e.message)||""}catch{}throw new Error(`API Error: ${J.status}${te?` - ${te}`:""}`)}const ge=await J.json(),ne=(((pe=(G=(Q=ge.choices)==null?void 0:Q[0])==null?void 0:G.message)==null?void 0:pe.content)||ge.content||"").replace(/```[\s\S]*?```/g,"").trim();ne?(Be(n,{prompt:ne}),o(c==="enhance"?"":"","success",2e3)):o("","warning",3e3)}catch(J){console.error("[]",J),o(`: ${J.message||""}`,"error",4e3)}finally{Be(n,{isEnhancing:!1})}},Nb=D.useCallback((n,c)=>{var F,Q,G,pe;const d=At.get(n);if(!d)return;const f=Array.isArray(c==null?void 0:c.characters)?c.characters:[],p=Array.isArray(c==null?void 0:c.scenes)?c.scenes:[];if(f.length===0&&p.length===0)return;M();const h=d.x+d.width+100,g=d.y,z=450,y=Date.now(),N=go||((F=Te.find(J=>J.type==="Video"&&(J.id==="sora-2"||J.id==="sora-2-pro")))==null?void 0:F.id)||((Q=Te.find(J=>J.type==="Video"))==null?void 0:Q.id)||"",S=Ri||((G=Te.find(J=>J.type==="Image"))==null?void 0:G.id)||"",C=Di||((pe=Te.find(J=>J.type==="Chat"))==null?void 0:pe.id)||"",E=ci||"16:9",H=sa||"720p",A=xo||"2K",U=[],V=[];if(f.length>0&&f.forEach((J,ge)=>{const le=`node - char-desc - ${y} - ${ge}`,ne=`node - char-video - ${y} - ${ge}`,te=`node - char-create - ${y} - ${ge}`,$e=wo(J,"video");U.push({id:le,type:"character-description",x:h,y:g+ge*z,width:400,height:400,settings:{characterId:(J==null?void 0:J.id)||"",characterName:(J==null?void 0:J.name)||"",role:(J==null?void 0:J.role)||"",age:(J==null?void 0:J.age)||"",gender:(J==null?void 0:J.gender)||"",description:(J==null?void 0:J.description)||"",prompt:$e,mode:"video",imageModel:S,imageRatio:E,imageResolution:A,referenceImages:[],chatModel:C}}),U.push({id:ne,type:"generate-character-video",x:h+420,y:g+ge*z,width:400,height:450,settings:{model:N,duration:"15s",ratio:E,resolution:H,videoPrompt:$e,referenceImages:[],sourceType:"character-description",sourceId:le}}),U.push({id:te,type:"create-character",x:h+840,y:g+ge*z,width:350,height:300,settings:{name:(J==null?void 0:J.name)||"",startSecond:1,endSecond:3}}),V.push({id:`conn - char-desc - ${y} - ${ge}`,from:n,to:le},{id:`conn - char-video - ${y} - ${ge}`,from:le,to:ne},{id:`conn - char-create - ${y} - ${ge}`,from:ne,to:te})}),p.length>0){const J=f.length;p.forEach((ge,le)=>{const ne=J+le,te=`node - scene-desc - ${y} - ${le}`,$e=`node - scene-video - ${y} - ${le}`,st=`node - scene-create - ${y} - ${le}`,Ue=pl(ge),Ze=(ge==null?void 0:ge.location)||(ge==null?void 0:ge.name)||(ge==null?void 0:ge.sceneName)||"";U.push({id:te,type:"scene-description",x:h,y:g+ne*z,width:400,height:400,settings:{sceneId:(ge==null?void 0:ge.id)||"",sceneName:Ze,description:(ge==null?void 0:ge.description)||"",prompt:Ue,mode:"video",style:(ge==null?void 0:ge.style)||"",imageModel:S,imageRatio:E,imageResolution:A,referenceImages:[],chatModel:C}}),U.push({id:$e,type:"generate-scene-video",x:h+420,y:g+ne*z,width:400,height:450,settings:{model:N,duration:"15s",ratio:E,resolution:H,videoPrompt:Ue,referenceImages:[],sourceType:"scene-description",sourceId:te}}),U.push({id:st,type:"create-scene",x:h+840,y:g+ne*z,width:350,height:300,settings:{name:Ze,startSecond:1,endSecond:3}}),V.push({id:`conn - scene-desc - ${y} - ${le}`,from:n,to:te},{id:`conn - scene-video - ${y} - ${le}`,from:te,to:$e},{id:`conn - scene-create - ${y} - ${le}`,from:$e,to:st})})}U.length>0&&l(J=>[...J,...U]),V.length>0&&m(J=>[...J,...V])},[At,Te,go,Ri,Di,ci,sa,xo,wo,pl]),_b=n=>{var F,Q,G,pe,J,ge,le,ne,te,$e,st,Ue,Ze,xt,yt,_t,bt,Wt;const c=At.get(n);if(!c)return;const d=c.type==="character-description",f=d?"generate-character-image":"generate-scene-image";if(u.find(Bt=>{var Ht;return Bt.from===n&&((Ht=At.get(Bt.to))==null?void 0:Ht.type)===f}))return;const h={name:((F=c.settings)==null?void 0:F.characterName)||((Q=c.settings)==null?void 0:Q.name)||"",role:((G=c.settings)==null?void 0:G.role)||"",description:((pe=c.settings)==null?void 0:pe.description)||"",age:((J=c.settings)==null?void 0:J.age)||"",gender:((ge=c.settings)==null?void 0:ge.gender)||""},g={name:((le=c.settings)==null?void 0:le.sceneName)||((ne=c.settings)==null?void 0:ne.location)||"",location:((te=c.settings)==null?void 0:te.sceneName)||(($e=c.settings)==null?void 0:$e.location)||"",description:((st=c.settings)==null?void 0:st.description)||""},z=d?wo(h,"image"):pl(g),y=c.x+c.width+200,N=c.y+c.height/2,S=$r(f,y,N,n);if(!(S!=null&&S.id))return;const C=((Ue=c.settings)==null?void 0:Ue.imageModel)||Ri||((Ze=Te.find(Bt=>Bt.type==="Image"))==null?void 0:Ze.id)||"",E=((xt=c.settings)==null?void 0:xt.imageRatio)||ci||"16:9",H=((yt=c.settings)==null?void 0:yt.imageResolution)||xo||"2K",A=((_t=c.settings)==null?void 0:_t.chatModel)||Di||"",U=((bt=c.settings)==null?void 0:bt.prompt)||z,V=d?Wh(U):U;Be(S.id,{model:C,ratio:E,resolution:H,prompt:V,referenceImages:((Wt=c.settings)==null?void 0:Wt.referenceImages)||[],chatModel:A,sourceType:c.type,sourceId:c.id})},Sb=n=>{var V,F,Q,G,pe,J,ge,le,ne,te,$e,st,Ue,Ze,xt,yt;const c=At.get(n);if(!c)return;const d=c.type==="character-description",f=d?"generate-character-video":"generate-scene-video";if(u.find(_t=>{var bt;return _t.from===n&&((bt=At.get(_t.to))==null?void 0:bt.type)===f}))return;const h={name:((V=c.settings)==null?void 0:V.characterName)||((F=c.settings)==null?void 0:F.name)||"",role:((Q=c.settings)==null?void 0:Q.role)||"",description:((G=c.settings)==null?void 0:G.description)||"",age:((pe=c.settings)==null?void 0:pe.age)||"",gender:((J=c.settings)==null?void 0:J.gender)||""},g={name:((ge=c.settings)==null?void 0:ge.sceneName)||((le=c.settings)==null?void 0:le.location)||"",location:((ne=c.settings)==null?void 0:ne.sceneName)||((te=c.settings)==null?void 0:te.location)||"",description:(($e=c.settings)==null?void 0:$e.description)||""},z=d?wo(h,"video"):pl(g),y=((st=c.settings)==null?void 0:st.prompt)||z,N=d?Hh(y):y,S=c.x+c.width+200,C=c.y+c.height/2,E=$r(f,S,C,n);if(!(E!=null&&E.id))return;const H=go||((Ue=Te.find(_t=>_t.type==="Video"&&(_t.id==="sora-2"||_t.id==="sora-2-pro")))==null?void 0:Ue.id)||((Ze=Te.find(_t=>_t.type==="Video"))==null?void 0:Ze.id)||"",A=((xt=c.settings)==null?void 0:xt.imageRatio)||ci||"16:9",U=sa||"720p";Be(E.id,{model:H,duration:"15s",ratio:A,resolution:U,videoPrompt:N,referenceImages:((yt=c.settings)==null?void 0:yt.referenceImages)||[],sourceType:c.type,sourceId:c.id})},Cb=D.useCallback(n=>{const c=[];for(const d of u)if(d.from===n){const f=At.get(d.to);f&&(f.type==="gen-image"||f.type==="gen-video")&&c.push(f)}return c},[u,At]),ko=n=>n?n==="sora-2-pro"||n.includes("sora-2")||n==="sora-2"?"15s":n.includes("veo")||n==="google-veo3"||n.includes("grok")||n==="grok-3"?"8s":"5s":"5s",Jc=n=>n?n==="sora-2-pro"?["15s","25s"]:n.includes("sora-2")||n==="sora-2"?["5s","10s","15s"]:n.includes("veo")||n==="google-veo3"?["8s"]:n.includes("grok")||n==="grok-3"?["8s","5s"]:n.includes("jimeng")?["5s","10s"]:["5s","10s"]:["5s","10s"],Eb=n=>{var z,y,N,S,C,E;const c=At.get(n);if(!c||c.type!=="storyboard-node")return;const d=((z=c.settings)==null?void 0:z.mode)||"video";let f,p,h;d==="image"?(f=localStorage.getItem("tapnow_last_image_model")||((y=Te.find(H=>H.type==="Image"))==null?void 0:y.id)||"",p="1:1",h=void 0):(f=go||localStorage.getItem("tapnow_last_video_model")||((N=Te.find(H=>H.type==="Video"))==null?void 0:N.id)||"",p="16:9",h=ko(f));const g={id:`shot-${Date.now()}`,scene_index:(((C=(S=c.settings)==null?void 0:S.shots)==null?void 0:C.length)||0)+1,time_range:"",image_url:"",description:"",prompt:"",camera:"",tags:[],status:"draft",model:f,ratio:p,duration:h,outputEnabled:!1,selectedImageIndex:-1};Be(n,{shots:[...((E=c.settings)==null?void 0:E.shots)||[],g]})},Ib=(n,c)=>{var p;const d=At.get(n);if(!d||d.type!=="storyboard-node")return;const f=(((p=d.settings)==null?void 0:p.shots)||[]).filter(h=>h.id!==c);f.forEach((h,g)=>{h.scene_index=g+1}),Be(n,{shots:f})},qt=(n,c,d,f={})=>{let p=!1,h=d.status;if(l(g=>{var H,A,U;const z=g.find(V=>V.id===n);if(!z||z.type!=="storyboard-node")return console.warn("[updateShot] :",{nodeId:n,found:!!z,type:z==null?void 0:z.type}),g;if(f.onlyIfStatus){const V=(((H=z.settings)==null?void 0:H.shots)||[]).find(F=>F.id===c);if(V&&V.status!==f.onlyIfStatus)return console.warn(`[updateShot] : ${c},  ${V.status} !==  ${f.onlyIfStatus}`),g}const y=(((A=z.settings)==null?void 0:A.shots)||[]).find(V=>V.id===c),N={...d},S=Object.prototype.hasOwnProperty.call(N,"durationCost"),C=new Set(["done","completed","failed","error"]);if(N.status==="generating"&&!S&&(N.durationCost=0),N.status&&C.has(N.status)&&!S&&y!=null&&y.generationStartTime){const V=(Date.now()-y.generationStartTime)/1e3;N.durationCost=Number(V.toFixed(1))}p=!0,h=N.status;const E=(((U=z.settings)==null?void 0:U.shots)||[]).map(V=>V.id===c?{...V,...N}:V);return g.map(V=>V.id===n?{...V,settings:{...V.settings,shots:E}}:V)}),p&&h){const g=`${n}-${c}`;Ud(h==="generating"?z=>({...z,[g]:"0.0s"}):z=>{if(!z[g])return z;const y={...z};return delete y[g],y})}if(d.video_url||d.output_url||d.output_images||d.image_url||d.lastFrame){const g=d.video_url||d.output_url||d.output_images&&d.output_images[0]||d.image_url||d.lastFrame,z=d.video_url?"video":"image",y=d.image_filename||"";setTimeout(()=>{Zs(`temp-${Date.now()}`,g,z,n,null,y)},50)}},$b=(n,c)=>{const d=At.get(n);if(!d||!c||c.length===0){console.warn("[] ");return}const f=c.map((y,N)=>{var V,F,Q,G,pe,J,ge,le,ne,te;const S=((V=y.keyframes)==null?void 0:V.find($e=>$e.type==="current"))||((F=y.keyframes)==null?void 0:F[0]),C=(S==null?void 0:S.mj_prompt)||"",E=(S==null?void 0:S.jimeng_prompt)||"",H=(S==null?void 0:S.description)||((G=(Q=y.keyframes)==null?void 0:Q[0])==null?void 0:G.description)||"",A=[];(J=(pe=y.global_tags)==null?void 0:pe.style)!=null&&J[0]&&A.push(y.global_tags.style[0]),(le=(ge=y.global_tags)==null?void 0:ge.camera)!=null&&le[0]&&A.push(y.global_tags.camera[0]),S!=null&&S.description&&["","","","","","","","Dolly","Pan","Tilt","Zoom"].forEach(st=>{H.includes(st)&&A.push(st)});const U=((te=(ne=y.global_tags)==null?void 0:ne.camera)==null?void 0:te[0])||A.find($e=>["","","","","","Dolly","Pan","Tilt","Zoom"].some(st=>$e.includes(st)))||"";return{id:`shot - ${Date.now()} -${N} `,scene_index:N+1,time_range:y.time_range||"",image_url:"",description:H,prompt:C||E,camera:U,tags:A,status:"draft"}}),p=d.x+d.width+100,h=d.y,g=`node - storyboard - ${Date.now()} `,z={id:g,type:"storyboard-node",x:p,y:h,width:600,height:500,settings:{projectTitle:"AI ",shots:f}};l(y=>[...y,z]),m(y=>[...y,{id:`conn - ${Date.now()} `,from:n,to:g}])},Mn=D.useRef(new Map);D.useRef(null);const Kh=async(n,c,d,f=null,p=null)=>{var h;try{const g=Te.find(A=>A.type==="Video"&&(A.id==="sora-2"||A.id==="sora-2-pro"));if(!g){alert(" Sora 2  Sora 2  Sora 2 Pro"),na(!1);return}const y=es(g.id).key;if(!y){alert(" API Key"),na(!1);return}if(d-c<1||d-c>3){alert(" 1-3 "),na(!1);return}const N=`${c},${d} `;let S;p&&p.trim()?S=p.trim():S=`${(g.url||xr).replace(/\/+$/,"")} /sora/v1 / characters`;const C=f?{from_task:f,timestamps:N}:{url:n,timestamps:N};console.log("[Create Character] Request Details:",{endpoint:S,apiKey:y?`${y.substring(0,8)}...${y.substring(y.length-4)} `:"EMPTY",payload:C,fromTaskId:f,videoUrl:f?"N/A (using from_task)":n,customEndpoint:p||"N/A (using default)"});const E=await fetch(S,{method:"POST",headers:{Authorization:`Bearer ${y} `,"Content-Type":"application/json"},body:JSON.stringify(C)});if(!E.ok){const A=await E.text();console.error("[Create Character] API Error:",{status:E.status,statusText:E.statusText,errorText:A,endpoint:S});let U=null;try{U=JSON.parse(A)}catch{}throw E.status===500||U&&(U.code==="get_origin_task_failed"||(h=U.message)!=null&&h.includes("get_origin_task_failed"))?new Error("TASK_NOT_FOUND"):new Error(`API(${E.status}): ${A||E.statusText} `)}const H=await E.json();if(H.id&&H.username){const A={id:H.id,username:H.username,profile_picture_url:H.profile_picture_url||"",permalink:H.permalink||""},U=[...On,A];Zo(U),alert(` "${H.username}" `),Ja(!1),_c("url"),Sc(""),Cc(""),ph(1),fh(3),qa("")}else throw new Error(" id  username")}catch(g){console.error("[Create Character] Failed:",g);let z=g.message;if(z==="TASK_NOT_FOUND"){alert(`

" URL"`);return}(z.includes("Failed to fetch")||g.name==="TypeError"||g.message.includes("NetworkError"))&&(z=`

1. API 
   -  API  "/sora" 
   -  Sora 

2.  (CORS)
   -  Allow CORS 

3. 
   - `),alert(`: ${z} `)}finally{na(!1)}},Yh=(n,c)=>{var C,E;let d=c.prompt||"";if(!d&&c.description&&(d=c.description),c.tags&&c.tags.length>0){const H=c.tags.join(", ");d+=`, ${H} `}if(c.camera&&(d+=`, ${c.camera} camera movement`),!d){alert("");return}const f=c.model||((C=Te.find(H=>H.type==="Video"&&H.id==="sora-2"))==null?void 0:C.id)||((E=Te.find(H=>H.type==="Video"))==null?void 0:E.id)||"",p=fn.get(f);if(!p||p.type!=="Video"){alert("");return}const h=[];c.image_url&&h.push(c.image_url),c.lastFrame&&h.push(c.lastFrame),qt(n,c.id,{status:"generating",generationStartTime:Date.now()});let g=c.duration||ko(f);const z=Jc(f);z.includes(g)||(console.warn(`[V3.5.5] Duration "${g}" not valid for model "${f}", using "${z[0]}"`),g=z[0]);const y=String(g).endsWith("s")?g:`${g}s`,N={model:f,ratio:c.ratio||"16:9",duration:y,resolution:_u(c.resolution||"720p")},S=`storyboard-${n}-shot-${c.id}`;vo(d,"video",h,S,N)},Gh=(n,c)=>{var N;let d=c.prompt||"";if(!d&&c.description&&(d=c.description),c.tags&&c.tags.length>0){const S=c.tags.join(", ");d+=`, ${S} `}if(!d){alert("");return}const f=c.model||localStorage.getItem("tapnow_last_image_model")||((N=Te.find(S=>S.type==="Image"))==null?void 0:N.id)||"",p=fn.get(f);if(!p||p.type!=="Image"){alert("");return}if(!es(f).key){alert(` "${f}"  API Key `),qt(n,c.id,{status:"failed",errorMsg:"API Key "}),qr(!0);return}const g=[];c.image_url&&g.push(c.image_url),c.referenceImages&&c.referenceImages.length>0&&g.push(...c.referenceImages),qt(n,c.id,{status:"generating",generationStartTime:Date.now()});const z={model:f,ratio:c.ratio||"1:1",resolution:Tl(c.resolution||"2K")},y=`storyboard-img-${n}-shot-${c.id}`;vo(d,"image",g,y,z)},Xh=async(n,c={})=>{var E,H,A,U,V,F,Q,G;const d=At.get(n),f=c.inputText||"",p=c.modelId||"";let h=f||((E=d==null?void 0:d.settings)==null?void 0:E.content)||"";if(!h){const pe=u.find(J=>J.to===n);if(pe){const J=At.get(pe.from);J&&(J.type==="novel-input"||J.type==="text-node")&&(h=((H=J.settings)==null?void 0:H.content)||J.content||"")}}if(!h||h.trim().length===0){o("","error");return}const g=p||((A=d==null?void 0:d.settings)==null?void 0:A.model)||"";if(!g){o("","error");return}const z=fn.get(g);if(!z){o("","error");return}const y=es(g),N=y.key;if(!N){o(" API Key","error"),qr(!0);return}((U=d==null?void 0:d.settings)==null?void 0:U.model)!==g&&Be(n,{model:g}),tp(g);try{localStorage.setItem("tapnow_last_extract_model",g)}catch{}Be(n,{isAnalyzing:!0,progress:5,errorMsg:null,analysisResults:null});let S=setInterval(()=>{l(pe=>pe.map(J=>{var ne;if(J.id!==n)return J;const ge=((ne=J.settings)==null?void 0:ne.progress)||0,le=Math.min(ge+7,92);return{...J,settings:{...J.settings,progress:le}}}))},500);const C=`


${h.substring(0,15e3)} ... ()

 JSON 
{
    "characters": [
        { "name": "", "role": "//", "age": "", "gender": "", "description": "", "appearance": "" }
    ],
    "scenes": [
        { "location": "", "description": "", "mood": "", "style": "" }
    ]
}
 JSON markdown `;try{const pe=(y.url||xr).replace(/\/+$/,""),J=await fetch(`${pe}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"},body:JSON.stringify({model:z.modelName||z.id||"gemini-1.5-pro-latest",messages:[{role:"system",content:"You are a helpful assistant that analyzes novels."},{role:"user",content:C}],temperature:.7})});if(!J.ok){let st="";try{const Ue=await J.json();st=((V=Ue==null?void 0:Ue.error)==null?void 0:V.message)||(Ue==null?void 0:Ue.message)||""}catch{}throw J.status===401&&(o("API Key 401","error",5e3),qr(!0)),new Error(`API Error: ${J.status}${st?` - ${st}`:""}`)}const ge=await J.json(),le=((G=(Q=(F=ge.choices)==null?void 0:F[0])==null?void 0:Q.message)==null?void 0:G.content)||ge.content||"";let ne=null;try{const st=le.replace(/```json/g,"").replace(/```/g,"").trim();ne=JSON.parse(st)}catch(st){console.warn("JSON Parse Error",st)}const te=Array.isArray(ne==null?void 0:ne.characters)?ne.characters:[],$e=Array.isArray(ne==null?void 0:ne.scenes)?ne.scenes:[];ne&&(te.length>0||$e.length>0)?(Be(n,{analysisResults:{characters:te,scenes:$e},lastAnalyzed:Date.now(),errorMsg:null}),setTimeout(()=>{Nb(n,{characters:te,scenes:$e})},200)):(Be(n,{analysisResults:null,lastAnalyzed:Date.now(),errorMsg:""}),o("/","warning"))}catch(pe){console.error("Extraction Failed",pe);let J=(pe==null?void 0:pe.message)||"";((pe==null?void 0:pe.name)==="TypeError"||/Failed to fetch|NetworkError/i.test(J))&&(J="CORS API http/https CORS "),Be(n,{errorMsg:J}),o(`: ${J}`,"error",5e3)}finally{S&&clearInterval(S),l(pe=>pe.map(J=>J.id===n?{...J,settings:{...J.settings,isAnalyzing:!1,progress:100}}:J)),setTimeout(()=>Be(n,{progress:0}),800)}},Mb=n=>{var y,N,S,C;const c=At.get(n);if(!c)return;const d=((y=c.settings)==null?void 0:y.content)||"";if(!d||d.trim().length===0){o("","error");return}const f=u.find(E=>{var H;return E.from===n&&((H=At.get(E.to))==null?void 0:H.type)==="extract-characters-scenes"});let p=f==null?void 0:f.to,h=p?At.get(p):null;if(!p){const H=c.x+c.width+50+200,A=c.y+c.height/2,U=$r("extract-characters-scenes",H,A,n);p=U==null?void 0:U.id,h=U||null}if(!p)return;const g=((N=h==null?void 0:h.settings)==null?void 0:N.model)||((C=(S=At.get(p))==null?void 0:S.settings)==null?void 0:C.model)||Di||"";if(!g){o("","warning",4e3),ln({nodeId:p,type:"extract-model"});return}if(!es(g).key){o(" API Key","error"),qr(!0);return}Be(p,{model:g}),requestAnimationFrame(()=>{Xh(p,{inputText:d,modelId:g})})},Jh=(n,c)=>{var f;const d=(f=c.target.files)==null?void 0:f[0];if(d){const p=new FileReader;p.onload=async h=>{const g=h.target.result;let z={w:0,h:0};try{z=await Wr(g)}catch{}M(),l(y=>y.map(N=>N.id===n?{...N,content:g,dimensions:z}:N))},p.readAsDataURL(d)}},Tb=(n,c)=>{if(!n||n.length===0)return[];const d=[...n].sort((g,z)=>g.time-z.time),f=[];let p=[],h=d[0].time;return d.forEach((g,z)=>{g.time-h>=c&&p.length>0?(f.push([...p]),p=[g],h=g.time):p.push(g)}),p.length>0&&f.push(p),f},Pb=async n=>{var H,A,U,V,F,Q,G,pe,J,ge,le,ne,te,$e,st;const c=At.get(n);if(!c||c.type!=="video-analyze")return;const d=ul(n);if(!d){alert("");return}const f=d.selectedKeyframes||[];if(f.length===0){alert("");return}const p=((H=c.settings)==null?void 0:H.model)||"gemini-3-pro",{key:h,url:g}=es(p),z=Te.find(Ue=>Ue.id===p);if(!h){alert(" API  Key"),qr(!0);return}const y=((A=c.settings)==null?void 0:A.segmentDuration)||3,N=Tb(f,y);if(N.length===0){alert("");return}l(Ue=>Ue.map(Ze=>Ze.id===n?{...Ze,isGenerating:!0,analysisResults:[]}:Ze));const S=[],C=d.videoFileName||"video.mp4";(U=d.videoMeta)!=null&&U.duration;const E=((V=c.settings)==null?void 0:V.analysisMode)||"manual";try{for(let Ue=0;Ue<N.length;Ue++){const Ze=N[Ue],xt=`${Ze[0].time.toFixed(1)}s-${Ze[Ze.length-1].time.toFixed(1)}s`,yt=`AI

 JSON 
{
  "video_id": "${C}",
  "scene_index": ${Ue+1},
  "time_range": "${xt}",
  "keyframes": [
    {
      "type": "prev",
      "time": 5.2,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    },
    {
      "type": "current",
      "time": 6.8,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    },
    {
      "type": "next",
      "time": 8.7,
      "description": "",
      "mj_prompt": "Midjourney ",
      "jimeng_prompt": ""
    }
  ],
  "global_tags": {
    "style": ["", ""],
    "camera": ["", ""],
    "color": [""]
  }
}


1.  prev/current/next 
2. mj_prompt  Midjourney
3. jimeng_prompt AI
4. global_tags `,_t=[{type:"text",text:` ${Ue+1}${xt}`}],bt=15,Wt=Ze.length>bt?Ze.slice(0,bt):Ze;Wt.forEach((wt,Lt)=>{_t.push({type:"image_url",image_url:{url:wt.url}}),Lt<Wt.length-1&&_t.push({type:"text",text:` ${Lt+1}${wt.time.toFixed(2)}s`})}),Ze.length>bt&&_t.push({type:"text",text:` ${Ze.length} API ${bt} `});const Bt=[{role:"system",content:yt},{role:"user",content:_t}],Ht=new AbortController,rn=setTimeout(()=>Ht.abort(),6e4);let O;try{O=await fetch(`${g}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({model:(z==null?void 0:z.id)||"gemini-3-pro",messages:Bt,stream:!1}),signal:Ht.signal})}catch(wt){throw clearTimeout(rn),wt.name==="AbortError"?new Error(""):wt.message&&wt.message.includes("Failed to fetch")?new Error(` API  (${g})
1. API 
2. 
3. API `):new Error(`: ${wt.message}`)}finally{clearTimeout(rn)}if(!O.ok){let wt="";try{wt=await O.text()}catch{wt=`HTTP ${O.status}: ${O.statusText}`}throw new Error(wt||`API Error: ${O.status}`)}const de=await O.json();console.log("[] API :",{hasData:!!de,hasChoices:!!de.choices,choicesLength:(F=de.choices)==null?void 0:F.length,dataKeys:Object.keys(de||{}),model:(z==null?void 0:z.modelName)||(z==null?void 0:z.id)});let Fe=null;if(de.choices&&de.choices.length>0?Fe=(G=(Q=de.choices[0])==null?void 0:Q.message)==null?void 0:G.content:(pe=de.data)!=null&&pe.choices&&de.data.choices.length>0?Fe=(ge=(J=de.data.choices[0])==null?void 0:J.message)==null?void 0:ge.content:de.content?Fe=de.content:(le=de.data)!=null&&le.content?Fe=de.data.content:de.text?Fe=de.text:(ne=de.data)!=null&&ne.text?Fe=de.data.text:de.message?Fe=typeof de.message=="string"?de.message:de.message.content:(te=de.data)!=null&&te.message?Fe=typeof de.data.message=="string"?de.data.message:de.data.message.content:de.result?Fe=typeof de.result=="string"?de.result:de.result.content:($e=de.data)!=null&&$e.result&&(Fe=typeof de.data.result=="string"?de.data.result:de.data.result.content),!Fe||Fe.trim()===""||Fe==="{}")throw console.error("[] API :",de),new Error(`API : ${JSON.stringify(de).substring(0,200)}`);let mt=Fe.trim();mt.startsWith("```")&&(mt=mt.replace(/^```(?:json)?\n?/,"").replace(/\n?```$/,""));let Ct;try{Ct=JSON.parse(mt)}catch(wt){console.error("[]  JSON :",wt,"500:",mt.substring(0,500));try{mt=mt.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*/g,""),mt=mt.replace(/,(\s*[}\]])/g,"$1"),Ct=JSON.parse(mt)}catch(Lt){console.error("[] JSON:",Lt,":",mt),Ct={video_id:C,scene_index:Ue+1,time_range:xt,keyframes:Ze.map((pt,ft)=>({type:ft===0?"prev":ft===1?"current":"next",time:pt.time,description:` ${pt.time.toFixed(1)}s`,mj_prompt:"A detailed scene from the video",jimeng_prompt:""})),global_tags:{style:[],camera:[],color:[]}},console.warn("[] :",mt.substring(0,200))}}if(S.push(Ct),l(wt=>wt.map(Lt=>{if(Lt.id===n){const ft=[...Lt.analysisResults||[],Ct];return{...Lt,analysisResults:ft}}return Lt})),!(E==="manual")){const Lt={id:`analyze-${n}-${Ue}-${Date.now()}`,type:"analyze",prompt:` -  ${Ue+1}`,url:((st=Ze[0])==null?void 0:st.url)||"",status:"completed",progress:100,modelName:(z==null?void 0:z.provider)||"Gemini 3 Pro",time:new Date().toLocaleString("zh-CN"),sourceNodeId:n,analysisResult:Ct,videoFileName:C,sceneIndex:Ue+1,timeRange:xt};$t(pt=>[Lt,...pt])}}l(Ue=>Ue.map(Ze=>{if(Ze.id===n){const xt=S.length>0?S:Ze.analysisResults||[];return{...Ze,isGenerating:!1,analysisResults:xt}}return Ze}))}catch(Ue){console.error(":",Ue);const Ze=Ue.message||"";l(xt=>xt.map(yt=>yt.id===n?{...yt,isGenerating:!1,errorMsg:Ze}:yt))}},Ab=async n=>{var z,y,N,S,C,E,H,A,U,V;const c=At.get(n);if(!c||c.type!=="video-analyze")return;const d=ul(n);if(!d||!d.content){alert("");return}let f=d.content;if(f.startsWith("blob:"))try{const F=await fetch(f).then(Q=>Q.blob());f=await new Promise((Q,G)=>{const pe=new FileReader;pe.onerror=()=>G(new Error("FileReader failed")),pe.onloadend=()=>Q(pe.result),pe.readAsDataURL(F)})}catch(F){console.error("Blob conversion failed",F),alert(" AI");return}let p=Te.find(F=>F.id==="gemini-3-pro"&&F.type==="Chat");p||(p=Te.find(F=>{var G;return(((G=F.id)==null?void 0:G.toLowerCase())||"").includes("gemini")&&F.type==="Chat"})),p||(p=Te.find(F=>F.type==="Chat"));const{key:h,url:g}=es((p==null?void 0:p.id)||"gemini-3-pro");if(!h){alert(" API  Key"),qr(!0);return}l(F=>F.map(Q=>Q.id===n?{...Q,isGenerating:!0,settings:{...Q.settings,voiceoverResults:[],analysisResults:[]}}:Q));try{const G=[{role:"system",content:`******AI**

1. ****

2. ****Voiceover

 **JSON **Markdown

{
  "voiceover_script": [
    { "time_range": "0s-3s", "text": "..." }
  ],
  "scenes": [
    {
      "scene_id": 1,
      "time_range": "0s-2.5s",
      "visual_analysis": {
        "camera_movement": "(Dolly Zoom Out) (Orbit)",
        "subject_dynamics": "",
        "atmosphere": ""
      },
      "prompts": {
        "jimeng_prompt": "()+++()...",
        "mj_prompt": "Midjourney Prompt: English description, include camera directives like 'dynamic angle', 'fast zoom out', 'cinematic lighting'..."
      }
    }
  ]
}

****
- ****
- ****""
- ****`},{role:"user",content:[{type:"text",text:"JSON"},{type:"image_url",image_url:{url:f}}]}],pe=new AbortController,J=setTimeout(()=>pe.abort(),12e4);let ge;try{ge=await fetch(`${g}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"},body:JSON.stringify({model:(p==null?void 0:p.id)||"gemini-3-pro",messages:G,stream:!1}),signal:pe.signal})}catch(Ze){throw clearTimeout(J),Ze.name==="AbortError"?new Error("120"):Ze.message&&Ze.message.includes("Failed to fetch")?new Error(` API  (${g})
1. API 
2. 
3. API 
4.  API Key`):new Error(`: ${Ze.message}`)}finally{clearTimeout(J)}if(!ge.ok){let Ze="";try{Ze=await ge.text()}catch{Ze=`HTTP ${ge.status}: ${ge.statusText}`}throw new Error(Ze||`API Error: ${ge.status}`)}const le=await ge.json();console.log("[AI] API :",{hasData:!!le,hasChoices:!!le.choices,choicesLength:(z=le.choices)==null?void 0:z.length,dataKeys:Object.keys(le||{}),model:(p==null?void 0:p.modelName)||(p==null?void 0:p.id)});let ne=null;if(le.choices&&le.choices.length>0?ne=(N=(y=le.choices[0])==null?void 0:y.message)==null?void 0:N.content:(S=le.data)!=null&&S.choices&&le.data.choices.length>0?ne=(E=(C=le.data.choices[0])==null?void 0:C.message)==null?void 0:E.content:le.content?ne=le.content:(H=le.data)!=null&&H.content?ne=le.data.content:le.text?ne=le.text:(A=le.data)!=null&&A.text?ne=le.data.text:le.message?ne=typeof le.message=="string"?le.message:le.message.content:(U=le.data)!=null&&U.message?ne=typeof le.data.message=="string"?le.data.message:le.data.message.content:le.result?ne=typeof le.result=="string"?le.result:le.result.content:(V=le.data)!=null&&V.result&&(ne=typeof le.data.result=="string"?le.data.result:le.data.result.content),!ne||ne.trim()===""||ne==="{}")throw console.error("[AI] API :",le),new Error(`API : ${JSON.stringify(le).substring(0,200)}`);let te=ne.trim();te.startsWith("```")&&(te=te.replace(/^```(?:json)?\n?/,"").replace(/\n?```$/,""));let $e;try{$e=JSON.parse(te)}catch(Ze){console.error("[AI]  JSON :",Ze,"500:",te.substring(0,500));try{te=te.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*/g,""),te=te.replace(/,(\s*[}\]])/g,"$1"),$e=JSON.parse(te)}catch(xt){throw console.error("[AI] JSON:",xt,":",te.substring(0,500)),new Error(` JSON : ${te.substring(0,200)}`)}}const st=($e.voiceover_script||[]).map((Ze,xt)=>({time:xt,text:Ze.text||""})),Ue=($e.scenes||[]).map((Ze,xt)=>{var yt,_t,bt,Wt,Bt,Ht;return{scene_index:Ze.scene_id||xt+1,time_range:Ze.time_range||"",keyframes:[{type:"current",time:0,description:`${((yt=Ze.visual_analysis)==null?void 0:yt.camera_movement)||""} ${((_t=Ze.visual_analysis)==null?void 0:_t.subject_dynamics)||""}`.trim(),mj_prompt:((bt=Ze.prompts)==null?void 0:bt.mj_prompt)||"",jimeng_prompt:((Wt=Ze.prompts)==null?void 0:Wt.jimeng_prompt)||""}],global_tags:{style:(Bt=Ze.visual_analysis)!=null&&Bt.atmosphere?[Ze.visual_analysis.atmosphere]:[],camera:(Ht=Ze.visual_analysis)!=null&&Ht.camera_movement?[Ze.visual_analysis.camera_movement]:[],color:[]}}});l(Ze=>Ze.map(xt=>xt.id===n?{...xt,isGenerating:!1,settings:{...xt.settings,voiceoverResults:st,analysisResults:Ue}}:xt)),Ue.length>0&&setTimeout(()=>{$b(n,Ue)},100)}catch(F){console.error("AI:",F);const Q=F.message||"AI";l(G=>G.map(pe=>pe.id===n?{...pe,isGenerating:!1,errorMsg:Q}:pe))}},Rb=()=>{const n=kc.name.trim(),c=kc.prompt.trim();if(!n||!c){alert("");return}sh(d=>[{id:`custom-${Date.now()}`,name:n,prompt:c},...d]),Rd({name:"",prompt:""})},Db=n=>{sh(c=>c.filter(d=>d.id!==n))},Ob=(n,c)=>{!n||!c||Be(n,{prompt:c})},Lb=async n=>new Promise((c,d)=>{const f=new Image;f.crossOrigin="anonymous";const p=setTimeout(()=>{d(new Error(""))},3e4);f.onload=()=>{clearTimeout(p);try{const g=document.createElement("canvas").getContext("2d"),z=Math.floor(f.width/3),y=Math.floor(f.height/3),N=[],S=[];for(let C=0;C<3;C++)for(let E=0;E<3;E++){const H=Math.max(0,Math.min(E*z,f.width-z)),A=Math.max(0,Math.min(C*y,f.height-y)),U=Math.min(z,f.width-H),V=Math.min(y,f.height-A),F=document.createElement("canvas");F.width=U,F.height=V;const Q=F.getContext("2d");Q.fillStyle="#ffffff",Q.fillRect(0,0,U,V),Q.drawImage(f,H,A,U,V,0,0,U,V);try{const G=F.toDataURL("image/png");S.push(Promise.resolve({url:G,width:U,height:V}))}catch(G){console.error("Canvas toDataURL :",G)}}Promise.all(S).then(C=>{c(C)}).catch(C=>{d(C)})}catch(h){d(h)}},f.onerror=()=>{clearTimeout(p),d(new Error(""))},f.src=n}),fl=async(n,c={})=>{if(!n)return;const{originX:d,originY:f,cols:p=3,spacing:h=20,nodeWidth:g=260,nodeHeight:z=260,replaceSelected:y=!1}=c;try{const N=await Lb(n);if(N.length!==9){alert("9");return}const S=Xs.current;if(y&&S&&S.size===9){const U=Array.from(S);l(V=>V.map(F=>{const Q=U.indexOf(F.id);return Q!==-1&&Q<N.length?{...F,content:N[Q].url,dimensions:{w:N[Q].width,h:N[Q].height}}:F}));return}const C=mn(window.innerWidth/2,window.innerHeight/2),E=d!==void 0?d:C.x,H=f!==void 0?f:C.y,A=[];for(let U=0;U<N.length;U++){const V=Math.floor(U/p),F=U%p,Q=E+F*(g+h),G=H+V*(z+h);A.push({id:`node-${Date.now()}-${U}`,type:"input-image",x:Q,y:G,width:g,height:z,content:N[U].url,dimensions:{w:N[U].width,h:N[U].height}})}l(U=>[...U,...A])}catch(N){alert(": "+N.message)}},Ub=()=>{const n=Oi.current,c=Xs.current;let d=[];if(n){const V=Br.current.find(F=>F.id===n);V&&(d=[V])}else c&&c.size>0&&(d=Br.current.filter(V=>c.has(V.id)));if(d.length<2){alert("");return}const f=new Set(d.map(V=>V.id)),p={};d.forEach(V=>{p[V.id]={id:V.id,node:V,parents:[],children:[],level:0,rank:0}}),sl.current.forEach(V=>{f.has(V.from)&&f.has(V.to)&&(p[V.from].children.push(V.to),p[V.to].parents.push(V.from))});let h=Object.values(p).filter(V=>V.parents.length===0);h.length===0&&d.length>0&&(h=[Object.values(p)[0]]),(()=>{const V=h.map(F=>({node:F,lvl:0}));for(;V.length>0;){const{node:F,lvl:Q}=V.shift();Q>=F.level&&(F.level=Q,F.children.forEach(G=>{const pe=p[G];pe&&Q<20&&V.push({node:pe,lvl:Q+1})}))}})();const z=Math.max(...Object.values(p).map(V=>V.level)),y=Array.from({length:z+1},()=>[]);Object.values(p).forEach(V=>{y[V.level].push(V)}),y.forEach(V=>{V.sort((F,Q)=>F.node.y-Q.node.y)});const N=3;for(let V=0;V<N;V++){for(let F=1;F<y.length;F++){const Q=y[F];Q.forEach(G=>{if(G.parents.length>0){let pe=0;G.parents.forEach(J=>{const ge=p[J],le=y[F-1].indexOf(ge);le!==-1&&(pe+=le)}),G.barycenter=pe/G.parents.length}else G.barycenter=y[F].indexOf(G)}),Q.sort((G,pe)=>(G.barycenter||0)-(pe.barycenter||0))}for(let F=y.length-2;F>=0;F--){const Q=y[F];Q.forEach(G=>{if(G.children.length>0){let pe=0;G.children.forEach(J=>{const ge=p[J],le=y[F+1].indexOf(ge);le!==-1&&(pe+=le)}),G.barycenter=pe/G.children.length}else G.barycenter=y[F].indexOf(G)}),Q.sort((G,pe)=>(G.barycenter||0)-(pe.barycenter||0))}}const S=Math.min(...d.map(V=>V.x)),C=Math.min(...d.map(V=>V.y)),E=150,H=40;let A=S;const U=new Map;y.forEach((V,F)=>{if(V.length===0)return;const Q=Math.max(...V.map(pe=>pe.node.width||260));V.reduce((pe,J)=>pe+(J.node.height||200),0)+(V.length-1)*H;let G=C;V.forEach(pe=>{U.set(pe.id,{...pe.node,x:A,y:G}),G+=(pe.node.height||200)+H}),A+=Q+E}),l(V=>V.map(F=>U.has(F.id)?U.get(F.id):F))},Zh=(n,c)=>{c.preventDefault(),c.stopPropagation(),c.currentTarget.classList.remove("drag-over");const d=Array.from(c.dataTransfer.files),f=d.find(h=>h.type.startsWith("video/"));if(f){ol(n,f);return}const p=d.filter(h=>h.type.startsWith("image/"));if(p.sort((h,g)=>h.name.localeCompare(g.name,void 0,{numeric:!0,sensitivity:"base"})),p.length>0){const h=At.get(n),g=(h==null?void 0:h.frames)||[],z=(h==null?void 0:h.selectedKeyframes)||[];let y=0;const N=[];p.forEach((S,C)=>{const E=new FileReader;E.onload=async H=>{const A=H.target.result,U=await yi.saveImage(A);if(N[C]={time:g.length+C,url:U,filename:S.name},y++,y===p.length){const V=N.filter(Boolean);l(F=>F.map(Q=>Q.id===n?{...Q,frames:[...g,...V],selectedKeyframes:[...z,...V]}:Q))}},E.readAsDataURL(S)})}},Fb=(n,c,d)=>{n.preventDefault(),n.stopPropagation();const f=n.currentTarget.getBoundingClientRect(),h=n.clientX-f.left>f.width/2?d+1:d;(w!==h||R!==c)&&(P(h),x(c))},Bb=(n,c,d)=>{n.preventDefault(),n.stopPropagation(),n.target===n.currentTarget&&(w!==d||R!==c)&&(P(d),x(c))},Wb=(n,c)=>{var N;c.preventDefault(),c.stopPropagation();const d=Array.from(c.dataTransfer.files).filter(S=>S.type.startsWith("image/"));if(d.length===0)return;let f=R===n&&w!==null?w:(((N=At.get(n))==null?void 0:N.frames)||[]).length;x(null),P(null),d.sort((S,C)=>S.name.localeCompare(C.name,void 0,{numeric:!0,sensitivity:"base"}));const p=At.get(n),h=(p==null?void 0:p.frames)||[],g=(p==null?void 0:p.selectedKeyframes)||[];let z=0;const y=[];d.forEach((S,C)=>{const E=new FileReader;E.onload=async H=>{const A=H.target.result,U=await yi.saveImage(A);let V=A;try{const F=await yi.getImage(U);F&&(V=URL.createObjectURL(F))}catch(F){console.warn("[KeyframeOrganizer] Failed to create blob URL, using base64:",F)}if(y[C]={time:Date.now()+C,url:V,imgId:U,filename:S.name},z++,z===d.length){const F=y.filter(Boolean),Q=[...h.slice(0,f),...F,...h.slice(f)],G=new Set([...g,...F]),pe=Q.map((ge,le)=>({...ge,time:le})),J=pe.filter((ge,le)=>G.has(Q[le]));l(ge=>ge.map(le=>le.id===n?{...le,frames:pe,selectedKeyframes:J}:le))}},E.readAsDataURL(S)})},Hb=async(n,c=30)=>new Promise((d,f)=>{const p=document.createElement("video");p.crossOrigin="anonymous",p.src=n,p.muted=!0;const h=document.createElement("canvas"),g=h.getContext("2d",{willReadFrequently:!0}),z=[];let y=null;p.onloadeddata=async()=>{h.width=320,h.height=Math.floor(320*(p.videoHeight/p.videoWidth));const N=p.duration,S=2;p.currentTime=0;const C=async()=>{const E=p.currentTime;if(E>=N||Math.abs(E-N)<.01){if(z.length===0||parseFloat(z[z.length-1].time)<N-.5){const U=document.createElement("canvas");U.width=p.videoWidth,U.height=p.videoHeight;const V=U.getContext("2d");p.currentTime=Math.max(0,N-.1),await new Promise(F=>{const Q=setTimeout(()=>F(),200);p.onseeked=()=>{clearTimeout(Q),V.drawImage(p,0,0);const G=Math.max(0,N-.1);z.push({time:G.toFixed(2),image:U.toDataURL("image/jpeg",.8)}),F()}})}d(z.map(U=>({time:parseFloat(U.time),url:U.image})));return}g.drawImage(p,0,0,h.width,h.height);const H=g.getImageData(0,0,h.width,h.height).data;if(y){let U=0;for(let F=0;F<H.length;F+=4)U+=Math.abs(H[F]-y[F])+Math.abs(H[F+1]-y[F+1])+Math.abs(H[F+2]-y[F+2]);if(U/(H.length/4*3)>c){const F=document.createElement("canvas");F.width=p.videoWidth,F.height=p.videoHeight,F.getContext("2d").drawImage(p,0,0);const Q=F.toDataURL("image/jpeg",.8),G=p.currentTime;z.push({time:G.toFixed(2),image:Q}),y=null}else y=H}else{y=H;const U=p.currentTime,V=document.createElement("canvas");V.width=p.videoWidth,V.height=p.videoHeight,V.getContext("2d").drawImage(p,0,0),z.push({time:U.toFixed(2),image:V.toDataURL("image/jpeg",.8)})}const A=p.currentTime+1/S;if(A>=N){if(z.length===0||parseFloat(z[z.length-1].time)<N-.5){const U=document.createElement("canvas");U.width=p.videoWidth,U.height=p.videoHeight;const V=U.getContext("2d");p.currentTime=Math.max(0,N-.1),await new Promise(F=>{const Q=setTimeout(()=>F(),200);p.onseeked=()=>{clearTimeout(Q),V.drawImage(p,0,0);const G=Math.max(0,N-.1);z.push({time:G.toFixed(2),image:U.toDataURL("image/jpeg",.8)}),F()}})}d(z.map(U=>({time:parseFloat(U.time),url:U.image})));return}p.currentTime=A,await new Promise(U=>{const V=setTimeout(()=>U(),200);p.onseeked=()=>{clearTimeout(V),U()}}),C()};C()},p.onerror=N=>f(new Error(""))}),Vb=async(n,c=2)=>{const d=At.get(n);if(d!=null&&d.content){l(f=>f.map(p=>p.id===n?{...p,extractingFrames:!0}:p));try{const f=await Cz(d.content,{fps:c});l(p=>p.map(h=>h.id===n?{...h,frames:f,selectedKeyframes:[],extractingFrames:!1}:h))}catch(f){console.error("",f),l(p=>p.map(h=>h.id===n?{...h,extractingFrames:!1}:h))}}},Kb=async(n,c=30)=>{const d=At.get(n);if(d!=null&&d.content){l(f=>f.map(p=>p.id===n?{...p,extractingFrames:!0}:p));try{const f=await Hb(d.content,c);l(p=>p.map(h=>h.id===n?{...h,frames:f,selectedKeyframes:[],extractingFrames:!1}:h))}catch(f){console.error("",f),alert(`: ${f.message}`),l(p=>p.map(h=>h.id===n?{...h,extractingFrames:!1}:h))}}},Yb=(n,c,d=0,f=null)=>{const p=!!(f!=null&&f.shiftKey);l(h=>h.map(g=>{if(g.id!==n)return g;const z=g.frames||[],y=E=>`${E.time}-${E.url}`,N=new Map(z.map(E=>[y(E),E]));let C=[...g.selectedKeyframes||[]];if(p&&Ac.current[n]!==void 0&&Ac.current[n]!==null&&z.length>0){const E=Ac.current[n],H=Math.min(E,d),A=Math.max(E,d),U=z.slice(H,A+1),V=new Set(C.map(y));U.forEach(F=>V.add(y(F))),C=Array.from(V).map(F=>N.get(F)).filter(Boolean)}else C=C.some(H=>y(H)===y(c))?C.filter(H=>y(H)!==y(c)):[...C,c];return Ac.current[n]=d,{...g,selectedKeyframes:C}}))},Gb=(n,c,d)=>{n.preventDefault(),n.stopPropagation(),Vd({visible:!0,x:n.clientX,y:n.clientY,nodeId:c,frame:d})},Zc=()=>{Vd({visible:!1,x:0,y:0,nodeId:null,frame:null})},Xb=()=>{const{frame:n}=Pi;if(!(n!=null&&n.url))return;const c={name:`Frame-${(n.time??0).toFixed(2)}s.png`,type:"image/png",content:n.url,isImage:!0,isVideo:!1,isAudio:!1,fromHistory:!0,fileExt:"png"};Je(d=>[...d,c]),Ks(!0),Zc()},Jb=async()=>{const{frame:n}=Pi;if(!(n!=null&&n.url))return;let c=n.url;if(c.startsWith("blob:"))try{c=`data:image/png;base64,${await Hn(c)}`}catch(S){console.error(" Blob URL  URL:",S)}let d;try{const S=await Wr(c);S!=null&&S.w&&(S!=null&&S.h)&&(d={w:S.w,h:S.h})}catch{}const f=a.filter(S=>S.type==="input-image");let p,h;if(f.length>0){const S=f[f.length-1];p=S.x-40,h=S.y+35}else{const S=mn(window.innerWidth/2,window.innerHeight/2);p=S.x+50,h=S.y+50}let g=p,z=h;const y=(S,C)=>a.some(E=>Math.abs(E.x-S)<80&&Math.abs(E.y-C)<80);let N=0;for(;y(g,z)&&N<50;)g-=40,z+=35,N++;$r("input-image",g,z,null,c,d),Zc()},Zb=()=>{const{frame:n}=Pi;n!=null&&n.url&&(l(c=>{const d=Oi.current,f=Xs.current,p=c.filter(g=>g.type==="preview");if(!p.length)return c;let h=null;if(d){const g=p.find(z=>z.id===d);g&&(h=g.id)}if(!h&&f&&f.size>0){const g=p.find(z=>f.has(z.id));g&&(h=g.id)}return h||(h=p[p.length-1].id),c.map(g=>g.id===h?{...g,content:n.url,previewType:"image"}:g)}),Zc())},qb=()=>{const{frame:n}=Pi;if(!(n!=null&&n.url))return;const c=ee,d=At.get(c);d&&d.type==="input-image"?l(f=>f.map(p=>p.id===c?{...p,content:n.url}:p)):alert('""'),Zc()},qc=(n,c,d=null,f=null)=>{n.preventDefault(),n.stopPropagation();const p=d?ui(c,d):ui(c),h=f!==null?f:c.selectedMjImageIndex!==void 0?c.selectedMjImageIndex:null,g={...c,url:p,selectedMjImageIndex:h},z=mn(n.clientX,n.clientY);$s({visible:!0,x:n.clientX,y:n.clientY,worldX:z.x,worldY:z.y,item:g})},Qb=()=>{const n=kr.item,c=ee,d=At.get(c),f=ui(n);d&&d.type==="input-image"&&f?l(p=>p.map(h=>h.id===c?{...h,content:f}:h)):alert('""'),$s({visible:!1,x:0,y:0,item:null})},ev=async()=>{const n=kr.item,c=ui(n);if(!c)return;let d=c;n.type==="video"&&!Un(d)&&(d+=(d.includes("?")?"&":"?")+"force_video_display=true");let f;if(n.type==="image")try{const C=await Wr(d);C!=null&&C.w&&(C!=null&&C.h)&&(f={w:C.w,h:C.h})}catch(C){console.error("SendHistoryToCanvas getImageDimensions error",C)}const p=a.filter(C=>C.type==="input-image");let h,g;if(p.length>0){const C=p[p.length-1];h=C.x-40,g=C.y+35}else{const C=mn(window.innerWidth/2,window.innerHeight/2);h=C.x+50,g=C.y+50}let z=h,y=g;const N=(C,E)=>a.some(H=>Math.abs(H.x-C)<80&&Math.abs(H.y-E)<80);let S=0;for(;N(z,y)&&S<50;)z-=40,y+=35,S++;$r("input-image",z,y,null,d,f),$s({visible:!1,x:0,y:0,item:null})},tv=()=>{const n=kr.item,c=(n==null?void 0:n.url)||(n==null?void 0:n.localCacheUrl)||(n==null?void 0:n.originalUrl)||(n==null?void 0:n.mjOriginalUrl);if(!n||!c)return;const d=n.type==="image",f=n.type==="video",p=d?"png":f?"mp4":"file",h=d?"image/png":f?"video/mp4":"application/octet-stream",g={name:`Generated-${n.id}.${p}`,type:h,content:c,isImage:d,isVideo:f,isAudio:!1,fromHistory:!0,fileExt:p};Je(z=>[...z,g]),Ks(!0),$s({visible:!1,x:0,y:0,item:null})},fp=async n=>{if(!n||n.length===0){console.warn("[V3.5.1 Debug] No items to download");return}const c=h=>(h==null?void 0:h.localCacheUrl)||(h==null?void 0:h.url)||(h==null?void 0:h.originalUrl)||(h==null?void 0:h.mjOriginalUrl);if(n.length===1){const h=n[0],g=c(h);if(!(h!=null&&h.mjImages)&&g){us({active:!0,current:0,total:1});try{const y=g;let N="mp4";if(y.startsWith("data:image"))N="png";else if(y.startsWith("data:video"))N="mp4";else if(h.type==="video"||y.includes("/video/")||y.includes("video_mp4"))N="mp4";else if(h.type==="image")N="png";else{const H=y.split("?")[0].split("/").pop();if(H&&H.includes(".")){const A=H.split(".").pop();A&&A.length<=5&&/^[a-z0-9]+$/i.test(A)&&(N=A)}}const C=`${(h.prompt||"download").replace(/[\\/:*?"<>|]/g,"_").slice(0,50)}.${N}`;if(y.startsWith("data:")){const E=document.createElement("a");E.href=y,E.download=C,E.click()}else{const H=await(await fetch(y)).blob(),A=document.createElement("a");A.href=URL.createObjectURL(H),A.download=C,A.click()}us({active:!1,current:1,total:1})}catch(y){console.error(":",y),us({active:!1,current:0,total:0}),alert(": "+y.message)}return}}const d=new gz;let f=0;const p=n.length;us({active:!0,current:0,total:p});try{for(const y of n){if(!y)continue;const N=[];if(y.mjImages&&y.mjImages.length>0)y.mjImages.forEach((S,C)=>{N.push({url:S,suffix:`_${C+1}`})});else{const S=c(y);S&&N.push({url:S,suffix:""})}for(const S of N)try{let C;if(S.url.startsWith("data:")){const F=S.url.split(","),Q=F[0].match(/:(.*?);/)[1],G=atob(F[1]);let pe=G.length;const J=new Uint8Array(pe);for(;pe--;)J[pe]=G.charCodeAt(pe);C=new Blob([J],{type:Q})}else C=await(await fetch(S.url)).blob();let E=C.type.split("/")[1]||"png";const H=c(y);if(H&&!H.startsWith("data:")){const F=H.split(".").pop().split("?")[0];F&&F.length<5&&(E=F)}const A=(y.prompt||"untitled").replace(/[\\/:*?"<>|]/g,"_").slice(0,40),U=y.id?`_${y.id.slice(-4)}`:"",V=`${A}${U}${S.suffix}.${E}`;d.file(V,C),f++}catch(C){console.error(` [${y.id}]:`,C)}us(S=>({...S,current:S.current+1}))}if(f===0){us({active:!1,current:0,total:0}),alert("");return}const h=await d.generateAsync({type:"blob"}),g=new Date,z=`${g.getFullYear().toString().slice(2)}${(g.getMonth()+1).toString().padStart(2,"0")}${g.getDate().toString().padStart(2,"0")}-${g.getHours().toString().padStart(2,"0")}${g.getMinutes().toString().padStart(2,"0")}`;xz.saveAs(h,`tapnow-assets-${z}.zip`),us({active:!1,current:0,total:0})}catch(h){console.error(":",h),us({active:!1,current:0,total:0}),alert(": "+h.message)}},hl=(n,c)=>{c!=null&&c.url&&(n.preventDefault(),n.stopPropagation(),lh({visible:!0,x:n.clientX,y:n.clientY,item:c}))},zo=()=>lh({visible:!1,x:0,y:0,item:null}),nv=()=>{const n=Ai.item;if(!(n!=null&&n.url))return;const c=n.type!=="video",d=n.type==="video",f=c?"png":"mp4",p=c?"image/png":"video/mp4",h={name:`Preview-${Date.now()}.${f}`,type:p,content:n.url,isImage:c,isVideo:d,isAudio:!1,fileExt:f};Je(g=>[...g,h]),Ks(!0),zo()},rv=async()=>{const n=Ai.item;if(!(n!=null&&n.url))return;const c=mn(window.innerWidth/2,window.innerHeight/2);let d={w:512,h:512};try{d=await Wr(n.url)}catch(f){console.warn("Preview dims fail",f)}$r("input-image",c.x+50,c.y+50,null,n.url,d),zo()},sv=(n,c)=>{n.preventDefault(),n.stopPropagation();const d=At.get(c);!d||!d.content||ch({visible:!0,x:n.clientX,y:n.clientY,nodeId:c})},hp=()=>{ch({visible:!1,x:0,y:0,nodeId:null})},iv=()=>{const n=Xa.nodeId,c=At.get(n);if(!c||!c.content)return;const d=!Un(c.content),f=Un(c.content),p=d?"png":"mp4",h=d?"image/png":"video/mp4",g={name:`InputImage-${Date.now()}.${p}`,type:h,content:c.content,isImage:d,isVideo:f,isAudio:!1,fileExt:p};Je(z=>[...z,g]),Ks(!0),hp()},qh=D.memo(({connections:n,nodesMap:c,connectionsByNode:d,connectingSource:f,connectingTarget:p,connectingInputType:h,mousePos:g,apiConfigsMap:z,selectedNodeId:y,onDisconnectConnection:N,visibleNodes:S})=>{const C=D.useMemo(()=>new Set(S.map(H=>H.id)),[S]),E=D.useMemo(()=>n.filter(H=>C.has(H.from)||C.has(H.to)),[n,C]);return i.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-visible w-full h-full",children:i.jsxs("svg",{className:"absolute inset-0 overflow-visible w-full h-full pointer-events-none",children:[E.map(H=>{var st;const A=c.get(H.from),U=c.get(H.to);if(!A||!U)return null;const V=y&&(A.id===y||U.id===y),F=V?1:.35,Q=A.x+A.width-4,G=A.y+A.height/2,pe=U.x+4;let J=U.y+U.height/2;if(U.type==="image-compare"){const Ze=(d.to.get(U.id)||[]).findIndex(xt=>xt.id===H.id);Ze===0?J=U.y+U.height*.33:Ze>=1&&(J=U.y+U.height*.66)}if(U.type==="gen-image"&&(H.inputType==="oref"||H.inputType==="sref")){const Ue=z.get((st=U.settings)==null?void 0:st.model);if(Ue&&(Ue.id.includes("mj")||Ue.provider.toLowerCase().includes("midjourney"))){const mt=(d.to.get(U.id)||[]).some(Ot=>!Ot.inputType||Ot.inputType==="default");let Ct=12;Ct+=24,mt&&(Ct+=68),Ct+=108,H.inputType==="oref"?J=U.y+Ct+16*.5:H.inputType==="sref"&&(J=U.y+Ct+16+6+28+6+16*.5)}}const ge=Math.abs(pe-Q),le=Q+ge*.5,ne=pe-ge*.5,te=(Q+pe)/2,$e=(G+J)/2;return i.jsxs("g",{className:"connection-group",style:{opacity:F},children:[i.jsx("path",{d:`M ${Q} ${G} C ${le} ${G}, ${ne} ${J}, ${pe} ${J}`,stroke:"transparent",strokeWidth:"20",fill:"none",style:{pointerEvents:"stroke"}}),i.jsx("path",{d:`M ${Q} ${G} C ${le} ${G}, ${ne} ${J}, ${pe} ${J}`,stroke:"#18181b",strokeWidth:"4",fill:"none"}),i.jsx("path",{d:`M ${Q} ${G} C ${le} ${G}, ${ne} ${J}, ${pe} ${J}`,stroke:"#71717a",strokeWidth:"2",fill:"none"}),i.jsx("circle",{cx:Q,cy:G,r:"2",fill:"#71717a"}),i.jsx("circle",{cx:pe,cy:J,r:"2",fill:"#71717a"}),i.jsxs("g",{className:"connection-delete cursor-pointer",style:{opacity:V?1:.35,pointerEvents:"auto",cursor:"pointer"},onClick:Ue=>{Ue.stopPropagation(),Ue.preventDefault(),N(H.id)},onMouseDown:Ue=>{Ue.stopPropagation(),Ue.preventDefault(),N(H.id)},children:[i.jsx("circle",{cx:te,cy:$e,r:"25",fill:"transparent",style:{pointerEvents:"auto",cursor:"pointer"},onClick:Ue=>{Ue.stopPropagation(),Ue.preventDefault(),N(H.id)},onMouseDown:Ue=>{Ue.stopPropagation(),Ue.preventDefault(),N(H.id)}}),i.jsx("circle",{cx:te,cy:$e,r:"12",fill:"#ef4444",opacity:"0.8",style:{pointerEvents:"none"}}),i.jsx("circle",{cx:te,cy:$e,r:"8",fill:"#ef4444",style:{pointerEvents:"none"}}),i.jsx(fz,{size:10,className:"text-white",x:te-5,y:$e-5,style:{pointerEvents:"none"}})]})]},H.id)}),f&&(()=>{const H=c.get(f);return H?i.jsx("path",{d:`M ${H.x+H.width-4} ${H.y+H.height/2} C ${H.x+H.width+100} ${H.y+H.height/2}, ${g.x-100} ${g.y}, ${g.x} ${g.y}`,stroke:"#60a5fa",strokeWidth:"2",fill:"none",strokeDasharray:"4,4"}):null})(),p&&(()=>{var V;const H=c.get(p);if(!H)return null;const A=H.x+4;let U=H.y+H.height/2;if(H.type==="gen-image"&&h){const F=z.get((V=H.settings)==null?void 0:V.model);if(F&&(F.id.includes("mj")||F.provider.toLowerCase().includes("midjourney"))){const xt=(d.to.get(H.id)||[]).some(_t=>!_t.inputType||_t.inputType==="default");let yt=12;yt+=24,xt&&(yt+=68),yt+=108,h==="oref"?U=H.y+yt+16*.5:h==="sref"&&(U=H.y+yt+16+6+28+6+16*.5)}}else H.type==="image-compare"&&(U=H.y+H.height/2);return i.jsx("path",{d:`M ${A} ${U} C ${A-100} ${U}, ${g.x+100} ${g.y}, ${g.x} ${g.y}`,stroke:"#60a5fa",strokeWidth:"2",fill:"none",strokeDasharray:"4,4"})})()]})})},(n,c)=>n.connections===c.connections&&n.visibleNodes===c.visibleNodes&&n.selectedNodeId===c.selectedNodeId&&n.connectingSource===c.connectingSource&&n.connectingTarget===c.connectingTarget&&n.connectingInputType===c.connectingInputType&&n.mousePos.x===c.mousePos.x&&n.mousePos.y===c.mousePos.y);D.useCallback(()=>i.jsx(qh,{connections:u,nodesMap:At,connectionsByNode:Ui,connectingSource:Dn,connectingTarget:hn,connectingInputType:ps,mousePos:Ld,apiConfigsMap:fn,selectedNodeId:ee,onDisconnectConnection:up,visibleNodes:Dc}),[u,At,Ui,Dn,hn,ps,Ld,fn,ee,up,Dc]);const Qh=D.useMemo(()=>{const n=new Map;return u.forEach(c=>{(!c.inputType||c.inputType==="default")&&n.set(c.to,!0)}),n},[u]),em=D.useCallback(n=>{const c=new Set,d=Ui.from.get(n)||[],f=Ui.to.get(n)||[];return d.forEach(p=>c.add(p.to)),f.forEach(p=>c.add(p.from)),c},[Ui]),tm=D.useMemo(()=>{const n=new Map;if(ee||Cn.size>0){const c=ee||(Cn.size===1?Array.from(Cn)[0]:null);c&&n.set(c,em(c))}return n},[ee,Cn,em]),ov=D.useCallback(n=>{var H,A,U,V,F,Q,G,pe,J,ge,le,ne,te,$e,st,Ue,Ze,xt,yt,_t,bt,Wt,Bt,Ht,rn;const d=we.zoom<.4,f=ee===n.id||Cn.has(n.id),p=Th(n.id),h=Go===n.id,g=Qh.get(n.id)||!1,z=Fr===n.id||Fr&&Cn.has(n.id),y=ee||(Cn.size===1?Array.from(Cn)[0]:null),N=y?tm.get(y):null,S=y&&y!==n.id&&N&&N.has(n.id),C=fn.get((H=n.settings)==null?void 0:H.model),E=C?(C.modelName||C.id||"").includes("nano-banana-2"):(((A=n.settings)==null?void 0:A.model)||"").includes("nano-banana-2");return d?i.jsxs("div",{"data-node-id":n.id,className:`absolute node-wrapper flex flex-col ${f?"ring-1 ring-blue-500":e==="dark"?"border border-zinc-800":"border border-zinc-200"} ${e==="dark"?"bg-[#18181b]":"bg-white"}`,style:{left:n.x,top:n.y,width:n.width,height:n.height,cursor:Fr===n.id||Fr&&Cn.has(n.id)?"grabbing":"default",zIndex:z?50:10,border:`1px solid ${e==="dark"?"#3f3f46":"#e4e4e7"}`,background:e==="dark"?"#18181b":"#fff",boxShadow:"none",borderRadius:"0",transform:"translateZ(0)",backfaceVisibility:"hidden"},onMouseDown:O=>{O.button===0&&(O.stopPropagation(),O.ctrlKey||O.metaKey?Ir(de=>{const Fe=new Set(de);return Fe.has(n.id)?Fe.delete(n.id):Fe.add(n.id),Fe.size===1?ae(Array.from(Fe)[0]):ae(null),Fe}):Cn.has(n.id)&&Cn.size>1?ae(n.id):(ae(n.id),Ir(new Set([n.id]))),Ya(n.id))},onMouseEnter:()=>{(Dn||hn)&&$i(n.id)},onMouseLeave:()=>{(Dn||hn)&&Go===n.id&&$i(null)},onMouseUp:O=>Ms(n.id,O),children:[n.type==="input-image"&&n.content&&i.jsx("div",{className:"w-full h-full relative",children:Un(n.content)?i.jsx("video",{src:n.content,className:"w-full h-full object-cover opacity-80",muted:!0,playsInline:!0}):i.jsx(Vn,{src:n.content,className:"w-full h-full object-cover opacity-80",alt:""})}),n.type==="video-input"&&n.content&&i.jsx("video",{src:n.content,className:"w-full h-full object-cover opacity-80",muted:!0,playsInline:!0}),!n.content&&i.jsx("div",{className:`p-2 font-bold text-sm truncate ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:n.type==="input-image"?"":n.type==="video-input"?"":n.type==="gen-image"||n.type==="gen-image"?"":n.type==="gen-video"?"":n.type==="text-node"?"":n.type==="preview"?"":n.type==="novel-input"?"":n.type==="extract-characters-scenes"?"":n.type==="character-description"?"":n.type==="scene-description"?"":n.type==="generate-character-video"?"":n.type==="generate-scene-video"?"":n.type==="generate-character-image"?"":n.type==="generate-scene-image"?"":n.type==="create-character"?"":n.type==="create-scene"?"":n.type==="save-to-local"||n.type==="local-save"?"":n.type||""}),n.type!=="input-image"&&n.type!=="video-input"&&n.type!=="video-analyze"&&n.type!=="preview"&&(n.type==="image-compare"?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"input-point",style:{top:"33%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:g?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:O=>{O.stopPropagation(),O.preventDefault();const de=mn(O.clientX,O.clientY);Es(de),ds(n.id),fs("default")},onMouseUp:O=>Ms(n.id,O,"default")}),i.jsx("div",{className:"input-point",style:{top:"66%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:g?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:O=>{O.stopPropagation(),O.preventDefault();const de=mn(O.clientX,O.clientY);Es(de),ds(n.id),fs("default")},onMouseUp:O=>Ms(n.id,O,"default")})]}):i.jsx("div",{className:"input-point",style:{top:"50%",left:"-0.25rem",width:"0.5rem",height:"0.5rem",backgroundColor:g?"#60a5fa":"#52525b",borderRadius:"50%",position:"absolute",zIndex:20,pointerEvents:"auto"},onMouseDown:O=>{O.stopPropagation(),O.preventDefault();const de=mn(O.clientX,O.clientY);Es(de),ds(n.id),fs("default")},onMouseUp:O=>Ms(n.id,O,"default")})),n.type!=="preview"&&i.jsx("div",{className:"connector connector-right",style:{position:"absolute",top:"50%",right:"-0.45rem",width:"0.9rem",height:"0.9rem",backgroundColor:Dn===n.id?"#d4d4d8":"#27272a",border:"1px solid #71717a",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"crosshair",zIndex:30,opacity:Dn===n.id?1:.5,pointerEvents:"auto"},onMouseDown:O=>{O.stopPropagation(),O.preventDefault();const de=mn(O.clientX,O.clientY);Es(de),Yo(n.id)},children:i.jsx(Vi,{size:10})})]},n.id):i.jsxs("div",{"data-node-id":n.id,className:`absolute rounded-xl shadow-xl transition-shadow duration-150 group flex flex-col node-wrapper ${f?"ring-1 ring-blue-500 shadow-blue-500/20":S?"ring-2 ring-blue-300/60 shadow-blue-300/30":e==="dark"?"border border-zinc-800 shadow-black/40":"border border-zinc-200 shadow-black/10"} ${h&&(Dn&&Dn!==n.id||hn&&hn!==n.id)?"ring-2 ring-green-500/50":""} ${e==="dark"?"bg-[#18181b]":"bg-white"}`,style:{left:n.x,top:n.y,width:n.width,height:n.height,cursor:Fr===n.id||Fr&&Cn.has(n.id)?"grabbing":"default",zIndex:z?50:10,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transform:"translateZ(0)",backfaceVisibility:"hidden"},onMouseDown:O=>{O.button===0&&(O.stopPropagation(),O.ctrlKey||O.metaKey?Ir(de=>{const Fe=new Set(de);return Fe.has(n.id)?Fe.delete(n.id):Fe.add(n.id),Fe.size===1?ae(Array.from(Fe)[0]):ae(null),Fe}):Cn.has(n.id)&&Cn.size>1?ae(n.id):(ae(n.id),Ir(new Set([n.id]))),Ya(n.id),ln(null))},onMouseEnter:()=>{(Dn||hn)&&$i(n.id)},onMouseLeave:()=>{(Dn||hn)&&Go===n.id&&$i(null)},onMouseUp:O=>Ms(n.id,O),onDoubleClick:O=>{O.stopPropagation(),(n.type==="input-image"||n.type==="video-input")&&n.content&&xn({url:n.content,type:Un(n.content)?"video":"image"})},children:[i.jsx("button",{onClick:O=>{O.stopPropagation(),rp(n.id)},className:`absolute -top-2.5 -right-2.5 z-50 p-1 rounded-full shadow border opacity-0 group-hover:opacity-100 transition-opacity scale-90 hover:scale-100 ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:text-red-500 hover:bg-zinc-700 border-zinc-700":"bg-zinc-100 text-zinc-500 hover:text-red-500 hover:bg-zinc-200 border-zinc-300"}`,onMouseDown:O=>O.stopPropagation(),children:i.jsx(ns,{size:12})}),i.jsx("div",{className:"absolute bottom-1 right-1 w-4 h-4 z-[100] resize-handle flex items-end justify-end p-0.5",onMouseDown:O=>{O.stopPropagation(),O.preventDefault(),zc(n.id)},children:i.jsx("svg",{width:"6",height:"6",viewBox:"0 0 8 8",fill:"none",className:"text-zinc-600",children:i.jsx("path",{d:"M8 0L8 8L0 8",stroke:"currentColor",strokeWidth:"2"})})}),n.type!=="input-image"&&n.type!=="video-input"&&n.type!=="video-analyze"&&n.type!=="preview"&&(n.type==="image-compare"?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`input-point ${hn===n.id&&!ps?"active":""}`,style:{top:"33%"},title:" 1 ",onMouseDown:O=>{O.stopPropagation(),O.preventDefault();const de=mn(O.clientX,O.clientY);Es(de),ds(n.id),fs("default")},onMouseUp:O=>Ms(n.id,O,"default")}),i.jsx("div",{className:`input-point ${hn===n.id&&!ps?"active":""}`,style:{top:"66%"},title:" 2 ",onMouseDown:O=>{O.stopPropagation(),O.preventDefault();const de=mn(O.clientX,O.clientY);Es(de),ds(n.id),fs("default")},onMouseUp:O=>Ms(n.id,O,"default")})]}):i.jsx("div",{className:`input-point ${g?"connected":""} ${hn===n.id&&!ps?"active":""}`,title:"",onMouseDown:O=>{O.stopPropagation(),O.preventDefault();const de=mn(O.clientX,O.clientY);Es(de),ds(n.id),fs("default")},onMouseUp:O=>Ms(n.id,O,"default")})),n.type!=="preview"&&i.jsx("div",{className:`connector connector-right ${Dn===n.id?"active":""} ${hn&&Go===n.id?"ring-2 ring-green-500/50":""}`,title:"",onMouseDown:O=>{O.stopPropagation(),O.preventDefault();const de=mn(O.clientX,O.clientY);Es(de),Yo(n.id)},onMouseEnter:()=>{hn&&$i(n.id)},onMouseLeave:()=>{hn&&Go===n.id&&$i(null)},children:i.jsx(Vi,{size:10})}),i.jsxs("div",{className:`overflow-hidden rounded-xl flex-1 flex flex-col pointer-events-none h-full w-full relative ${e==="dark"?"bg-[#18181b]":"bg-white"}`,children:[n.type==="novel-input"&&i.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[i.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0",children:[i.jsx(ts,{size:12,className:"text-blue-500"}),i.jsx("span",{children:""})]}),i.jsxs("div",{className:"flex-1 flex flex-col gap-2 p-3 overflow-hidden min-h-0",children:[i.jsx("textarea",{value:((U=n.settings)==null?void 0:U.content)||"",onChange:O=>{const de=O.target.value;de.length<=1e4&&Be(n.id,{content:de})},placeholder:"10,000...",maxLength:1e4,className:`w-full flex-1 resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:O=>O.stopPropagation()}),i.jsxs("div",{className:"text-right text-[10px] text-zinc-500 shrink-0",children:[(((V=n.settings)==null?void 0:V.content)||"").length,"/10,000"]}),i.jsxs("button",{className:"w-full py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-1.5 bg-blue-600 hover:bg-blue-500 text-white shrink-0",onMouseDown:O=>O.stopPropagation(),onClick:O=>{O.stopPropagation(),Mb(n.id)},children:[i.jsx(Ml,{size:12})," "]})]})]}),n.type==="extract-characters-scenes"&&i.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold",children:[i.jsx(ku,{size:12,className:"text-purple-500"}),i.jsx("span",{children:""})]}),((F=n.settings)==null?void 0:F.analysisResults)&&i.jsx("span",{className:"text-[10px] opacity-70",children:(((Q=n.settings.analysisResults.characters)==null?void 0:Q.length)||0)+(((G=n.settings.analysisResults.scenes)==null?void 0:G.length)||0)})]}),i.jsxs("div",{className:"flex-1 flex flex-col p-3 overflow-hidden min-h-0",children:[i.jsx("div",{className:"flex flex-col gap-3",children:i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:O=>{O.stopPropagation(),ln((Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="extract-model"?null:{nodeId:n.id,type:"extract-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:O=>O.stopPropagation(),children:[i.jsx("span",{className:"truncate font-mono",children:Rc((pe=n.settings)==null?void 0:pe.model)}),i.jsx(Rs,{size:12,className:"opacity-50 shrink-0"})]}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="extract-model"&&i.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:O=>O.stopPropagation(),onMouseLeave:()=>Zn(null),children:[i.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(pr).filter(([,O])=>O.models.some(de=>de.type==="Chat")).map(([O,de])=>i.jsx("button",{onMouseEnter:()=>Zn(O),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${zn===O?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:de.name||O},O))}),i.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[zn&&((J=pr[zn])==null?void 0:J.models.filter(O=>O.type==="Chat").map(O=>{var de;return i.jsxs("button",{onClick:()=>{Be(n.id,{model:O.id}),tp(O.id);try{localStorage.setItem("tapnow_last_extract_model",O.id)}catch{}ln(null),Zn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((de=n.settings)==null?void 0:de.model)===O.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[i.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:O.displayName||O.modelName||O.id}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(O.id)}`})]},O.id)})),!zn&&i.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]})}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar mt-2",children:[(()=>{var mt;const O=(mt=n.settings)==null?void 0:mt.analysisResults;if(!O)return i.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-[11px] opacity-70",children:[i.jsx(Fg,{size:18,className:"mb-1 opacity-70"}),i.jsx("span",{children:""})]});const de=Array.isArray(O.characters)?O.characters:[],Fe=Array.isArray(O.scenes)?O.scenes:[];return i.jsxs("div",{className:"flex flex-col gap-3",children:[de.length>0&&i.jsxs("div",{children:[i.jsxs("div",{className:"text-[10px] font-medium mb-1 opacity-70",children:[" (",de.length,")"]}),de.map((Ct,Ot)=>i.jsxs("div",{className:`p-2 rounded mb-1 ${e==="dark"?"bg-zinc-800":"bg-white border border-zinc-200"}`,children:[i.jsxs("div",{className:"flex items-center gap-1 text-[11px]",children:[i.jsx("span",{className:`w-2 h-2 rounded-full shrink-0 ${Ot===0?"bg-red-500":Ot===1?"bg-purple-500":Ot===2?"bg-blue-500":"bg-zinc-400"}`}),i.jsx("span",{className:"font-medium",children:Ct.name||""})]}),Ct.description&&i.jsx("div",{className:"mt-1 text-[10px] opacity-70 leading-snug",children:Ct.description})]},`${Ct.name||"char"}-${Ot}`))]}),Fe.length>0&&i.jsxs("div",{children:[i.jsxs("div",{className:"text-[10px] font-medium mb-1 opacity-70",children:[" (",Fe.length,")"]}),Fe.map((Ct,Ot)=>i.jsxs("div",{className:`p-2 rounded mb-1 ${e==="dark"?"bg-zinc-800":"bg-white border border-zinc-200"}`,children:[i.jsxs("div",{className:"flex items-center gap-1 text-[11px]",children:[i.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 shrink-0"}),i.jsx("span",{className:"font-medium",children:Ct.location||Ct.name||""})]}),Ct.description&&i.jsx("div",{className:"mt-1 text-[10px] opacity-70 leading-snug",children:Ct.description})]},`${Ct.location||"scene"}-${Ot}`))]}),de.length===0&&Fe.length===0&&i.jsx("div",{className:"text-[11px] text-zinc-500",children:"/"})]})})(),((ge=n.settings)==null?void 0:ge.errorMsg)&&i.jsx("div",{className:"mt-2 text-[10px] text-red-500 break-words",children:n.settings.errorMsg})]}),((le=n.settings)==null?void 0:le.isAnalyzing)&&i.jsxs("div",{className:"mt-2",children:[i.jsx("div",{className:"text-[10px] mb-1 opacity-70",children:"..."}),i.jsx("div",{className:`w-full h-1.5 rounded-full overflow-hidden ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:i.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${((ne=n.settings)==null?void 0:ne.progress)||0}%`}})}),i.jsxs("div",{className:"text-[10px] mt-1 opacity-70",children:[((te=n.settings)==null?void 0:te.progress)||0,"%"]})]}),i.jsx("button",{className:`mt-2 w-full py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-1.5 ${($e=n.settings)!=null&&$e.isAnalyzing?"bg-zinc-700 text-zinc-400 cursor-not-allowed":"bg-purple-600 hover:bg-purple-500 text-white"}`,onMouseDown:O=>O.stopPropagation(),onClick:O=>{O.stopPropagation(),Xh(n.id)},children:(st=n.settings)!=null&&st.isAnalyzing?i.jsxs(i.Fragment,{children:[i.jsx(hi,{size:12,className:"animate-spin"}),"..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ml,{size:12}),""]})})]})]}),(n.type==="character-description"||n.type==="scene-description")&&i.jsx("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:(()=>{var Lt,pt,ft,kt,ot,Mt,Dt,Rt,zt,yn,En,Z,re,Ie,at,se,Ae,vt,Qt,ct,bn,Kt,B;const O=n.type==="character-description",de=O?"":"",Fe=((Lt=n.settings)==null?void 0:Lt.mode)||"video",mt={name:((pt=n.settings)==null?void 0:pt.characterName)||((ft=n.settings)==null?void 0:ft.name)||"",role:((kt=n.settings)==null?void 0:kt.role)||"",description:((ot=n.settings)==null?void 0:ot.description)||"",age:((Mt=n.settings)==null?void 0:Mt.age)||"",gender:((Dt=n.settings)==null?void 0:Dt.gender)||""},Ct={name:((Rt=n.settings)==null?void 0:Rt.sceneName)||((zt=n.settings)==null?void 0:zt.location)||"",location:((yn=n.settings)==null?void 0:yn.sceneName)||((En=n.settings)==null?void 0:En.location)||"",description:((Z=n.settings)==null?void 0:Z.description)||""},Ot=O?wo(mt,Fe):pl(Ct),wt=((re=n.settings)==null?void 0:re.prompt)||Ot;return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(ts,{size:12,className:O?"text-red-500":"text-green-500"}),i.jsx("span",{children:de})]}),O?mt.name?i.jsxs("div",{className:"text-[10px] text-zinc-500",children:[": ",mt.name]}):null:Ct.name?i.jsxs("div",{className:"text-[10px] text-zinc-500",children:[": ",Ct.name]}):null]}),i.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-y-auto custom-scrollbar min-h-0",children:[i.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i.jsx("button",{className:`px-2 py-1 rounded text-[10px] transition-colors ${Fe==="video"?"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,onMouseDown:ze=>ze.stopPropagation(),onClick:()=>{var Ge;const ze=((Ge=n.settings)==null?void 0:Ge.prompt)||(O?wo(mt,"image"):Ot),Me=O?Hh(ze):ze;Be(n.id,{mode:"video",prompt:Me}),setTimeout(()=>Sb(n.id),0)},children:""}),i.jsx("button",{className:`px-2 py-1 rounded text-[10px] transition-colors ${Fe==="image"?"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,onMouseDown:ze=>ze.stopPropagation(),onClick:()=>{var Ge;const ze=((Ge=n.settings)==null?void 0:Ge.prompt)||(O?wo(mt,"video"):Ot),Me=O?Wh(ze):ze;Be(n.id,{mode:"image",prompt:Me}),setTimeout(()=>_b(n.id),0)},children:""}),i.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[i.jsx("button",{onClick:()=>Vh(n.id,"enhance"),disabled:(Ie=n.settings)==null?void 0:Ie.isEnhancing,className:`px-2 py-1 rounded text-[10px] transition-colors ${(at=n.settings)!=null&&at.isEnhancing?e==="dark"?"bg-zinc-700 text-zinc-500 cursor-not-allowed":"bg-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-purple-600/80 text-white hover:bg-purple-500":"bg-purple-600 text-white hover:bg-purple-500"}`,children:O?"":""}),i.jsx("button",{onClick:()=>Vh(n.id,"filter"),disabled:(se=n.settings)==null?void 0:se.isEnhancing,className:`px-2 py-1 rounded text-[10px] transition-colors ${(Ae=n.settings)!=null&&Ae.isEnhancing?e==="dark"?"bg-zinc-700 text-zinc-500 cursor-not-allowed":"bg-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-200 text-zinc-700 hover:bg-zinc-300"}`,children:""})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("div",{className:"flex items-center justify-between text-[10px] text-zinc-500",children:[i.jsx("span",{children:""}),((vt=n.settings)==null?void 0:vt.isEnhancing)&&i.jsxs("span",{className:"flex items-center gap-1 text-blue-400",children:[i.jsx(hi,{size:10,className:"animate-spin"}),""]})]}),i.jsx("textarea",{value:wt,onChange:ze=>Be(n.id,{prompt:ze.target.value}),placeholder:"/...",className:`w-full h-28 resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:ze=>ze.stopPropagation()})]}),i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] font-medium opacity-70",children:"/"}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:ze=>{ze.stopPropagation(),ln((Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="desc-model"?null:{nodeId:n.id,type:"desc-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:ze=>ze.stopPropagation(),children:[i.jsx("span",{className:"truncate font-mono",children:Rc((Qt=n.settings)==null?void 0:Qt.chatModel)}),i.jsx(Rs,{size:12,className:"opacity-50 shrink-0"})]}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="desc-model"&&i.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:ze=>ze.stopPropagation(),onMouseLeave:()=>Zn(null),children:[i.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(pr).filter(([,ze])=>ze.models.some(Me=>Me.type==="Chat")).map(([ze,Me])=>i.jsx("button",{onMouseEnter:()=>Zn(ze),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${zn===ze?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:Me.name||ze},ze))}),i.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[zn&&((ct=pr[zn])==null?void 0:ct.models.filter(ze=>ze.type==="Chat").map(ze=>{var Me;return i.jsxs("button",{onClick:()=>{Be(n.id,{chatModel:ze.id}),tp(ze.id);try{localStorage.setItem("tapnow_last_extract_model",ze.id)}catch{}ln(null),Zn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((Me=n.settings)==null?void 0:Me.chatModel)===ze.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[i.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:ze.displayName||ze.modelName||ze.id}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(ze.id)}`})]},ze.id)})),!zn&&i.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]}),i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),i.jsx("select",{value:((bn=n.settings)==null?void 0:bn.style)||"none",onChange:ze=>{var Nt;const Me=ze.target.value,Ge=jb(Me),qe=((Nt=n.settings)==null?void 0:Nt.prompt)||Ot,ut=qe.includes("")?qe.replace(/^[^]+/,`${Ge}`):`${Ge}${qe}`;Be(n.id,{style:Me,prompt:ut})},className:`w-full text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:ze=>ze.stopPropagation(),children:zb.map(ze=>i.jsx("option",{value:ze.value,children:ze.label},ze.value))})]}),i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),i.jsx("div",{className:`rounded-lg border-2 border-dashed p-2 transition-colors drop-zone ${e==="dark"?"border-zinc-700 bg-zinc-800/60":"border-zinc-300 bg-white"}`,onDrop:ze=>hb(n.id,ze),onDragOver:dp,onDragLeave:pp,onMouseDown:ze=>ze.stopPropagation(),children:((B=(Kt=n.settings)==null?void 0:Kt.referenceImages)==null?void 0:B.length)>0?i.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[n.settings.referenceImages.map((ze,Me)=>i.jsxs("div",{className:"relative aspect-square rounded overflow-hidden",children:[i.jsx(Vn,{src:ze,className:"w-full h-full object-cover"}),i.jsx("button",{onClick:Ge=>{Ge.stopPropagation();const qe=[...n.settings.referenceImages];qe.splice(Me,1),Be(n.id,{referenceImages:qe})},className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white hover:bg-red-500",title:"",children:i.jsx(ns,{size:10})})]},`${n.id}-ref-${Me}`)),i.jsxs("label",{className:"aspect-square rounded border border-dashed border-zinc-500/60 flex items-center justify-center text-[10px] text-zinc-400 cursor-pointer hover:border-blue-400 hover:text-blue-400",children:["+ ",i.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:ze=>Fh(n.id,ze)})]})]}):i.jsxs("label",{className:"flex flex-col items-center justify-center gap-1 text-[10px] text-zinc-500 cursor-pointer",children:[i.jsx(Hi,{size:16}),"",i.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:ze=>Fh(n.id,ze)})]})})]})]})]})})()}),(n.type==="generate-character-video"||n.type==="generate-scene-video")&&i.jsx("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:(()=>{var bn,Kt,B,ze,Me,Ge,qe,ut,Nt,rt,je,fe;const O=n.type==="generate-character-video",de=O?"character-description":"scene-description",Fe=O?"generate-character-image":"generate-scene-image",mt=u.filter(me=>me.to===n.id).map(me=>At.get(me.from)).find(me=>(me==null?void 0:me.type)===de),Ct=u.filter(me=>me.to===n.id).map(me=>At.get(me.from)).find(me=>(me==null?void 0:me.type)===Fe),Ot=dt.find(me=>me.sourceNodeId===n.id&&me.status==="completed"),wt=dt.find(me=>me.sourceNodeId===n.id&&me.status==="generating"),Lt=dt.find(me=>me.sourceNodeId===n.id&&me.status==="failed"),pt=ui(Ot),ft=Ct?dt.find(me=>me.sourceNodeId===Ct.id&&me.status==="completed"):null,kt=(bn=ft==null?void 0:ft.output_images)!=null&&bn.length?ft.output_images:(Kt=ft==null?void 0:ft.mjImages)!=null&&Kt.length?ft.mjImages:[],ot=ui(ft),Mt=kt.length>0?kt:ot?[ot]:[],Dt=(B=Ct==null?void 0:Ct.settings)==null?void 0:B.selectedImageIndex,Rt=Dt!=null&&Mt[Dt]?Mt[Dt]:null,zt=((ze=n.settings)==null?void 0:ze.videoPrompt)||((Me=mt==null?void 0:mt.settings)==null?void 0:Me.prompt)||"",yn=yh[n.id]||0,En=Ot!=null&&Ot.durationMs?(Ot.durationMs/1e3).toFixed(1):null,Z=!!wt,re=go||((Ge=Te.find(me=>me.type==="Video"&&(me.id==="sora-2"||me.id==="sora-2-pro")))==null?void 0:Ge.id)||((qe=Te.find(me=>me.type==="Video"))==null?void 0:qe.id)||"",Ie=((ut=n.settings)==null?void 0:ut.model)||re,at=Jc(Ie),se=(Nt=n.settings)==null?void 0:Nt.duration,Ae=at.includes(se)?se:at[0]||"5s";at.length>0&&se&&!at.includes(se)&&setTimeout(()=>{Be(n.id,{duration:at[0]||"5s"})},0);const vt=_z,Qt=Ul(((rt=n.settings)==null?void 0:rt.resolution)||sa||"720P"),ct=vt.includes(Qt)?Qt:"720P";return ct!==Qt&&setTimeout(()=>{Be(n.id,{resolution:ct})},0),i.jsxs(i.Fragment,{children:[(Z||En)&&i.jsx("div",{className:`m-3 mb-0 px-2 py-1 rounded text-[10px] font-mono text-center ${e==="dark"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-blue-50 text-blue-600 border border-blue-200"}`,children:Z?i.jsxs("span",{children:["? ",yn.toFixed(1),"s"]}):i.jsxs("span",{children:["?  ",En,"s"]})}),i.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[i.jsx(Jk,{size:12,className:"text-green-500"}),i.jsx("span",{children:O?"":""})]}),i.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-y-auto min-h-0",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:me=>{me.stopPropagation(),ln((Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="role-video-model"?null:{nodeId:n.id,type:"role-video-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:me=>me.stopPropagation(),children:[i.jsx("span",{className:"truncate font-mono",children:Rc(Ie)}),i.jsx(Rs,{size:12,className:"opacity-50 shrink-0"})]}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="role-video-model"&&i.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:me=>me.stopPropagation(),onMouseLeave:()=>Zn(null),children:[i.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(pr).filter(([,me])=>me.models.some(ce=>ce.type==="Video")).map(([me,ce])=>i.jsx("button",{onMouseEnter:()=>Zn(me),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${zn===me?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:ce.name||me},me))}),i.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[zn&&((je=pr[zn])==null?void 0:je.models.filter(me=>me.type==="Video").map(me=>{var ce;return i.jsxs("button",{onClick:()=>{Be(n.id,{model:me.id}),ep(me.id);try{localStorage.setItem("tapnow_last_video_model",me.id)}catch{}ln(null),Zn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((ce=n.settings)==null?void 0:ce.model)===me.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[i.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:me.displayName||me.modelName||me.id}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(me.id)}`})]},me.id)})),!zn&&i.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsx("select",{value:Ae,onChange:me=>Be(n.id,{duration:me.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:me=>me.stopPropagation(),children:(at.length>0?at:["5s","10s","15s"]).map(me=>i.jsx("option",{value:me,children:me},me))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsxs("select",{value:((fe=n.settings)==null?void 0:fe.ratio)||"16:9",onChange:me=>Be(n.id,{ratio:me.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:me=>me.stopPropagation(),children:[i.jsx("option",{value:"16:9",children:"16:9"}),i.jsx("option",{value:"9:16",children:"9:16"}),i.jsx("option",{value:"1:1",children:"1:1"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsx("select",{value:ct,onChange:me=>{const ce=me.target.value;if(Be(n.id,{resolution:ce}),ce!=="Auto"){bh(ce);try{localStorage.setItem("tapnow_last_video_res",ce)}catch{}}},className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:me=>me.stopPropagation(),children:vt.map(me=>i.jsx("option",{value:me,children:me==="Auto"?"":me},me))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsx("textarea",{value:zt,onChange:me=>Be(n.id,{videoPrompt:me.target.value}),placeholder:"...",className:`w-full h-20 resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:me=>me.stopPropagation()})]}),pt?i.jsx("div",{className:"relative w-full aspect-video bg-black rounded-lg overflow-hidden cursor-pointer",onDoubleClick:me=>{me.preventDefault(),me.stopPropagation(),xn({id:`preview-video-${n.id}`,url:pt,type:"video"}),setLightboxOpen(!0)},onContextMenu:me=>{me.preventDefault(),me.stopPropagation();const ce=mn(me.clientX,me.clientY);$r("video-input",ce.x,ce.y,null,pt,{w:400,h:300})},onMouseDown:me=>me.stopPropagation(),children:i.jsx("video",{src:pt,controls:!0,className:"w-full h-full object-contain",onMouseDown:me=>me.stopPropagation()})}):i.jsx("div",{className:`w-full aspect-video rounded border-2 border-dashed flex items-center justify-center ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,children:i.jsx("span",{className:`text-sm ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""})}),wt&&i.jsxs("div",{className:"mb-2",children:[i.jsx("div",{className:"text-[10px] mb-1 text-zinc-500",children:"..."}),i.jsx("div",{className:`w-full h-1.5 rounded-full overflow-hidden ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:i.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${wt.progress||0}%`}})}),i.jsxs("div",{className:"text-[10px] text-zinc-500 mt-1",children:[wt.progress||0,"%"]})]}),(Lt==null?void 0:Lt.errorMsg)&&i.jsx("div",{className:"text-[10px] text-red-500",children:Lt.errorMsg})]}),i.jsx("div",{className:"px-3 py-2 border-t shrink-0",children:i.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${wt?"bg-zinc-400 cursor-not-allowed text-white":e==="dark"?"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white":"bg-green-600 hover:bg-green-500 text-white"}`,disabled:!!wt,onMouseDown:me=>me.stopPropagation(),onClick:()=>{var Xe,Re,De;const me=zt,ce=((Xe=n.settings)==null?void 0:Xe.referenceImages)||((Re=mt==null?void 0:mt.settings)==null?void 0:Re.referenceImages)||[],He=Rt?[Rt]:ce;if(!me&&He.length===0){alert("");return}if(!Ie){alert("");return}vo(me||"","video",He,n.id,{model:Ie,ratio:((De=n.settings)==null?void 0:De.ratio)||"16:9",duration:Ae,resolution:ct})},children:wt?"...":""})})]})})()}),(n.type==="generate-character-image"||n.type==="generate-scene-image")&&i.jsx("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:(()=>{var ft,kt,ot,Mt,Dt,Rt,zt,yn,En;const O=n.type==="generate-scene-image",de=dt.find(Z=>Z.sourceNodeId===n.id&&Z.status==="completed"),Fe=dt.find(Z=>Z.sourceNodeId===n.id&&Z.status==="generating"),mt=dt.find(Z=>Z.sourceNodeId===n.id&&Z.status==="failed"),Ct=ui(de),Ot=(ft=de==null?void 0:de.output_images)!=null&&ft.length?de.output_images:(kt=de==null?void 0:de.mjImages)!=null&&kt.length?de.mjImages:Ct?[Ct]:[],wt=((ot=n.settings)==null?void 0:ot.selectedImageIndex)??null,Lt=Ri||((Mt=Te.find(Z=>Z.type==="Image"))==null?void 0:Mt.id)||"",pt=((Dt=n.settings)==null?void 0:Dt.model)||Lt;return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[i.jsx(ts,{size:12,className:"text-blue-500"}),i.jsx("span",{children:O?"":""})]}),i.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-y-auto min-h-0",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:Z=>{Z.stopPropagation(),ln((Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="role-image-model"?null:{nodeId:n.id,type:"role-image-model"})},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:Z=>Z.stopPropagation(),children:[i.jsx("span",{className:"truncate font-mono",children:Rc(pt)}),i.jsx(Rs,{size:12,className:"opacity-50 shrink-0"})]}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="role-image-model"&&i.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Z=>Z.stopPropagation(),onMouseLeave:()=>Zn(null),children:[i.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(pr).filter(([,Z])=>Z.models.some(re=>re.type==="Image")).map(([Z,re])=>i.jsx("button",{onMouseEnter:()=>Zn(Z),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${zn===Z?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:re.name||Z},Z))}),i.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[zn&&((Rt=pr[zn])==null?void 0:Rt.models.filter(Z=>Z.type==="Image").map(Z=>{var re;return i.jsxs("button",{onClick:()=>{Be(n.id,{model:Z.id}),Qd(Z.id);try{localStorage.setItem("tapnow_last_image_model",Z.id)}catch{}ln(null),Zn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((re=n.settings)==null?void 0:re.model)===Z.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[i.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:Z.displayName||Z.modelName||Z.id}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(Z.id)}`})]},Z.id)})),!zn&&i.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsxs("select",{value:((zt=n.settings)==null?void 0:zt.ratio)||"16:9",onChange:Z=>Be(n.id,{ratio:Z.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:Z=>Z.stopPropagation(),children:[i.jsx("option",{value:"16:9",children:"16:9"}),i.jsx("option",{value:"9:16",children:"9:16"}),i.jsx("option",{value:"1:1",children:"1:1"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsxs("select",{value:((yn=n.settings)==null?void 0:yn.resolution)||"2K",onChange:Z=>Be(n.id,{resolution:Z.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:Z=>Z.stopPropagation(),children:[i.jsx("option",{value:"1K",children:"1K"}),i.jsx("option",{value:"2K",children:"2K"}),i.jsx("option",{value:"4K",children:"4K"}),i.jsx("option",{value:"Auto",children:"Auto"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsx("textarea",{value:((En=n.settings)==null?void 0:En.prompt)||"",onChange:Z=>Be(n.id,{prompt:Z.target.value}),placeholder:"...",className:`w-full h-20 resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:Z=>Z.stopPropagation()})]}),Ot.length>0?i.jsx("div",{className:"grid grid-cols-2 gap-2",children:Ot.map((Z,re)=>i.jsxs("div",{className:`relative aspect-square bg-black rounded-lg overflow-hidden cursor-pointer transition-all ${wt===re?"ring-2 ring-blue-500 ring-offset-2":"hover:ring-1 hover:ring-zinc-400"}`,onClick:Ie=>{Ie.stopPropagation();const at=wt===re?null:re;Be(n.id,{selectedImageIndex:at})},onDoubleClick:Ie=>{Ie.preventDefault(),Ie.stopPropagation(),xn({id:`preview-${n.id}-${re}`,url:Z,type:"image",mjImages:Ot,selectedMjImageIndex:re}),setLightboxOpen(!0)},onContextMenu:Ie=>{Ie.preventDefault(),Ie.stopPropagation();const at=mn(Ie.clientX,Ie.clientY);$r("input-image",at.x,at.y,null,Z,{w:400,h:300})},onMouseDown:Ie=>Ie.stopPropagation(),children:[i.jsx(Vn,{src:Z,className:"w-full h-full object-contain"}),i.jsxs("div",{className:"absolute top-1 left-1 bg-black/50 text-white text-[10px] px-1 py-0.5 rounded",children:[re+1,"/",Ot.length]}),wt===re&&i.jsx("div",{className:"absolute top-1 right-1 bg-blue-500 text-white text-[10px] px-1 py-0.5 rounded",children:""})]},`${Z}-${re}`))}):i.jsx("div",{className:`w-full h-28 rounded border-2 border-dashed flex items-center justify-center ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,children:i.jsx("span",{className:`text-sm ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""})}),Fe&&i.jsxs("div",{className:"mb-2",children:[i.jsx("div",{className:"text-[10px] mb-1 text-zinc-500",children:"..."}),i.jsx("div",{className:`w-full h-1.5 rounded-full overflow-hidden ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:i.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${Fe.progress||0}%`}})}),i.jsxs("div",{className:"text-[10px] text-zinc-500 mt-1",children:[Fe.progress||0,"%"]})]}),(mt==null?void 0:mt.errorMsg)&&i.jsx("div",{className:"text-[10px] text-red-500",children:mt.errorMsg})]}),i.jsx("div",{className:"px-3 py-2 border-t shrink-0",children:i.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${Fe?"bg-zinc-400 cursor-not-allowed text-white":e==="dark"?"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,disabled:!!Fe,onMouseDown:Z=>Z.stopPropagation(),onClick:()=>{var Ie,at,se,Ae,vt,Qt,ct;const Z=((Ie=n.settings)==null?void 0:Ie.prompt)||"",re=((at=n.settings)==null?void 0:at.model)||Ri||((se=Te.find(bn=>bn.type==="Image"))==null?void 0:se.id)||"";if(!Z&&(!((Ae=n.settings)!=null&&Ae.referenceImages)||n.settings.referenceImages.length===0)){alert("");return}if(!re){alert("");return}vo(Z,"image",((vt=n.settings)==null?void 0:vt.referenceImages)||[],n.id,{model:re,ratio:((Qt=n.settings)==null?void 0:Qt.ratio)||"16:9",resolution:((ct=n.settings)==null?void 0:ct.resolution)||xo||"2K"})},children:Fe?"...":""})})]})})()}),(n.type==="create-character"||n.type==="create-scene")&&i.jsx("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:(()=>{var Ct,Ot,wt,Lt,pt,ft,kt,ot,Mt;const O=n.type==="create-character",de=O?"":"",Fe=Number.isFinite((Ct=n.settings)==null?void 0:Ct.startSecond)?n.settings.startSecond:1,mt=Number.isFinite((Ot=n.settings)==null?void 0:Ot.endSecond)?n.settings.endSecond:3;return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 border-b text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[i.jsx(Zp,{size:12,className:O?"text-blue-500":"text-green-500"}),i.jsx("span",{children:de})]}),i.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-y-auto min-h-0",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:O?"":""}),i.jsx("input",{type:"text",value:((wt=n.settings)==null?void 0:wt.name)||"",onChange:Dt=>Be(n.id,{name:Dt.target.value}),className:`w-full px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,placeholder:O?"...":"...",onMouseDown:Dt=>Dt.stopPropagation()})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:" 1-3 "}),i.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[i.jsx("input",{type:"number",min:"0",step:"0.1",value:Fe,onChange:Dt=>Be(n.id,{startSecond:parseFloat(Dt.target.value)||0}),className:`w-20 px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:Dt=>Dt.stopPropagation()}),i.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),i.jsx("input",{type:"number",min:"0",step:"0.1",value:mt,onChange:Dt=>Be(n.id,{endSecond:parseFloat(Dt.target.value)||0}),className:`w-20 px-2 py-1 rounded text-xs border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:Dt=>Dt.stopPropagation()}),i.jsxs("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:[": ",(mt-Fe).toFixed(1),"s"]})]})]})]}),((Lt=n.settings)==null?void 0:Lt.isCreating)&&i.jsxs("div",{className:"px-3 py-2 border-t shrink-0",children:[i.jsx("div",{className:"flex items-center gap-2 mb-2",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsxs("span",{className:"text-[10px] text-zinc-500",children:[de,"..."]}),i.jsxs("span",{className:"text-[10px] text-zinc-500",children:[((pt=n.settings)==null?void 0:pt.createProgress)||0,"%"]})]}),i.jsx("div",{className:`w-full h-1.5 rounded-full overflow-hidden ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:i.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${((ft=n.settings)==null?void 0:ft.createProgress)||0}%`}})})]})}),((kt=n.settings)==null?void 0:kt.createError)&&i.jsx("div",{className:"text-[10px] text-red-500 mt-1",children:n.settings.createError})]}),i.jsx("div",{className:"px-3 py-2 border-t shrink-0",children:i.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${(ot=n.settings)!=null&&ot.isCreating?"bg-zinc-400 cursor-not-allowed text-white":e==="dark"?"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white":"bg-blue-600 hover:bg-blue-500 text-white"}`,onMouseDown:Dt=>Dt.stopPropagation(),type:"button",disabled:(Mt=n.settings)==null?void 0:Mt.isCreating,onClick:async()=>{var at,se;const Dt=((at=n.settings)==null?void 0:at.name)||"";if(!Dt||Dt.trim().length===0){alert(`${O?"":""}`);return}const Rt=Fe??1,zt=mt??3;if(zt-Rt<1||zt-Rt>3){alert(" 1-3 ");return}const yn=O?"generate-character-video":"generate-scene-video",En=u.filter(Ae=>Ae.to===n.id).map(Ae=>At.get(Ae.from)).find(Ae=>(Ae==null?void 0:Ae.type)===yn);if(!En){alert("");return}const Z=dt.find(Ae=>Ae.sourceNodeId===En.id&&Ae.status==="completed"),re=(Z==null?void 0:Z.localCacheUrl)||(Z==null?void 0:Z.url)||(Z==null?void 0:Z.originalUrl)||En.content||"";if(!re){alert("URL");return}const Ie=(Z==null?void 0:Z.remoteTaskId)||null;Be(n.id,{isCreating:!0,createProgress:10,createError:null});try{const Ae=Te.find(qe=>qe.type==="Video"&&(qe.id==="sora-2"||qe.id==="sora-2-pro"));if(!Ae){Be(n.id,{isCreating:!1,createError:" Sora 2 "}),alert(" Sora 2  Sora 2  Sora 2 Pro");return}const vt=es(Ae.id),Qt=vt.key;if(!Qt){Be(n.id,{isCreating:!1,createError:" API Key"}),alert(" API Key"),qr(!0);return}Be(n.id,{createProgress:40});const ct=(vt.url||xr).replace(/\/+$/,""),bn=Za&&Za.trim()?Za.trim():`${ct}/sora/v1/characters`,Kt=`${Rt},${zt}`,B=Ie?{from_task:Ie,timestamps:Kt}:{url:re,timestamps:Kt};Be(n.id,{createProgress:70});const ze=await fetch(bn,{method:"POST",headers:{Authorization:`Bearer ${Qt}`,"Content-Type":"application/json"},body:JSON.stringify(B)});if(Be(n.id,{createProgress:90}),!ze.ok){const qe=await ze.text();let ut=null;try{ut=JSON.parse(qe)}catch{}throw ze.status===500||ut&&(ut.code==="get_origin_task_failed"||(se=ut.message)!=null&&se.includes("get_origin_task_failed"))?new Error("TASK_NOT_FOUND"):new Error(`API (${ze.status}): ${qe||ze.statusText}`)}const Me=await ze.json();if(!(Me!=null&&Me.id)||!(Me!=null&&Me.username))throw new Error(" id  username");const Ge={id:Me.id,username:Me.username,profile_picture_url:Me.profile_picture_url||"",permalink:Me.permalink||""};Zo(qe=>[...qe,Ge]),setTimeout(()=>{Be(n.id,{isCreating:!1,createProgress:0,createError:null,characterId:Me.id,characterUsername:Me.username}),alert(`${O?"":""} "${Me.username}" `)},300)}catch(Ae){let vt=Ae.message||"";vt==="TASK_NOT_FOUND"?vt="":(vt.includes("Failed to fetch")||Ae.name==="TypeError"||Ae.message.includes("NetworkError"))&&(vt=`

1. API 
   -  API  "/sora" 
   -  Sora 

2.  (CORS)
   -  Allow CORS 

3. 
   - `),Be(n.id,{isCreating:!1,createProgress:0,createError:vt}),alert(`${O?"":""}: ${vt}`)}},children:O?"":""})})]})})()}),n.type==="local-save"&&(()=>{var Ot,wt,Lt,pt,ft,kt,ot,Mt,Dt,Rt;const O=sp(n.id),de=O.length,Fe=!!((Ot=n.settings)!=null&&Ot.isSaving),Ct=(((wt=n.settings)==null?void 0:wt.serverUrl)||"").trim()?((Lt=n.settings)==null?void 0:Lt.serverStatus)==="connected":on;return i.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-semibold",children:[i.jsx(Zk,{size:12,className:"text-green-500"}),i.jsx("span",{children:""})]}),i.jsx("div",{className:`w-2 h-2 rounded-full ${Ct?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-red-500"}`,title:Ct?"":""})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-3 custom-scrollbar flex flex-col gap-3",children:[i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"text",value:((pt=n.settings)==null?void 0:pt.serverUrl)??"",onChange:zt=>Be(n.id,{serverUrl:zt.target.value}),placeholder:Zt||"http://127.0.0.1:9527",className:`flex-1 text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:zt=>zt.stopPropagation()}),i.jsx("button",{className:`px-2 py-1 text-[10px] rounded border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-blue-500":"bg-white border-zinc-300 text-zinc-700 hover:border-blue-500"}`,onMouseDown:zt=>zt.stopPropagation(),onClick:()=>{var zt;return q1(n.id,((zt=n.settings)==null?void 0:zt.serverUrl)||"")},children:""})]})]}),i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] font-medium opacity-70",children:""}),i.jsx("input",{type:"text",value:((ft=n.settings)==null?void 0:ft.subfolder)||"",onChange:zt=>Be(n.id,{subfolder:zt.target.value}),placeholder:"v1_characters",className:`w-full text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:zt=>zt.stopPropagation()})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("label",{className:"text-[10px] font-medium opacity-70",children:" ()"}),i.jsx("button",{className:`w-10 h-5 rounded-full relative transition-colors ${(kt=n.settings)!=null&&kt.autoSave?"bg-green-600":"bg-zinc-600"}`,onClick:()=>{var zt;return Be(n.id,{autoSave:!((zt=n.settings)!=null&&zt.autoSave)})},onMouseDown:zt=>zt.stopPropagation(),children:i.jsx("div",{className:`absolute top-1 w-3 h-3 rounded-full bg-white transition-all ${(ot=n.settings)!=null&&ot.autoSave?"left-6":"left-1"}`})})]}),i.jsxs("div",{className:"flex items-center justify-between text-[10px] text-zinc-500 mt-1",children:[i.jsx("span",{children:""}),i.jsx("span",{children:de})]}),de>0?i.jsx("div",{className:"grid grid-cols-4 gap-2",children:O.slice(0,4).map((zt,yn)=>{const En=zt.type==="video"||Un(zt.url)||zt.url.startsWith("data:video");return i.jsx("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-black/40 border border-zinc-700/40",children:En?i.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-zinc-300",children:i.jsx(zu,{size:14,className:"text-purple-300"})}):i.jsx(Vn,{src:zt.url,className:"w-full h-full object-cover"})},`${zt.url}-${yn}`)})}):i.jsx("div",{className:"text-[10px] text-zinc-500",children:""}),i.jsxs("div",{className:"mt-auto border-t pt-2 border-zinc-700/50",children:[i.jsxs("div",{className:"text-[10px] text-zinc-500 flex justify-between",children:[i.jsx("span",{children:":"}),i.jsx("span",{children:(Mt=n.settings)!=null&&Mt.lastSaved?n.settings.lastSaved.split(" ")[1]:""})]}),i.jsxs("div",{className:"text-[10px] text-zinc-500 flex justify-between mt-1",children:[i.jsx("span",{children:":"}),i.jsxs("span",{children:[((Rt=(Dt=n.settings)==null?void 0:Dt.savedFiles)==null?void 0:Rt.length)||0," "]})]})]}),i.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${Fe?"bg-zinc-600 cursor-not-allowed text-white":"bg-green-600 hover:bg-green-500 text-white"}`,disabled:Fe||de===0,onMouseDown:zt=>zt.stopPropagation(),onClick:async()=>{if(de===0){o("","warning");return}Be(n.id,{isSaving:!0});try{await ip(n,O)}catch(zt){o(`: ${zt.message||""}`,"error")}finally{Be(n.id,{isSaving:!1})}},children:Fe?"...":""})]})]})})(),n.type==="input-image"&&i.jsx("div",{className:`relative w-full h-full flex flex-col items-center justify-center transition-colors pointer-events-auto drop-zone ${e==="dark"?"bg-zinc-900 group-hover:bg-zinc-800":"bg-zinc-100 group-hover:bg-zinc-200"}`,onDrop:O=>fb(n.id,O),onDragOver:dp,onDragLeave:pp,onContextMenu:O=>sv(O,n.id),children:n.content?i.jsxs("div",{className:"relative w-full h-full",children:[Un(n.content)?i.jsx("video",{src:n.content,controls:!0,className:"w-full h-full object-contain bg-black/50",draggable:!1,style:{imageRendering:we.zoom>=1?"auto":"crisp-edges",WebkitFontSmoothing:"antialiased",transform:"translateZ(0)",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}}):i.jsx("img",{src:n.content,className:"w-full h-full object-contain bg-black/50",draggable:!1,loading:"lazy",style:{imageRendering:we.zoom>=1?"auto":"crisp-edges",WebkitFontSmoothing:"antialiased",transform:"translateZ(0)",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}}),n.dimensions&&i.jsxs("div",{className:`absolute bottom-2 right-2 text-[10px] px-1.5 py-0.5 rounded backdrop-blur-sm border ${e==="dark"?"bg-black/70 text-white border-white/10":"bg-white/80 text-zinc-800 border-zinc-200"}`,children:[n.dimensions.w,"x",n.dimensions.h]}),!n.isMasking&&i.jsxs("div",{className:"absolute inset-0 bg-black/40 transition-opacity gap-2 opacity-0 group-hover:opacity-100 flex flex-col items-center justify-center",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("label",{className:`cursor-pointer px-3 py-1.5 rounded-lg text-xs backdrop-blur-sm border transition-colors ${e==="dark"?"bg-white/10 hover:bg-white/20 text-white border-white/10":"bg-white hover:bg-zinc-100 text-zinc-800 border-zinc-300"}`,onMouseDown:O=>O.stopPropagation(),children:[" ",i.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:O=>Jh(n.id,O)})]}),!Un(n.content)&&i.jsxs("button",{onClick:O=>{O.stopPropagation(),l(de=>de.map(Fe=>Fe.id===n.id?{...Fe,isMasking:!Fe.isMasking}:Fe))},className:`px-3 py-1.5 rounded-lg text-xs backdrop-blur-sm border transition-colors flex items-center gap-1 ${e==="dark"?n.isMasking?"bg-red-500/80 hover:bg-red-500 text-white border-red-400":"bg-white/10 hover:bg-white/20 text-white border-white/10":n.isMasking?"bg-red-500 hover:bg-red-600 text-white border-red-400":"bg-white hover:bg-zinc-100 text-zinc-800 border-zinc-300"}`,onMouseDown:O=>O.stopPropagation(),children:[i.jsx(Wk,{size:12}),""]})]}),i.jsxs("div",{className:`text-[10px] text-center px-2 ${e==="dark"?"text-zinc-300":"text-zinc-500"}`,children:["",i.jsx("br",{})," Ctrl+V "]})]}),!n.isMasking&&n.maskContent&&i.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",style:{background:"rgba(255, 0, 0, 0.3)",mixBlendMode:"multiply",WebkitMaskImage:`url(${n.maskContent})`,maskImage:`url(${n.maskContent})`,WebkitMaskSize:"100% 100%",maskSize:"100% 100%",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}}),n.isMasking&&!Un(n.content)&&n.dimensions&&i.jsx(vz,{nodeId:n.id,imageUrl:n.content,imageDimensions:n.dimensions,isActive:n.isMasking,onClose:()=>{l(O=>O.map(de=>de.id===n.id?{...de,isMasking:!1}:de))},onSave:O=>{},onUpdateNode:(O,de)=>{l(Fe=>Fe.map(mt=>mt.id===O?{...mt,...de}:mt))},theme:e,view:we,maskContent:n.maskContent})]}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-full w-full",children:[i.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center mb-3 border ${e==="dark"?"bg-zinc-800 border-zinc-700/50":"bg-zinc-100 border-zinc-300"}`,children:i.jsx(da,{className:`w-6 h-6 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`})}),i.jsxs("label",{className:"bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-xs font-medium transition-colors cursor-pointer pointer-events-auto",onMouseDown:O=>O.stopPropagation(),children:["",i.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:O=>Jh(n.id,O)})]}),i.jsxs("div",{className:"text-[10px] text-center mt-2 pointer-events-none text-zinc-500",children:["",i.jsx("br",{})," Ctrl+V "]})]})}),n.type==="video-input"&&i.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto drop-zone video-input-container ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,onDragOver:dp,onDragLeave:pp,children:[i.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(zu,{size:13,className:"text-blue-500"}),i.jsx("span",{children:" / "}),i.jsx("button",{onClick:O=>{var Mt;O.stopPropagation();const de=((Mt=n.settings)==null?void 0:Mt.videoExpanded)===!1,Fe=(n.frames||[]).length,mt=de?Math.max(1,Math.floor(n.width/290)):1,Ct=Math.max(1,Math.ceil(Fe/mt)),Ot=72,wt=de?n.content?230:190:0,Lt=n.content&&de?48:0,pt=36,ft=30,kt=de?158:106,ot=Ot+wt+Lt+pt+Ct*kt+ft;l(Dt=>Dt.map(Rt=>Rt.id===n.id?{...Rt,height:Math.max(de?500:220,ot),settings:{...Rt.settings,videoExpanded:de}}:Rt))},className:`p-1 hover:bg-zinc-200 dark:hover:bg-zinc-700 rounded transition-colors ml-1 ${((Ue=n.settings)==null?void 0:Ue.videoExpanded)===!1?"bg-zinc-200 dark:bg-zinc-700":""}`,title:((Ze=n.settings)==null?void 0:Ze.videoExpanded)===!1?"":"",children:((xt=n.settings)==null?void 0:xt.videoExpanded)===!1?i.jsx(Rs,{size:12}):i.jsx(Xp,{size:12})})]}),i.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-zinc-500",children:[(yt=n.videoMeta)!=null&&yt.duration?i.jsxs("span",{children:[" ",n.videoMeta.duration.toFixed(1),"s"]}):null,(_t=n.videoMeta)!=null&&_t.w?i.jsxs("span",{children:[n.videoMeta.w,"x",n.videoMeta.h]}):null,(bt=n.selectedKeyframes)!=null&&bt.length?i.jsxs("span",{className:"text-blue-500",children:[" ",n.selectedKeyframes.length," "]}):null]})]}),i.jsxs("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-hidden min-h-0",children:[n.content?i.jsxs("div",{className:"space-y-2",children:[((Wt=n.settings)==null?void 0:Wt.videoExpanded)!==!1&&i.jsx("div",{className:"relative w-full max-w-[360px] aspect-video bg-black rounded-lg overflow-hidden flex items-center justify-center mx-auto",onDrop:O=>Zh(n.id,O),children:i.jsx("video",{src:n.content,controls:!0,className:"w-full h-full object-contain",draggable:!1})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("label",{className:"bg-blue-600 hover:bg-blue-500 text-white px-3 py-1.5 rounded text-xs font-medium transition-colors cursor-pointer",onMouseDown:O=>O.stopPropagation(),children:["",i.jsx("input",{type:"file",className:"hidden",accept:"video/*",onChange:O=>{var de;return ol(n.id,(de=O.target.files)==null?void 0:de[0])}})]}),i.jsx("button",{className:`px-3 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"border-zinc-700 bg-zinc-800 text-zinc-300 hover:border-blue-500 hover:text-blue-400":"border-zinc-300 hover:border-blue-500 hover:text-blue-600"}`,onMouseDown:O=>O.stopPropagation(),onClick:()=>Vb(n.id,2),children:i.jsx("span",{className:"whitespace-nowrap",children:"2fps"})}),i.jsx("button",{className:`px-3 py-1.5 rounded text-xs border transition-colors ${e==="dark"?"bg-green-600/40 border-green-500 text-green-200 hover:bg-green-600/60 hover:border-green-400":"bg-green-50 border-green-300 hover:border-green-500 hover:text-green-600"}`,onMouseDown:O=>O.stopPropagation(),onClick:()=>Kb(n.id,30),children:i.jsx("span",{className:"whitespace-nowrap",children:""})}),n.extractingFrames&&i.jsx("span",{className:"text-[11px] text-blue-500",children:"..."})]})]}):((Bt=n.settings)==null?void 0:Bt.videoExpanded)!==!1&&i.jsx("div",{className:"flex flex-col items-center justify-center gap-3 w-full px-4 mx-auto shrink-0 transition-colors border-2 border-transparent hover:border-blue-500/30 rounded-lg p-4",onDrop:O=>Zh(n.id,O),children:i.jsxs("div",{className:"flex flex-col gap-2 items-center justify-center shrink-0 w-full",children:[i.jsx("div",{className:`relative w-full h-64 flex flex-col items-center justify-center border-2 border-dashed rounded-lg transition-colors ${L===n.id&&!R?"border-blue-500 bg-blue-500/10":e==="dark"?"border-zinc-700 hover:border-zinc-500":"border-zinc-300 hover:border-zinc-400"}`,children:i.jsxs("label",{className:"cursor-pointer flex flex-col items-center justify-center w-full h-full",children:[i.jsx(hz,{size:48,className:`mb-2 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`}),i.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),i.jsx("input",{type:"file",className:"hidden",accept:"video/*",onChange:O=>{var de;return ol(n.id,(de=O.target.files)==null?void 0:de[0])}})]})}),i.jsx("div",{className:"text-[10px] text-center text-zinc-500 pointer-events-none",children:" MP4/WEBM Ctrl+V "})]})}),i.jsxs("div",{className:"flex items-center justify-between text-[11px] text-zinc-500",children:[i.jsx("span",{children:""}),i.jsxs("div",{className:"flex items-center gap-2 flex-nowrap shrink-0 whitespace-nowrap",children:[i.jsxs("span",{children:[(n.frames||[]).length," "]}),(n.frames||[]).length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>{const O=n.frames||[],de=n.selectedKeyframes||[];let Fe=[];de.length===0?Fe=O.map(mt=>({url:mt.url,time:mt.time,filename:mt.filename})):Fe=[],l(mt=>mt.map(Ct=>Ct.id===n.id?{...Ct,selectedKeyframes:Fe}:Ct))},className:`text-[10px] px-1.5 py-0.5 rounded transition-colors flex items-center gap-1 ${e==="dark"?"bg-blue-600/30 text-blue-300 hover:bg-blue-600/50":"bg-blue-100 text-blue-600 hover:bg-blue-200"}`,onMouseDown:O=>O.stopPropagation(),title:(n.selectedKeyframes||[]).length>0?"":"",children:[(n.selectedKeyframes||[]).length>0?i.jsx(Ug,{size:10}):i.jsx(Hk,{size:10}),(n.selectedKeyframes||[]).length>0?"":""]}),i.jsxs("button",{onClick:()=>{confirm("")&&l(O=>O.map(de=>de.id===n.id?{...de,frames:[],selectedKeyframes:[]}:de))},className:`text-[10px] px-1.5 py-0.5 rounded transition-colors flex items-center gap-1 flex-nowrap ${e==="dark"?"bg-red-600/30 text-red-300 hover:bg-red-600/50":"bg-red-100 text-red-600 hover:bg-red-200"}`,onMouseDown:O=>O.stopPropagation(),title:"",children:[i.jsx(Os,{size:10}),""]})]})]})]}),i.jsx("div",{className:"grid gap-3 w-full overflow-y-auto custom-scrollbar flex-1 min-h-0 relative p-1 content-start items-start",style:{gridTemplateColumns:((Ht=n.settings)==null?void 0:Ht.videoExpanded)===!1?"1fr":"repeat(auto-fill, minmax(260px, 1fr))",gridAutoRows:"auto"},onDrop:O=>Wb(n.id,O),onDragOver:O=>Bb(O,n.id,(n.frames||[]).length),onDragLeave:O=>{O.currentTarget.contains(O.relatedTarget)||(x(null),P(null))},children:(n.frames||[]).length===0?i.jsxs("div",{className:`col-span-full text-[11px] text-zinc-500 text-center py-4 border rounded ${e==="dark"?"bg-zinc-800/40 border-zinc-700":"bg-white/40 border-zinc-300"}`,children:["",i.jsx("div",{className:"mt-1 opacity-50 text-[9px]",children:""})]}):(n.frames||[]).map((O,de)=>{var Ot;const Fe=(n.selectedKeyframes||[]).some(wt=>wt.url===O.url&&wt.time===O.time),mt=R===n.id&&w===de,Ct=R===n.id&&w===(n.frames||[]).length&&de===(n.frames||[]).length-1;return i.jsxs("div",{className:"relative",children:[mt&&i.jsx("div",{className:"absolute -top-1.5 left-0 right-0 h-1 bg-red-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.8)] z-50"}),i.jsxs("button",{className:`relative w-full rounded overflow-hidden group transition-all ${Fe?"ring-2 ring-blue-500 border-2 border-blue-500 bg-blue-900/30":e==="dark"?"border border-zinc-700 hover:border-zinc-500":"border border-zinc-300 hover:border-zinc-400"}`,onMouseDown:wt=>wt.stopPropagation(),onClick:wt=>Yb(n.id,O,de,wt),onContextMenu:wt=>Gb(wt,n.id,O),onDragOver:wt=>Fb(wt,n.id,de),children:[i.jsx(Vn,{src:O.url,className:`w-full bg-black ${((Ot=n.settings)==null?void 0:Ot.videoExpanded)===!1?"h-[90px] object-cover":"aspect-video object-contain max-h-[140px]"}`,alt:`frame-${de}`}),i.jsxs("div",{className:"absolute left-1 top-1 text-[10px] px-1 py-0.5 rounded bg-black/60 text-white",children:[typeof O.time=="number"?O.time.toFixed(2):O.time,"s"]}),O.filename&&i.jsx("div",{className:"absolute left-0 bottom-0 right-0 bg-black/80 text-white text-[9px] px-1 py-0.5 opacity-0 group-hover:opacity-100 transition-opacity truncate",title:O.filename,children:O.filename}),i.jsxs("div",{className:"absolute top-1 bottom-1 right-1 flex flex-col justify-between items-center z-20 pointer-events-none",children:[i.jsx("div",{className:"pointer-events-auto w-5 h-5 rounded-full border border-white/80 bg-black/40 flex items-center justify-center shrink-0 mb-auto",children:Fe?i.jsx(Ol,{size:12,className:"text-white"}):null}),i.jsx("button",{onClick:wt=>{wt.stopPropagation(),l(Lt=>Lt.map(pt=>{if(pt.id!==n.id)return pt;const ft=(pt.frames||[]).filter((ot,Mt)=>Mt!==de),kt=(pt.selectedKeyframes||[]).filter(ot=>ot.url!==O.url);return{...pt,frames:ft,selectedKeyframes:kt}}))},className:"pointer-events-auto w-5 h-5 rounded bg-red-600/80 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-500 my-1 shrink-0",title:"",children:i.jsx(ns,{size:12})}),i.jsxs("div",{className:"pointer-events-auto flex flex-col gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity shrink-0 mt-auto",children:[de>0&&i.jsx("button",{onClick:wt=>{wt.stopPropagation(),l(Lt=>Lt.map(pt=>{if(pt.id!==n.id)return pt;const ft=[...pt.frames||[]];[ft[de-1],ft[de]]=[ft[de],ft[de-1]];const kt=[...pt.selectedKeyframes||[]],ot=kt.findIndex(Mt=>Mt.url===O.url);return ot>0&&([kt[ot-1],kt[ot]]=[kt[ot],kt[ot-1]]),{...pt,frames:ft,selectedKeyframes:kt}}))},className:"w-5 h-5 rounded bg-black/70 text-white flex items-center justify-center hover:bg-blue-600",title:"",children:i.jsx(Xp,{size:12})}),de<(n.frames||[]).length-1&&i.jsx("button",{onClick:wt=>{wt.stopPropagation(),l(Lt=>Lt.map(pt=>{if(pt.id!==n.id)return pt;const ft=[...pt.frames||[]];[ft[de],ft[de+1]]=[ft[de+1],ft[de]];const kt=[...pt.selectedKeyframes||[]],ot=kt.findIndex(Mt=>Mt.url===O.url);return ot>=0&&ot<kt.length-1&&([kt[ot],kt[ot+1]]=[kt[ot+1],kt[ot]]),{...pt,frames:ft,selectedKeyframes:kt}}))},className:"w-5 h-5 rounded bg-black/70 text-white flex items-center justify-center hover:bg-blue-600",title:"",children:i.jsx(Rs,{size:12})})]})]})]}),Ct&&i.jsx("div",{className:"absolute -bottom-1.5 left-0 right-0 h-1 bg-red-500 rounded-full shadow-[0_0_8px_rgba(239,68,68,0.8)] z-50"})]},`${O.url}-${de}`)})})]})]}),n.type==="text-node"&&i.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,children:[i.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(ts,{size:13,className:"text-blue-500"}),i.jsx("span",{children:""})]})}),i.jsx("div",{className:"flex-1 p-3",children:i.jsx("textarea",{"data-node-type":"text-node","data-node-id":n.id,value:((rn=n.settings)==null?void 0:rn.text)||"",onChange:O=>{Be(n.id,{text:O.target.value})},placeholder:"...",className:`w-full h-full resize-none outline-none text-sm p-2 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:O=>O.stopPropagation()})})]}),n.type==="video-analyze"&&i.jsxs("div",{className:`relative w-full h-full flex flex-col transition-colors pointer-events-auto video-analyze-container ${e==="dark"?"bg-zinc-900/80":"bg-zinc-100"}`,onClick:O=>{const de=window.getSelection();if(de&&de.toString().length>0)return;const Fe=O.target;Fe&&(Fe.tagName==="INPUT"||Fe.tagName==="TEXTAREA"||Fe.tagName==="SELECT"||Fe.tagName==="BUTTON"||Fe.isContentEditable||Fe.closest('input, textarea, select, button, [contenteditable="true"]'))||O.stopPropagation()},children:[i.jsx("div",{className:"flex items-center justify-between px-3 py-2 border-b text-xs font-semibold",children:i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Xk,{size:13,className:"text-blue-500"}),i.jsx("span",{children:" / "})]})}),i.jsx("div",{className:"flex-1 flex flex-col gap-3 p-3 overflow-hidden min-h-0",children:(()=>{var Ct,Ot,wt,Lt,pt,ft,kt,ot,Mt,Dt,Rt,zt,yn,En,Z,re,Ie,at;const O=ul(n.id);if(!O)return i.jsxs("div",{className:"flex flex-col items-center justify-center flex-1 gap-2 text-[11px] text-zinc-500",children:[i.jsx($l,{size:24,className:"text-zinc-400"}),i.jsx("span",{children:""})]});const de=O.videoFileName||"",Fe=((Ct=O.videoMeta)==null?void 0:Ct.duration)||0,mt=O.selectedKeyframes||[];return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:`text-[11px] px-2 py-1.5 rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-50 border-zinc-300"}`,children:[i.jsx("div",{className:"flex items-center justify-between mb-1",children:i.jsx("span",{className:"text-zinc-500",children:O.isImageInput?"":""})}),i.jsxs("div",{className:"text-zinc-700 dark:text-zinc-300",children:[i.jsxs("div",{children:[": ",O.isImageInput?"":de]}),!O.isImageInput&&i.jsxs("div",{children:[": ",Fe.toFixed(1),"s"]}),i.jsxs("div",{children:[": ",mt.length," "]})]})]}),i.jsxs("div",{className:`flex items-center gap-2 p-1 rounded-lg border shadow-inner ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-100 border-zinc-200"}`,children:[i.jsxs("button",{onClick:()=>Be(n.id,{analysisMode:"manual"}),className:`flex-1 py-1 px-2 text-[11px] rounded transition-all flex justify-center items-center gap-1 ${(((Ot=n.settings)==null?void 0:Ot.analysisMode)||"manual")==="manual"?e==="dark"?"bg-zinc-600 shadow-md text-blue-300 font-bold":"bg-white shadow-md text-blue-600 font-bold":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:se=>se.stopPropagation(),children:[i.jsx(Ig,{size:12})," "]}),i.jsxs("button",{onClick:()=>Be(n.id,{analysisMode:"auto"}),className:`flex-1 py-1 px-2 text-[11px] rounded transition-all flex justify-center items-center gap-1 ${((wt=n.settings)==null?void 0:wt.analysisMode)==="auto"?e==="dark"?"bg-zinc-600 shadow-md text-purple-300 font-bold":"bg-white shadow-md text-purple-600 font-bold":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:se=>se.stopPropagation(),children:[i.jsx(Ml,{size:12})," AI "]})]}),(((Lt=n.settings)==null?void 0:Lt.analysisMode)||"manual")==="manual"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-[11px] text-zinc-500",children:":"}),i.jsx("input",{type:"number",min:"1",max:"30",value:((pt=n.settings)==null?void 0:pt.segmentDuration)||3,onChange:se=>{const Ae=parseInt(se.target.value)||3;Be(n.id,{segmentDuration:Ae}),G1(Ae.toString());try{localStorage.setItem("tapnow_last_segment_duration",Ae.toString())}catch{}},className:`w-16 px-2 py-1 text-[11px] rounded border ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300 text-zinc-800"}`,onMouseDown:se=>se.stopPropagation()}),i.jsx("span",{className:"text-[11px] text-zinc-500",children:""})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-[11px] text-zinc-500",children:":"}),i.jsxs("div",{className:"relative flex-1",children:[i.jsxs("button",{onClick:se=>{se.stopPropagation(),ln((Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="analyze-model"?null:{nodeId:n.id,type:"analyze-model"})},className:`w-full flex items-center justify-between px-2 py-1 rounded text-[11px] border transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 hover:border-zinc-600":"bg-zinc-50 border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,onMouseDown:se=>se.stopPropagation(),children:[i.jsx("span",{className:"truncate font-mono",children:((kt=fn.get((ft=n.settings)==null?void 0:ft.model))==null?void 0:kt.id)||((ot=n.settings)==null?void 0:ot.model)||"gemini-3-pro"}),i.jsx(Rs,{size:10,className:"opacity-50 shrink-0 ml-1"})]}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="analyze-model"&&i.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:se=>se.stopPropagation(),onMouseLeave:()=>Zn(null),children:[i.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(pr).filter(([,se])=>se.models.some(Ae=>Ae.type==="Chat")).map(([se,Ae])=>i.jsx("button",{onMouseEnter:()=>Zn(se),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${zn===se?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:Ae.name||se},se))}),i.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[zn&&((Mt=pr[zn])==null?void 0:Mt.models.filter(se=>se.type==="Chat").map(se=>{var Ae;return i.jsxs("button",{onClick:()=>{Be(n.id,{model:se.id}),J1(se.id);try{localStorage.setItem("tapnow_last_analyze_model",se.id)}catch{}ln(null),Zn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((Ae=n.settings)==null?void 0:Ae.model)===se.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[i.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:se.id}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(se.id)}`})]},se.id)})),!zn&&i.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})]})]}),i.jsx("button",{onClick:()=>{var se;return((se=n.settings)==null?void 0:se.analysisMode)==="auto"?Ab(n.id):Pb(n.id)},disabled:n.isGenerating||(((Dt=n.settings)==null?void 0:Dt.analysisMode)||"manual")==="manual"&&mt.length===0,className:`w-full px-3 py-2 rounded text-xs font-medium transition-colors flex items-center justify-center gap-2 ${n.isGenerating?"bg-zinc-600 text-zinc-400 cursor-not-allowed":((Rt=n.settings)==null?void 0:Rt.analysisMode)==="auto"?"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white shadow-lg":"bg-blue-600 hover:bg-blue-500 text-white"}`,onMouseDown:se=>se.stopPropagation(),children:n.isGenerating?i.jsxs(i.Fragment,{children:[i.jsx(hi,{size:14,className:"animate-spin"}),i.jsx("span",{children:((zt=n.settings)==null?void 0:zt.analysisMode)==="auto"?"AI ...":"..."})]}):i.jsxs(i.Fragment,{children:[i.jsx(Ml,{size:14}),i.jsx("span",{children:((yn=n.settings)==null?void 0:yn.analysisMode)==="auto"?"":""})]})}),n.errorMsg&&i.jsx("div",{className:"text-[10px] text-red-500 px-2 py-1 rounded bg-red-500/10",children:n.errorMsg})]}),((En=n.settings)==null?void 0:En.analysisMode)==="auto"&&((re=(Z=n.settings)==null?void 0:Z.analysisResults)==null?void 0:re.length)>0&&i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar pt-2",children:[((Ie=n.settings.voiceoverResults)==null?void 0:Ie.length)>0&&i.jsxs("div",{className:`p-2 rounded-lg mb-4 ${e==="dark"?"bg-zinc-700/50 border border-zinc-700":"bg-zinc-50 border border-blue-200"}`,children:[i.jsxs("h4",{className:`text-xs font-semibold mb-2 flex items-center gap-1 ${e==="dark"?"text-white":"text-blue-700"}`,children:[i.jsx(Qk,{size:12})," "]}),i.jsx("div",{className:"space-y-1",children:n.settings.voiceoverResults.map((se,Ae)=>i.jsxs("p",{className:`text-[10px] select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:vt=>vt.stopPropagation(),children:[i.jsxs("span",{className:"font-mono text-xs mr-2 opacity-70",children:["[",se.time_range||`${se.time}s`,"]"]}),se.text||i.jsx("span",{className:"text-zinc-400 italic",children:""})]},Ae))})]}),i.jsxs("h4",{className:`text-xs font-semibold mb-3 flex items-center gap-1 ${e==="dark"?"text-white":"text-zinc-800"}`,children:[i.jsx(Ig,{size:12}),"  (",n.settings.analysisResults.length," )"]}),i.jsx("div",{className:"space-y-4",children:n.settings.analysisResults.map((se,Ae)=>{var vt,Qt,ct,bn,Kt,B,ze,Me;return i.jsxs("div",{className:`p-3 rounded-lg ${e==="dark"?"bg-zinc-800 border border-zinc-700":"bg-zinc-50 border border-zinc-200"}`,children:[i.jsxs("h5",{className:`text-sm font-bold mb-2 ${e==="dark"?"text-purple-400":"text-purple-700"}`,children:[" ",se.scene_index||se.scene_id||Ae+1," ",i.jsxs("span",{className:"text-xs font-normal opacity-70 ml-2",children:["(",se.time_range,")"]})]}),i.jsxs("div",{className:"text-[11px] space-y-1 mb-3",children:[((Qt=(vt=se.keyframes)==null?void 0:vt[0])==null?void 0:Qt.description)&&i.jsxs("p",{className:`select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:Ge=>Ge.stopPropagation(),children:[i.jsx("span",{className:"font-semibold mr-1",children:"/:"})," ",se.keyframes[0].description]}),((bn=(ct=se.global_tags)==null?void 0:ct.style)==null?void 0:bn[0])&&i.jsxs("p",{className:`select-text cursor-text ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,onMouseDown:Ge=>Ge.stopPropagation(),children:[i.jsx("span",{className:"font-semibold mr-1",children:"/:"})," ",se.global_tags.style[0]]})]}),i.jsxs("div",{className:"space-y-2",children:[((B=(Kt=se.keyframes)==null?void 0:Kt[0])==null?void 0:B.jimeng_prompt)&&i.jsxs("div",{className:`p-2 rounded ${e==="dark"?"bg-zinc-700 border border-zinc-600":"bg-zinc-50 border border-gray-300"}`,children:[i.jsxs("h6",{className:`text-[10px] font-semibold mb-1 flex items-center gap-1 ${e==="dark"?"text-yellow-300":"text-yellow-700"}`,children:[i.jsx(Tg,{size:10}),"  Prompt"]}),i.jsx("p",{className:`text-[10px] whitespace-pre-wrap select-text cursor-text ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,onMouseDown:Ge=>Ge.stopPropagation(),children:se.keyframes[0].jimeng_prompt}),i.jsxs("button",{onClick:()=>navigator.clipboard.writeText(se.keyframes[0].jimeng_prompt),className:"mt-1 flex items-center text-[9px] text-blue-400 hover:text-blue-300",onMouseDown:Ge=>Ge.stopPropagation(),children:[i.jsx($g,{size:10,className:"mr-1"})," "]})]}),((Me=(ze=se.keyframes)==null?void 0:ze[0])==null?void 0:Me.mj_prompt)&&i.jsxs("div",{className:`p-2 rounded ${e==="dark"?"bg-zinc-700 border border-zinc-600":"bg-zinc-50 border border-gray-300"}`,children:[i.jsxs("h6",{className:`text-[10px] font-semibold mb-1 flex items-center gap-1 ${e==="dark"?"text-green-300":"text-green-700"}`,children:[i.jsx(Tg,{size:10})," MJ Prompt"]}),i.jsx("p",{className:`text-[10px] whitespace-pre-wrap select-text cursor-text ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,onMouseDown:Ge=>Ge.stopPropagation(),children:se.keyframes[0].mj_prompt}),i.jsxs("button",{onClick:()=>navigator.clipboard.writeText(se.keyframes[0].mj_prompt),className:"mt-1 flex items-center text-[9px] text-blue-400 hover:text-blue-300",onMouseDown:Ge=>Ge.stopPropagation(),children:[i.jsx($g,{size:10,className:"mr-1"})," "]})]})]})]},Ae)})})]}),(((at=n.settings)==null?void 0:at.analysisMode)||"manual")==="manual"&&n.analysisResults&&n.analysisResults.length>0?i.jsxs("div",{className:"space-y-3 flex-1 flex flex-col min-h-0",children:[i.jsxs("div",{className:"text-[11px] font-medium text-zinc-700 dark:text-zinc-300 shrink-0",children:[" (",n.analysisResults.length," )"]}),i.jsx("div",{className:"space-y-3 flex-1 overflow-y-auto custom-scrollbar min-h-0",children:n.analysisResults.map((se,Ae)=>{var B,ze,Me,Ge,qe,ut,Nt;const vt=rt=>{var me,ce;const je=(me=O.selectedKeyframes)==null?void 0:me.find(He=>Math.abs(He.time-rt)<.1);if(je)return je.url;const fe=(ce=O.frames)==null?void 0:ce.find(He=>Math.abs(He.time-rt)<.1);return(fe==null?void 0:fe.url)||null},Qt=((B=se.keyframes)==null?void 0:B.find(rt=>rt.type==="current"))||((ze=se.keyframes)==null?void 0:ze[0]),ct=(Me=se.keyframes)==null?void 0:Me.find(rt=>rt.type==="prev"),bn=(Ge=se.keyframes)==null?void 0:Ge.find(rt=>rt.type==="next"),Kt=(Qt==null?void 0:Qt.description)||((ut=(qe=se.keyframes)==null?void 0:qe[0])==null?void 0:ut.description)||"";return i.jsxs("div",{className:`p-3 rounded-lg border ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-white border-zinc-300"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"font-medium text-[11px] text-zinc-800 dark:text-zinc-200",children:[" ",se.scene_index||Ae+1]}),i.jsx("div",{className:"text-[10px] text-zinc-500",children:se.time_range})]}),i.jsx("div",{className:"text-[10px] text-zinc-600 dark:text-zinc-400 mb-3 line-clamp-2 select-text cursor-text",onMouseDown:rt=>rt.stopPropagation(),children:Kt}),i.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[ct,Qt,bn].map((rt,je)=>{if(!rt)return i.jsx("div",{className:"aspect-video bg-zinc-200 dark:bg-zinc-700 rounded"},je);const fe=vt(rt.time);return i.jsxs("div",{className:"relative aspect-video bg-black rounded overflow-hidden",children:[fe?i.jsx("img",{src:fe,className:"w-full h-full object-cover",alt:` ${je+1}`,loading:"lazy"}):i.jsx("div",{className:"w-full h-full flex items-center justify-center text-[8px] text-zinc-500",children:rt.type==="prev"?"":rt.type==="current"?"":""}),i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 text-center",children:[rt.time.toFixed(1),"s"]})]},je)})}),i.jsx("div",{className:"space-y-2",children:(Nt=se.keyframes)==null?void 0:Nt.map((rt,je)=>i.jsxs("div",{className:"space-y-1.5",children:[i.jsxs("div",{className:"text-[9px] text-zinc-500",children:[rt.type==="prev"?"":rt.type==="current"?"":""," (",rt.time.toFixed(1),"s)"]}),rt.mj_prompt&&i.jsx("div",{className:`p-2 rounded border ${e==="dark"?"bg-zinc-900 border-zinc-600":"bg-zinc-50 border-zinc-200"}`,children:i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:"Midjourney "}),i.jsx("div",{className:"text-[10px] text-zinc-700 dark:text-zinc-300 break-words select-text cursor-text",onMouseDown:fe=>fe.stopPropagation(),children:rt.mj_prompt})]}),i.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[i.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(rt.mj_prompt),alert("")}catch{alert("")}},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:fe=>fe.stopPropagation(),title:"",children:i.jsx(ua,{size:12})}),i.jsx("button",{onClick:()=>{const fe=mn(n.x+n.width+100,n.y+n.height/2),me=`node-${Date.now()}`,ce={id:me,type:"gen-image",x:fe.x-180,y:fe.y-170,width:360,height:340,settings:{model:"mj-v6",prompt:rt.mj_prompt,ratio:"Auto",resolution:"2K"}};l(He=>[...He,ce]),setTimeout(()=>{const He=mn(n.x+n.width+200,n.y+n.height/2),Xe=`node-${Date.now()+1}`,Re={id:Xe,type:"preview",x:He.x-160,y:He.y-130,width:320,height:260};l(De=>[...De,Re]),m(De=>[...De,{id:`conn-${Date.now()}`,from:me,to:Xe}])},50)},className:"p-1 rounded hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors text-blue-600 dark:text-blue-400",onMouseDown:fe=>fe.stopPropagation(),title:"",children:i.jsx(Dg,{size:12})})]})]})}),rt.jimeng_prompt&&i.jsx("div",{className:`p-2 rounded border ${e==="dark"?"bg-zinc-900 border-zinc-600":"bg-zinc-50 border-zinc-200"}`,children:i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:""}),i.jsx("div",{className:"text-[10px] text-zinc-700 dark:text-zinc-300 break-words select-text cursor-text",onMouseDown:fe=>fe.stopPropagation(),children:rt.jimeng_prompt})]}),i.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(rt.jimeng_prompt),alert("")}catch{alert("")}},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:fe=>fe.stopPropagation(),title:"",children:i.jsx(ua,{size:12})})]})})]},je))}),se.global_tags&&i.jsxs("div",{className:"mt-2 pt-2 border-t border-zinc-300 dark:border-zinc-700",children:[i.jsx("div",{className:"text-[9px] text-zinc-500 mb-1",children:""}),i.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(se.global_tags).map(([rt,je])=>Array.isArray(je)&&je.map((fe,me)=>i.jsx("span",{className:"text-[8px] px-1.5 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:fe},`${rt}-${me}`)))})]})]},Ae)})})]}):null]})})()})]}),n.type==="storyboard-node"&&(()=>{var de,Fe,mt,Ct,Ot,wt,Lt,pt,ft,kt,ot,Mt,Dt,Rt,zt,yn,En,Z,re,Ie,at,se,Ae,vt,Qt,ct,bn,Kt;const O=(B,ze)=>{const Me=B.clipboardData.items;for(let Ge=0;Ge<Me.length;Ge++)if(Me[Ge].type.indexOf("image")!==-1){B.preventDefault(),B.stopPropagation();const qe=Me[Ge].getAsFile(),ut=new FileReader;ut.onload=Nt=>qt(n.id,ze,{image_url:Nt.target.result}),ut.readAsDataURL(qe);return}};return i.jsx("div",{className:"flex h-full",children:i.jsxs("div",{className:`flex flex-col h-full rounded-xl overflow-hidden pointer-events-auto transition-colors flex-1 ${e==="dark"?"bg-zinc-950 border border-zinc-800":"bg-white border border-zinc-300 shadow-sm"}`,onMouseEnter:()=>oh(!0),onMouseLeave:()=>oh(!1),children:[i.jsxs("div",{className:`px-4 py-3 border-b flex justify-between items-center shrink-0 flex-nowrap overflow-x-auto no-scrollbar ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[i.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[i.jsx(Il,{size:16,className:"text-purple-500"}),i.jsx("span",{className:`font-bold text-xs ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,children:""}),i.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"/"}),(de=n.settings)!=null&&de.isEditingTitle?i.jsx("input",{type:"text",value:((Fe=n.settings)==null?void 0:Fe.projectTitle)||"",onChange:B=>Be(n.id,{projectTitle:B.target.value}),placeholder:"",className:`font-bold text-xs bg-transparent border-b border-blue-500 outline-none w-32 transition-colors ${e==="dark"?"text-zinc-200 placeholder-zinc-500":"text-zinc-800 placeholder-zinc-400"}`,onMouseDown:B=>B.stopPropagation(),onClick:B=>B.stopPropagation(),onKeyDown:B=>{B.stopPropagation(),(B.key==="Enter"||B.key==="Escape")&&Be(n.id,{isEditingTitle:!1})},onBlur:()=>Be(n.id,{isEditingTitle:!1}),autoFocus:!0}):i.jsx("span",{className:`font-bold text-xs cursor-move ${e==="dark"?"text-zinc-200":"text-zinc-800"} ${(mt=n.settings)!=null&&mt.projectTitle?"":e==="dark"?"text-zinc-500":"text-zinc-400"}`,title:"",children:((Ct=n.settings)==null?void 0:Ct.projectTitle)||""}),i.jsx("button",{onClick:B=>{var ze;B.stopPropagation(),Be(n.id,{isEditingTitle:!((ze=n.settings)!=null&&ze.isEditingTitle)})},onMouseDown:B=>B.stopPropagation(),className:`p-0.5 rounded transition-colors ${(Ot=n.settings)!=null&&Ot.isEditingTitle?"text-blue-500":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-400 hover:text-zinc-600"}`,title:"",children:i.jsx(oz,{size:12})}),i.jsxs("div",{className:`flex items-center ml-2 p-0.5 rounded-full ${e==="dark"?"bg-zinc-800":"bg-zinc-200"}`,children:[i.jsx("button",{onClick:B=>{var ut,Nt;B.stopPropagation();const ze="image",Me=localStorage.getItem("tapnow_last_image_model")||((ut=Te.find(rt=>rt.type==="Image"))==null?void 0:ut.id)||"",qe=(((Nt=n.settings)==null?void 0:Nt.shots)||[]).map(rt=>{const je=Te.find(fe=>fe.id===rt.model);return!je||je.type==="Video"?{...rt,model:Me,duration:void 0}:rt});Be(n.id,{mode:ze,shots:qe})},className:`text-[10px] px-2 py-0.5 rounded-full transition-all ${(((wt=n.settings)==null?void 0:wt.mode)||"video")==="image"?"bg-blue-500 text-white shadow-sm":e==="dark"?"text-zinc-400 hover:text-zinc-200":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:B=>B.stopPropagation(),title:"",children:""}),i.jsx("button",{onClick:B=>{var ut,Nt;B.stopPropagation();const ze="video",Me=localStorage.getItem("tapnow_last_video_model")||((ut=Te.find(rt=>rt.type==="Video"))==null?void 0:ut.id)||"",qe=(((Nt=n.settings)==null?void 0:Nt.shots)||[]).map(rt=>{const je=Te.find(fe=>fe.id===rt.model);return!je||je.type==="Image"?{...rt,model:Me,duration:ko(Me)}:rt});Be(n.id,{mode:ze,shots:qe})},className:`text-[10px] px-2 py-0.5 rounded-full transition-all ${(((Lt=n.settings)==null?void 0:Lt.mode)||"video")==="video"?"bg-green-500 text-white shadow-sm":e==="dark"?"text-zinc-400 hover:text-zinc-200":"text-zinc-500 hover:text-zinc-700"}`,onMouseDown:B=>B.stopPropagation(),title:"",children:""})]})]}),i.jsxs("div",{className:"flex items-center gap-2 relative z-10 shrink-0",children:[i.jsx("button",{onClick:B=>{B.stopPropagation(),confirm("")&&Be(n.id,{shots:[]})},className:"p-1 hover:bg-red-100 hover:text-red-500 rounded text-zinc-400 transition-colors",title:"",children:i.jsx(Os,{size:14})}),i.jsxs("button",{onClick:()=>{var ze,Me;const B=dl(n.id);if(B.length>0){const Ge=B.join(`
`),qe=/#\s*(\d+)\s*([^#]*)|\s*(\d+)\s*\s*([^#]*)/g,ut=[];let Nt;for(;(Nt=qe.exec(Ge))!==null;){const rt=parseInt(Nt[1]||Nt[3]),je=(Nt[2]||Nt[4]||"").trim();je&&ut.push({num:rt,text:je})}if(ut.length===0&&Ge.split(`
`).filter(je=>je.trim()).forEach((je,fe)=>{const me=je.match(/^(\d+)[.\s]+(.*)/);me?ut.push({num:parseInt(me[1]),text:me[2].trim()}):ut.push({num:fe+1,text:je.trim()})}),ut.length>0){const rt=((ze=n.settings)==null?void 0:ze.shots)||[],je=[...rt];ut.forEach((fe,me)=>{me<rt.length?je[me]={...je[me],prompt:fe.text,description:fe.text}:je.push({id:Date.now()+Math.random()+me,prompt:fe.text,description:fe.text,model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0})}),Be(n.id,{shots:je})}else alert(" (: #1 )")}else Be(n.id,{scriptExpanded:!((Me=n.settings)!=null&&Me.scriptExpanded)})},className:`text-xs px-2 py-1 rounded transition-colors flex items-center gap-1 ${e==="dark"?"bg-purple-600 hover:bg-purple-500 text-white":"bg-purple-500 hover:bg-purple-400 text-white"}`,onMouseDown:B=>B.stopPropagation(),title:dl(n.id).length>0?"":"",children:[i.jsx(ts,{size:12}),i.jsx("span",{className:"whitespace-nowrap",children:""})]}),(()=>{var Me;const B=ul(n.id),ze=((Me=B==null?void 0:B.selectedKeyframes)==null?void 0:Me.length)||0;return i.jsxs("button",{onClick:async()=>{var rt;if(!B||ze===0){alert("");return}const Ge=B.selectedKeyframes,qe=((rt=n.settings)==null?void 0:rt.shots)||[],ut=Math.max(qe.length,Ge.length),Nt=Array.from({length:ut},(je,fe)=>{var me,ce,He,Xe,Re,De,Ut,Tt,cn;return{id:((me=qe[fe])==null?void 0:me.id)||`shot-${Date.now()}-${fe}`,...qe[fe],prompt:((ce=qe[fe])==null?void 0:ce.prompt)??"",description:((He=qe[fe])==null?void 0:He.description)??"",model:((Xe=qe[fe])==null?void 0:Xe.model)||localStorage.getItem("tapnow_last_video_model")||"",image_url:((Re=Ge[fe])==null?void 0:Re.url)??((De=qe[fe])==null?void 0:De.image_url)??"",image_filename:((Ut=Ge[fe])==null?void 0:Ut.filename)||((Tt=qe[fe])==null?void 0:Tt.image_filename)||"",status:((cn=qe[fe])==null?void 0:cn.status)||"draft"}});if(M(),window.LocalImageManager){for(let je of Nt)if(je.image_url&&(je.image_url.startsWith("file://")||je.image_url.startsWith("img_"))){const me=je.image_url.startsWith("img_")?je.image_url:je.imgId||je.image_filename;if(me)try{const ce=await window.LocalImageManager.getImage(me);ce&&(je.image_url=URL.createObjectURL(ce))}catch(ce){console.error("[KeyframeImport] Failed to load local image:",me,ce)}}}Be(n.id,{shots:Nt})},className:`text-xs px-2 py-1 rounded transition-colors flex items-center gap-1 ${ze>0?"bg-blue-600 hover:bg-blue-500 text-white":e==="dark"?"bg-zinc-700 text-zinc-400 cursor-not-allowed":"bg-zinc-200 text-zinc-500 cursor-not-allowed"}`,onMouseDown:Ge=>Ge.stopPropagation(),disabled:ze===0,title:ze>0?` ${ze} `:"",children:[i.jsx(da,{size:12}),i.jsxs("span",{className:"whitespace-nowrap",children:["",ze>0?` (${ze})`:""]})]})})(),(()=>{var Ge;const B=((Ge=n.settings)==null?void 0:Ge.mode)||"video",ze=u.filter(qe=>qe.to===n.id).map(qe=>At.get(qe.from)).find(qe=>qe&&(B==="image"&&qe.type==="gen-image"||B==="video"&&qe.type==="gen-video"));if(!ze)return null;const Me=ze.settings||{};return i.jsxs("button",{onClick:()=>{var Nt;const qe=((Nt=n.settings)==null?void 0:Nt.shots)||[];if(qe.length===0){Be(n.id,{errorMsg:""});return}M();const ut=qe.map(rt=>({...rt,model:Me.model||rt.model,ratio:Me.ratio||rt.ratio,resolution:Me.resolution||rt.resolution,duration:Me.duration||rt.duration}));Be(n.id,{shots:ut}),o(`  ${ut.length}  | ${Me.model||"?"} / ${Me.ratio||"?"}`,"success",5e3)},className:`text-xs px-2 py-1 rounded transition-colors flex items-center gap-1 ${e==="dark"?"bg-green-600 hover:bg-green-500 text-white":"bg-green-500 hover:bg-green-400 text-white"}`,onMouseDown:qe=>qe.stopPropagation(),title:` ${B==="image"?"":""}: ${Me.model||"?"} / ${Me.ratio||"?"} / ${Me.resolution||"?"}${B==="video"?` / ${Me.duration||"?"}`:""}`,children:[i.jsx(Bu,{size:12}),i.jsx("span",{className:"whitespace-nowrap",children:""})]})})(),i.jsxs("div",{className:`flex items-center gap-1 border-l pl-2 ml-1 ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,children:[i.jsx("input",{type:"number",min:"0",max:"20",value:he,onChange:B=>We(Math.max(0,parseInt(B.target.value)||0)),className:`w-8 text-center text-xs rounded border outline-none py-0.5 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`,title:" (0=)"}),i.jsx("button",{onClick:()=>{var Nt,rt;const B=((Nt=n.settings)==null?void 0:Nt.mode)||"video",ze=((rt=n.settings)==null?void 0:rt.shots)||[],Me=ze.filter(je=>je.status==="generating");if(Me.length>0){const je=prompt(` ${Me.length} 




  "1"  "ok" = 
  "2"  "skip" = 
  = `,"");if(je===null||je.trim()==="")return;const fe=je.trim().toLowerCase();(fe==="1"||fe==="ok"||fe==="")&&Me.forEach(me=>{qt(n.id,me.id,{status:"pending",errorMsg:""}),me.status="pending"})}let Ge=ze.filter(je=>je.status!=="done"&&je.status!=="generating"&&!je.outputEnabled),qe=!1;if(Ge.length===0){if(Ge=ze.filter(je=>!je.outputEnabled&&je.status==="done"),Ge.length===0){const je=ze.every(me=>me.outputEnabled);ze.some(me=>me.status==="generating")?alert(""):je&&ze.length>0?alert(`
`):alert("");return}qe=!0}if(qe){const je=`

 ${Ge.length} 

 
 

`;if(!confirm(je))return}const ut=Ge.map(je=>({nodeId:n.id,shotId:je.id,retryCount:0,mode:B}));ie(je=>[...je,...ut]),ke.current!=="running"&&(ke.current="idle"),ye(je=>je+1),o(`  ${ut.length} ${B==="image"?"":""} | : ${he===0?"":he}${qe?" ()":""}`,"success",5e3)},className:`p-1 rounded transition-colors ${(((pt=n.settings)==null?void 0:pt.mode)||"video")==="image"?e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-400 text-white":e==="dark"?"bg-yellow-600 hover:bg-yellow-500 text-white":"bg-yellow-500 hover:bg-yellow-400 text-white"}`,title:`${(((ft=n.settings)==null?void 0:ft.mode)||"video")==="image"?"":""}`,children:i.jsxs("div",{className:"flex items-center gap-1",children:[(((kt=n.settings)==null?void 0:kt.mode)||"video")==="image"?i.jsx(da,{size:12}):i.jsx(ju,{size:12,fill:"currentColor"}),i.jsx("span",{className:"text-[10px] font-medium whitespace-nowrap",children:""})]})}),i.jsx("button",{onClick:async()=>{var Ge,qe,ut;const B=((Ge=n.settings)==null?void 0:Ge.mode)||"video",ze=(((qe=n.settings)==null?void 0:qe.shots)||[]).filter(Nt=>B==="image"?Nt.output_url:Nt.video_url);if(ze.length===0){alert(`${B==="image"?"":""}`);return}const Me=((ut=n.settings)==null?void 0:ut.projectTitle)||"";for(let Nt=0;Nt<ze.length;Nt++){const rt=ze[Nt],je=B==="image"?rt.output_url:rt.video_url,fe=B==="image"?"png":"mp4",me=`${Me}_${Nt+1}.${fe}`;try{const He=await(await fetch(je)).blob(),Xe=document.createElement("a");Xe.href=URL.createObjectURL(He),Xe.download=me,Xe.click(),URL.revokeObjectURL(Xe.href)}catch(ce){console.error("Download failed:",ce)}await new Promise(ce=>setTimeout(ce,300))}},className:`p-1 rounded transition-colors ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,title:"",onMouseDown:B=>B.stopPropagation(),children:i.jsx(No,{size:12})}),i.jsx("button",{onClick:B=>{B.stopPropagation(),l(ze=>ze.map(Me=>{var Ge;if(Me.id===n.id){const qe=(Ge=Me.settings)==null?void 0:Ge.showOutputPreview,ut=qe?Math.max(380,Me.width-160):Me.width+160;return{...Me,width:ut,settings:{...Me.settings,showOutputPreview:!qe}}}return Me}))},className:`p-1 rounded transition-colors ${(ot=n.settings)!=null&&ot.showOutputPreview?"bg-blue-500 text-white":e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-400":"bg-zinc-200 hover:bg-zinc-300 text-zinc-500"}`,title:(Mt=n.settings)!=null&&Mt.showOutputPreview?"":"",onMouseDown:B=>B.stopPropagation(),children:i.jsx(fa,{size:12,className:`transition-transform ${(Dt=n.settings)!=null&&Dt.showOutputPreview?"rotate-90":""}`})})]})]}),((Rt=n.settings)==null?void 0:Rt.showOutputPreview)&&i.jsx("div",{className:"w-[160px] shrink-0 flex items-center justify-center gap-2 ml-1 ",children:(((zt=n.settings)==null?void 0:zt.mode)||"video")==="image"?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:B=>{var Ge;B.stopPropagation();const ze=((Ge=n.settings)==null?void 0:Ge.shots)||[],Me=ze.length>0&&ze.every(qe=>qe.outputEnabled);Be(n.id,{shots:ze.map(qe=>({...qe,outputEnabled:!Me}))})},className:`text-[10px] px-2 py-1 rounded transition-colors whitespace-nowrap ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,onMouseDown:B=>B.stopPropagation(),title:"/",children:(((yn=n.settings)==null?void 0:yn.shots)||[]).every(B=>B.outputEnabled)?"":""}),i.jsxs("button",{onClick:B=>{var Ge;B.stopPropagation();const ze=((Ge=n.settings)==null?void 0:Ge.shots)||[],Me=ze.some(qe=>qe.selectedImageIndex>=0);Be(n.id,{shots:ze.map(qe=>({...qe,selectedImageIndex:qe.outputEnabled?qe.selectedImageIndex:Me?-1:0}))})},className:`text-[10px] px-2 py-1 rounded transition-colors flex items-center gap-1 whitespace-nowrap ${e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-400 text-white"}`,onMouseDown:B=>B.stopPropagation(),title:"==",children:[i.jsx(da,{size:10}),i.jsx("span",{children:(((En=n.settings)==null?void 0:En.shots)||[]).some(B=>B.selectedImageIndex>=0)?"":""})]})]}):i.jsx("button",{onClick:B=>{var Ge;B.stopPropagation();const ze=((Ge=n.settings)==null?void 0:Ge.shots)||[],Me=ze.length>0&&ze.every(qe=>qe.outputEnabled);Be(n.id,{shots:ze.map(qe=>({...qe,outputEnabled:!Me}))})},className:`text-[10px] px-2 py-1 rounded transition-colors whitespace-nowrap ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-600"}`,onMouseDown:B=>B.stopPropagation(),title:"/",children:(((Z=n.settings)==null?void 0:Z.shots)||[]).every(B=>B.outputEnabled)?"":""})})]}),((re=n.settings)==null?void 0:re.scriptExpanded)&&i.jsxs("div",{className:`border-b shrink-0 p-3 space-y-2 ${e==="dark"?"bg-zinc-900/30 border-zinc-800":"bg-zinc-50/50 border-zinc-200"}`,children:[i.jsx("textarea",{value:((Ie=n.settings)==null?void 0:Ie.scriptText)||"",onChange:B=>Be(n.id,{scriptText:B.target.value}),placeholder:": #1  #2  ...",className:`w-full h-24 p-2 text-xs rounded border resize-none overflow-y-auto custom-scrollbar ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 placeholder-zinc-500":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onMouseDown:B=>B.stopPropagation(),onWheel:B=>{B.stopPropagation()}}),i.jsxs("div",{className:"flex gap-2 flex-wrap",children:[i.jsx("button",{onClick:()=>{var fe,me;const ze=dl(n.id).join(`
`),Me=((fe=n.settings)==null?void 0:fe.scriptText)||"",Ge=ze||Me,qe=[],ut=/#\s*(\d+)\s*([^#]*)|\s*(\d+)\s*\s*([^#]*)/g;let Nt;for(;(Nt=ut.exec(Ge))!==null;){const ce=parseInt(Nt[1]||Nt[3]),He=(Nt[2]||Nt[4]||"").trim();He&&qe.push({num:ce,text:He})}if(qe.length===0&&Ge.split(`
`).filter(He=>He.trim()).forEach((He,Xe)=>{const Re=He.match(/^(\d+)[.\s]+(.*)/);Re?qe.push({num:parseInt(Re[1]),text:Re[2].trim()}):qe.push({num:Xe+1,text:He.trim()})}),qe.length===0){alert(": #1  #2 ");return}qe.sort((ce,He)=>ce.num-He.num);const rt=((me=n.settings)==null?void 0:me.shots)||[],je=[...rt];qe.forEach((ce,He)=>{He<rt.length?je[He]={...je[He],prompt:ce.text,description:ce.text}:je.push({id:Date.now()+Math.random()+He,prompt:ce.text,description:ce.text,model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0})}),Be(n.id,{shots:je,scriptExpanded:!1})},className:"px-3 py-1.5 text-xs bg-purple-600 text-white rounded hover:bg-purple-500 transition-colors",onMouseDown:B=>B.stopPropagation(),children:""}),i.jsxs("button",{onClick:async()=>{var qe,ut,Nt,rt,je,fe,me,ce,He,Xe;const B=((qe=n.settings)==null?void 0:qe.scriptText)||"";if(!B.trim()){Be(n.id,{errorMsg:""});return}(((ut=n.settings)==null?void 0:ut.shots)||[]).length>0&&window.confirm(`
""""`);const{key:Me,url:Ge}=es(ht);if(!Me){Be(n.id,{errorMsg:" Chat  Key"});return}try{M(),Be(n.id,{isGenerating:!0,errorMsg:""});const Re=((Nt=n.settings)==null?void 0:Nt.llmSplitPrompt)||`
 JSON : [{"prompt": "1"}, {"prompt": "2"}, ...]
 JSON`,cn=(((fe=(je=(rt=(await(await fetch(`${Ge}/v1/chat/completions`,{method:"POST",headers:{Authorization:`Bearer ${Me}`,"Content-Type":"application/json"},body:JSON.stringify({model:ht,messages:[{role:"system",content:Re},{role:"user",content:B}],stream:!1})})).json()).choices)==null?void 0:rt[0])==null?void 0:je.message)==null?void 0:fe.content)||"").match(/\[[\s\S]*\]/);if(cn){const en=JSON.parse(cn[0]),Ee=((me=n.settings)==null?void 0:me.mode)||"video",Le=Ee==="image"?localStorage.getItem("tapnow_last_image_model")||((ce=Te.find(Xn=>Xn.type==="Image"))==null?void 0:ce.id)||"":localStorage.getItem("tapnow_last_video_model")||((He=Te.find(Xn=>Xn.type==="Video"))==null?void 0:He.id)||"",Qe=Ee==="image"?"1:1":"16:9",Et=Ee==="video"?ko(Le):void 0,Ft=en.map((Xn,Tn)=>({id:`shot-${Date.now()}-${Tn}`,scene_index:Tn+1,prompt:Xn.prompt||Xn.description||"",description:Xn.description||Xn.prompt||"",image_url:"",video_url:"",output_url:"",model:Le,ratio:Qe,duration:Et,status:"draft",outputEnabled:!1,selectedImageIndex:-1})),Vt=((Xe=n.settings)==null?void 0:Xe.shots)||[],Ln=Vt.length>0&&!window.lastLlmSplitOverwrite?[...Vt,...Ft]:Ft;Be(n.id,{shots:Ln,scriptExpanded:!1,isGenerating:!1})}else throw new Error("AI ")}catch(Re){console.error("[LLM Split] Error:",Re),Be(n.id,{isGenerating:!1,errorMsg:Re.message})}},className:"px-2 py-1.5 text-xs bg-blue-600 text-white rounded hover:bg-blue-500 transition-colors flex items-center gap-1",onMouseDown:B=>B.stopPropagation(),disabled:(at=n.settings)==null?void 0:at.isGenerating,title:" AI ",children:[i.jsx(Ml,{size:12}),(se=n.settings)!=null&&se.isGenerating?"...":"LLM"]}),i.jsx("button",{onClick:()=>{var B;return Be(n.id,{showLlmPromptEditor:!((B=n.settings)!=null&&B.showLlmPromptEditor)})},className:`p-1.5 text-xs rounded transition-colors ${(Ae=n.settings)!=null&&Ae.showLlmPromptEditor?"bg-blue-500 text-white":e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-700"}`,onMouseDown:B=>B.stopPropagation(),title:" LLM  Prompt",children:i.jsx(sz,{size:12})}),!((vt=n.settings)!=null&&vt.showLlmPromptEditor)&&i.jsxs("div",{className:`flex flex-col text-[10px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:[i.jsx("span",{children:": #1 #2 "}),i.jsx("span",{children:"LLM: "})]})]}),((Qt=n.settings)==null?void 0:Qt.showLlmPromptEditor)&&i.jsxs("div",{className:"flex items-start gap-2 mt-2",children:[i.jsx("span",{className:`text-[10px] shrink-0 pt-1 ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"LLM Prompt:"}),i.jsx("textarea",{value:((ct=n.settings)==null?void 0:ct.llmSplitPrompt)||`
 JSON : [{"prompt": "1"}, {"prompt": "2"}, ...]
 JSON`,onChange:B=>Be(n.id,{llmSplitPrompt:B.target.value}),className:`flex-1 text-xs p-2 rounded resize-none overflow-y-auto custom-scrollbar ${e==="dark"?"bg-zinc-800 text-zinc-200 border-zinc-700":"bg-white text-zinc-800 border-zinc-300"} border`,rows:3,placeholder:" LLM  Prompt...",onMouseDown:B=>B.stopPropagation(),onClick:B=>B.stopPropagation(),onKeyDown:B=>B.stopPropagation(),onWheel:B=>{B.stopPropagation()}})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-3 min-h-0 bg-opacity-50",onWheel:B=>{B.stopPropagation()},children:((Kt=(bn=n.settings)==null?void 0:bn.shots)==null?void 0:Kt.length)>0?n.settings.shots.map((B,ze)=>{var Ge,qe,ut,Nt,rt,je,fe,me;const Me=(Zr==null?void 0:Zr.nodeId)===n.id&&(Zr==null?void 0:Zr.shotId)===B.id;return i.jsxs(xd.Fragment,{children:[i.jsxs("div",{className:"relative h-2 -mt-1 -mb-1 z-10 group/insert flex items-center justify-center cursor-pointer hover:h-6 transition-all",onClick:ce=>{ce.stopPropagation();const He=[...n.settings.shots||[]];He.splice(ze,0,{id:Date.now()+Math.random(),prompt:"",description:"",model:localStorage.getItem("tapnow_last_video_model")||"",duration:5,status:"draft",outputEnabled:!0,selectedImageIndex:0}),Be(n.id,{shots:He})},title:"",children:[i.jsx("div",{className:"w-full h-[2px] bg-blue-500 opacity-0 group-hover/insert:opacity-100 transition-opacity"}),i.jsx("div",{className:"absolute w-5 h-5 rounded-full bg-blue-600 text-white flex items-center justify-center opacity-0 group-hover/insert:opacity-100 transition-opacity shadow-sm scale-75 group-hover/insert:scale-100",children:i.jsx(Vi,{size:12})})]}),i.jsxs("div",{className:"flex items-stretch gap-2 w-full",children:[i.jsxs("div",{tabIndex:0,onClick:ce=>{ce.stopPropagation(),Ga({nodeId:n.id,shotId:B.id}),ce.currentTarget.focus()},onPaste:ce=>O(ce,B.id),className:`relative flex-1 flex gap-3 p-3 rounded-lg border transition-all group/shot cursor-pointer outline-none focus:ring-2 focus:ring-blue-500/50 ${Me?"border-blue-500 ring-1 ring-blue-500 bg-blue-500/5 z-10":e==="dark"?"bg-zinc-900/50 border-zinc-800 hover:border-zinc-600":"bg-white border-zinc-200 hover:border-blue-300 hover:shadow-md"}`,children:[i.jsx("div",{className:`font-mono text-sm w-6 shrink-0 flex items-start pt-1 font-bold ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:ze+1}),i.jsx("div",{className:"flex flex-col gap-2 shrink-0 mr-2 h-full min-h-[14rem] w-52",children:(()=>{var en;const He=(((en=n.settings)==null?void 0:en.mode)||"video")==="video",Xe=B.useFirstLastFrame,Re=B.activeInput||"first",De=B.useMultiRef,Ut=e==="dark"?"border-zinc-800":"border-zinc-300",Tt=e==="dark"?"bg-black":"bg-zinc-50",cn=(Ee,Le)=>{var Ft;const Qe=(Ft=Ee.target.files)==null?void 0:Ft[0];if(!Qe)return;const Et=new FileReader;Et.onload=Vt=>{qt(n.id,B.id,{[Le]:Vt.target.result})},Et.readAsDataURL(Qe),Ee.target.value=""};if(He){const Ee=(Le,Qe)=>{const Et=Le==="first"?"image_url":"lastFrame",Ft=B[Et],Vt=Le==="first"?"":"",un=Qe?"flex-1 h-full":"w-14 h-full shrink-0";return i.jsxs("div",{className:`relative rounded-lg border overflow-hidden group ${un} ${Tt} ${Ut} flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 transition-all`,onClick:Ln=>{Ln.stopPropagation(),Qe||qt(n.id,B.id,{activeInput:Le})},children:[Ft?i.jsx(Vn,{src:Ft,className:`w-full h-full object-cover ${Qe?"":"opacity-60 hover:opacity-100"}`}):i.jsxs("div",{className:"flex flex-col items-center gap-1 text-zinc-500",children:[i.jsx(Hi,{size:Qe?20:14}),Qe&&i.jsxs("span",{className:"text-[10px]",children:["",Vt]})]}),i.jsx("div",{className:"absolute top-0 left-0 bg-black/60 text-white text-[9px] px-1.5 py-0.5 rounded-br z-20 backdrop-blur-md pointer-events-none",children:Vt}),Ft&&i.jsx("button",{onClick:Ln=>{Ln.stopPropagation(),xn({url:Ft,type:"image"})},className:"absolute bottom-1 left-1 p-1 rounded-full bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:i.jsx(Ds,{size:10})}),Qe&&i.jsxs(i.Fragment,{children:[Ft&&i.jsx("button",{onClick:Ln=>{Ln.stopPropagation(),qt(n.id,B.id,{[Et]:""})},className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white hover:bg-red-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",children:i.jsx(ns,{size:12})}),i.jsxs("label",{className:"absolute inset-0 z-10 flex items-center justify-center cursor-pointer opacity-0 hover:opacity-100",children:[i.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:Ln=>cn(Ln,Et)}),i.jsx("div",{className:"p-2 rounded-full bg-black/50 text-white",children:i.jsx(Hi,{size:16})})]}),i.jsx("div",{className:"absolute bottom-1 right-1 p-1 rounded bg-black/40 hover:bg-blue-500 text-white transition-colors cursor-pointer z-30",onClick:Ln=>{Ln.stopPropagation(),qt(n.id,B.id,{useFirstLastFrame:!Xe,activeInput:Xe?"first":"last"})},title:"",children:i.jsx(e0,{size:12})}),Ft&&B.image_filename&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[9px] pl-8 pr-8 py-0.5 truncate opacity-0 group-hover:opacity-100 transition-opacity z-20",title:B.image_filename,children:B.image_filename})]})]},Le)};return Xe?i.jsxs("div",{className:"flex flex-row gap-2 h-full w-full",children:[Ee("first",Re==="first"),Ee("last",Re==="last")]}):Ee("first",!0)}else{const Ee=B.referenceImages&&B.referenceImages.length>0?B.referenceImages:B.image_url?[B.image_url]:[],Le=Ee[0]||"";return i.jsxs("div",{className:"flex flex-col gap-2 h-full w-full",children:[i.jsxs("div",{className:`relative flex-1 rounded-lg border overflow-hidden group ${Tt} ${Ut} flex flex-col items-center justify-center`,children:[Le?i.jsxs(i.Fragment,{children:[i.jsx(Vn,{src:Le,className:"w-full h-full object-cover"}),i.jsx("button",{onClick:Qe=>{Qe.stopPropagation(),xn({url:Le,type:"image"})},className:"absolute bottom-1 left-1 p-1 rounded-full bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:i.jsx(Ds,{size:12})}),B.image_filename&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[9px] px-8 py-0.5 truncate opacity-0 group-hover:opacity-100 transition-opacity z-20",title:B.image_filename,children:B.image_filename}),i.jsx("button",{onClick:Qe=>{Qe.stopPropagation(),qt(n.id,B.id,{image_url:"",image_filename:"",referenceImages:[]})},className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white hover:bg-red-500 opacity-0 group-hover:opacity-100 transition-opacity z-30",title:"",children:i.jsx(ns,{size:12})})]}):i.jsxs("div",{className:"flex flex-col items-center gap-1 text-zinc-500",children:[i.jsx(Hi,{size:20}),i.jsx("span",{className:"text-[10px]",children:""})]}),i.jsxs("label",{className:`absolute inset-0 z-10 flex items-center justify-center cursor-pointer ${Le?"opacity-0 hover:opacity-100":"opacity-100"}`,children:[i.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:Qe=>{var Ft;const Et=(Ft=Qe.target.files)==null?void 0:Ft[0];if(Et){const Vt=new FileReader;Vt.onload=un=>{qt(n.id,B.id,{image_url:un.target.result,image_filename:Et.name})},Vt.readAsDataURL(Et)}}}),Le&&i.jsx("div",{className:"p-2 rounded-full bg-black/50 text-white",children:i.jsx(Hi,{size:16})})]}),i.jsx("div",{className:`absolute bottom-1 right-1 p-1 rounded bg-black/40 hover:bg-blue-500 text-white transition-colors cursor-pointer z-30 ${De?"text-blue-400 bg-blue-500/30":"text-zinc-400"}`,onClick:Qe=>{Qe.stopPropagation(),qt(n.id,B.id,{useMultiRef:!De})},title:"",children:i.jsx(Il,{size:12})})]}),De&&i.jsxs("div",{className:"flex gap-2 h-14 shrink-0 overflow-x-auto no-scrollbar items-center",children:[Ee.slice(1).map((Qe,Et)=>i.jsxs("div",{className:`relative w-12 h-14 shrink-0 rounded border overflow-hidden cursor-pointer hover:border-blue-500 transition-all ${Ut} ${Tt}`,onClick:Ft=>{Ft.stopPropagation();const Vt=[...Ee],un=Et+1;[Vt[0],Vt[un]]=[Vt[un],Vt[0]],qt(n.id,B.id,{referenceImages:Vt,image_url:Vt[0]})},children:[i.jsx(Vn,{src:Qe,className:"w-full h-full object-cover"}),i.jsx("div",{className:"absolute top-0 left-0 bg-black/50 text-white text-[8px] px-1 backdrop-blur-sm",children:Et+2})]},Et+1)),Ee.length<4&&i.jsxs("label",{className:`w-12 h-14 shrink-0 rounded border border-dashed flex items-center justify-center cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-800 ${Ut} text-zinc-400 hover:text-blue-500 hover:border-blue-500 transition-colors`,children:[i.jsx(Vi,{size:16}),i.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:Qe=>{var Ft;const Et=(Ft=Qe.target.files)==null?void 0:Ft[0];if(Et){const Vt=new FileReader;Vt.onload=un=>{qt(n.id,B.id,{referenceImages:[...Ee,un.target.result]})},Vt.readAsDataURL(Et)}}})]})]})]})}})()}),i.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-2",children:[i.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[i.jsxs("div",{className:"relative",children:[i.jsxs("button",{onClick:ce=>{ce.stopPropagation(),ln((Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="shot-model"&&Ke.shotId===B.id?null:{nodeId:n.id,type:"shot-model",shotId:B.id})},onMouseDown:ce=>ce.stopPropagation(),className:`flex items-center justify-between gap-1 px-2 py-1 rounded border text-xs transition-colors min-w-[100px] ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:[i.jsx("span",{className:"truncate font-mono text-[10px]",children:(()=>{var ce,He;return(ce=n.settings)!=null&&ce.mode,((He=fn.get(B.model))==null?void 0:He.id)||B.model||""})()}),i.jsx(Rs,{size:10,className:"opacity-50 shrink-0"})]}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="shot-model"&&Ke.shotId===B.id&&i.jsxs("div",{className:`absolute top-full left-0 mt-1 w-64 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:ce=>ce.stopPropagation(),onMouseLeave:()=>Zn(null),children:[i.jsx("div",{className:`w-24 border-r pr-1 max-h-80 overflow-y-auto custom-scrollbar ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:(()=>{var Xe;const He=(((Xe=n.settings)==null?void 0:Xe.mode)||"video")==="image"?"Image":"Video";return Object.entries(pr).filter(([,Re])=>Re.models.some(De=>De.type===He)).map(([Re,De])=>i.jsx("button",{onMouseEnter:()=>Zn(Re),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${zn===Re?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:De.name||Re},Re))})()}),i.jsxs("div",{className:"flex-1 pl-1 max-h-80 overflow-y-auto custom-scrollbar",children:[(()=>{var Xe,Re;const He=(((Xe=n.settings)==null?void 0:Xe.mode)||"video")==="image"?"Image":"Video";return zn&&((Re=pr[zn])==null?void 0:Re.models.filter(De=>De.type===He).map(De=>i.jsxs("button",{onClick:()=>{var en;const Ut=((en=n.settings)==null?void 0:en.mode)||"video",Tt=ko(De.id);qt(n.id,B.id,{model:De.id,duration:B.duration||Tt});const cn=Ut==="image"?"tapnow_last_image_model":"tapnow_last_video_model";localStorage.setItem(cn,De.id),Ut==="image"?Qd(De.id):ep(De.id),ln(null),Zn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${B.model===De.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[i.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:De.id}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(De.id)}`})]},De.id)))})(),!zn&&i.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]}),(()=>{var Xe;const ce=((Xe=n.settings)==null?void 0:Xe.mode)||"video",He=ce==="video"?Zg(B.model):t0;return i.jsx("select",{value:B.ratio||(ce==="video"?"16:9":"1:1"),onChange:Re=>qt(n.id,B.id,{ratio:Re.target.value}),onClick:Re=>Re.stopPropagation(),onMouseDown:Re=>Re.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:He.map(Re=>i.jsx("option",{value:Re,children:Re},Re))})})(),(()=>{var He,Xe,Re,De;if((((He=n.settings)==null?void 0:He.mode)||"video")==="video")return(Xe=B.model)!=null&&Xe.includes("jimeng")||(De=(Re=fn.get(B.model))==null?void 0:Re.modelName)!=null&&De.includes("jimeng")?i.jsxs("select",{value:_u(B.resolution||"720p"),onChange:Ut=>qt(n.id,B.id,{resolution:Ut.target.value}),onClick:Ut=>Ut.stopPropagation(),onMouseDown:Ut=>Ut.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,title:"",children:[i.jsx("option",{value:"720p",children:"720p"}),i.jsx("option",{value:"1080p",children:"1080p"})]}):null;{const Ut=Qp(B.model);return i.jsx("select",{value:Tl(B.resolution||"2K"),onChange:Tt=>qt(n.id,B.id,{resolution:Tt.target.value}),onClick:Tt=>Tt.stopPropagation(),onMouseDown:Tt=>Tt.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,title:"",children:Ut.map(Tt=>i.jsx("option",{value:Tt,children:Tt},Tt))})}})(),(((Ge=n.settings)==null?void 0:Ge.mode)||"video")==="video"&&(()=>{var De,Ut;const ce=B.model||((De=Te.find(Tt=>Tt.type==="Video"&&Tt.id==="sora-2"))==null?void 0:De.id)||((Ut=Te.find(Tt=>Tt.type==="Video"))==null?void 0:Ut.id)||"",He=Te.find(Tt=>Tt.id===ce),Xe=(He==null?void 0:He.durations)||Jc(ce),Re=ko(ce);return i.jsx("select",{value:B.duration||Re,onChange:Tt=>qt(n.id,B.id,{duration:Tt.target.value}),onClick:Tt=>Tt.stopPropagation(),onMouseDown:Tt=>Tt.stopPropagation(),className:`text-xs px-2 py-1 rounded border outline-none transition-colors ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200 hover:border-zinc-600":"bg-white border-zinc-300 text-zinc-800 hover:border-zinc-400"}`,children:Xe.map(Tt=>i.jsx("option",{value:Tt,children:Tt},Tt))})})()]}),i.jsx("textarea",{className:`text-sm outline-none resize-none bg-transparent transition-all ${e==="dark"?"text-zinc-200 placeholder:text-zinc-700":"text-zinc-800 placeholder:text-zinc-400"}`,value:B.description||"",placeholder:"...",title:B.description||"",onChange:ce=>qt(n.id,B.id,{description:ce.target.value}),onClick:ce=>{ce.stopPropagation(),Me||Ga({nodeId:n.id,shotId:B.id})},onMouseDown:ce=>ce.stopPropagation(),onFocus:ce=>{ce.stopPropagation(),Me||Ga({nodeId:n.id,shotId:B.id})},onInput:ce=>{Me&&(ce.currentTarget.style.height="auto",ce.currentTarget.style.height=ce.currentTarget.scrollHeight+"px")},ref:ce=>{ce&&Me&&(ce.style.height="auto",ce.style.height=ce.scrollHeight+"px")},style:{minHeight:Me?"8rem":"2.5rem",height:Me?"auto":"2.5rem",transition:"all 0.2s ease-in-out"}}),i.jsxs("div",{className:`p-2 rounded text-xs font-mono border transition-all relative ${e==="dark"?"bg-zinc-950 border-zinc-800 text-zinc-400":"bg-zinc-50 border-zinc-200 text-zinc-600"}`,style:{minHeight:Me?"8rem":"2rem",transition:"all 0.2s ease-in-out"},children:[i.jsx("textarea",{className:"w-full bg-transparent outline-none resize-none placeholder:text-opacity-50 transition-all pr-8",value:B.prompt||"",placeholder:"...",onChange:ce=>qt(n.id,B.id,{prompt:ce.target.value}),onClick:ce=>{ce.stopPropagation(),Me||Ga({nodeId:n.id,shotId:B.id})},onMouseDown:ce=>ce.stopPropagation(),onFocus:ce=>{ce.stopPropagation(),Me||Ga({nodeId:n.id,shotId:B.id})},onInput:ce=>{Me&&(ce.currentTarget.style.height="auto",ce.currentTarget.style.height=ce.currentTarget.scrollHeight+"px")},ref:ce=>{ce&&Me&&(ce.style.height="auto",ce.style.height=ce.scrollHeight+"px")},style:{minHeight:Me?"8rem":"2rem",height:Me?"auto":"2rem",transition:"all 0.2s ease-in-out"}}),(B.model==="sora-2"||B.model==="sora-2-pro")&&On.length>0&&i.jsx("button",{onClick:ce=>{ce.stopPropagation(),Jo(!0)},className:`absolute top-2 right-2 p-1 rounded transition-colors ${e==="dark"?"text-zinc-500 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-400 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:i.jsx(ku,{size:12})})]}),(B.status==="generating"||B.status==="done"||B.status==="completed"||B.status==="failed"||B.status==="error")&&i.jsxs("div",{className:`absolute top-1 right-1 px-1.5 py-0.5 rounded text-[10px] font-mono flex items-center gap-1 backdrop-blur-[2px] z-10 ${e==="dark"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-blue-50 text-blue-600 border border-blue-200"}`,children:[i.jsx(Mg,{size:10}),i.jsx("span",{children:B.status==="generating"?ah[`${n.id}-${B.id}`]?ah[`${n.id}-${B.id}`].replace(" ",""):"0.0s":`${(B.durationCost||0).toFixed(1)}s`})]}),(()=>{const ce=B.model||"";if(!(ce&&(ce.includes("sora")||ce==="sora-2"||ce==="sora-2-pro"))||On.length===0)return null;const Xe=B.prompt||"",Re=`${n.id}-${B.id}`,De=mh[Re]||!1,Ut=5,Tt=On.length>Ut;return i.jsx("div",{className:"border-t border-dashed mt-1",style:{borderColor:e==="dark"?"rgba(63, 63, 70, 0.5)":"rgba(161, 161, 170, 0.5)"},children:i.jsxs("div",{className:"flex items-center justify-between py-1 px-1",children:[i.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 flex-1 custom-scrollbar",children:(De?On:On.slice(0,Ut)).map(cn=>{const en=`@${cn.username}`,Ee=Xe.includes(en);return i.jsxs("button",{onClick:Le=>{Le.stopPropagation();let Qe=Xe||"";Ee?Qe=Qe.replace(en,"").replace(/\s{2,}/g," ").trim():(Qe=Qe.trim(),Qe=Qe?`${Qe} ${en} `:`${en} `),qt(n.id,B.id,{prompt:Qe})},className:`relative shrink-0 transition-all ${Ee?"scale-110":"opacity-70 hover:opacity-100"}`,title:cn.username,children:[i.jsx("img",{src:cn.localCacheUrl||cn.profile_picture_url||"",alt:cn.username,className:`w-8 h-8 rounded-full object-cover border-2 ${Ee?"border-blue-500 ring-2 ring-blue-500":"border-transparent"}`,onError:Le=>{Le.target.style.display="none"}}),i.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 bg-black/50 rounded-full p-0.5",children:i.jsx($l,{size:8,className:"text-green-400"})})]},cn.id)})}),Tt&&i.jsx("button",{onClick:cn=>{cn.stopPropagation(),De?Ec(en=>{const Ee={...en};return delete Ee[Re],Ee}):(Jo(!0),Ec(en=>({...en,[Re]:!0})))},className:`shrink-0 px-2 py-1 text-[10px] rounded transition-colors ml-2 ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,title:De?"":"",children:De?"":`+${On.length-Ut}`})]})})})(),i.jsxs("div",{className:"flex gap-1 flex-wrap items-center mt-1",children:[(qe=B.tags)==null?void 0:qe.map((ce,He)=>i.jsx("span",{className:`px-1.5 py-0.5 text-[10px] rounded border ${e==="dark"?"bg-blue-900/30 text-blue-300 border-blue-800":"bg-blue-50 text-blue-600 border-blue-200"}`,children:ce},He)),B.camera&&i.jsxs("span",{className:`px-1.5 py-0.5 text-[10px] rounded border flex items-center gap-1 ${e==="dark"?"bg-purple-900/30 text-purple-300 border-purple-800":"bg-purple-50 text-purple-600 border-purple-200"}`,children:[i.jsx(zu,{size:8})," ",B.camera]}),B.time_range&&i.jsx("span",{className:`text-[10px] ml-auto font-mono ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:B.time_range})]})]}),i.jsxs("div",{className:`flex flex-col gap-2 justify-center border-l pl-2 shrink-0 ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[(()=>{var Re;const ce=((Re=n.settings)==null?void 0:Re.mode)||"video",He=ce==="image"?B.output_url:B.video_url,Xe=B.status==="done"&&He;return i.jsx("button",{onClick:De=>{De.stopPropagation(),B.status==="generating"?qt(n.id,B.id,{status:"draft",errorMsg:null}):ce==="image"?Gh(n.id,B):Yh(n.id,B)},className:`p-1.5 rounded text-white shadow-sm transition-all active:scale-95 ${B.status==="generating"?"bg-zinc-500 hover:bg-red-500":Xe?"bg-blue-500 hover:bg-green-600":ce==="image"?"bg-blue-600 hover:bg-blue-500":"bg-green-600 hover:bg-green-500"}`,title:B.status==="generating"?"":Xe?"":`${ce==="image"?"":""}`,onMouseDown:De=>De.stopPropagation(),children:B.status==="generating"?i.jsxs("div",{className:"relative w-3.5 h-3.5 flex items-center justify-center",children:[i.jsx(hi,{size:14,className:"animate-spin absolute"}),i.jsx(Ug,{size:10,fill:"currentColor",className:"opacity-0 hover:opacity-100 absolute z-10 transition-opacity"})]}):Xe?i.jsx(Ol,{size:14}):ce==="image"?i.jsx(da,{size:14}):i.jsx(Og,{size:14,fill:"currentColor"})})})(),i.jsx("button",{onClick:()=>Ib(n.id,B.id),className:`p-1.5 transition-colors ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-600"}`,title:"",onMouseDown:ce=>ce.stopPropagation(),children:i.jsx(Os,{size:14})}),i.jsxs("div",{className:"flex flex-col gap-0.5 ml-1",children:[i.jsx("button",{onClick:()=>{var Xe;const ce=[...((Xe=n.settings)==null?void 0:Xe.shots)||[]],He=ce.findIndex(Re=>Re.id===B.id);He>0&&([ce[He-1],ce[He]]=[ce[He],ce[He-1]],Be(n.id,{shots:ce}))},disabled:ze===0,className:`p-0.5 rounded transition-colors ${ze===0?"opacity-30 cursor-not-allowed":""} ${e==="dark"?"text-zinc-500 hover:text-blue-400 hover:bg-zinc-800":"text-zinc-400 hover:text-blue-500 hover:bg-zinc-100"}`,title:"",onMouseDown:ce=>ce.stopPropagation(),children:i.jsx(Xp,{size:12})}),i.jsx("button",{onClick:()=>{var Xe;const ce=[...((Xe=n.settings)==null?void 0:Xe.shots)||[]],He=ce.findIndex(Re=>Re.id===B.id);He<ce.length-1&&([ce[He],ce[He+1]]=[ce[He+1],ce[He]],Be(n.id,{shots:ce}))},disabled:ze===(((Nt=(ut=n.settings)==null?void 0:ut.shots)==null?void 0:Nt.length)||0)-1,className:`p-0.5 rounded transition-colors ${ze===(((je=(rt=n.settings)==null?void 0:rt.shots)==null?void 0:je.length)||0)-1?"opacity-30 cursor-not-allowed":""} ${e==="dark"?"text-zinc-500 hover:text-blue-400 hover:bg-zinc-800":"text-zinc-400 hover:text-blue-500 hover:bg-zinc-100"}`,title:"",onMouseDown:ce=>ce.stopPropagation(),children:i.jsx(Rs,{size:12})})]})]})]}),((fe=n.settings)==null?void 0:fe.showOutputPreview)&&i.jsxs("div",{className:`w-[160px] shrink-0 p-2 ml-1 flex flex-col gap-2 rounded-lg border transition-all ${e==="dark"?"bg-zinc-900/50 border-zinc-800":"bg-white border-zinc-200"} ${B.outputEnabled?e==="dark"?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-300":""}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:`w-4 h-4 rounded border cursor-pointer flex items-center justify-center transition-colors ${B.outputEnabled?"bg-blue-500 border-blue-500 text-white":e==="dark"?"border-zinc-600 hover:border-blue-400":"border-zinc-400 hover:border-blue-400"}`,onClick:ce=>{ce.stopPropagation(),qt(n.id,B.id,{outputEnabled:!B.outputEnabled})},title:B.outputEnabled?"":"",children:B.outputEnabled&&i.jsx(Ll,{size:10})}),i.jsx("span",{className:`text-[10px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:((me=B.output_images)==null?void 0:me.length)>0?"":""})]}),(()=>{var cn;const ce=B.output_images||[],He=B.selectedImageIndex??0;if((((cn=n.settings)==null?void 0:cn.mode)||"video")==="video")return i.jsxs("div",{className:`flex-1 min-h-[80px] rounded overflow-hidden relative group/preview cursor-pointer border ${e==="dark"?"border-zinc-800 bg-black":"border-zinc-200 bg-zinc-50"}`,onClick:en=>{en.stopPropagation(),B.video_url&&xn({url:B.video_url,type:"video",prompt:B.prompt})},children:[B.video_url?i.jsx("video",{src:B.video_url,className:"w-full h-full object-cover",muted:!0}):i.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30",children:i.jsx(Pg,{size:16})}),B.video_url&&i.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/preview:opacity-100 flex items-center justify-center transition-opacity",children:i.jsx(Ds,{size:16,className:"text-white drop-shadow-md"})}),B.video_filename&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity",title:B.video_filename,children:B.video_filename})]});const Re=B.outputEnabled,De=He>=0,Ut=De?He:0;if(ce.length>=2)if(Me){const en=ce[Ut]||ce[0],Ee=ce.slice(0,4).map((Le,Qe)=>({img:Le,idx:Qe})).filter(Le=>Le.idx!==Ut);return i.jsxs("div",{className:"flex flex-col gap-1 flex-1 min-h-[100px]",children:[i.jsxs("div",{className:`relative flex-1 rounded border overflow-hidden transition-all group/main ${De?"border-blue-500 ring-1 ring-blue-500/50":e==="dark"?"border-zinc-700":"border-zinc-300"} ${Re?"cursor-not-allowed opacity-80":"cursor-pointer"}`,onClick:Le=>{Le.stopPropagation(),Re||qt(n.id,B.id,{selectedImageIndex:De?-1:Ut})},onDoubleClick:Le=>{var Qe,Et;Le.stopPropagation(),xn({url:en,type:"image",prompt:B.prompt,mjImages:ce,selectedMjImageIndex:Ut,storyboardContext:{nodeId:n.id,shotId:B.id,shotIndex:(((Qe=n.settings)==null?void 0:Qe.shots)||[]).findIndex(Ft=>Ft.id===B.id),allShots:((Et=n.settings)==null?void 0:Et.shots)||[]}})},onContextMenu:Le=>{hl(Le,{url:en,type:"image",prompt:B.prompt,mjImages:ce,selectedMjImageIndex:Ut,sourceNode:n})},children:[i.jsx(Vn,{src:en,className:"w-full h-full object-cover"}),i.jsx("div",{className:`absolute top-0 left-0 text-[8px] px-1 py-0.5 rounded-br ${De?"bg-blue-500 text-white":"bg-black/50 text-white"}`,children:Ut+1}),De&&i.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white p-0.5 rounded-bl",children:i.jsx(Ll,{size:10})}),Re&&i.jsx("div",{className:"absolute top-1 right-1 bg-yellow-500 text-black p-0.5 rounded text-[8px]",children:""}),i.jsx("button",{onClick:Le=>{var Qe,Et;Le.stopPropagation(),xn({url:en,type:"image",prompt:B.prompt,mjImages:ce,selectedMjImageIndex:Ut,storyboardContext:{nodeId:n.id,shotId:B.id,shotIndex:(((Qe=n.settings)==null?void 0:Qe.shots)||[]).findIndex(Ft=>Ft.id===B.id),allShots:((Et=n.settings)==null?void 0:Et.shots)||[]}})},className:"absolute bottom-0 left-0 p-0.5 rounded-tr bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover/main:opacity-100 transition-opacity z-10",title:"",children:i.jsx(Ds,{size:10})})]}),i.jsx("div",{className:"flex gap-1 h-10 shrink-0",children:Ee.map(({img:Le,idx:Qe})=>i.jsxs("div",{className:`relative flex-1 rounded border overflow-hidden transition-all group/thumb ${e==="dark"?"border-zinc-700":"border-zinc-300"} ${Re?"cursor-not-allowed opacity-60":"cursor-pointer hover:border-blue-400"}`,onClick:Et=>{Et.stopPropagation(),Re||qt(n.id,B.id,{selectedImageIndex:Qe})},onContextMenu:Et=>{hl(Et,{url:Le,type:"image",prompt:B.prompt,mjImages:ce,selectedMjImageIndex:Qe,sourceNode:n})},children:[i.jsx(Vn,{src:Le,className:"w-full h-full object-cover"}),i.jsx("div",{className:"absolute top-0 left-0 bg-black/50 text-white text-[7px] px-0.5",children:Qe+1})]},Qe))})]})}else return i.jsx("div",{className:"grid grid-cols-2 gap-1 flex-1 min-h-[100px]",children:ce.slice(0,4).map((en,Ee)=>i.jsxs("div",{className:`relative rounded border overflow-hidden transition-all group/cell ${He===Ee?"border-blue-500 ring-1 ring-blue-500/50":e==="dark"?"border-zinc-700":"border-zinc-300"} ${Re?"cursor-not-allowed opacity-80":"cursor-pointer hover:border-blue-400"}`,onClick:Le=>{Le.stopPropagation(),Re||qt(n.id,B.id,{selectedImageIndex:He===Ee?-1:Ee})},onDoubleClick:Le=>{var Qe,Et;Le.stopPropagation(),xn({url:en,type:"image",prompt:B.prompt,mjImages:ce,selectedMjImageIndex:Ee,storyboardContext:{nodeId:n.id,shotId:B.id,shotIndex:(((Qe=n.settings)==null?void 0:Qe.shots)||[]).findIndex(Ft=>Ft.id===B.id),allShots:((Et=n.settings)==null?void 0:Et.shots)||[]}})},onContextMenu:Le=>{hl(Le,{url:en,type:"image",prompt:B.prompt,mjImages:ce,selectedMjImageIndex:Ee,sourceNode:n})},children:[i.jsx(Vn,{src:en,className:"w-full h-full object-cover"}),i.jsx("div",{className:`absolute top-0 left-0 text-[7px] px-0.5 rounded-br ${He===Ee?"bg-blue-500 text-white":"bg-black/50 text-white"}`,children:Ee+1}),He===Ee&&i.jsx("div",{className:"absolute top-0 right-0 bg-blue-500 text-white p-0.5 rounded-bl",children:i.jsx(Ll,{size:8})}),i.jsx("button",{onClick:Le=>{var Qe,Et;Le.stopPropagation(),xn({url:en,type:"image",prompt:B.prompt,mjImages:ce,selectedMjImageIndex:Ee,storyboardContext:{nodeId:n.id,shotId:B.id,shotIndex:(((Qe=n.settings)==null?void 0:Qe.shots)||[]).findIndex(Ft=>Ft.id===B.id),allShots:((Et=n.settings)==null?void 0:Et.shots)||[]}})},className:"absolute bottom-0 left-0 p-0.5 rounded-tr bg-black/60 text-white hover:bg-blue-500 opacity-0 group-hover/cell:opacity-100 transition-opacity z-10",title:"",children:i.jsx(Ds,{size:8})})]},Ee))});const Tt=ce[0]||B.output_url;return i.jsxs("div",{className:`flex-1 min-h-[80px] rounded overflow-hidden relative group/preview cursor-pointer border ${e==="dark"?"border-zinc-800 bg-black":"border-zinc-200 bg-zinc-50"}`,onClick:en=>{en.stopPropagation(),Tt&&xn({url:Tt,type:"image",prompt:B.prompt})},onContextMenu:en=>{Tt&&hl(en,{url:Tt,type:"image",prompt:B.prompt,sourceNode:n})},children:[Tt?i.jsx(Vn,{src:Tt,className:"w-full h-full object-cover"}):i.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-30",children:i.jsx(Pg,{size:16})}),Tt&&i.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover/preview:opacity-100 flex items-center justify-center transition-opacity",children:i.jsx(Ds,{size:16,className:"text-white drop-shadow-md"})}),B.image_filename&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[8px] px-1 py-0.5 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity",title:B.image_filename,children:B.image_filename})]})})()]})]})]},B.id)}):i.jsxs("div",{className:`flex flex-col items-center justify-center h-40 gap-3 rounded-lg border-2 border-dashed ${e==="dark"?"border-zinc-800 text-zinc-600":"border-zinc-300 text-zinc-400"}`,children:[i.jsx(Il,{size:32,className:"opacity-50"}),i.jsx("span",{className:"text-xs",children:""})]})}),i.jsx("div",{className:`p-3 border-t shrink-0 ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:i.jsxs("button",{onClick:()=>Eb(n.id),className:`w-full py-2 border border-dashed text-xs rounded transition-colors flex items-center justify-center gap-2 ${e==="dark"?"border-zinc-700 text-zinc-400 hover:bg-zinc-800 hover:text-zinc-200":"border-zinc-300 text-zinc-500 hover:bg-white hover:text-blue-600 hover:border-blue-400"}`,onMouseDown:B=>B.stopPropagation(),children:[i.jsx(Vi,{size:14})," "]})})]})})})(),n.type==="image-compare"&&i.jsx("div",{className:"w-full h-full pointer-events-auto",children:i.jsx(Ez,{img1:p[0],img2:p[1]})}),n.type==="preview"&&i.jsxs("div",{className:"flex flex-col h-full pointer-events-auto",children:[i.jsxs("div",{className:`flex items-center justify-between px-3 py-2 border-b text-xs font-semibold ${e==="dark"?"border-zinc-800 text-zinc-200":"border-zinc-200 text-zinc-700"}`,children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx(Ds,{size:13,className:"text-blue-500"}),i.jsx("span",{children:""})]}),i.jsx("span",{className:"text-[10px] text-zinc-500",children:n.previewType==="video"?"":""})]}),i.jsxs("div",{className:"flex-1 flex flex-col p-2 gap-2 min-h-0",children:[i.jsx("div",{className:`relative flex-1 rounded-lg overflow-hidden flex items-center justify-center min-h-0 ${e==="dark"?"bg-zinc-900":"bg-zinc-100"}`,onContextMenu:O=>{const de=n.content||n.previewMjImages&&n.previewMjImages[0];de&&hl(O,{url:de,type:n.previewType||(Un(de)?"video":"image"),sourceNode:n})},onDoubleClick:O=>{O.stopPropagation(),O.preventDefault();const de=n.content||n.previewMjImages&&n.previewMjImages[0];de&&xn({url:de,type:n.previewType||(Un(de)?"video":"image")})},children:n.content||n.previewMjImages&&n.previewMjImages.length>0?Un(n.content)||n.previewType==="video"?i.jsx("video",{src:n.content,className:"w-full h-full object-contain bg-black",controls:!0,draggable:!1}):n.previewMjImages&&(n.previewMjImages.length===4||n.previewMjImages.length>1)?i.jsx("div",{className:`w-full h-full grid gap-0.5 p-0.5 ${n.previewMjImages.length===4?"grid-cols-2 grid-rows-2":"grid-cols-2"}`,children:n.previewMjImages.map((O,de)=>i.jsx("div",{className:"relative w-full h-full overflow-hidden bg-black flex items-center justify-center group",children:i.jsx("img",{src:O,className:"max-w-full max-h-full w-auto h-auto object-contain",alt:` ${de+1}`,draggable:!1,onError:Fe=>{console.error(` ${de+1} `),Fe.target.style.display="none"}})},de))}):i.jsxs("div",{className:"w-full h-full relative group/preview",children:[i.jsx(Vn,{src:n.content||n.previewMjImages&&n.previewMjImages[0],className:"w-full h-full object-contain bg-black",draggable:!1,onError:O=>{console.warn("[Preview] Image load error")}}),n.previewFilename&&i.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] px-2 py-1 truncate opacity-0 group-hover/preview:opacity-100 transition-opacity backdrop-blur-sm",title:n.previewFilename,children:n.previewFilename})]}):i.jsxs("div",{className:"flex flex-col items-center justify-center text-[11px] text-zinc-500",children:[i.jsx(da,{className:"w-6 h-6 mb-1 text-zinc-400"}),i.jsx("span",{children:" AI  / AI  "}),i.jsx("span",{children:""})]})}),i.jsxs("div",{className:"flex items-center justify-between gap-2 text-[11px]",children:[i.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:O=>O.stopPropagation(),onClick:async()=>{if(n.content)try{await navigator.clipboard.writeText(n.content)}catch{}},children:[i.jsx(ua,{size:13}),""]}),i.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:O=>O.stopPropagation(),onClick:async()=>{if(!n.content)return;const O=mn(n.x+n.width+100,n.y+n.height/2);let de;if(!Un(n.content))try{const Fe=await Wr(n.content);Fe!=null&&Fe.w&&(Fe!=null&&Fe.h)&&(de={w:Fe.w,h:Fe.h})}catch{}$r("input-image",O.x,O.y,null,n.content,de)},children:[i.jsx(wu,{size:13}),""]}),i.jsxs("button",{className:`flex-1 inline-flex items-center justify-center gap-1 px-2 py-1 rounded border ${e==="dark"?"border-zinc-700 text-zinc-200 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onMouseDown:O=>O.stopPropagation(),onClick:()=>{if(!n.content)return;const O={name:n.previewType==="video"?"Preview.mp4":"Preview.png",type:n.previewType==="video"?"video/mp4":"image/png",content:n.content,isImage:n.previewType!=="video",isVideo:n.previewType==="video",isAudio:!1,fromPreview:!0};Je(de=>[...de,O]),Ks(!0)},children:[i.jsx(pa,{size:13}),""]})]})]})]}),(n.type==="gen-image"||n.type==="gen-video")&&(()=>{var Ct,Ot,wt,Lt,pt,ft,kt,ot,Mt,Dt,Rt,zt,yn,En;const O=dt.find(Z=>Z.sourceNodeId===n.id&&(Z.status==="generating"||Z.status==="completed")),de=O&&O.status==="generating",Fe=O!=null&&O.durationMs?(O.durationMs/1e3).toFixed(1):null,mt=yh[n.id]||0;return i.jsxs("div",{className:"p-3 flex flex-col h-full pointer-events-auto",children:[(de||Fe)&&i.jsx("div",{className:`mb-2 px-2 py-1 rounded text-[10px] font-mono text-center ${e==="dark"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-blue-50 text-blue-600 border border-blue-200"}`,children:de?i.jsxs("span",{children:[" ",mt.toFixed(1),"s"]}):i.jsxs("span",{children:["  ",Fe,"s"]})}),i.jsxs("div",{className:`flex items-center gap-1.5 mb-2 text-xs font-semibold shrink-0 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[n.type==="gen-image"?i.jsx(Fg,{size:12,className:"text-blue-400"}):i.jsx(zu,{size:12,className:"text-purple-400"}),i.jsx("span",{children:n.type==="gen-image"?"AI ":"AI "})]}),p.length>0&&i.jsxs("div",{className:`mb-2 rounded-lg border p-2 relative group/ref ${e==="dark"?"bg-zinc-900/50 border-purple-500/20":"bg-violet-50 border-violet-200"}`,children:[i.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[i.jsxs("span",{className:`text-[10px] font-medium flex items-center gap-1 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[i.jsx(Dg,{size:10}),""]}),i.jsxs("span",{className:"text-[9px] font-mono text-zinc-500",children:[p.length,"/10"]})]}),i.jsx("div",{className:"flex -space-x-2 overflow-visible pb-1 items-center custom-scrollbar pl-1",children:p.map((Z,re)=>i.jsx("div",{className:"relative shrink-0 flex flex-col items-center gap-0 ",children:i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute -top-1 -left-1 w-4 h-4 text-[9px] font-semibold rounded-full bg-zinc-700 text-white select-none flex items-center justify-center border border-white/70 shadow-sm leading-none pointer-events-none",style:{zIndex:30},children:re+1}),i.jsx("div",{className:`relative w-8 h-8 rounded-full border-2 thumb-stack-item cursor-pointer overflow-hidden ${e==="dark"?"border-[#18181b] bg-zinc-800":"border-white bg-zinc-200"}`,style:{zIndex:10-re},children:i.jsx(Vn,{src:Z,className:"w-full h-full object-cover"})})]})},re))})]}),i.jsxs("div",{className:`rounded-lg p-3 mb-2 border focus-within:border-blue-500/30 transition-colors flex-1 flex flex-col ${e==="dark"?"bg-zinc-950/50 border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[n.type==="gen-image"&&(()=>{const Z=n==null?void 0:n.maskContent;let re=u.find(Ae=>Ae.to===n.id&&(!Ae.inputType||Ae.inputType==="default"));re||(re=u.find(Ae=>Ae.to===n.id));const Ie=re?At.get(re.from):null,at=Ie&&Ie.maskContent;return Z||at?i.jsxs("div",{className:`flex items-center gap-1.5 mb-2 px-2 py-1 rounded text-[10px] font-medium ${e==="dark"?"bg-purple-900/30 text-purple-300 border border-purple-800":"bg-purple-50 text-purple-600 border border-purple-200"}`,children:[i.jsx(E1,{size:12}),i.jsx("span",{children:at?"":""})]}):null})(),i.jsxs("div",{className:"flex items-start gap-2 mb-1 flex-1 h-full min-h-0",children:[i.jsx("textarea",{className:`flex-1 h-full bg-transparent text-xs outline-none resize-none custom-scrollbar ${e==="dark"?"text-zinc-300 placeholder-zinc-600":"text-zinc-800 placeholder-zinc-400"}`,placeholder:"...",value:n.type==="gen-image"?((Ct=n.settings)==null?void 0:Ct.prompt)||"":((Ot=n.settings)==null?void 0:Ot.videoPrompt)||"",onChange:Z=>Be(n.id,n.type==="gen-image"?{prompt:Z.target.value}:{videoPrompt:Z.target.value}),onMouseDown:Z=>Z.stopPropagation()}),n.type==="gen-video"&&(((wt=n.settings)==null?void 0:wt.model)==="sora-2"||((Lt=n.settings)==null?void 0:Lt.model)==="sora-2-pro")&&On.length>0&&i.jsx("div",{className:"relative shrink-0",children:i.jsx("button",{onClick:Z=>{Z.stopPropagation(),Jo(!0)},className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:i.jsx(ku,{size:14})})})]})]}),n.type==="gen-video"&&(()=>{var ct,bn;const Z=((ct=n.settings)==null?void 0:ct.model)||"",re=fn.get(Z),Ie=(re==null?void 0:re.modelName)||(re==null?void 0:re.id)||Z;if(!(Ie&&(Ie.includes("sora")||Z.includes("sora")))||On.length===0)return null;const se=((bn=n.settings)==null?void 0:bn.videoPrompt)||"",Ae=mh[n.id]||!1,vt=5,Qt=On.length>vt;return i.jsx("div",{className:"border-t border-dashed mt-1",style:{borderColor:e==="dark"?"rgba(63, 63, 70, 0.5)":"rgba(161, 161, 170, 0.5)"},children:i.jsxs("div",{className:"flex items-center justify-between py-1 px-1",children:[i.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 flex-1 custom-scrollbar",children:(Ae?On:On.slice(0,vt)).map(Kt=>{const B=`@${Kt.username}`,ze=se.includes(B);return i.jsxs("button",{onClick:Me=>{Me.stopPropagation();let Ge=se||"";ze?Ge=Ge.replace(B,"").replace(/\s{2,}/g," ").trim():(Ge=Ge.trim(),Ge=Ge?`${Ge} ${B} `:`${B} `),Be(n.id,{videoPrompt:Ge})},className:`relative shrink-0 transition-all ${ze?"scale-110":"opacity-70 hover:opacity-100"}`,title:Kt.username,children:[i.jsx(Vn,{src:Kt.localCacheUrl||Kt.profile_picture_url||"",alt:Kt.username,className:`w-8 h-8 rounded-full object-cover border-2 ${ze?"border-blue-500 ring-2 ring-blue-500":"border-transparent"}`,onError:Me=>{Me.target.style.display="none"}}),i.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 bg-black/50 rounded-full p-0.5",children:i.jsx($l,{size:8,className:"text-green-400"})})]},Kt.id)})}),Qt&&i.jsx("button",{onClick:Kt=>{Kt.stopPropagation(),Ae?Ec(B=>{const ze={...B};return delete ze[n.id],ze}):(Jo(!0),Ec(B=>({...B,[n.id]:!0})))},className:`shrink-0 px-2 py-1 text-[10px] rounded transition-colors ml-2 ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,title:Ae?"":"",children:Ae?"":`+${On.length-vt}`})]})})})(),n.type==="gen-image"&&(()=>{var Ie;const Z=fn.get((Ie=n.settings)==null?void 0:Ie.model);return Z&&(Z.id.includes("mj")||Z.provider.toLowerCase().includes("midjourney"))})()&&(()=>{var Ie,at;const Z=Vc(n.id,"oref"),re=Vc(n.id,"sref");return i.jsxs("div",{className:"flex flex-col gap-1.5 mb-2 relative","data-mj-instructions":"true",children:[i.jsxs("div",{className:"relative flex items-center gap-1.5","data-mj-oref":"true",children:[i.jsx("div",{className:`input-point ${Z?"connected":""} ${hn===n.id&&ps==="oref"?"active":""}`,title:"oref",onMouseDown:se=>{se.stopPropagation(),se.preventDefault();const Ae=mn(se.clientX,se.clientY);Es(Ae),ds(n.id),fs("oref")},onMouseUp:se=>Ms(n.id,se,"oref"),"data-input-type":"oref",style:{position:"absolute",top:"50%",left:"-0.25rem",transform:"translateY(-50%)",width:"0.5rem",height:"0.5rem",marginRight:"0.25rem",zIndex:20,cursor:"crosshair"}}),i.jsxs("div",{className:"flex items-center gap-1.5 flex-1 ml-2",children:[i.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"oref"}),Z&&i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]})]}),i.jsxs("div",{className:"relative flex items-center gap-1.5",children:[i.jsx("div",{className:"w-0.5rem h-0.5rem mr-0.25rem ml-2"}),i.jsxs("div",{className:"flex items-center gap-1.5 flex-1",children:[i.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"ow"}),((Ie=n.settings)==null?void 0:Ie.mjOw)&&n.settings.mjOw>0&&i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]}),i.jsx("input",{type:"number",min:"1",max:"1000",placeholder:"1-1000",value:((at=n.settings)==null?void 0:at.mjOw)||"",onChange:se=>{const Ae=parseInt(se.target.value,10);isNaN(Ae)||Ae<1?Be(n.id,{mjOw:""}):Ae>1e3?Be(n.id,{mjOw:1e3}):Be(n.id,{mjOw:Ae})},onMouseDown:se=>se.stopPropagation(),className:`flex-1 px-2 py-1 rounded text-[10px] border outline-none focus:border-blue-500/50 ${e==="dark"?"bg-zinc-900/50 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`})]}),i.jsxs("div",{className:"relative flex items-center gap-1.5","data-mj-sref":"true",children:[i.jsx("div",{className:`input-point ${re?"connected":""} ${hn===n.id&&ps==="sref"?"active":""}`,title:"sref",onMouseDown:se=>{se.stopPropagation(),se.preventDefault();const Ae=mn(se.clientX,se.clientY);Es(Ae),ds(n.id),fs("sref")},onMouseUp:se=>Ms(n.id,se,"sref"),"data-input-type":"sref",style:{position:"absolute",top:"50%",left:"-0.25rem",transform:"translateY(-50%)",width:"0.5rem",height:"0.5rem",marginRight:"0.25rem",zIndex:20,cursor:"crosshair"}}),i.jsxs("div",{className:"flex items-center gap-1.5 flex-1 ml-2",children:[i.jsx("span",{className:`text-[10px] font-medium ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:"sref"}),re&&i.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500"})]})]})]})})(),n.type==="gen-image"&&E&&i.jsxs("div",{className:`mb-2 rounded-lg border p-3 space-y-2 ${e==="dark"?"bg-zinc-900/50 border-zinc-800":"bg-white border-zinc-200"}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("button",{className:"flex items-center gap-1 text-[11px] font-semibold",onClick:()=>P1(Z=>!Z),onMouseDown:Z=>Z.stopPropagation(),children:[i.jsx("span",{className:e==="dark"?"text-zinc-200":"text-zinc-700",children:""}),i.jsx(fa,{size:12,className:`transition-transform ${ih?"":"rotate-90"} ${e==="dark"?"text-zinc-400":"text-zinc-500"}`})]}),i.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[i.jsxs("span",{className:"text-zinc-500",children:[Ha.length," "]}),i.jsx("button",{className:`px-2 py-0.5 rounded text-[10px] border ${e==="dark"?"border-zinc-700 text-zinc-300 hover:bg-zinc-800":"border-zinc-300 text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>A1(Z=>!Z),onMouseDown:Z=>Z.stopPropagation(),children:Dd?"":""})]})]}),!ih&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"max-h-36 overflow-y-auto custom-scrollbar flex flex-wrap gap-2",children:[Ha.map(Z=>i.jsxs("div",{className:`border rounded-lg px-2 py-1.5 flex items-center gap-2 text-[11px] ${e==="dark"?"border-zinc-700 bg-zinc-950/50 text-zinc-200":"border-zinc-200 bg-zinc-50 text-zinc-700"}`,children:[i.jsx("span",{className:"font-medium whitespace-nowrap",children:Z.name}),i.jsx("button",{onClick:()=>Ob(n.id,Z.prompt),className:"px-2 py-0.5 rounded text-[10px] bg-blue-600 text-white hover:bg-blue-500 transition-colors",onMouseDown:re=>re.stopPropagation(),children:""}),Dd&&i.jsx("button",{onClick:()=>Db(Z.id),className:`px-2 py-0.5 rounded text-[10px] border ${e==="dark"?"border-red-500/50 text-red-400 hover:bg-red-500/10":"border-red-200 text-red-600 hover:bg-red-50"}`,onMouseDown:re=>re.stopPropagation(),children:""})]},Z.id)),Ha.length===0&&i.jsx("div",{className:`text-[11px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:""})]}),Dd&&i.jsxs("div",{className:"grid grid-cols-1 gap-1.5",children:[i.jsx("input",{type:"text",value:kc.name,onChange:Z=>Rd(re=>({...re,name:Z.target.value})),placeholder:"",className:`w-full px-2 py-1 text-[11px] rounded border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder:text-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder:text-zinc-400"}`,onMouseDown:Z=>Z.stopPropagation()}),i.jsx("textarea",{value:kc.prompt,onChange:Z=>Rd(re=>({...re,prompt:Z.target.value})),placeholder:"...",className:`w-full min-h-[70px] px-2 py-1 text-[11px] rounded border resize-none custom-scrollbar ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder:text-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder:text-zinc-400"}`,onMouseDown:Z=>Z.stopPropagation()}),i.jsx("button",{onClick:Rb,className:"w-full py-1.5 rounded text-[11px] font-medium bg-blue-600 hover:bg-blue-500 text-white transition-colors",onMouseDown:Z=>Z.stopPropagation(),children:""})]})]})]}),i.jsxs("div",{className:`mt-auto pt-2 flex items-center justify-between shrink-0 relative gap-2 border-t ${e==="dark"?"border-zinc-800/50":"border-zinc-200"}`,children:[i.jsxs("div",{className:"relative flex-1 min-w-0",children:[i.jsxs("button",{title:(ft=fn.get((pt=n.settings)==null?void 0:pt.model))==null?void 0:ft.provider,onClick:Z=>{Z.stopPropagation(),ln((Ke==null?void 0:Ke.type)==="model"?null:{nodeId:n.id,type:"model"})},className:`flex items-center gap-2 pl-1 pr-2 py-1 rounded text-[10px] transition-colors border w-full ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-300 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-700 border-zinc-300"}`,children:[i.jsx("span",{className:`w-2 h-2 rounded-full ${Ts((kt=n.settings)==null?void 0:kt.model)}`}),i.jsx("span",{className:"truncate font-mono",children:((Mt=fn.get((ot=n.settings)==null?void 0:ot.model))==null?void 0:Mt.id)||"Model"})]}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="model"&&i.jsxs("div",{className:`absolute bottom-full left-0 mb-1 w-96 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Z=>Z.stopPropagation(),onMouseLeave:()=>Zn(null),children:[i.jsx("div",{className:`w-36 border-r pr-1 max-h-64 overflow-y-auto custom-scrollbar flex flex-col justify-end ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(pr).filter(([,Z])=>Z.models.some(re=>re.type===(n.type==="gen-image"?"Image":"Video"))).map(([Z,re])=>i.jsxs("button",{onMouseEnter:()=>Zn(Z),className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left text-[10px] transition-colors ${zn===Z?e==="dark"?"bg-zinc-700 text-zinc-100":"bg-zinc-200 text-zinc-900":e==="dark"?"hover:bg-zinc-800 text-zinc-400":"hover:bg-zinc-100 text-zinc-600"}`,children:[i.jsx("span",{className:"truncate font-medium",children:re.name}),i.jsx(fa,{size:10,className:"opacity-50"})]},Z))}),i.jsxs("div",{className:"flex-1 pl-1 max-h-64 overflow-y-auto custom-scrollbar flex flex-col justify-end",children:[zn&&((Dt=pr[zn])==null?void 0:Dt.models.filter(Z=>Z.type===(n.type==="gen-image"?"Image":"Video")).map(Z=>{var re;return i.jsxs("button",{onClick:()=>{const Ie={model:Z.id};if(Z.id==="grok-3"&&(Ie.ratio="3:2",Ie.duration="8s",Ie.resolution="1080P"),Be(n.id,Ie),n.type==="gen-image"){Qd(Z.id);try{localStorage.setItem("tapnow_last_image_model",Z.id)}catch{}}else if(n.type==="gen-video"){ep(Z.id);try{localStorage.setItem("tapnow_last_video_model",Z.id)}catch{}}ln(null),Zn(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${((re=n.settings)==null?void 0:re.model)===Z.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[i.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:Z.id}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(Z.id)}`})]},Z.id)})),!zn&&i.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]}),n.type==="gen-image"&&(()=>{var re;const Z=fn.get((re=n.settings)==null?void 0:re.model);return Z&&(Z.id.includes("mj")||Z.provider.toLowerCase().includes("midjourney"))})()&&i.jsxs("div",{className:"relative flex-1 min-w-0",children:[i.jsx("button",{title:((Rt=ef.find(Z=>{var re;return Z.value===((re=n.settings)==null?void 0:re.mjVersion)}))==null?void 0:Rt.label)||"MJ V7",onClick:Z=>{Z.stopPropagation(),ln((Ke==null?void 0:Ke.type)==="mjVersion"&&Ke.nodeId===n.id?null:{nodeId:n.id,type:"mjVersion"})},className:`flex items-center gap-2 pl-1 pr-2 py-1 rounded text-[10px] transition-colors border w-full ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-300 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-700 border-zinc-300"}`,children:i.jsx("span",{className:"truncate",children:((zt=ef.find(Z=>{var re;return Z.value===((re=n.settings)==null?void 0:re.mjVersion)}))==null?void 0:zt.label)||"MJ V7"})}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="mjVersion"&&i.jsx("div",{className:`absolute bottom-full left-0 mb-1 w-32 rounded-lg shadow-xl p-1 z-[60] border max-h-64 overflow-y-auto custom-scrollbar ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Z=>Z.stopPropagation(),children:ef.map(Z=>{var re,Ie;return i.jsxs("button",{onClick:()=>{Be(n.id,{mjVersion:Z.value}),ln(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"} ${((re=n.settings)==null?void 0:re.mjVersion)===Z.value?e==="dark"?"bg-zinc-800":"bg-zinc-100":""}`,children:[i.jsx("span",{className:"text-xs font-medium",children:Z.label}),((Ie=n.settings)==null?void 0:Ie.mjVersion)===Z.value&&i.jsx("svg",{className:"w-3 h-3 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},Z.value)})})]}),i.jsxs("div",{className:"flex gap-1 shrink-0",children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:Z=>{Z.stopPropagation(),ln((Ke==null?void 0:Ke.type)==="ratio"&&Ke.nodeId===n.id?null:{nodeId:n.id,type:"ratio"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:((yn=n.settings)==null?void 0:yn.ratio)||"Auto"}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="ratio"&&i.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-20 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Z=>Z.stopPropagation(),children:Zg((En=n.settings)==null?void 0:En.model).map(Z=>i.jsx("button",{onClick:()=>{Be(n.id,{ratio:Z}),V1(Z);try{localStorage.setItem("tapnow_last_ratio",Z)}catch{}ln(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:Z},Z))})]}),n.type==="gen-video"&&(()=>{var at,se;const Z=fn.get((at=n.settings)==null?void 0:at.model);return((Z==null?void 0:Z.id)||(Z==null?void 0:Z.modelName)||"").includes("grok")?i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:Ae=>{Ae.stopPropagation(),ln((Ke==null?void 0:Ke.type)==="vres"&&Ke.nodeId===n.id?null:{nodeId:n.id,type:"vres"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:Ul(((se=n.settings)==null?void 0:se.resolution)||"720P")}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="vres"&&i.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-24 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:Ae=>Ae.stopPropagation(),children:M1.map(Ae=>i.jsx("button",{onClick:()=>{Be(n.id,{resolution:Ae}),bh(Ae);try{localStorage.setItem("tapnow_last_video_res",Ae)}catch{}ln(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:Ae},Ae))})]}):null})(),n.type==="gen-image"&&(()=>{var Ie;const Z=fn.get((Ie=n.settings)==null?void 0:Ie.model);return!(Z&&(Z.id.includes("mj")||Z.provider.toLowerCase().includes("midjourney")))})()?i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:Z=>{Z.stopPropagation(),ln((Ke==null?void 0:Ke.type)==="res"&&Ke.nodeId===n.id?null:{nodeId:n.id,type:"res"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:(()=>{var vt,Qt;const Z=fn.get((vt=n.settings)==null?void 0:vt.model),re=(Z==null?void 0:Z.id)||(Z==null?void 0:Z.modelName)||"",Ie=Qp(re),at=((Qt=n.settings)==null?void 0:Qt.resolution)||"2K",se=Tl(at),Ae=Ie.includes(se)?se:Ie[0]||"2K";return at!==se&&Ie.includes(se)?setTimeout(()=>{Be(n.id,{resolution:se})},0):!Ie.includes(se)&&Ie.length>0&&setTimeout(()=>{Be(n.id,{resolution:Ie[0]})},0),Ae})()}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="res"&&(()=>{var at;const Z=fn.get((at=n.settings)==null?void 0:at.model),re=(Z==null?void 0:Z.id)||(Z==null?void 0:Z.modelName)||"",Ie=Qp(re);return i.jsx("div",{className:`absolute bottom-full right-0 mb-1 w-24 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:se=>se.stopPropagation(),children:Ie.map(se=>i.jsx("button",{onClick:()=>{Be(n.id,{resolution:se}),K1(se);try{localStorage.setItem("tapnow_last_image_res",se)}catch{}ln(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:se},se))})})()]}):(()=>{var Ie,at,se,Ae,vt,Qt,ct,bn,Kt,B,ze,Me,Ge,qe;const Z=fn.get((Ie=n.settings)==null?void 0:Ie.model);return Z&&(Z.id.includes("mj")||Z.provider.toLowerCase().includes("midjourney"))?null:i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:ut=>{ut.stopPropagation(),ln((Ke==null?void 0:Ke.type)==="duration"&&Ke.nodeId===n.id?null:{nodeId:n.id,type:"duration"})},className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border ${e==="dark"?"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,children:((at=n.settings)==null?void 0:at.duration)||"5s"}),(Ke==null?void 0:Ke.nodeId)===n.id&&Ke.type==="duration"&&i.jsx("div",{className:`absolute bottom-full left-1/2 -translate-x-1/2 mb-1 w-20 rounded-lg shadow-xl p-1 z-[60] border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseDown:ut=>ut.stopPropagation(),children:(((se=Te.find(ut=>{var Nt;return ut.id===((Nt=n.settings)==null?void 0:Nt.model)}))==null?void 0:se.durations)||["5s","10s"]).map(ut=>i.jsx("button",{onClick:()=>{Be(n.id,{duration:ut}),ln(null)},className:`w-full text-center py-1 text-[10px] rounded ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:ut},ut))})]}),(((vt=(Ae=n.settings)==null?void 0:Ae.model)==null?void 0:vt.includes("jimeng"))||((bn=(ct=fn.get((Qt=n.settings)==null?void 0:Qt.model))==null?void 0:ct.modelName)==null?void 0:bn.includes("jimeng"))||((B=(Kt=n.settings)==null?void 0:Kt.model)==null?void 0:B.includes("grok")))&&i.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[i.jsx("span",{className:"text-[10px] opacity-70",children:""}),i.jsx("div",{className:"flex bg-zinc-100 dark:bg-zinc-800 rounded p-0.5 border dark:border-zinc-700",children:["720p","1080p"].map(ut=>{var Nt;return i.jsx("button",{onClick:rt=>{rt.stopPropagation(),Be(n.id,{resolution:ut})},onMouseDown:rt=>rt.stopPropagation(),className:`text-[10px] px-2 py-0.5 rounded transition-all ${(((Nt=n.settings)==null?void 0:Nt.resolution)||"720p")===ut?"bg-white dark:bg-zinc-700 shadow-sm text-blue-600 dark:text-blue-400 font-medium":"text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300"}`,children:ut},ut)})})]}),n.type==="gen-video"&&((ze=n.settings)==null?void 0:ze.model)==="sora-2"&&i.jsxs("label",{className:`flex items-center gap-1 px-2 py-1 rounded text-[10px] border cursor-pointer transition-colors ${e==="dark"?(Me=n.settings)!=null&&Me.isHD?"bg-blue-600/30 border-blue-500 text-blue-300":"bg-zinc-800/50 hover:bg-zinc-800 text-zinc-400 border-zinc-700/50":(Ge=n.settings)!=null&&Ge.isHD?"bg-blue-500/30 border-blue-400 text-blue-700":"bg-zinc-100 hover:bg-zinc-200 text-zinc-600 border-zinc-300"}`,onClick:ut=>ut.stopPropagation(),children:[i.jsx("input",{type:"checkbox",checked:((qe=n.settings)==null?void 0:qe.isHD)||!1,onChange:ut=>{ut.stopPropagation(),Be(n.id,{isHD:ut.target.checked})},className:"w-3 h-3 cursor-pointer",onMouseDown:ut=>ut.stopPropagation()}),i.jsx("span",{children:"HD"})]})]})})()]}),i.jsx("button",{onClick:()=>{var at,se;const Z=n.type==="gen-image"?((at=n.settings)==null?void 0:at.prompt)||"":((se=n.settings)==null?void 0:se.videoPrompt)||"",re=dl(n.id),Ie=re.length>0?re.join(" ")+(Z?" "+Z:""):Z;vo(Ie,n.type==="gen-image"?"image":"video",p,n.id)},className:"bg-blue-600 hover:bg-blue-500 text-white p-1.5 rounded-md shadow-lg active:scale-95 transition-transform shrink-0",title:"",children:i.jsx(Og,{size:12,fill:"currentColor"})})]})]})})()]})]},n.id)},[ee,Cn,Go,Qh,tm,fn,Th,e,we,Fr,Dn,hn,ps,rp,Ms,mn,Ya,ae,Ir,ln,$i,Yo,ds,fs,zc,xn,Un,Be,dl,vo,ko,Jc,Cb,ul,sb]),av=a.length>50||er!=="off",lv=Od||Vo;return i.jsxs(i.Fragment,{children:[i.jsx(bz,{visible:Xr.visible,progress:Xr.progress,status:Xr.status,type:Xr.type}),i.jsxs("div",{className:`w-full h-screen font-sans overflow-hidden select-none flex flex-col transition-colors duration-300 ${e==="dark"?"bg-[#09090b] text-white":"bg-zinc-100 text-zinc-900"} ${av?"perf-mode":""} ${lv?"interacting":""}`,onClick:()=>{kr.visible&&$s(n=>({...n,visible:!1})),Pi.visible&&Vd(n=>({...n,visible:!1}))},children:[i.jsxs("div",{className:`h-12 flex items-center justify-between px-4 z-50 shrink-0 border-b transition-colors duration-300 ${e==="dark"?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-md flex items-center justify-center",children:i.jsx(qk,{size:16,className:"text-white"})}),i.jsx("span",{className:`font-bold text-sm tracking-wide ${e==="dark"?"text-zinc-200":"text-zinc-800"}`,children:"Tapnow Studio"}),tn?i.jsx("input",{ref:cr,type:"text",value:Ye,onChange:n=>It(n.target.value),onBlur:()=>{Xt(!1);try{localStorage.setItem("tapnow_project_name",Ye)}catch{}},onKeyDown:n=>{if(n.key==="Enter"){Xt(!1);try{localStorage.setItem("tapnow_project_name",Ye)}catch{}}},className:`ml-2 px-2 py-0.5 text-xs border rounded outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,style:{minWidth:"100px",maxWidth:"200px"}}):i.jsx("span",{onClick:()=>{Xt(!0),setTimeout(()=>{var n;return(n=cr.current)==null?void 0:n.focus()},0)},className:`ml-2 text-xs cursor-pointer hover:underline ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,title:"",children:Ye})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>{const n=["off","normal","ultra"],d=(n.indexOf(er)+1)%n.length,f=n[d];Cr(f)},className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${er!=="off"?e==="dark"?"bg-blue-600 border-blue-500 text-white hover:bg-blue-500":"bg-blue-500 border-blue-400 text-white hover:bg-blue-600":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:er==="ultra"?"":er==="normal"?"":"",children:[i.jsx(ju,{size:14,className:er!=="off"?"fill-current":""}),i.jsx("span",{children:er==="ultra"?"":""})]}),i.jsxs("button",{onClick:xb,className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:"/",children:[i.jsx(No,{size:14}),i.jsx("span",{children:""})]}),i.jsx("button",{onClick:gb,className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors border ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:"",children:e==="dark"?i.jsxs(i.Fragment,{children:[i.jsx(dz,{size:14,className:"text-amber-400"}),i.jsx("span",{children:""})]}):i.jsxs(i.Fragment,{children:[i.jsx(ez,{size:14,className:"text-blue-500"}),i.jsx("span",{children:""})]})}),i.jsx("button",{onClick:lt,disabled:$.length===0,className:`flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium transition-colors border ${$.length===0?e==="dark"?"bg-zinc-900/50 border-zinc-800 text-zinc-600 cursor-not-allowed":"bg-zinc-50 border-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:" (Ctrl+Z)",children:i.jsx(az,{size:14})}),i.jsx("button",{onClick:Se,disabled:b.length===0,className:`flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium transition-colors border ${b.length===0?e==="dark"?"bg-zinc-900/50 border-zinc-800 text-zinc-600 cursor-not-allowed":"bg-zinc-50 border-zinc-200 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 hover:bg-zinc-800":"bg-zinc-100 border-zinc-300 text-zinc-700 hover:bg-zinc-200"}`,title:" (Ctrl+Shift+Z)",children:i.jsx(lz,{size:14})}),i.jsx(Su,{variant:"ghost",onClick:()=>{M(),l([]),m([]),It(""),localStorage.removeItem("tapnow_project_name")},children:""}),i.jsx(Su,{variant:"secondary",icon:uz,onClick:()=>qr(!0),children:"API "})]})]}),i.jsxs("div",{className:`flex-1 relative overflow-hidden flex transition-colors duration-300 ${e==="dark"?"bg-[#09090b]":"bg-zinc-100"}`,children:[i.jsxs("div",{className:`w-14 border-r flex flex-col items-center py-3 gap-3 z-40 shrink-0 transition-colors duration-300 ${e==="dark"?"bg-[#09090b] border-zinc-800":"bg-white border-zinc-200"}`,children:[i.jsx("button",{onClick:Ub,className:`p-2.5 rounded-lg transition-all mb-2 ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:i.jsx(nz,{size:18})}),[{id:"select",icon:tz},{id:"history",icon:Rg},{id:"characters",icon:ku}].map(n=>i.jsx("button",{onClick:()=>{B1(n.id),n.id==="history"&&Nc(!jc),n.id==="characters"&&Jo(!dh)},className:`p-2.5 rounded-lg transition-all ${F1===n.id?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-200 text-zinc-900":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-800"}`,children:i.jsx(n.icon,{size:18})},n.id)),i.jsx("div",{className:"flex-1"}),i.jsx("button",{onClick:()=>Ks(!Ii),className:`p-2.5 rounded-lg transition-all mb-2 ${Ii?"bg-blue-600 text-white":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-800"}`,title:"AI ",children:i.jsx(pa,{size:18})}),i.jsx("button",{onClick:yb,className:`p-2.5 rounded-lg transition-all ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:i.jsx(Lg,{size:18})}),i.jsx("button",{onClick:wb,className:`p-2.5 rounded-lg transition-all mb-2 ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:i.jsx(Hi,{size:18})}),i.jsx("button",{onClick:vb,className:`p-2.5 rounded-lg transition-all mb-2 ${e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-800 hover:bg-zinc-200"}`,title:"",children:i.jsx(No,{size:18})})]}),jc&&i.jsxs("div",{className:`w-72 z-30 flex flex-col animate-in slide-in-from-left border-r transition-colors duration-300 ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[i.jsxs("div",{className:`p-3 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("h3",{className:`font-bold text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),Ci.active&&i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-16 h-1.5 bg-zinc-700 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-blue-500 transition-all duration-200",style:{width:`${Ci.current/Ci.total*100}%`}})}),i.jsxs("span",{className:"text-[9px] text-zinc-500 font-mono",children:[Ci.current,"/",Ci.total]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{const n=["off","normal","ultra"],d=(n.indexOf(Bn)+1)%n.length;gn(n[d])},className:`p-1.5 rounded transition-colors flex items-center gap-1 ${Bn==="ultra"?e==="dark"?"text-orange-400 bg-orange-500/20 hover:bg-orange-500/30":"text-orange-600 bg-orange-100 hover:bg-orange-200":Bn==="normal"?e==="dark"?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-green-600 bg-green-100 hover:bg-green-200":e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:Bn==="ultra"?"":Bn==="normal"?"":"",children:i.jsx(ju,{size:14})}),i.jsx("button",{onClick:()=>O1(n=>!n),className:`p-1.5 rounded transition-colors ${uh?e==="dark"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-blue-600 bg-blue-100 hover:bg-blue-200":e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:i.jsx(Hi,{size:14})}),i.jsxs("button",{onClick:()=>{const c=dt.filter(d=>d.status==="completed");ur.size>0?fo(new Set):fo(new Set(c.map(d=>d.id)))},className:`p-1.5 rounded transition-colors flex items-center gap-1 ${ur.size>0?e==="dark"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-blue-600 bg-blue-100 hover:bg-blue-200":e==="dark"?"text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:ur.size>0?` (${ur.size})`:"",children:[ur.size>0?i.jsx(Ol,{size:14}):i.jsx(Yk,{size:14}),ur.size>0&&i.jsx("span",{className:"text-[9px] font-bold",children:ur.size})]}),i.jsx("button",{onClick:()=>Ic(!0),className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:"",children:i.jsx(Il,{size:14})}),i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>{if(ur.size>0){const n=[...ur].map(c=>dt.find(d=>d.id===c)).filter(Boolean);fp(n)}else ln((Ke==null?void 0:Ke.type)==="batch-download"?null:{type:"batch-download"})},className:`p-1.5 rounded transition-colors ${ur.size>0?"text-blue-400 bg-blue-500/20":e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,title:ur.size>0?` (${ur.size})`:"",children:i.jsx(No,{size:14})}),(Ke==null?void 0:Ke.type)==="batch-download"&&ur.size===0&&i.jsxs("div",{className:`absolute right-0 top-full mt-1 w-40 rounded-lg shadow-xl py-1 z-50 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseLeave:()=>ln(null),children:[i.jsxs("button",{onClick:()=>{ln(null);const n=dt.filter(c=>(c.startTime||0)>=Wo);fp(n)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:[" (",dt.filter(n=>(n.startTime||0)>=Wo).length,")"]}),i.jsxs("button",{onClick:()=>{ln(null),fp(dt)},className:`w-full text-left px-3 py-2 text-xs transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,children:[" (",dt.length,")"]})]})]}),i.jsx("button",{onClick:()=>Nc(!1),children:i.jsx(ns,{size:12,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]})]}),i.jsx("div",{className:"px-3 pt-2",children:i.jsxs("div",{className:`flex items-center gap-2 text-[10px] px-2 py-1 rounded ${on?e==="dark"?"bg-blue-500/20 text-blue-300":"bg-blue-100 text-blue-600":e==="dark"?"bg-zinc-800 text-zinc-500":"bg-zinc-100 text-zinc-500"}`,children:[i.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${on?"bg-green-500":"bg-red-500"}`}),i.jsx("span",{children:on?" - ":""})]})}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-3",children:[uh&&i.jsx("div",{className:`rounded-lg border p-3 space-y-3 ${e==="dark"?"bg-zinc-900/60 border-zinc-800":"bg-white border-zinc-200"}`,children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"text",value:tr.imageSavePath||"",onChange:n=>{const c=zr(n.target.value);Lr(d=>({...d,imageSavePath:c}))},onBlur:n=>nl({image_save_path:zr(n.target.value||"")}),onKeyDown:n=>{n.key==="Enter"&&n.currentTarget.blur()},placeholder:" history",className:`flex-1 text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`}),i.jsx("button",{onClick:()=>kh("imageSavePath","image_save_path"),className:`px-2 py-1.5 text-[10px] rounded border ${e==="dark"?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 border-zinc-300 hover:bg-zinc-200"}`,children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-[10px] block mb-1 text-zinc-500",children:""}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"text",value:tr.videoSavePath||"",onChange:n=>{const c=zr(n.target.value);Lr(d=>({...d,videoSavePath:c}))},onBlur:n=>nl({video_save_path:zr(n.target.value||"")}),onKeyDown:n=>{n.key==="Enter"&&n.currentTarget.blur()},placeholder:" history",className:`flex-1 text-xs border rounded px-2 py-1.5 outline-none focus:border-blue-500 ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`}),i.jsx("button",{onClick:()=>kh("videoSavePath","video_save_path"),className:`px-2 py-1.5 text-[10px] rounded border ${e==="dark"?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 border-zinc-300 hover:bg-zinc-200"}`,children:""})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-[10px] text-zinc-500",children:"PNG  JPG"}),i.jsx("button",{className:`w-10 h-5 rounded-full relative transition-colors ${tr.convertPngToJpg?"bg-green-600":"bg-zinc-600"} ${tr.pilAvailable?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>{if(!tr.pilAvailable)return;const n=!tr.convertPngToJpg;Lr(c=>({...c,convertPngToJpg:n})),nl({convert_png_to_jpg:n},{silent:!0})},disabled:!tr.pilAvailable,children:i.jsx("div",{className:`absolute top-1 w-3 h-3 rounded-full bg-white transition-all ${tr.convertPngToJpg?"left-6":"left-1"}`})})]}),!tr.pilAvailable&&i.jsx("div",{className:"text-[9px] text-amber-400",children:"PIL PNG  JPG "}),i.jsx("button",{className:`w-full py-2 rounded text-[10px] font-medium transition-colors ${e==="dark"?"bg-orange-600/30 text-orange-200 hover:bg-orange-600/40":"bg-orange-100 text-orange-600 hover:bg-orange-200"}`,onClick:Z1,children:""}),i.jsx("div",{className:"text-[9px] text-zinc-500",children:""})]})}),(()=>{const n=dt.filter(d=>(d.startTime||0)>=Wo),c=dt.filter(d=>(d.startTime||0)<Wo);return i.jsxs(i.Fragment,{children:[n.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`flex items-center gap-2 text-[10px] ${e==="dark"?"text-blue-400":"text-blue-600"}`,children:[i.jsx("div",{className:"flex-1 h-px bg-blue-500/30"}),i.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-blue-500/10 font-medium",children:[" (",n.length,")"]}),i.jsx("div",{className:"flex-1 h-px bg-blue-500/30"})]}),n.map(d=>i.jsx(Bg,{item:d,theme:e,lightboxItem:Sn,performanceMode:Bn,providers:Pe,defaultProviders:qp,localCacheServerConnected:on,onCacheMissing:wh,onDelete:Rh,isSelected:ur.has(d.id),onSelect:f=>{fo(p=>{const h=new Set(p);return h.has(f)?h.delete(f):h.add(f),h})},onClick:()=>{const f=d.mjImages&&d.mjImages.length>1&&d.selectedMjImageIndex!==void 0?d.selectedMjImageIndex:0,p=d.mjImages&&d.mjImages.length>1?d.mjImages[f]:null,h=p?hs(d,p):hs(d);h&&xn({...d,url:h,selectedMjImageIndex:f,storyboardContext:null})},onContextMenu:f=>qc(f,d),onImageClick:(f,p,h,g)=>{f.stopPropagation(),$t(N=>N.map(S=>S.id===p.id?{...S,url:h,selectedMjImageIndex:g}:S));const z=hs(p,h),y={...p,url:z,selectedMjImageIndex:g,storyboardContext:null};xn(y)},onImageContextMenu:(f,p,h,g)=>qc(f,p,h,g),onRefresh:f=>{f.apiConfig&&($t(p=>p.map(h=>h.id===f.id?{...h,status:"generating",errorMsg:null,progress:5}:h)),f.modelName.includes("veo")?Bi(f.remoteTaskId,f.id,f.apiConfig.baseUrl,f.apiConfig.apiKey,f.width,f.height):bo(f.remoteTaskId,f.id,f.apiConfig.baseUrl,f.apiConfig.apiKey,f.width,f.height,f.apiConfig.modelId||""))},Loader2:hi,Trash2:Os,RefreshCw:Bu},d.id))]}),c.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:`flex items-center gap-2 text-[10px] ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:[i.jsx("div",{className:`flex-1 h-px ${e==="dark"?"bg-zinc-700":"bg-zinc-300"}`}),i.jsxs("span",{className:"px-2 py-0.5 font-medium",children:[" (",c.length,")"]}),i.jsx("div",{className:`flex-1 h-px ${e==="dark"?"bg-zinc-700":"bg-zinc-300"}`})]}),c.map(d=>i.jsx(Bg,{item:d,theme:e,lightboxItem:Sn,performanceMode:Bn,providers:Pe,defaultProviders:qp,localCacheServerConnected:on,onCacheMissing:wh,onDelete:Rh,isSelected:ur.has(d.id),onSelect:f=>{fo(p=>{const h=new Set(p);return h.has(f)?h.delete(f):h.add(f),h})},onClick:()=>{const f=d.mjImages&&d.mjImages.length>1&&d.selectedMjImageIndex!==void 0?d.selectedMjImageIndex:0,p=d.mjImages&&d.mjImages.length>1?d.mjImages[f]:null,h=p?hs(d,p):hs(d);h&&xn({...d,url:h,selectedMjImageIndex:f,storyboardContext:null})},onContextMenu:f=>qc(f,d),onImageClick:(f,p,h,g)=>{f.stopPropagation(),$t(N=>N.map(S=>S.id===p.id?{...S,url:h,selectedMjImageIndex:g}:S));const z=hs(p,h),y={...p,url:z,selectedMjImageIndex:g,storyboardContext:null};xn(y)},onImageContextMenu:(f,p,h,g)=>qc(f,p,h,g),onRefresh:f=>{f.apiConfig&&($t(p=>p.map(h=>h.id===f.id?{...h,status:"generating",errorMsg:null,progress:5}:h)),f.modelName.includes("veo")?Bi(f.remoteTaskId,f.id,f.apiConfig.baseUrl,f.apiConfig.apiKey,f.width,f.height):bo(f.remoteTaskId,f.id,f.apiConfig.baseUrl,f.apiConfig.apiKey,f.width,f.height,f.apiConfig.modelId||""))},Loader2:hi,Trash2:Os,RefreshCw:Bu},d.id))]})]})})()]})]}),dh&&i.jsxs("div",{className:`w-72 z-30 flex flex-col animate-in slide-in-from-left border-r transition-colors duration-300 ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[i.jsxs("div",{className:`p-3 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[i.jsx("h3",{className:`font-bold text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:"Sora "}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{const n=Te.find(c=>c.type==="Video"&&(c.id==="sora-2"||c.id==="sora-2-pro"));if(n){const c=(n.url||xr).replace(/\/+$/,"");qa(`${c}/sora/v1/characters`)}else{const c=xr.replace(/\/+$/,"");qa(`${c}/sora/v1/characters`)}Ja(!0)},className:`px-2 py-1 text-[10px] rounded transition-colors ${e==="dark"?"bg-blue-600 hover:bg-blue-500 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}`,children:""}),i.jsx("button",{onClick:()=>Jo(!1),children:i.jsx(ns,{size:12,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3",children:On.length===0?i.jsx("div",{className:`text-center py-8 text-sm ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:'""'}):i.jsx("div",{className:"grid grid-cols-2 gap-3",children:On.map(n=>i.jsxs("div",{className:`group rounded-lg overflow-hidden border cursor-pointer hover:border-blue-500/50 transition-colors ${e==="dark"?"bg-zinc-900 border-zinc-800":"bg-white border-zinc-200"}`,onClick:()=>{const c=` @${n.username} `,d=document.activeElement;if(d&&(d.tagName==="TEXTAREA"||d.tagName==="INPUT")){const f=d,p=f.selectionStart||0,h=f.selectionEnd||0,g=f.value,z=g.slice(0,p)+c+g.slice(h);f.value=z;const y=p+c.length;f.setSelectionRange(y,y),f.dispatchEvent(new Event("input",{bubbles:!0})),f.focus()}else navigator.clipboard.writeText(c.trim()).then(()=>{alert(`: ${c.trim()}`)})},children:[i.jsxs("div",{className:"aspect-square bg-zinc-800 relative group/char",children:[n.localCacheUrl||n.profile_picture_url?i.jsx(Vn,{src:n.localCacheUrl||n.profile_picture_url,alt:n.username,className:"w-full h-full object-cover",onError:c=>{c.target.style.display="none"}}):i.jsx("div",{className:"w-full h-full flex items-center justify-center text-zinc-500",children:i.jsx(Zp,{size:24})}),i.jsx("button",{onClick:c=>{if(c.stopPropagation(),confirm(` "${n.username}" `)){const d=On.filter(f=>f.id!==n.id);Zo(d);try{localStorage.setItem("tapnow_characters",JSON.stringify(d))}catch(f){console.error(":",f)}}},className:"absolute top-1 right-1 p-1.5 rounded-full bg-black/50 text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 z-10",title:"",children:i.jsx(Os,{size:12})})]}),i.jsx("div",{className:"p-2 relative",children:i.jsxs("p",{className:`text-xs truncate flex items-center gap-1 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:[n.username,i.jsx($l,{size:12,className:"text-green-500 shrink-0",title:"Sora 2 "})]})})]},n.id))})})]}),L1&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center",onClick:()=>Ja(!1),children:i.jsxs("div",{className:`w-[500px] max-h-[90vh] overflow-y-auto rounded-lg shadow-2xl flex flex-col ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-white border-zinc-200"} border`,onClick:n=>n.stopPropagation(),children:[i.jsxs("div",{className:`p-4 border-b flex justify-between items-center ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[i.jsx("h3",{className:`font-bold text-sm ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),i.jsx("button",{onClick:()=>Ja(!1),children:i.jsx(ns,{size:16,className:e==="dark"?"text-zinc-500":"text-zinc-400"})})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),i.jsxs("div",{className:"flex gap-2 mb-2",children:[i.jsx("button",{onClick:()=>{_c("url"),Cc("")},className:`px-3 py-1.5 text-xs rounded transition-colors ${li==="url"?e==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,children:" URL"}),i.jsx("button",{onClick:()=>{_c("history"),Sc(""),Qa(null)},className:`px-3 py-1.5 text-xs rounded transition-colors ${li==="history"?e==="dark"?"bg-blue-600 text-white":"bg-blue-500 text-white":e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-100 text-zinc-600 hover:bg-zinc-200"}`,children:""})]}),li==="url"?i.jsx("input",{type:"text",value:qo,onChange:n=>Sc(n.target.value),placeholder:" URL...",className:`w-full px-3 py-2 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`}):i.jsxs("select",{value:Qo,onChange:n=>{const c=n.target.value;if(Cc(c),c){const d=yo.get(c),f=ui(d);f&&(_c("url"),Sc(f),Cc(""))}},className:`w-full px-3 py-2 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`,children:[i.jsx("option",{value:"",children:"..."}),dt.filter(n=>n.type==="video"&&n.status==="completed"&&(n.url||n.localCacheUrl||n.originalUrl)).map(n=>{var c;return i.jsxs("option",{value:n.id,children:[((c=n.prompt)==null?void 0:c.slice(0,50))||"Untitled"," - ",n.time]},n.id)})]}),(()=>{let n=null;if(li==="url"&&qo.trim())n=qo.trim();else if(li==="history"&&Qo){const c=yo.get(Qo),d=ui(c);d&&(n=d)}return n?i.jsxs("div",{className:"mt-2 mb-2",children:[i.jsx("video",{controls:!0,crossOrigin:"anonymous",className:"w-full h-40 object-contain bg-black rounded-lg",src:n,onError:c=>{console.error(":",n,c),Qa("")},onLoadStart:()=>{Qa(null)},onLoadedData:()=>{Qa(null)}},n),hh&&i.jsx("div",{className:"text-red-500 text-xs mt-1 text-center",children:hh})]}):null})()]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:" 1-3 "}),i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("input",{type:"number",min:"0",step:"0.1",value:ea,onChange:n=>ph(parseFloat(n.target.value)||0),className:`w-20 px-2 py-1.5 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`}),i.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),i.jsx("input",{type:"number",min:"0",step:"0.1",value:ta,onChange:n=>fh(parseFloat(n.target.value)||0),className:`w-20 px-2 py-1.5 text-xs rounded border outline-none ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200":"bg-white border-zinc-300 text-zinc-800"}`}),i.jsxs("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:[": ",(ta-ea).toFixed(1),"s"]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:`block text-xs mb-2 ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:"API  (API Endpoint)"}),i.jsx("input",{type:"text",value:Za,onChange:n=>qa(n.target.value),placeholder:": https://your-domain.com/sora/v1/characters",className:`w-full px-3 py-2 text-xs rounded border outline-none font-mono ${e==="dark"?"bg-zinc-900 border-zinc-700 text-zinc-200 placeholder-zinc-600":"bg-white border-zinc-300 text-zinc-800 placeholder-zinc-400"}`,onFocus:n=>{if(!n.target.value){const c=Te.find(f=>f.type==="Video"&&(f.id==="sora-2"||f.id==="sora-2-pro")),d=c?(c.url||xr).replace(/\/+$/,""):xr.replace(/\/+$/,"");qa(`${d}/sora/v1/characters`)}}}),i.jsx("p",{className:`text-[10px] mt-1 ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:""})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[i.jsx("button",{onClick:()=>Ja(!1),className:`px-4 py-2 text-xs rounded transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200"}`,children:""}),i.jsx("button",{onClick:async()=>{if(li==="url"&&!qo.trim()){alert(" URL");return}if(li==="history"&&!Qo){alert("");return}if(ta-ea<1||ta-ea>3){alert(" 1-3 ");return}na(!0);try{const n=Za.trim()||null;li==="url"?await Kh(qo,ea,ta,null,n):await Kh("",ea,ta,Qo,n)}finally{na(!1)}},disabled:Yd,className:`px-4 py-2 text-xs rounded transition-colors ${Yd?"bg-zinc-400 text-zinc-200 cursor-not-allowed":e==="dark"?"bg-blue-600 text-white hover:bg-blue-500":"bg-blue-500 text-white hover:bg-blue-600"}`,children:Yd?"...":""})]})]})]})}),i.jsxs("div",{className:"flex-1 relative overflow-hidden flex",children:[i.jsxs("div",{ref:Gs,id:"canvas-bg",className:"flex-1 h-full cursor-default relative",onMouseDown:eb,onClick:tb,onDoubleClick:nb,onContextMenu:rb,style:{backgroundImage:e==="dark"?"radial-gradient(#27272a 1px, transparent 1px)":"radial-gradient(rgba(0, 0, 0, 0.08) 0.5px, transparent 0.5px)",backgroundSize:`${20*we.zoom}px ${20*we.zoom}px`,backgroundPosition:`${we.x}px ${we.y}px`,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transform:"translateZ(0)",backfaceVisibility:"hidden"},children:[i.jsxs("div",{className:"absolute origin-top-left will-change-transform",style:{transform:`translate3d(${we.x}px, ${we.y}px, 0) scale(${we.zoom})`,width:kz,height:zz,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",transformOrigin:"top left",imageRendering:we.zoom>=1?"auto":"crisp-edges"},children:[i.jsx(qh,{connections:u,nodesMap:At,connectionsByNode:Ui,connectingSource:Dn,connectingTarget:hn,connectingInputType:ps,mousePos:Ld,apiConfigsMap:fn,selectedNodeId:ee,onDisconnectConnection:up,visibleNodes:Dc}),Dc.map(n=>ov(n))]}),Is&&i.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-500/10 pointer-events-none z-50",style:{left:Math.min(Is.startX,Is.endX),top:Math.min(Is.startY,Is.endY),width:Math.abs(Is.endX-Is.startX),height:Math.abs(Is.endY-Is.startY)}})]}),i.jsxs("div",{className:`fixed right-0 top-12 bottom-0 border-l shadow-2xl flex flex-col z-50 transition-transform duration-300 ease-in-out select-text ${e==="dark"?"bg-[#121214] border-zinc-800":"bg-white border-zinc-200"} ${Ii?"translate-x-0":"translate-x-full"}`,style:{width:Ad,pointerEvents:Ii?"auto":"none"},children:[i.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1.5 cursor-ew-resize transition-colors z-50 flex items-center justify-center group ${e==="dark"?"hover:bg-blue-600/50":"hover:bg-blue-400/30"}`,onMouseDown:Q1,children:i.jsx("div",{className:`h-8 w-1 rounded transition-colors ${e==="dark"?"bg-zinc-700 group-hover:bg-blue-500":"bg-zinc-300 group-hover:bg-blue-500"}`})}),i.jsxs("div",{className:`h-12 flex items-center justify-between px-3 shrink-0 border-b ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs("div",{className:"relative z-50",children:[i.jsxs("button",{onClick:n=>{n.stopPropagation(),Wn(!rr),Ur(null)},className:`flex items-center gap-2 text-xs border rounded px-2 py-1 outline-none focus:border-blue-500 cursor-pointer max-w-[200px] ${e==="dark"?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:border-zinc-600":"bg-white text-zinc-800 border-zinc-300 hover:border-zinc-400"}`,children:[i.jsx("span",{className:"truncate font-mono",children:ht}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(ht)}`}),i.jsx(Rs,{size:12,className:"shrink-0 opacity-50"})]}),rr&&i.jsxs("div",{className:`absolute top-full left-0 mt-1 w-72 rounded-lg shadow-xl p-1 z-[60] border flex ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseLeave:()=>Ur(null),children:[i.jsx("div",{className:`w-24 border-r pr-1 max-h-64 overflow-y-auto custom-scrollbar flex flex-col ${e==="dark"?"border-zinc-700":"border-zinc-200"}`,children:Object.entries(pr).filter(([,n])=>n.models.some(c=>c.type==="Chat")).map(([n,c])=>i.jsx("button",{onMouseEnter:()=>Ur(n),className:`w-full text-left px-2 py-1.5 text-[10px] rounded transition-colors ${sr===n?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:c.name||n},n))}),i.jsxs("div",{className:"flex-1 pl-1 max-h-64 overflow-y-auto custom-scrollbar",children:[sr&&((nm=pr[sr])==null?void 0:nm.models.filter(n=>n.type==="Chat").map(n=>i.jsxs("button",{onClick:()=>{_n(n.id),Wn(!1),Ur(null)},className:`w-full flex items-center justify-between px-2 py-1.5 rounded text-left transition-colors ${ht===n.id?e==="dark"?"bg-blue-600/30 text-blue-300":"bg-blue-100 text-blue-700":e==="dark"?"hover:bg-zinc-800 text-zinc-300":"hover:bg-zinc-100 text-zinc-700"}`,children:[i.jsx("span",{className:"text-[10px] font-medium truncate font-mono",children:n.id}),i.jsx("div",{className:`w-1.5 h-1.5 rounded-full shrink-0 ${Ts(n.id)}`})]},n.id))),!sr&&i.jsx("div",{className:`text-[10px] px-2 py-3 text-center ${e==="dark"?"text-zinc-500":"text-zinc-400"}`,children:"  Provider"})]})]})]})}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:lb,className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,title:"",children:i.jsx(Vi,{size:16})}),wr.length>1&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>Gd(!gh),className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,children:i.jsx(Rg,{size:16})}),gh&&i.jsx("div",{className:`absolute right-0 top-full mt-1 w-48 rounded-lg shadow-xl py-1 z-50 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,onMouseLeave:()=>Gd(!1),children:wr.map(n=>i.jsxs("div",{className:`flex items-center justify-between px-3 py-2 text-xs cursor-pointer ${Ss===n.id?e==="dark"?"bg-zinc-800 text-white":"bg-zinc-100 text-zinc-900":e==="dark"?"text-zinc-400 hover:bg-zinc-800/50":"text-zinc-500 hover:bg-zinc-100"}`,onClick:()=>{Er(n.id),Gd(!1)},children:[i.jsx("span",{className:"truncate flex-1",children:n.title}),i.jsx("button",{onClick:c=>{c.stopPropagation(),cb(c,n.id)},className:`p-1 ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,children:i.jsx(ns,{size:10})})]},n.id))})]}),i.jsx("button",{onClick:()=>Ks(!1),className:`p-1.5 rounded ${e==="dark"?"text-zinc-400 hover:text-white hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100"}`,children:i.jsx(fa,{size:16})})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4 space-y-4 select-text",children:[aa==null?void 0:aa.messages.map(n=>i.jsxs("div",{className:`flex gap-3 select-text ${n.role==="user"?"flex-row-reverse":""}`,children:[i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shrink-0 select-none ${n.role==="user"?"bg-blue-600":"bg-green-600"}`,children:n.role==="user"?i.jsx(Zp,{size:16,className:"text-white"}):i.jsx(Eg,{size:16,className:"text-white"})}),i.jsxs("div",{className:`flex flex-col gap-1 max-w-[85%] select-text ${n.role==="user"?"items-end":"items-start"}`,children:[n.files&&n.files.length>0&&i.jsx("div",{className:`flex flex-wrap gap-2 mb-1 ${n.role==="user"?"justify-end":"justify-start"}`,children:n.files.map((c,d)=>i.jsx("div",{className:`rounded p-1 border flex items-center gap-1 ${e==="dark"?"bg-zinc-800 border-zinc-700":"bg-zinc-100 border-zinc-300"}`,children:c.isImage?i.jsx(Vn,{src:c.content,className:"w-16 h-16 object-cover rounded",alt:c.name}):c.isVideo?i.jsx("video",{src:c.content,controls:!0,className:`max-w-full rounded-lg bg-black max-h-[300px] border ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,playsInline:!0}):c.isAudio?i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(Ag,{size:16}),i.jsx("span",{className:"text-[8px] mt-1",children:""})]}):c.isPDF?i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(ts,{size:16}),i.jsx("span",{className:"text-[8px] mt-1",children:"PDF"})]}):c.isDoc?i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(ts,{size:16}),i.jsx("span",{className:"text-[8px] mt-1",children:"DOC"})]}):c.isExcel?i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(ts,{size:16}),i.jsx("span",{className:"text-[8px] mt-1",children:"XLS"})]}):i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(ts,{size:16}),i.jsx("span",{className:"text-[8px] mt-1 max-w-full truncate px-1",children:c.fileExt||c.name.split(".").pop()||""})]})},d))}),n.content&&n.content.trim()&&i.jsx("div",{className:`rounded-2xl px-4 py-2.5 text-sm select-text break-words ${n.role==="user"?e==="dark"?"bg-zinc-800 text-white rounded-tr-none":"bg-zinc-300 text-zinc-900 rounded-tr-none":e==="dark"?"bg-zinc-800/50 text-zinc-300 rounded-tl-none border border-zinc-800":"bg-zinc-100 text-zinc-800 rounded-tl-none border border-zinc-200"}`,style:{userSelect:"text",cursor:"text"},children:n.isError?i.jsx("span",{className:"text-red-500 select-text cursor-text",style:{userSelect:"text",cursor:"text"},children:n.content}):n.content?i.jsx("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:Lk.sanitize(wn.parse(n.content))},style:{userSelect:"text",cursor:"text"}}):null})]})]},n.id||n.timestamp||`msg-${Math.random()}`)),Cs&&i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"w-8 h-8 rounded-full bg-green-600 flex items-center justify-center shrink-0",children:i.jsx(Eg,{size:16,className:"text-white"})}),i.jsx("div",{className:`rounded-2xl rounded-tl-none px-4 py-2 border flex items-center ${e==="dark"?"bg-zinc-800/50 border-zinc-800":"bg-zinc-100 border-zinc-200"}`,children:i.jsxs("div",{className:"flex gap-1",children:[i.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0s"}}),i.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),i.jsx("div",{className:"w-1.5 h-1.5 bg-zinc-500 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})]}),i.jsx("div",{ref:zh})]}),i.jsxs("div",{className:`p-3 border-t ${e==="dark"?"border-zinc-800 bg-[#121214]":"border-zinc-200 bg-zinc-50"}`,children:[q.length>0&&i.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-2 custom-scrollbar",children:q.map((n,c)=>i.jsxs("div",{className:"relative group shrink-0",children:[n.isImage?i.jsx(Vn,{src:n.content,className:`w-12 h-12 object-cover rounded border ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,alt:n.name}):n.isVideo?i.jsx("video",{src:n.content,className:`w-16 h-12 object-cover rounded border bg-black ${e==="dark"?"border-zinc-700":"border-zinc-300"}`,muted:!0,playsInline:!0}):n.isAudio?i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(Ag,{size:16}),i.jsx("span",{className:"text-[8px] mt-1",children:""})]}):n.isPDF?i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(ts,{size:16}),i.jsx("span",{className:"text-[8px] mt-1",children:"PDF"})]}):n.isDoc?i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(ts,{size:16}),i.jsx("span",{className:"text-[8px] mt-1",children:"DOC"})]}):n.isExcel?i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(ts,{size:16}),i.jsx("span",{className:"text-[8px] mt-1",children:"XLS"})]}):i.jsxs("div",{className:`w-12 h-12 rounded flex flex-col items-center justify-center ${e==="dark"?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-zinc-100 border border-zinc-300 text-zinc-500"}`,children:[i.jsx(ts,{size:16}),i.jsx("span",{className:"text-[8px] mt-1 max-w-full truncate px-1",children:n.fileExt||n.name.split(".").pop()||""})]}),i.jsx("button",{onClick:()=>db(c),className:`absolute -top-1 -right-1 rounded-full p-0.5 border opacity-0 group-hover:opacity-100 transition-opacity ${e==="dark"?"bg-zinc-900 text-zinc-400 hover:text-white border-zinc-700":"bg-white text-zinc-500 hover:text-zinc-900 border-zinc-300"}`,children:i.jsx(ns,{size:10})})]},c))}),i.jsxs("div",{className:`relative rounded-xl flex items-end p-2 focus-within:border-blue-500/50 transition-colors border ${e==="dark"?"bg-zinc-800/50 border-zinc-700":"bg-white border-zinc-300"}`,children:[i.jsxs("label",{className:`p-2 cursor-pointer transition-colors ${e==="dark"?"text-zinc-400 hover:text-white":"text-zinc-500 hover:text-zinc-900"}`,title:"",children:[i.jsx(rz,{size:18}),i.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:ub,accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.md,.js,.py,.html,.css,.json,.csv"})]}),i.jsx("textarea",{value:oi,onChange:n=>Wa(n.target.value),onKeyDown:n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),Oh())},placeholder:"...",className:`w-full bg-transparent text-sm resize-none outline-none max-h-32 py-2 px-1 custom-scrollbar ${e==="dark"?"text-white placeholder-zinc-500":"text-zinc-800 placeholder-zinc-400"}`,rows:1,style:{minHeight:"36px"}}),i.jsx("button",{onClick:Oh,disabled:!oi.trim()&&q.length===0||Cs,className:`p-2 rounded-lg transition-all mb-0.5 ${!oi.trim()&&q.length===0||Cs?"opacity-50 bg-transparent text-zinc-400":"bg-blue-600 text-white hover:bg-blue-500"}`,children:i.jsx(cz,{size:16})})]}),i.jsx("div",{className:`text-[10px] text-center mt-2 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:" MP4/MP3/PDF/Doc/Excel/Code   Enter "})]})]}),dr.visible&&i.jsx("div",{className:`fixed z-50 w-40 rounded-lg shadow-xl border ${e==="dark"?"bg-[#18181b] border-zinc-800":"bg-white border-zinc-200"}`,style:{left:dr.x,top:dr.y,transform:"translate(-50%, -50%)"},onMouseLeave:()=>{Xo(n=>({...n,visible:!1})),Ti(!1)},children:i.jsx("div",{className:"p-1",children:[{type:"input-image",label:""},{type:"text-node",label:""},{type:"novel-input",label:""},{type:"extract-characters-scenes",label:"",children:[{type:"character-description",label:""},{type:"scene-description",label:""},{type:"generate-character-image",label:""},{type:"generate-scene-image",label:""},{type:"generate-character-video",label:""},{type:"generate-scene-video",label:""},{type:"create-character",label:""},{type:"create-scene",label:""}]},{type:"video-input",label:" / "},{type:"video-analyze",label:" / "},{type:"storyboard-node",label:""},{type:"gen-image",label:"AI "},{type:"gen-video",label:"AI "},{type:"image-compare",label:""},{type:"preview",label:""},{type:"local-save",label:""}].map(n=>i.jsx("div",{children:n.children?i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"flex items-center",onMouseEnter:()=>Ti(!0),children:[i.jsx("button",{className:`flex-1 text-left px-3 py-2 text-xs rounded transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>$r(n.type,dr.worldX,dr.worldY,dr.sourceNodeId,void 0,void 0,dr.targetNodeId,dr.inputType),children:n.label}),i.jsx("button",{className:`px-2 py-2 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-100"}`,onClick:c=>{c.stopPropagation(),Ti(d=>!d)},onMouseEnter:()=>Ti(!0),title:"",children:i.jsx(fa,{size:12,className:"transition-transform"})})]}),R1&&i.jsx("div",{className:`absolute left-full top-0 ml-1 w-40 rounded-lg shadow-xl p-1 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,children:n.children.map(c=>i.jsx("button",{className:`w-full text-left px-3 py-2 text-[11px] rounded transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>$r(c.type,dr.worldX,dr.worldY,dr.sourceNodeId,void 0,void 0,dr.targetNodeId,dr.inputType),children:c.label},c.type))})]}):i.jsx("button",{className:`w-full text-left px-3 py-2 text-xs rounded transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>$r(n.type,dr.worldX,dr.worldY,dr.sourceNodeId,void 0,void 0,dr.targetNodeId,dr.inputType),children:n.label})},n.type))})}),kr.visible&&i.jsxs("div",{className:`fixed z-[100] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:kr.x,top:kr.y},children:[i.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:tv,children:[i.jsx(pa,{size:14,className:"text-purple-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:ev,children:[i.jsx(ua,{size:14,className:"text-blue-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=kr.item,c=(n==null?void 0:n.url)||(n==null?void 0:n.localCacheUrl)||(n==null?void 0:n.originalUrl)||(n==null?void 0:n.mjOriginalUrl);c&&(l(d=>{const f=d.filter(h=>h.type==="preview");if(!f.length)return d;const p=f[f.length-1].id;return d.map(h=>h.id===p?{...h,content:c,previewType:n.type==="video"?"video":"image"}:h)}),$s({visible:!1,x:0,y:0,item:null}))},children:[i.jsx(Ds,{size:14,className:"text-emerald-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:Qb,children:[i.jsx(wu,{size:14,className:ee?"text-green-500":"text-zinc-400"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=kr.item,c=n.mjImages&&n.mjImages.length>0?n.mjImages[n.selectedMjImageIndex||0]||n.mjImages[0]:n.localCacheUrl||n.url||n.originalUrl||n.mjOriginalUrl;c&&(Zr.nodeId&&Zr.shotId?qt(Zr.nodeId,Zr.shotId,{image_url:c}):alert(""),$s({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null}))},children:[i.jsx(Il,{size:14,className:Zr.nodeId&&Zr.shotId?"text-orange-500":"text-zinc-400"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=kr.item,c=(n==null?void 0:n.url)||(n==null?void 0:n.localCacheUrl)||(n==null?void 0:n.originalUrl)||(n==null?void 0:n.mjOriginalUrl);if(c){const d=(kr.worldX||0)+340,f=kr.worldY||0;fl(c,{originX:d,originY:f})}$s({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null})},children:[i.jsx(Jp,{size:14,className:"text-blue-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:async()=>{const n=kr.item,c=(n==null?void 0:n.url)||(n==null?void 0:n.localCacheUrl)||(n==null?void 0:n.originalUrl)||(n==null?void 0:n.mjOriginalUrl);if(c){try{const f=n.type==="video"||c.includes("/video/")||c.includes("video_mp4")?"mp4":"png",h=`${(n.prompt||"download").replace(/[\\/:*?"<>|]/g,"_").slice(0,50)}.${f}`,z=await(await fetch(c)).blob(),y=window.URL.createObjectURL(z),N=document.createElement("a");N.href=y,N.download=h,N.click(),window.URL.revokeObjectURL(y)}catch(d){console.error(":",d),alert("")}$s({visible:!1,x:0,y:0,worldX:0,worldY:0,item:null})}},children:[i.jsx(No,{size:14,className:"text-green-500"})," ",((rm=kr.item)==null?void 0:rm.type)==="video"?"":""]})]}),Wd.visible&&i.jsxs("div",{className:`fixed z-[120] w-52 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:Wd.x,top:Wd.y},onMouseLeave:()=>Hd({visible:!1,x:0,y:0}),children:[i.jsxs("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:[" ",Cn.size>0?Cn.size:ee?1:0," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:bb,children:[i.jsx(Lg,{size:14,className:"text-blue-500"})," "]})]}),Pi.visible&&i.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:Pi.x,top:Pi.y},children:[i.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:Xb,children:[i.jsx(pa,{size:14,className:"text-purple-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:Jb,children:[i.jsx(ua,{size:14,className:"text-blue-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:Zb,children:[i.jsx(Ds,{size:14,className:"text-emerald-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:qb,children:[i.jsx(wu,{size:14,className:ee?"text-green-500":"text-zinc-400"})," "]})]}),Ai.visible&&i.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:Ai.x,top:Ai.y},onMouseLeave:zo,children:[i.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:nv,children:[i.jsx(pa,{size:14,className:"text-purple-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:rv,children:[i.jsx(ua,{size:14,className:"text-blue-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=Ai.item;n!=null&&n.url&&xn({url:n.url,type:n.type||"image",prompt:n.prompt||"",mjImages:n.mjImages,selectedMjImageIndex:n.selectedMjImageIndex||0}),zo()},children:[i.jsx(Ds,{size:14,className:"text-green-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=Ai.item;if(n!=null&&n.url){const c=Xs.current;if(c&&c.size===9)fl(n.url,{replaceSelected:!0});else{const f=n.sourceNode,p=f?f.x+f.width+20:void 0,h=f?f.y:void 0;fl(n.url,{originX:p,originY:h})}}zo()},children:[i.jsx(Jp,{size:14,className:"text-blue-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:async()=>{const n=Ai.item;if(!(n!=null&&n.url)){zo();return}try{const d=n.type==="video"||n.url.includes("/video/")||n.url.includes("video_mp4")?"mp4":"png",p=`${(n.prompt||"download").replace(/[\\/:*?"<>|]/g,"_").slice(0,50)}_${Date.now()}.${d}`;if(n.url.startsWith("data:")){const h=document.createElement("a");h.href=n.url,h.download=p,document.body.appendChild(h),h.click(),document.body.removeChild(h)}else{const g=await(await fetch(n.url)).blob(),z=window.URL.createObjectURL(g),y=document.createElement("a");y.href=z,y.download=p,y.click(),window.URL.revokeObjectURL(z)}}catch(c){console.error(":",c),o("","error")}zo()},children:[i.jsx(No,{size:14,className:"text-cyan-500"})," "]})]}),Xa.visible&&i.jsxs("div",{className:`fixed z-[110] w-48 rounded-lg shadow-2xl py-1 animate-in fade-in duration-100 border ${e==="dark"?"bg-[#18181b] border-zinc-700":"bg-white border-zinc-200"}`,style:{left:Xa.x,top:Xa.y},onMouseLeave:hp,children:[i.jsx("div",{className:`px-3 py-1.5 text-[10px] font-medium border-b mb-1 ${e==="dark"?"text-zinc-500 border-zinc-800":"text-zinc-500 border-zinc-200"}`,children:""}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:iv,children:[i.jsx(pa,{size:14,className:"text-purple-500"})," "]}),i.jsxs("button",{className:`w-full text-left px-3 py-2 text-xs flex items-center gap-2 transition-colors ${e==="dark"?"text-zinc-300 hover:bg-zinc-800":"text-zinc-700 hover:bg-zinc-100"}`,onClick:()=>{const n=Xa.nodeId,c=At.get(n);if(!c||!c.content)return;const d=Xs.current;if(d&&d.size===9)fl(c.content,{replaceSelected:!0});else{const p=c.x+c.width+20,h=c.y;fl(c.content,{originX:p,originY:h})}hp()},children:[i.jsx(Jp,{size:14,className:"text-blue-500"})," "]})]}),i.jsx($z,{item:Sn,onClose:()=>xn(null),onNavigate:n=>{const c=ho.current;if(c&&c.mjImages&&c.mjImages.length>n&&n>=0){const d=Math.max(0,Math.min(n,c.mjImages.length-1)),f=c.mjImages[d],p=hs(c,f);c.id&&!c.storyboardContext&&$t(h=>h.map(g=>g.id===c.id?{...g,url:f,selectedMjImageIndex:d}:g)),xn({...c,url:p,selectedMjImageIndex:d})}},onShotNavigate:(n,c)=>{const d=ho.current;if(!(d!=null&&d.storyboardContext)||!c)return;const f=d.storyboardContext.shotIndex,p=n>f?1:-1;let h=n,g=null;for(;h>=0&&h<c.length;){const N=c[h];if(((N==null?void 0:N.output_images)||[]).length>0){g=N;break}h+=p}if(!g)return;const z=g.output_images||[],y=0;xn({url:z[y],type:"image",mjImages:z,selectedMjImageIndex:y,prompt:g.prompt,storyboardContext:{...d.storyboardContext,shotId:g.id,shotIndex:h}})},onHistoryNavigate:n=>{const c=ho.current;if(!c||c.storyboardContext)return;const d=dt.findIndex(p=>p.id===c.id);if(d===-1)return;let f=d+n;for(;f>=0&&f<dt.length;){const p=dt[f];if(p.url&&p.status==="completed"){const g=p.mjImages&&p.mjImages.length>1?p.mjImages[0]:p.url,z=g?hs(p,g):hs(p);xn({...p,url:z,selectedMjImageIndex:0,storyboardContext:null});return}f+=n}}}),i.jsxs(Iz,{isOpen:D1,onClose:()=>qr(!1),title:"",theme:e,children:[i.jsx("div",{className:"p-4 space-y-3",children:i.jsxs("div",{className:"mb-2",children:[i.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"Global API Key Key"}),i.jsx("div",{className:"mt-1 flex gap-2",children:i.jsx("input",{type:"password",value:an,onChange:n=>Yt(n.target.value),className:`flex-1 rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:" Key Key"})})]})}),i.jsxs("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:[i.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"V2.6.1 "}),i.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-2",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),i.jsxs("select",{value:Bn,onChange:n=>{const c=n.target.value;gn(c),localStorage.setItem("tapnow_performance_mode",c)},className:`text-xs rounded px-2 py-0.5 border outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`,children:[i.jsx("option",{value:"off",children:" ()"}),i.jsx("option",{value:"normal",children:" ()"}),i.jsx("option",{value:"ultra",children:" ()"})]})]}),i.jsx("p",{className:"text-[9px] text-zinc-500",children:""})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:""}),i.jsx("input",{type:"text",value:Zt,onChange:n=>{const c=n.target.value;Si(c),localStorage.setItem("tapnow_local_server_url",c)},placeholder:"http://127.0.0.1:9527",className:`w-full text-xs rounded px-2 py-1 border outline-none ${e==="dark"?"bg-zinc-800 border-zinc-700 text-zinc-300":"bg-white border-zinc-300"}`}),i.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-zinc-500",children:[i.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${on?"bg-green-500":"bg-red-500"}`}),i.jsx("span",{children:on?"":""})]})]}),i.jsx("p",{className:"text-[9px] text-zinc-500 mt-1",children:""})]})]})]}),i.jsxs("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:[i.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"API "}),i.jsxs("div",{className:"flex gap-2 mt-2",children:[i.jsxs("button",{onClick:()=>{const n={version:"3.4.23",exportTime:new Date().toISOString(),globalApiKey:an,providers:Pe,apiConfigs:Te.map(({key:S,url:C,...E})=>E)},c=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),d=URL.createObjectURL(c),f=document.createElement("a");f.href=d;const p=new Date,h=p.getFullYear().toString().slice(2),g=(p.getMonth()+1).toString().padStart(2,"0"),z=p.getDate().toString().padStart(2,"0"),y=p.getHours().toString().padStart(2,"0"),N=p.getMinutes().toString().padStart(2,"0");f.download=`tapnow-api-keys-${h}${g}${z}-${y}${N}.json`,f.click(),URL.revokeObjectURL(d)},className:`flex-1 px-3 py-2 text-xs rounded flex items-center justify-center gap-2 transition-colors ${e==="dark"?"bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 border border-blue-500/30":"bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200"}`,children:[i.jsx(No,{size:14})," API Keys"]}),i.jsxs("button",{onClick:()=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.onchange=async c=>{const d=c.target.files[0];if(d)try{const f=await d.text(),p=JSON.parse(f);if(p.globalApiKey&&(Yt(p.globalApiKey),localStorage.setItem("tapnow_global_key",p.globalApiKey)),p.providers&&Gt(h=>({...h,...p.providers})),p.apiConfigs&&Array.isArray(p.apiConfigs)){const h=p.apiConfigs.map(g=>{if(g.modelName&&g.modelName!==g.id)return{id:g.modelName,provider:g.provider,type:g.type,_uid:g._uid||`uid-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,...g.durations?{durations:g.durations}:{}};const{displayName:z,modelName:y,isCustom:N,key:S,url:C,...E}=g;return{...E,_uid:E._uid||`uid-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}});it(h)}alert("API ")}catch(f){alert(": "+f.message)}},n.click()},className:`flex-1 px-3 py-2 text-xs rounded flex items-center justify-center gap-2 transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700 border border-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200 border border-zinc-300"}`,children:[i.jsx(Hi,{size:14})," API Keys"]})]}),i.jsx("p",{className:"text-[9px] text-zinc-500 mt-1",children:" KeyProvider  Key"})]}),i.jsxs("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:[i.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"API "}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[i.jsxs("button",{onClick:()=>{$n({}),pn.current={},alert("")},className:`px-2 py-1.5 text-[10px] rounded flex items-center justify-center gap-1 transition-colors ${e==="dark"?"bg-red-600/20 text-red-400 hover:bg-red-600/30 border border-red-500/30":"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200"}`,children:[i.jsx(Bk,{size:12}),"",Object.keys(Jt).length>0&&i.jsx("span",{className:"ml-1 px-1 rounded bg-red-500/30 text-[9px]",children:Object.keys(Jt).length})]}),i.jsxs("button",{onClick:()=>{j({}),alert("")},className:`px-2 py-1.5 text-[10px] rounded flex items-center justify-center gap-1 transition-colors ${e==="dark"?"bg-amber-600/20 text-amber-400 hover:bg-amber-600/30 border border-amber-500/30":"bg-amber-50 text-amber-600 hover:bg-amber-100 border border-amber-200"}`,children:[i.jsx(Mg,{size:12}),"",Object.keys(Nn).length>0&&i.jsx("span",{className:"ml-1 px-1 rounded bg-amber-500/30 text-[9px]",children:Object.keys(Nn).length})]}),i.jsxs("button",{onClick:()=>{W.current=[],alert("")},className:`px-2 py-1.5 text-[10px] rounded flex items-center justify-center gap-1 transition-colors ${e==="dark"?"bg-blue-600/20 text-blue-400 hover:bg-blue-600/30 border border-blue-500/30":"bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200"}`,children:[i.jsx(ju,{size:12}),""]})]}),i.jsx("p",{className:"text-[9px] text-zinc-500 mt-1",children:" =  = 60 = 1006"})]}),i.jsx("div",{className:"mb-2 border-t pt-2 border-zinc-700/50",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"/"}),i.jsx("p",{className:`text-[10px] mt-0.5 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:" ()"})]}),i.jsxs("div",{className:"flex items-center gap-2 ml-3",children:[i.jsx("input",{type:"range",min:"1",max:"30",value:v,onChange:n=>{const c=parseInt(n.target.value)||5;I(c),localStorage.setItem("tapnow_max_undo_steps",String(c))},className:"w-20",onMouseDown:n=>n.stopPropagation()}),i.jsx("span",{className:`text-xs font-mono w-6 text-center ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,children:v})]})]})}),i.jsx("div",{className:"mb-2",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:""}),i.jsx("p",{className:`text-[10px] mt-0.5 ${e==="dark"?"text-zinc-600":"text-zinc-500"}`,children:"FormDataURL"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-3",children:[i.jsx("input",{type:"checkbox",checked:nt,onChange:n=>{const c=n.target.checked;gt(c),localStorage.setItem("tapnow_jimeng_use_local_file",String(c))},className:"sr-only peer"}),i.jsx("div",{className:`w-11 h-6 rounded-full peer peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-500/50 ${nt?"bg-blue-600":e==="dark"?"bg-zinc-700":"bg-zinc-300"} peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all`})]})]})}),i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:`text-xs ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,children:""}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{const n=Object.values(el).some(d=>d),c={};n||Object.keys(pr).forEach(d=>c[d]=!0),Xd(c)},className:`p-1 rounded hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors ${e==="dark"?"text-zinc-400":"text-zinc-500"}`,title:Object.values(el).some(n=>n)?"":"",children:i.jsx(Kk,{size:14,className:`transition-transform ${Object.values(el).some(n=>n)?"":"rotate-180"}`})}),i.jsxs(Su,{className:"h-7 text-xs px-3 bg-blue-600 hover:bg-blue-500",onClick:()=>{const n=`custom-${Date.now()}`,c="New Provider";Gt(d=>({...d,[n]:{name:c,key:"",url:"",enabled:!0}})),Xd(d=>({...d,[n]:!0})),$c({key:n,tempName:c})},children:[i.jsx(Vi,{size:14,className:"mr-1"})," "]})]})]}),i.jsx("div",{className:"space-y-2 max-h-[50vh] overflow-y-auto custom-scrollbar pr-1",children:Object.entries(pr).map(([n,c])=>{var d,f,p;return i.jsxs("div",{className:`group rounded-lg border ${e==="dark"?"bg-[#18181b] border-zinc-800":"bg-zinc-50 border-zinc-200"}`,children:[i.jsx("button",{onClick:()=>Xd(h=>({...h,[n]:!h[n]})),className:`w-full flex items-center justify-between px-3 py-2.5 text-left transition-colors ${e==="dark"?"hover:bg-zinc-800/50":"hover:bg-zinc-100"}`,children:W1===n?i.jsxs("div",{className:"flex items-center justify-between w-full",children:[i.jsxs("span",{className:`text-sm font-semibold ${e==="dark"?"text-zinc-100":"text-zinc-800"}`,children:[" ",c.name,"?"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:h=>{h.stopPropagation(),Gt(g=>{const z={...g};return delete z[n],z}),Jd(null)},className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-700 text-white rounded",children:""}),i.jsx("button",{onClick:h=>{h.stopPropagation(),Jd(null)},className:`text-xs px-2 py-1 rounded ${e==="dark"?"bg-zinc-700 hover:bg-zinc-600 text-zinc-300":"bg-zinc-200 hover:bg-zinc-300 text-zinc-700"}`,children:""})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[i.jsx("div",{className:`w-2 h-2 rounded-full ${((d=Pe[n])==null?void 0:d.enabled)!==!1?"bg-green-500":"bg-zinc-500"}`}),(ra==null?void 0:ra.key)===n?i.jsx("input",{type:"text",value:ra.tempName,onChange:h=>$c(g=>({...g,tempName:h.target.value})),onBlur:()=>{const h=ra.tempName.trim(),g=n;h&&h!==g&&(Gt(z=>{const{[g]:y,...N}=z;return{...N,[h]:y}}),it(z=>z.map(y=>y.provider===g?{...y,provider:h}:y))),$c(null)},onKeyDown:h=>{h.key==="Enter"&&h.target.blur(),h.stopPropagation()},onClick:h=>h.stopPropagation(),autoFocus:!0,className:`text-sm font-semibold bg-transparent border-b border-blue-500 outline-none w-full ${e==="dark"?"text-zinc-100":"text-zinc-800"}`}):i.jsx("span",{className:`text-sm font-semibold ${e==="dark"?"text-zinc-100":"text-zinc-800"}`,children:c.name}),i.jsxs("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${e==="dark"?"bg-zinc-800 text-zinc-500":"bg-zinc-200 text-zinc-500"}`,children:[c.models.length," "]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[!ra&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:h=>{h.stopPropagation(),$c({key:n,tempName:c.name})},className:"p-1 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors opacity-0 group-hover:opacity-100",title:"",children:i.jsx(iz,{size:12,className:e==="dark"?"text-zinc-400":"text-zinc-500"})}),i.jsx("button",{onClick:h=>{h.stopPropagation(),Jd(n)},className:"p-1 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors opacity-0 group-hover:opacity-100",title:"",children:i.jsx(Os,{size:12,className:e==="dark"?"text-zinc-400 hover:text-red-400":"text-zinc-500 hover:text-red-500"})})]}),i.jsx(Rs,{size:16,className:`transition-transform ${el[n]?"rotate-180":""} ${e==="dark"?"text-zinc-500":"text-zinc-400"}`})]})]})}),el[n]&&i.jsxs("div",{className:`px-3 pb-3 border-t ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[i.jsxs("div",{className:"pt-3 pb-2 space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[i.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider text-right ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"API Key"}),i.jsx("input",{type:"password",value:((f=Pe[n])==null?void 0:f.key)||"",onChange:h=>Gt(g=>({...g,[n]:{...g[n],key:h.target.value}})),className:`col-span-3 w-full rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:"sk-..."})]}),i.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[i.jsx("label",{className:`text-[10px] font-medium uppercase tracking-wider text-right ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:"Base URL"}),i.jsx("input",{type:"text",value:((p=Pe[n])==null?void 0:p.url)||"",onChange:h=>Gt(g=>({...g,[n]:{...g[n],url:h.target.value}})),className:`col-span-3 w-full rounded px-2 py-1 text-xs outline-none focus:border-blue-600/50 border ${e==="dark"?"bg-zinc-900 border-zinc-800 text-zinc-300":"bg-white border-zinc-300 text-zinc-900"}`,placeholder:"https://..."})]})]}),i.jsxs("div",{className:`mt-2 pt-2 border-t ${e==="dark"?"border-zinc-800/50":"border-zinc-200"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:`text-[10px] font-medium uppercase tracking-wider ${e==="dark"?"text-zinc-500":"text-zinc-600"}`,children:""}),i.jsxs("button",{onClick:()=>{const h=`${n}-${Date.now()}`;it(g=>[...g,{id:h,provider:n,type:"Chat"}])},className:`text-[9px] px-1.5 py-0.5 rounded flex items-center gap-1 ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-200 text-zinc-600 hover:bg-zinc-300"}`,children:[i.jsx(Vi,{size:10})," "]})]}),i.jsx("div",{className:"space-y-1.5",children:c.models.map(h=>i.jsxs("div",{className:`flex items-center justify-between px-2 py-1.5 rounded ${e==="dark"?"bg-zinc-900/50 hover:bg-zinc-800/50":"bg-white hover:bg-zinc-100"}`,children:[i.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[i.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${Ts(h.id)}`}),i.jsx("input",{type:"text",value:h.id||"",onChange:g=>Dh(h.id,{id:g.target.value},h.id),className:`text-xs bg-transparent border-b border-transparent hover:border-zinc-600 focus:border-blue-500 outline-none flex-1 font-mono ${e==="dark"?"text-zinc-300":"text-zinc-700"}`,placeholder:"model-id",title:` ID: ${h.id}`}),i.jsxs("select",{value:h.type||"Chat",onChange:g=>Dh(h.id,{type:g.target.value}),className:`text-[9px] px-1 rounded cursor-pointer outline-none ${e==="dark"?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700":"bg-zinc-200 text-zinc-500 hover:bg-zinc-300"}`,children:[i.jsx("option",{value:"Chat",children:"Chat"}),i.jsx("option",{value:"Image",children:"Image"}),i.jsx("option",{value:"Video",children:"Video"})]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:()=>ob(h.id),disabled:xh===h.id,className:`px-1.5 py-0.5 rounded text-[9px] ${qd[h.id]==="success"?"text-green-500":e==="dark"?"text-zinc-500 hover:text-zinc-300":"text-zinc-400 hover:text-zinc-600"}`,children:xh===h.id?i.jsx(hi,{size:10,className:"animate-spin"}):qd[h.id]==="success"?i.jsx(Ol,{size:10}):i.jsx($l,{size:10})}),i.jsx("button",{onClick:()=>ib(h.id),className:`px-1 ${e==="dark"?"text-zinc-600 hover:text-red-500":"text-zinc-400 hover:text-red-500"}`,children:i.jsx(Os,{size:10})})]})]},h._uid||h.id))})]})]})]},n)})}),i.jsx("div",{className:`pt-2 flex justify-end gap-2 border-t mt-3 ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:i.jsx(Su,{variant:"secondary",onClick:()=>qr(!1),children:""})})]}),U1&&i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[i.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>{Ic(!1),mo(new Set)}}),i.jsxs("div",{className:`relative w-[90vw] h-[85vh] max-w-7xl rounded-lg shadow-2xl flex flex-col ${e==="dark"?"bg-[#121214] border border-zinc-800":"bg-white border border-zinc-200"}`,children:[i.jsxs("div",{className:`p-4 border-b flex items-center justify-between ${e==="dark"?"border-zinc-800":"border-zinc-200"}`,children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("h2",{className:`text-lg font-bold ${e==="dark"?"text-zinc-100":"text-zinc-900"}`,children:""}),i.jsxs("span",{className:`text-sm ${e==="dark"?"text-zinc-400":"text-zinc-600"}`,children:[" ",ir.size," "]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{ir.size===dt.length?mo(new Set):mo(new Set(dt.map(n=>n.id)))},className:`px-3 py-1.5 text-xs rounded transition-colors ${e==="dark"?"bg-zinc-800 text-zinc-300 hover:bg-zinc-700":"bg-zinc-100 text-zinc-700 hover:bg-zinc-200"}`,children:ir.size===dt.length?"":""}),i.jsxs("button",{onClick:()=>{ir.size!==0&&confirm(` ${ir.size} `)&&($t(n=>{const c=n.filter(d=>!ir.has(d.id));try{localStorage.setItem("tapnow_history",JSON.stringify(c))}catch(d){console.error(":",d)}return c}),mo(new Set))},disabled:ir.size===0,className:`px-3 py-1.5 text-xs rounded transition-colors flex items-center gap-1.5 ${ir.size===0?e==="dark"?"bg-zinc-800/50 text-zinc-600 cursor-not-allowed":"bg-zinc-100 text-zinc-400 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:[i.jsx(Os,{size:14}),""]}),i.jsxs("button",{onClick:async()=>{if(ir.size===0)return;const n=(Zt||"").replace(/\/+$/,"");if(!n){o("","error");return}const d=dt.filter(f=>ir.has(f.id)).map(f=>f.localFilePath||f.localCacheUrl).filter(Boolean);if(d.length===0){o("","warning");return}try{const f=await fetch(`${n}/delete-batch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:d})});if(!f.ok){const h=await f.text();throw new Error(h||"")}const p=await f.json();$t(h=>h.map(g=>ir.has(g.id)?{...g,localCacheUrl:null,localFilePath:null}:g)),o((p==null?void 0:p.message)||` ${d.length} `,"success")}catch(f){o(`: ${f.message||""}`,"error")}},disabled:ir.size===0,className:`px-3 py-1.5 text-xs rounded transition-colors flex items-center gap-1.5 ${ir.size===0?e==="dark"?"bg-zinc-800/50 text-zinc-600 cursor-not-allowed":"bg-zinc-100 text-zinc-400 cursor-not-allowed":e==="dark"?"bg-amber-600/30 text-amber-200 hover:bg-amber-600/40":"bg-amber-100 text-amber-600 hover:bg-amber-200"}`,children:[i.jsx(Os,{size:14}),""]}),i.jsxs("button",{onClick:async()=>{if(ir.size===0)return;const n=dt.filter(p=>ir.has(p.id)&&(p.url||p.localCacheUrl||p.originalUrl||p.mjOriginalUrl));if(n.length===0){alert("");return}const c=mn(window.innerWidth/2,window.innerHeight/2),d=c.x,f=c.y;n.forEach((p,h)=>{const g=h%5*20,z=Math.floor(h/5)*20;let y=p.localCacheUrl||p.url||p.originalUrl||p.mjOriginalUrl;p.type==="video"&&!Un(y)&&(y+=(y.includes("?")?"&":"?")+"force_video_display=true"),p.type==="image"?(async()=>{try{const N=await Wr(y);$r("input-image",d+g,f+z,null,y,N)}catch{$r("input-image",d+g,f+z,null,y)}})():p.type==="video"&&$r("video-input",d+g,f+z,null,y)}),Ic(!1),mo(new Set)},disabled:ir.size===0,className:`px-3 py-1.5 text-xs rounded transition-colors flex items-center gap-1.5 ${ir.size===0?e==="dark"?"bg-zinc-800/50 text-zinc-600 cursor-not-allowed":"bg-zinc-100 text-zinc-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[i.jsx(wu,{size:14}),""]}),i.jsx("button",{onClick:()=>{Ic(!1),mo(new Set)},className:`p-1.5 rounded transition-colors ${e==="dark"?"text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800":"text-zinc-500 hover:text-zinc-700 hover:bg-zinc-200"}`,children:i.jsx(ns,{size:18})})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:i.jsx("div",{className:"grid grid-cols-4 gap-4",children:dt.map(n=>{var le,ne,te,$e,st;const c=ir.has(n.id),d=n.modelName||((le=n.apiConfig)==null?void 0:le.modelId)||((ne=n.apiConfig)==null?void 0:ne.model)||((te=n.apiConfig)==null?void 0:te.modelName)||n.model||"",f=d.length>12?`${d.slice(0,9)}...`:d,p=(on?n.localCacheUrl||(n.localCacheMap?Object.values(n.localCacheMap)[0]:null):null)||n.url||n.originalUrl||n.mjOriginalUrl,h=n.mjImages&&n.mjImages.length>0?n.mjImages:n.output_images&&n.output_images.length>0?n.output_images:null,g=h?h.map(Ue=>on&&n.localCacheMap&&n.localCacheMap[Ue]?n.localCacheMap[Ue]:Ue):null,z=typeof n.selectedMjImageIndex=="number"?n.selectedMjImageIndex:0,y=g?Math.min(z,g.length-1):0,N=g&&g.length>=4?g.slice(0,4):null,S=N?Math.min(y,N.length-1):0,C=g?g[y]||g[0]:p,E=!!(on&&(n.localCacheUrl||n.localFilePath||n.localCacheMap&&Object.keys(n.localCacheMap).length>0)),H=n.type==="video"||(C?Un(C):!1),A=n.ratio||n.mjRatio||"",U=n.resolution||(n.width&&n.height?`${n.width}x${n.height}`:""),V=U?U.replace(/p$/i,""):"",F=H&&n.duration?`${String(n.duration).replace(/s$/i,"")}s`:"",Q=[A,V].filter(Boolean);H&&F&&Q.push(F);const G=Q.join("/"),pe=n.startTime?new Date(n.startTime).toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit"}):n.time||"",J=typeof n.durationMs=="number"&&n.durationMs>0?`${(n.durationMs/6e4).toFixed(1)}m`:"",ge=H?n.hasInputImages?"":"":n.hasInputImages?"":"";return i.jsxs("div",{className:`relative rounded-lg overflow-hidden border-2 transition-all ${c?"border-blue-500 shadow-lg shadow-blue-500/20":e==="dark"?"border-zinc-800 hover:border-zinc-700":"border-zinc-200 hover:border-zinc-300"}`,children:[i.jsxs("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-1.5",children:[c&&i.jsx("div",{className:"bg-blue-500 rounded-full p-1",children:i.jsx(Ll,{size:16,className:"text-white"})}),n.status==="completed"&&C&&i.jsx("button",{onClick:Ue=>{Ue.stopPropagation();const Ze={...n,url:C,selectedMjImageIndex:h&&h.length>1?y:void 0};xn(Ze)},className:`p-1.5 rounded-full transition-colors backdrop-blur-sm ${e==="dark"?"bg-black/60 text-white hover:bg-black/80":"bg-white/80 text-zinc-700 hover:bg-white"}`,title:" ()",children:i.jsx(Ds,{size:14})})]}),i.jsxs("div",{className:`relative ${n.mjImages&&(n.mjImages.length===4||n.mjImages.length>1)||n.mjNeedsSplit&&((st=($e=n.apiConfig)==null?void 0:$e.modelId)!=null&&st.includes("mj"))?(()=>{const Ue=n.mjRatio||"1:1";return Ue==="16:9"?"aspect-video":Ue==="9:16"?"aspect-[9/16]":Ue==="4:3"?"aspect-[4/3]":Ue==="3:4"?"aspect-[3/4]":Ue==="21:9"?"aspect-[21/9]":"aspect-square"})():"aspect-video"} ${e==="dark"?"bg-zinc-900":"bg-zinc-100"}`,children:[E&&i.jsx("div",{className:"absolute top-2 left-2 z-10 text-[9px] px-2 py-0.5 rounded bg-orange-500 text-white shadow",children:""}),n.status==="completed"&&(C||N&&N.length>0)?H?i.jsx("video",{src:C,className:"w-full h-full object-contain",controls:!0,playsInline:!0,preload:"metadata"}):N&&N.length>0?i.jsx("div",{className:"grid grid-cols-2 grid-rows-2 w-full h-full",children:N.map((Ue,Ze)=>{const xt=S===Ze;return i.jsxs("div",{className:`relative w-full h-full cursor-pointer ${xt?"ring-2 ring-blue-400":""}`,onClick:yt=>{yt.stopPropagation(),$t(_t=>_t.map(bt=>bt.id===n.id?{...bt,selectedMjImageIndex:Ze}:bt))},onDoubleClick:yt=>{yt.preventDefault(),yt.stopPropagation(),xn({...n,url:Ue,selectedMjImageIndex:Ze})},children:[i.jsx(Vn,{src:Ue,className:`w-full h-full object-cover ${xt?"opacity-80":""}`,alt:`-${Ze+1}`}),xt&&i.jsx("div",{className:"absolute inset-0 bg-black/20 pointer-events-none"}),i.jsx("div",{className:"absolute bottom-1 left-1 bg-black/60 text-white text-[9px] px-1.5 py-0.5 rounded",children:Ze+1})]},`${n.id}-${Ze}`)})}):i.jsx(Vn,{src:C,className:"w-full h-full object-contain",alt:"",onError:Ue=>{Ue.target.style.display="none"}}):i.jsx("div",{className:`w-full h-full flex items-center justify-center ${e==="dark"?"text-zinc-600":"text-zinc-400"}`,children:n.status==="generating"?i.jsx(hi,{size:24,className:"animate-spin"}):i.jsx(Gk,{size:24})})]}),i.jsxs("div",{onClick:()=>{const Ue=new Set(ir);c?Ue.delete(n.id):Ue.add(n.id),mo(Ue)},className:`p-2 text-xs cursor-pointer ${e==="dark"?"bg-zinc-900 text-zinc-300":"bg-zinc-50 text-zinc-700"}`,children:[i.jsx("div",{className:"truncate font-medium",children:n.prompt||""}),i.jsxs("div",{className:"text-[10px] opacity-70 mt-0.5",children:[i.jsxs("span",{children:[ge," "]}),i.jsx("span",{title:d,children:f}),G&&i.jsxs("span",{children:["  ",G]}),pe&&i.jsxs("span",{children:["  ",pe]}),J&&i.jsxs("span",{children:["  ",J]})]})]})]},n.id)})})})]})]})]})]})]}),i.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-[9999] flex flex-col gap-2 pointer-events-none",children:r.map(n=>i.jsx("div",{className:`px-4 py-2 rounded-lg shadow-lg text-sm font-medium pointer-events-auto animate-pulse ${n.type==="success"?"bg-green-600 text-white":n.type==="error"?"bg-red-600 text-white":n.type==="warning"?"bg-yellow-500 text-black":"bg-zinc-800 text-white"}`,children:n.message},n.id))})]})}tf.createRoot(document.getElementById("root")).render(i.jsx(xd.StrictMode,{children:i.jsx(Mz,{})}));</script>
  <style rel="stylesheet" crossorigin>*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.\!visible{visibility:visible!important}.visible{visibility:visible}.collapse{visibility:collapse}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.-bottom-0\.5{bottom:-.125rem}.-bottom-1\.5{bottom:-.375rem}.-left-1{left:-.25rem}.-right-0\.5{right:-.125rem}.-right-1{right:-.25rem}.-right-2\.5{right:-.625rem}.-top-1{top:-.25rem}.-top-1\.5{top:-.375rem}.-top-10{top:-2.5rem}.-top-2\.5{top:-.625rem}.bottom-0{bottom:0}.bottom-1{bottom:.25rem}.bottom-2{bottom:.5rem}.bottom-4{bottom:1rem}.bottom-8{bottom:2rem}.bottom-full{bottom:100%}.left-0{left:0}.left-1{left:.25rem}.left-1\/2{left:50%}.left-2{left:.5rem}.left-4{left:1rem}.left-6{left:1.5rem}.left-full{left:100%}.right-0{right:0}.right-1{right:.25rem}.right-2{right:.5rem}.right-4{right:1rem}.top-0{top:0}.top-1{top:.25rem}.top-1\/2{top:50%}.top-12{top:3rem}.top-2{top:.5rem}.top-20{top:5rem}.top-4{top:1rem}.top-full{top:100%}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.z-\[100\]{z-index:100}.z-\[110\]{z-index:110}.z-\[120\]{z-index:120}.z-\[200\]{z-index:200}.z-\[60\]{z-index:60}.z-\[9999\]{z-index:9999}.col-span-3{grid-column:span 3 / span 3}.col-span-full{grid-column:1 / -1}.m-3{margin:.75rem}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:.25rem;margin-bottom:.25rem}.-mb-1{margin-bottom:-.25rem}.-mt-1{margin-top:-.25rem}.mb-0{margin-bottom:0}.mb-0\.5{margin-bottom:.125rem}.mb-1{margin-bottom:.25rem}.mb-1\.5{margin-bottom:.375rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-auto{margin-bottom:auto}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.ml-auto{margin-left:auto}.mr-0{margin-right:0}.mr-1{margin-right:.25rem}.mr-1\.5{margin-right:.375rem}.mr-2{margin-right:.5rem}.mt-0\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-auto{margin-top:auto}.line-clamp-1{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.line-clamp-2{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.hidden{display:none}.aspect-\[21\/9\]{aspect-ratio:21/9}.aspect-\[3\/4\]{aspect-ratio:3/4}.aspect-\[4\/3\]{aspect-ratio:4/3}.aspect-\[9\/16\]{aspect-ratio:9/16}.aspect-square{aspect-ratio:1 / 1}.aspect-video{aspect-ratio:16 / 9}.h-0{height:0px}.h-1{height:.25rem}.h-1\.5{height:.375rem}.h-10{height:2.5rem}.h-12{height:3rem}.h-14{height:3.5rem}.h-16{height:4rem}.h-2{height:.5rem}.h-20{height:5rem}.h-24{height:6rem}.h-28{height:7rem}.h-3{height:.75rem}.h-3\.5{height:.875rem}.h-4{height:1rem}.h-40{height:10rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-\[2px\]{height:2px}.h-\[85vh\]{height:85vh}.h-\[90px\]{height:90px}.h-auto{height:auto}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.max-h-32{max-height:8rem}.max-h-36{max-height:9rem}.max-h-64{max-height:16rem}.max-h-80{max-height:20rem}.max-h-\[140px\]{max-height:140px}.max-h-\[300px\]{max-height:300px}.max-h-\[50vh\]{max-height:50vh}.max-h-\[85vh\]{max-height:85vh}.max-h-\[90vh\]{max-height:90vh}.max-h-full{max-height:100%}.min-h-0{min-height:0px}.min-h-\[100px\]{min-height:100px}.min-h-\[14rem\]{min-height:14rem}.min-h-\[70px\]{min-height:70px}.min-h-\[80px\]{min-height:80px}.w-0{width:0px}.w-0\.5{width:.125rem}.w-1{width:.25rem}.w-1\.5{width:.375rem}.w-10{width:2.5rem}.w-11{width:2.75rem}.w-12{width:3rem}.w-14{width:3.5rem}.w-16{width:4rem}.w-2{width:.5rem}.w-20{width:5rem}.w-24{width:6rem}.w-3{width:.75rem}.w-3\.5{width:.875rem}.w-32{width:8rem}.w-36{width:9rem}.w-4{width:1rem}.w-40{width:10rem}.w-48{width:12rem}.w-5{width:1.25rem}.w-52{width:13rem}.w-6{width:1.5rem}.w-64{width:16rem}.w-7{width:1.75rem}.w-72{width:18rem}.w-8{width:2rem}.w-96{width:24rem}.w-\[160px\]{width:160px}.w-\[500px\]{width:500px}.w-\[680px\]{width:680px}.w-\[90vw\]{width:90vw}.w-auto{width:auto}.w-full{width:100%}.min-w-0{min-width:0px}.min-w-\[100px\]{min-width:100px}.min-w-\[300px\]{min-width:300px}.max-w-7xl{max-width:80rem}.max-w-\[200px\]{max-width:200px}.max-w-\[360px\]{max-width:360px}.max-w-\[85\%\]{max-width:85%}.max-w-\[90vw\]{max-width:90vw}.max-w-full{max-width:100%}.max-w-xl{max-width:36rem}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.border-collapse{border-collapse:collapse}.origin-top-left{transform-origin:top left}.-translate-x-1\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-full{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-75{--tw-scale-x: .75;--tw-scale-y: .75;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-90{--tw-scale-x: .9;--tw-scale-y: .9;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-95{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes bounce{0%,to{transform:translateY(-25%);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;animation-timing-function:cubic-bezier(0,0,.2,1)}}.animate-bounce{animation:bounce 1s infinite}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes spin{to{transform:rotate(360deg)}}.cursor-col-resize{cursor:col-resize}.cursor-default{cursor:default}.cursor-ew-resize{cursor:ew-resize}.cursor-move{cursor:move}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.cursor-text{cursor:text}.resize-none{resize:none}.resize{resize:both}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-row-reverse{flex-direction:row-reverse}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.flex-nowrap{flex-wrap:nowrap}.content-start{align-content:flex-start}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-0{gap:0px}.gap-0\.5{gap:.125rem}.gap-1{gap:.25rem}.gap-1\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.-space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(-.5rem * var(--tw-space-x-reverse));margin-left:calc(-.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-1\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.375rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.375rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-visible{overflow:visible}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.whitespace-pre-wrap{white-space:pre-wrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-xl{border-radius:.75rem}.rounded-bl{border-bottom-left-radius:.25rem}.rounded-br{border-bottom-right-radius:.25rem}.rounded-tl-none{border-top-left-radius:0}.rounded-tr{border-top-right-radius:.25rem}.rounded-tr-none{border-top-right-radius:0}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-\[\#18181b\]{--tw-border-opacity: 1;border-color:rgb(24 24 27 / var(--tw-border-opacity, 1))}.border-amber-200{--tw-border-opacity: 1;border-color:rgb(253 230 138 / var(--tw-border-opacity, 1))}.border-amber-500\/30{border-color:#f59e0b4d}.border-blue-200{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-blue-300{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.border-blue-400{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.border-blue-500{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.border-blue-500\/30{border-color:#3b82f64d}.border-blue-800{--tw-border-opacity: 1;border-color:rgb(30 64 175 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-300{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.border-green-400{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.border-green-500{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.border-purple-200{--tw-border-opacity: 1;border-color:rgb(233 213 255 / var(--tw-border-opacity, 1))}.border-purple-500\/20{border-color:#a855f733}.border-purple-800{--tw-border-opacity: 1;border-color:rgb(107 33 168 / var(--tw-border-opacity, 1))}.border-red-200{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.border-red-400{--tw-border-opacity: 1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.border-red-500\/30{border-color:#ef44444d}.border-red-500\/50{border-color:#ef444480}.border-red-800{--tw-border-opacity: 1;border-color:rgb(153 27 27 / var(--tw-border-opacity, 1))}.border-transparent{border-color:transparent}.border-violet-200{--tw-border-opacity: 1;border-color:rgb(221 214 254 / var(--tw-border-opacity, 1))}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.border-white\/10{border-color:#ffffff1a}.border-white\/60{border-color:#fff9}.border-white\/70{border-color:#ffffffb3}.border-white\/80{border-color:#fffc}.border-zinc-200{--tw-border-opacity: 1;border-color:rgb(228 228 231 / var(--tw-border-opacity, 1))}.border-zinc-300{--tw-border-opacity: 1;border-color:rgb(212 212 216 / var(--tw-border-opacity, 1))}.border-zinc-400{--tw-border-opacity: 1;border-color:rgb(161 161 170 / var(--tw-border-opacity, 1))}.border-zinc-500\/60{border-color:#71717a99}.border-zinc-600{--tw-border-opacity: 1;border-color:rgb(82 82 91 / var(--tw-border-opacity, 1))}.border-zinc-700{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.border-zinc-700\/40{border-color:#3f3f4666}.border-zinc-700\/50{border-color:#3f3f4680}.border-zinc-800{--tw-border-opacity: 1;border-color:rgb(39 39 42 / var(--tw-border-opacity, 1))}.border-zinc-800\/50{border-color:#27272a80}.bg-\[\#09090b\]{--tw-bg-opacity: 1;background-color:rgb(9 9 11 / var(--tw-bg-opacity, 1))}.bg-\[\#09090b\]\/90{background-color:#09090be6}.bg-\[\#121214\]{--tw-bg-opacity: 1;background-color:rgb(18 18 20 / var(--tw-bg-opacity, 1))}.bg-\[\#18181b\]{--tw-bg-opacity: 1;background-color:rgb(24 24 27 / var(--tw-bg-opacity, 1))}.bg-amber-100{--tw-bg-opacity: 1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.bg-amber-50{--tw-bg-opacity: 1;background-color:rgb(255 251 235 / var(--tw-bg-opacity, 1))}.bg-amber-500\/30{background-color:#f59e0b4d}.bg-amber-600\/20{background-color:#d9770633}.bg-amber-600\/30{background-color:#d977064d}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-black\/20{background-color:#0003}.bg-black\/40{background-color:#0006}.bg-black\/50{background-color:#00000080}.bg-black\/60{background-color:#0009}.bg-black\/70{background-color:#000000b3}.bg-black\/80{background-color:#000c}.bg-blue-100{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-blue-500\/10{background-color:#3b82f61a}.bg-blue-500\/20{background-color:#3b82f633}.bg-blue-500\/30{background-color:#3b82f64d}.bg-blue-500\/5{background-color:#3b82f60d}.bg-blue-600{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-600\/20{background-color:#2563eb33}.bg-blue-600\/30{background-color:#2563eb4d}.bg-blue-600\/80{background-color:#2563ebcc}.bg-blue-900\/20{background-color:#1e3a8a33}.bg-blue-900\/30{background-color:#1e3a8a4d}.bg-green-100{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-500\/20{background-color:#22c55e33}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-green-600\/40{background-color:#16a34a66}.bg-orange-100{--tw-bg-opacity: 1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-orange-500{--tw-bg-opacity: 1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.bg-orange-500\/20{background-color:#f9731633}.bg-orange-600\/30{background-color:#ea580c4d}.bg-purple-50{--tw-bg-opacity: 1;background-color:rgb(250 245 255 / var(--tw-bg-opacity, 1))}.bg-purple-500{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity: 1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-purple-600\/80{background-color:#9333eacc}.bg-purple-900\/30{background-color:#581c874d}.bg-red-100{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-500\/10{background-color:#ef44441a}.bg-red-500\/30{background-color:#ef44444d}.bg-red-500\/80{background-color:#ef4444cc}.bg-red-600{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-red-600\/20{background-color:#dc262633}.bg-red-600\/30{background-color:#dc26264d}.bg-red-600\/80{background-color:#dc2626cc}.bg-red-900\/30{background-color:#7f1d1d4d}.bg-transparent{background-color:transparent}.bg-violet-50{--tw-bg-opacity: 1;background-color:rgb(245 243 255 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/10{background-color:#ffffff1a}.bg-white\/40{background-color:#fff6}.bg-white\/80{background-color:#fffc}.bg-white\/90{background-color:#ffffffe6}.bg-yellow-500{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.bg-yellow-600{--tw-bg-opacity: 1;background-color:rgb(202 138 4 / var(--tw-bg-opacity, 1))}.bg-zinc-100{--tw-bg-opacity: 1;background-color:rgb(244 244 245 / var(--tw-bg-opacity, 1))}.bg-zinc-200{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.bg-zinc-300{--tw-bg-opacity: 1;background-color:rgb(212 212 216 / var(--tw-bg-opacity, 1))}.bg-zinc-400{--tw-bg-opacity: 1;background-color:rgb(161 161 170 / var(--tw-bg-opacity, 1))}.bg-zinc-50{--tw-bg-opacity: 1;background-color:rgb(250 250 250 / var(--tw-bg-opacity, 1))}.bg-zinc-50\/50{background-color:#fafafa80}.bg-zinc-500{--tw-bg-opacity: 1;background-color:rgb(113 113 122 / var(--tw-bg-opacity, 1))}.bg-zinc-600{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity, 1))}.bg-zinc-700{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.bg-zinc-700\/50{background-color:#3f3f4680}.bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.bg-zinc-800\/40{background-color:#27272a66}.bg-zinc-800\/50{background-color:#27272a80}.bg-zinc-800\/60{background-color:#27272a99}.bg-zinc-900{--tw-bg-opacity: 1;background-color:rgb(24 24 27 / var(--tw-bg-opacity, 1))}.bg-zinc-900\/30{background-color:#18181b4d}.bg-zinc-900\/50{background-color:#18181b80}.bg-zinc-900\/60{background-color:#18181b99}.bg-zinc-900\/80{background-color:#18181bcc}.bg-zinc-900\/90{background-color:#18181be6}.bg-zinc-950{--tw-bg-opacity: 1;background-color:rgb(9 9 11 / var(--tw-bg-opacity, 1))}.bg-zinc-950\/50{background-color:#09090b80}.bg-opacity-50{--tw-bg-opacity: .5}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-blue-600{--tw-gradient-from: #2563eb var(--tw-gradient-from-position);--tw-gradient-to: rgb(37 99 235 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-600{--tw-gradient-from: #16a34a var(--tw-gradient-from-position);--tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-purple-600{--tw-gradient-from: #9333ea var(--tw-gradient-from-position);--tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.to-emerald-600{--tw-gradient-to: #059669 var(--tw-gradient-to-position)}.to-indigo-600{--tw-gradient-to: #4f46e5 var(--tw-gradient-to-position)}.fill-current{fill:currentColor}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.p-0{padding:0}.p-0\.5{padding:.125rem}.p-1{padding:.25rem}.p-1\.5{padding:.375rem}.p-2{padding:.5rem}.p-2\.5{padding:.625rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-8{padding:2rem}.px-0\.5{padding-left:.125rem;padding-right:.125rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-1\.5{padding-left:.375rem;padding-right:.375rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\.5{padding-top:.625rem;padding-bottom:.625rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-1{padding-bottom:.25rem}.pb-2{padding-bottom:.5rem}.pb-3{padding-bottom:.75rem}.pl-1{padding-left:.25rem}.pl-2{padding-left:.5rem}.pl-8{padding-left:2rem}.pr-1{padding-right:.25rem}.pr-2{padding-right:.5rem}.pr-8{padding-right:2rem}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-3{padding-top:.75rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[10px\]{font-size:10px}.text-\[11px\]{font-size:11px}.text-\[7px\]{font-size:7px}.text-\[8px\]{font-size:8px}.text-\[9px\]{font-size:9px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-none{line-height:1}.leading-snug{line-height:1.375}.tracking-\[0\.3em\]{letter-spacing:.3em}.tracking-tighter{letter-spacing:-.05em}.tracking-wide{letter-spacing:.025em}.tracking-wider{letter-spacing:.05em}.tracking-widest{letter-spacing:.1em}.text-amber-200{--tw-text-opacity: 1;color:rgb(253 230 138 / var(--tw-text-opacity, 1))}.text-amber-400{--tw-text-opacity: 1;color:rgb(251 191 36 / var(--tw-text-opacity, 1))}.text-amber-600{--tw-text-opacity: 1;color:rgb(217 119 6 / var(--tw-text-opacity, 1))}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-700{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.text-cyan-500{--tw-text-opacity: 1;color:rgb(6 182 212 / var(--tw-text-opacity, 1))}.text-emerald-500{--tw-text-opacity: 1;color:rgb(16 185 129 / var(--tw-text-opacity, 1))}.text-green-200{--tw-text-opacity: 1;color:rgb(187 247 208 / var(--tw-text-opacity, 1))}.text-green-300{--tw-text-opacity: 1;color:rgb(134 239 172 / var(--tw-text-opacity, 1))}.text-green-400{--tw-text-opacity: 1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity: 1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-orange-200{--tw-text-opacity: 1;color:rgb(254 215 170 / var(--tw-text-opacity, 1))}.text-orange-400{--tw-text-opacity: 1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity: 1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-purple-300{--tw-text-opacity: 1;color:rgb(216 180 254 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-purple-500{--tw-text-opacity: 1;color:rgb(168 85 247 / var(--tw-text-opacity, 1))}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-700{--tw-text-opacity: 1;color:rgb(126 34 206 / var(--tw-text-opacity, 1))}.text-red-200{--tw-text-opacity: 1;color:rgb(254 202 202 / var(--tw-text-opacity, 1))}.text-red-300{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-white\/70{color:#ffffffb3}.text-yellow-300{--tw-text-opacity: 1;color:rgb(253 224 71 / var(--tw-text-opacity, 1))}.text-yellow-700{--tw-text-opacity: 1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.text-zinc-100{--tw-text-opacity: 1;color:rgb(244 244 245 / var(--tw-text-opacity, 1))}.text-zinc-200{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.text-zinc-300{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.text-zinc-400{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.text-zinc-500{--tw-text-opacity: 1;color:rgb(113 113 122 / var(--tw-text-opacity, 1))}.text-zinc-600{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.text-zinc-700{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.text-zinc-800{--tw-text-opacity: 1;color:rgb(39 39 42 / var(--tw-text-opacity, 1))}.text-zinc-900{--tw-text-opacity: 1;color:rgb(24 24 27 / var(--tw-text-opacity, 1))}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.placeholder-zinc-400::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(161 161 170 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-400::placeholder{--tw-placeholder-opacity: 1;color:rgb(161 161 170 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-500::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(113 113 122 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-500::placeholder{--tw-placeholder-opacity: 1;color:rgb(113 113 122 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-600::-moz-placeholder{--tw-placeholder-opacity: 1;color:rgb(82 82 91 / var(--tw-placeholder-opacity, 1))}.placeholder-zinc-600::placeholder{--tw-placeholder-opacity: 1;color:rgb(82 82 91 / var(--tw-placeholder-opacity, 1))}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-20{opacity:.2}.opacity-30{opacity:.3}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-70{opacity:.7}.opacity-80{opacity:.8}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(0\,0\,0\,0\.5\)\]{--tw-shadow: 0 0 10px rgba(0,0,0,.5);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_10px_rgba\(255\,255\,255\,0\.5\)\]{--tw-shadow: 0 0 10px rgba(255,255,255,.5);--tw-shadow-colored: 0 0 10px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(239\,68\,68\,0\.8\)\]{--tw-shadow: 0 0 8px rgba(239,68,68,.8);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(34\,197\,94\,0\.6\)\]{--tw-shadow: 0 0 8px rgba(34,197,94,.6);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\[0_0_8px_rgba\(34\,197\,94\,0\.8\)\]{--tw-shadow: 0 0 8px rgba(34,197,94,.8);--tw-shadow-colored: 0 0 8px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-inner{--tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / .05);--tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-black\/10{--tw-shadow-color: rgb(0 0 0 / .1);--tw-shadow: var(--tw-shadow-colored)}.shadow-black\/40{--tw-shadow-color: rgb(0 0 0 / .4);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-300\/30{--tw-shadow-color: rgb(147 197 253 / .3);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-500\/20{--tw-shadow-color: rgb(59 130 246 / .2);--tw-shadow: var(--tw-shadow-colored)}.shadow-blue-900\/20{--tw-shadow-color: rgb(30 58 138 / .2);--tw-shadow: var(--tw-shadow-colored)}.outline-none{outline:2px solid transparent;outline-offset:2px}.ring-1{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-blue-300\/60{--tw-ring-color: rgb(147 197 253 / .6)}.ring-blue-400{--tw-ring-opacity: 1;--tw-ring-color: rgb(96 165 250 / var(--tw-ring-opacity, 1))}.ring-blue-500{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.ring-blue-500\/30{--tw-ring-color: rgb(59 130 246 / .3)}.ring-blue-500\/50{--tw-ring-color: rgb(59 130 246 / .5)}.ring-green-500\/50{--tw-ring-color: rgb(34 197 94 / .5)}.ring-offset-2{--tw-ring-offset-width: 2px}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-\[50px\]{--tw-blur: blur(50px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-md{--tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0 / .07)) drop-shadow(0 2px 2px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.grayscale{--tw-grayscale: grayscale(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-\[2px\]{--tw-backdrop-blur: blur(2px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-xl{--tw-backdrop-blur: blur(24px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-filter{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-shadow{transition-property:box-shadow;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-100{transition-duration:.1s}.duration-150{transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{transition-timing-function:linear}.will-change-transform{will-change:transform}body{margin:0;padding:0;background-color:#09090b}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.select-text{-webkit-user-select:text;-moz-user-select:text;user-select:text}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.art-loader-container{position:fixed;top:0;left:0;right:0;bottom:0;background-color:#09090b;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;color:#e4e4e7}.art-center-group{display:flex;flex-direction:column;align-items:center;transform:translateY(-20px)}.art-visual{position:relative;width:60px;height:60px;margin-bottom:30px}.art-ring-outer{position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid rgba(255,255,255,.1);border-radius:50%;animation:art-breathe 4s ease-in-out infinite}.art-ring-inner{position:absolute;top:0;right:0;bottom:0;left:0;border-radius:50%;border:1px solid transparent;border-top-color:#fff;border-left-color:#ffffff4d;opacity:.8;animation:art-spin 2s cubic-bezier(.4,0,.2,1) infinite}.art-dot{position:absolute;top:50%;left:50%;width:4px;height:4px;background-color:#fff;border-radius:50%;transform:translate(-50%,-50%);box-shadow:0 0 10px #ffffff80}.art-title{font-size:12px;font-weight:300;text-transform:uppercase;letter-spacing:.3em;opacity:.9;margin-bottom:8px}.art-status{font-family:Courier New,monospace;font-size:10px;color:#71717a;letter-spacing:.1em;animation:art-pulse 2s ease-in-out infinite}.art-footer{position:absolute;bottom:40px;display:flex;flex-direction:column;align-items:center;text-align:center;gap:12px;opacity:0;animation:art-fade-up 1s ease-out .5s forwards}.footer-author{display:flex;flex-direction:column;gap:4px}.footer-author .label{font-size:9px;color:#52525b;text-transform:uppercase;letter-spacing:.2em}.footer-author .name{font-size:14px;font-weight:500;letter-spacing:.5em;color:#fff;text-indent:.5em}.footer-divider{width:20px;height:1px;background-color:#27272a}.footer-thanks{display:flex;flex-direction:column;gap:2px}.footer-thanks .label{font-size:8px;color:#3f3f46;text-transform:uppercase;letter-spacing:.1em}.footer-thanks .content{font-size:10px;color:#71717a;font-family:Courier New,monospace}.footer-thanks .highlight{color:#a1a1aa;font-weight:600}@keyframes art-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes art-breathe{0%,to{transform:scale(1);opacity:.5}50%{transform:scale(1.1);opacity:.2}}@keyframes art-pulse{0%,to{opacity:.4}50%{opacity:.8}}@keyframes art-fade-up{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.markdown-body{line-height:1.5}.markdown-body p{margin:0}.markdown-body p+p{margin-top:.5em}.markdown-body ul,.markdown-body ol{margin:.5em 0;padding-left:1.5em}.markdown-body pre{margin:.5em 0;padding:.5em;border-radius:.5em;overflow-x:auto}.markdown-body code{font-size:.875em}.placeholder\:text-zinc-400::-moz-placeholder{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-400::placeholder{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-600::-moz-placeholder{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-600::placeholder{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-700::-moz-placeholder{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.placeholder\:text-zinc-700::placeholder{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.placeholder\:text-opacity-50::-moz-placeholder{--tw-text-opacity: .5}.placeholder\:text-opacity-50::placeholder{--tw-text-opacity: .5}.after\:absolute:after{content:var(--tw-content);position:absolute}.after\:left-\[2px\]:after{content:var(--tw-content);left:2px}.after\:top-\[2px\]:after{content:var(--tw-content);top:2px}.after\:h-5:after{content:var(--tw-content);height:1.25rem}.after\:w-5:after{content:var(--tw-content);width:1.25rem}.after\:rounded-full:after{content:var(--tw-content);border-radius:9999px}.after\:bg-white:after{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.after\:transition-all:after{content:var(--tw-content);transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.after\:content-\[\'\'\]:after{--tw-content: "";content:var(--tw-content)}.focus-within\:border-blue-500\/30:focus-within{border-color:#3b82f64d}.focus-within\:border-blue-500\/50:focus-within{border-color:#3b82f680}.hover\:h-6:hover{height:1.5rem}.hover\:scale-100:hover{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-blue-300:hover{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.hover\:border-blue-400:hover{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.hover\:border-blue-500:hover{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.hover\:border-blue-500\/30:hover{border-color:#3b82f64d}.hover\:border-blue-500\/50:hover{border-color:#3b82f680}.hover\:border-green-400:hover{--tw-border-opacity: 1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.hover\:border-green-500:hover{--tw-border-opacity: 1;border-color:rgb(34 197 94 / var(--tw-border-opacity, 1))}.hover\:border-zinc-300:hover{--tw-border-opacity: 1;border-color:rgb(212 212 216 / var(--tw-border-opacity, 1))}.hover\:border-zinc-400:hover{--tw-border-opacity: 1;border-color:rgb(161 161 170 / var(--tw-border-opacity, 1))}.hover\:border-zinc-500:hover{--tw-border-opacity: 1;border-color:rgb(113 113 122 / var(--tw-border-opacity, 1))}.hover\:border-zinc-600:hover{--tw-border-opacity: 1;border-color:rgb(82 82 91 / var(--tw-border-opacity, 1))}.hover\:border-zinc-700:hover{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.hover\:bg-amber-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.hover\:bg-amber-200:hover{--tw-bg-opacity: 1;background-color:rgb(253 230 138 / var(--tw-bg-opacity, 1))}.hover\:bg-amber-600\/30:hover{background-color:#d977064d}.hover\:bg-amber-600\/40:hover{background-color:#d9770666}.hover\:bg-black\/70:hover{background-color:#000000b3}.hover\:bg-black\/80:hover{background-color:#000c}.hover\:bg-blue-100:hover{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-200:hover{--tw-bg-opacity: 1;background-color:rgb(191 219 254 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-400:hover{--tw-bg-opacity: 1;background-color:rgb(96 165 250 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-400\/30:hover{background-color:#60a5fa4d}.hover\:bg-blue-500:hover{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-500\/30:hover{background-color:#3b82f64d}.hover\:bg-blue-600:hover{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-600\/30:hover{background-color:#2563eb4d}.hover\:bg-blue-600\/50:hover{background-color:#2563eb80}.hover\:bg-blue-700:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-green-200:hover{--tw-bg-opacity: 1;background-color:rgb(187 247 208 / var(--tw-bg-opacity, 1))}.hover\:bg-green-400:hover{--tw-bg-opacity: 1;background-color:rgb(74 222 128 / var(--tw-bg-opacity, 1))}.hover\:bg-green-500:hover{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.hover\:bg-green-500\/30:hover{background-color:#22c55e4d}.hover\:bg-green-600:hover{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.hover\:bg-green-600\/60:hover{background-color:#16a34a99}.hover\:bg-orange-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 215 170 / var(--tw-bg-opacity, 1))}.hover\:bg-orange-500\/30:hover{background-color:#f973164d}.hover\:bg-orange-600\/40:hover{background-color:#ea580c66}.hover\:bg-purple-400:hover{--tw-bg-opacity: 1;background-color:rgb(192 132 252 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-500:hover{--tw-bg-opacity: 1;background-color:rgb(168 85 247 / var(--tw-bg-opacity, 1))}.hover\:bg-red-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.hover\:bg-red-200:hover{--tw-bg-opacity: 1;background-color:rgb(254 202 202 / var(--tw-bg-opacity, 1))}.hover\:bg-red-50:hover{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500:hover{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500\/10:hover{background-color:#ef44441a}.hover\:bg-red-600:hover{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.hover\:bg-red-600\/30:hover{background-color:#dc26264d}.hover\:bg-red-600\/50:hover{background-color:#dc262680}.hover\:bg-red-700:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\:bg-red-800:hover{--tw-bg-opacity: 1;background-color:rgb(153 27 27 / var(--tw-bg-opacity, 1))}.hover\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\:bg-white\/20:hover{background-color:#fff3}.hover\:bg-yellow-400:hover{--tw-bg-opacity: 1;background-color:rgb(250 204 21 / var(--tw-bg-opacity, 1))}.hover\:bg-yellow-500:hover{--tw-bg-opacity: 1;background-color:rgb(234 179 8 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-100:hover{--tw-bg-opacity: 1;background-color:rgb(244 244 245 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-200:hover{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-300:hover{--tw-bg-opacity: 1;background-color:rgb(212 212 216 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-600:hover{--tw-bg-opacity: 1;background-color:rgb(82 82 91 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-700:hover{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-800:hover{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.hover\:bg-zinc-800\/50:hover{background-color:#27272a80}.hover\:from-blue-500:hover{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-green-500:hover{--tw-gradient-from: #22c55e var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:from-purple-500:hover{--tw-gradient-from: #a855f7 var(--tw-gradient-from-position);--tw-gradient-to: rgb(168 85 247 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.hover\:to-emerald-500:hover{--tw-gradient-to: #10b981 var(--tw-gradient-to-position)}.hover\:to-indigo-500:hover{--tw-gradient-to: #6366f1 var(--tw-gradient-to-position)}.hover\:text-blue-300:hover{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.hover\:text-blue-400:hover{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.hover\:text-blue-500:hover{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.hover\:text-blue-600:hover{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.hover\:text-green-600:hover{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.hover\:text-red-400:hover{--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.hover\:text-red-500:hover{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.hover\:text-red-600:hover{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\:text-zinc-200:hover{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.hover\:text-zinc-300:hover{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.hover\:text-zinc-600:hover{--tw-text-opacity: 1;color:rgb(82 82 91 / var(--tw-text-opacity, 1))}.hover\:text-zinc-700:hover{--tw-text-opacity: 1;color:rgb(63 63 70 / var(--tw-text-opacity, 1))}.hover\:text-zinc-800:hover{--tw-text-opacity: 1;color:rgb(39 39 42 / var(--tw-text-opacity, 1))}.hover\:text-zinc-900:hover{--tw-text-opacity: 1;color:rgb(24 24 27 / var(--tw-text-opacity, 1))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-100:hover{opacity:1}.hover\:shadow-md:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:ring-1:hover{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.hover\:ring-zinc-400:hover{--tw-ring-opacity: 1;--tw-ring-color: rgb(161 161 170 / var(--tw-ring-opacity, 1))}.focus\:border-blue-500:focus{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\:border-blue-500\/50:focus{border-color:#3b82f680}.focus\:border-blue-600\/50:focus{border-color:#2563eb80}.focus\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\:ring-blue-500\/50:focus{--tw-ring-color: rgb(59 130 246 / .5)}.active\:scale-95:active{--tw-scale-x: .95;--tw-scale-y: .95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:opacity-50:disabled{opacity:.5}.group\/insert:hover .group-hover\/insert\:scale-100{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:bg-blue-500{--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.group:hover .group-hover\:bg-zinc-200{--tw-bg-opacity: 1;background-color:rgb(228 228 231 / var(--tw-bg-opacity, 1))}.group:hover .group-hover\:bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.group\/cell:hover .group-hover\/cell\:opacity-100,.group\/insert:hover .group-hover\/insert\:opacity-100,.group\/main:hover .group-hover\/main\:opacity-100,.group\/preview:hover .group-hover\/preview\:opacity-100,.group:hover .group-hover\:opacity-100{opacity:1}.peer:checked~.peer-checked\:after\:translate-x-full:after{content:var(--tw-content);--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.peer:checked~.peer-checked\:after\:border-white:after{content:var(--tw-content);--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.peer:focus~.peer-focus\:outline-none{outline:2px solid transparent;outline-offset:2px}.peer:focus~.peer-focus\:ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.peer:focus~.peer-focus\:ring-blue-500\/50{--tw-ring-color: rgb(59 130 246 / .5)}@media (prefers-color-scheme: dark){.dark\:border-zinc-700{--tw-border-opacity: 1;border-color:rgb(63 63 70 / var(--tw-border-opacity, 1))}.dark\:bg-blue-900\/30{background-color:#1e3a8a4d}.dark\:bg-zinc-700{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.dark\:bg-zinc-800{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.dark\:text-blue-300{--tw-text-opacity: 1;color:rgb(147 197 253 / var(--tw-text-opacity, 1))}.dark\:text-blue-400{--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.dark\:text-zinc-200{--tw-text-opacity: 1;color:rgb(228 228 231 / var(--tw-text-opacity, 1))}.dark\:text-zinc-300{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}.dark\:text-zinc-400{--tw-text-opacity: 1;color:rgb(161 161 170 / var(--tw-text-opacity, 1))}.dark\:hover\:bg-blue-900\/30:hover{background-color:#1e3a8a4d}.dark\:hover\:bg-zinc-700:hover{--tw-bg-opacity: 1;background-color:rgb(63 63 70 / var(--tw-bg-opacity, 1))}.dark\:hover\:bg-zinc-800:hover{--tw-bg-opacity: 1;background-color:rgb(39 39 42 / var(--tw-bg-opacity, 1))}.dark\:hover\:text-zinc-300:hover{--tw-text-opacity: 1;color:rgb(212 212 216 / var(--tw-text-opacity, 1))}}</style>
</head>

<body style="margin: 0; padding: 0; background-color: #09090b;">
    <div id="root"></div>
</body>

</html>